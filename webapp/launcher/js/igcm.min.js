IG$.classmodule=$s.extend($s.panel,{closable:!0,layout:"border",bodyPadding:0,_init:function(){this.loadDataSource()},loadDataSource:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"tablecontent",payload:{address:"/"},mbody:{option:"standard"}},e,function(e){var t,i,a=[],o=e.pools,n=this.down("[name=t_ds]");if(a.push({name:"Select Database Instance",poolname:""}),o)for(t=0;t<o.length;t++)i=o[t],a.push(i);n.store.loadData(a),n.setValue(""),this.loadItemContent()},function(){e.loadItemContent()}),t.send()},loadItemContent:function(){var e,t=this;(e=new IG$._rpc$).init(t,{ack:"content",payload:{uid:t.uid},mbody:{option:"standard"}},t,t.rs_loadItemContent,!1),e.send()},rs_loadItemContent:function(e){var t,i,a,o,n,s,l,d=this,r=e.content,m=d.down("[name=t_ds]");(d.item=r).modules=r.modules||[],m.setValue(r.data_source||""),window.ace?(t=$(d.down("[name=javasrc]").el.dom),(i=$(".idv-jcl-edtr",t)).empty(),o=IG$.j$ext._w(t),n=IG$.j$ext._h(t),a=$("<div class='idv-jcl-view'></div>").appendTo(i),IG$.j$ext._w(a,o),IG$.j$ext._h(a,n),(l=ace.edit(a[0])).getSession().setMode("ace/mode/java"),d.scripteditor=l,d.scriptview=a,d.scriptview=a,d.scripteditor=l,t=$(d.down("[name=javasrc_all]").el.dom),(i=$(".idv-jcl-edtr",t)).empty(),o=IG$.j$ext._w(t),n=IG$.j$ext._h(t),a=$("<div class='idv-jcl-view'></div>").appendTo(i),IG$.j$ext._w(a,o),IG$.j$ext._h(a,n),(l=ace.edit(a[0])).getSession().setMode("ace/mode/java"),d.scriptview_all=a,d.scripteditor_all=l,s=r.modules,d.down("[name=g_m]").store.loadData(s)):IG$.getScriptCache(ig$.scmap.igcg,new IG$.callBackObj(d,function(){this.rs_loadItemContent(e)}))},saveMetaContent:function(e){var t=this,i=new IG$._rpc$,a=t.item,o="source"==e?"plugin":"writecontent",n=t.down("[name=t_ds]");t.commitModule(),a.data_source=n.getValue(),i.init(t,{ack:o,payload:{uid:t.uid,option:"source"==e?e:null},mbody:a,meta_type:"class_module"},t,t.rs_saveMetaContent,null,e),i.send()},rs_saveMetaContent:function(e,t){"source"==t?this.scripteditor_all.setValue(e.source):"compile"==t?this.doCompile():IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},doCompile:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"plugin",payload:{uid:e.uid,option:"compile"},mbody:e.item,meta_type:"class_module"},e,e.rs_doCompile,null),t.send()},rs_doCompile:function(e){var t,a=this,o=e&&e.length?e[0]:null,n=[];if(o&&"E"==o.status){for((t=o.results).error_details=t.error_details||[],i=0;i<t.error_details.length;i++)n.push("line : "+t.error_details[i].line_number+", "+t.error_details[i].message);a.down("[name=compileres]").setValue(n.join("\r\n")),a.setViewMode(1)}else a.down("[name=compileres]").setValue(""),IG$.alertmsg(ig$.appname,"Compiled Successfully",null,null,0,"success")},toolbarHandler:function(e){var t,o,n,i,a=this,s=a.down("[name=g_m]");switch(e){case"cmd_save":a.saveMetaContent();break;case"cmd_compile":a.saveMetaContent("compile");break;case"cmd_source":a.saveMetaContent("source");break;case"cmd_rename":case"cmd_delete":if((t=s.getSelectionModel().selected)&&0<t.length&&(o=t.items[0]),o&&o.get("name")){for(i=0;i<a.item.modules.length;i++)if(a.item.modules[i].name==o.get("name")){"cmd_delete"==e?a.item.modules.splice(i,1):n=a.item.modules[i];break}if("cmd_delete"==e)s.store.remove(o),a._module=null,a.scripteditor.setValue("");else{var l=new IG$.makeItemEditor({itemtype:"Module",itemname:n.name,description:n.description,commit_f:function(){var e=this,t=e.down("[name=fitemname]"),i=e.down("[name=fitemname]").getValue(),a=e.down("[name=fdesc]").getValue();e.down("[name=fhelpuid]").getValue(),e.down("[name=selitemtype]");t.clearInvalid(),i?-1<i.indexOf(" ")?t.markInvalid(["Space not allowed"]):(o.set("name",i),o.set("description",a),n.name=i,n.description=a,e.close()):t.markInvalid([t.blankText])}});IG$.checkLogin(this,l)}}}},commitModule:function(){var n=this;n._module&&(n._module.script=n.scripteditor.getValue(),n._module.iparams=[],n._module.oparams=[],$.each(["iparams","oparams"],function(e,t){var i,a=n.down("[name=g_"+t+"]"),o=n._module[t];for(e=0;e<a.store.data.items.length;e++)(i=a.store.data.items[e]).get("name")&&o.push({name:i.get("name")})}))},editModule:function(e){var t,i,n=this,a=e.get("name"),o=n.item;for(n._module&&n.commitModule(),t=0;t<o.modules.length;t++)if(o.modules[t].name==a){i=o.modules[t];break}i&&(n.down("[name=m_s]").show(),n.scripteditor.setValue(i.script||""),n._module=i,$.each(["iparams","oparams"],function(e,t){var i=n.down("[name=g_"+t+"]"),a=[],o=n._module[t];if(o)for(e=0;e<o.length;e++)a.push({name:o[e].name});i.store.loadData(a)}))},addModule:function(e,t){var i,a=this,o=a.down("[name=g_m]"),n=!0;for(a._module&&a.commitModule(),i=0;i<a.item.modules.length;i++)if(a.item.modules[i].name==e){n=!1;break}return 1==n&&(o.store.add({name:e,description:t}),a.item.modules.push({name:e,description:t,script:null,iparams:[],oparams:[]})),n},setViewMode:function(e){var t=this,i=t.down("[name=mcard]"),a=t.down("[name=t_source]");t.vcard=-1<e?e:0==t.vcard?1:0,0==t.vcard?(i.getLayout().setActiveItem(0),a.setText("View Source")):(i.getLayout().setActiveItem(1),a.setText("Edit Code"),t.toolbarHandler("cmd_source"))},initComponent:function(){var s=this;s.vcard=0,$s.apply(this,{items:[{xtype:"panel",layout:"card",region:"center",flex:1,name:"mcard",items:[{xtype:"panel",layout:"border",items:[{xtype:"panel",title:"Module Functions",region:"west",layout:"fit",split:!0,collapsible:!0,collapseMode:"mini",width:300,tbar:[{text:"New",handler:function(){var e=new IG$.makeItem({itemtype:"Module",commit_f:function(){var e=this,t=e.down("[name=fitemname]"),i=e.down("[name=fitemname]").getValue(),a=e.down("[name=fdesc]").getValue();e.down("[name=fhelpuid]").getValue(),e.down("[name=selitemtype]");t.clearInvalid(),i?-1<i.indexOf(" ")?t.markInvalid(["Space not allowed"]):1==s.addModule.call(s,i,a)&&e.close():t.markInvalid([t.blankText])}});IG$.checkLogin(this,e)},scope:this},{text:"Rename",handler:function(){this.toolbarHandler("cmd_rename")},scope:this},{text:"Delete",handler:function(){this.toolbarHandler("cmd_delete")},scope:this}],items:[{xtype:"gridpanel",name:"g_m",store:{xtype:"store",fields:["name","description"]},columns:[{text:IRm$.r1("B_NAME"),flex:1,dataIndex:"name"},{text:IRm$.r1("B_DESC"),flex:1,dataIndex:"description"},{xtype:"actioncolumn",width:30,menuDisabled:!0,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("L_EDIT"),handler:function(e,t,i){var a=e.store.getAt(t);this.editModule(a)},scope:this}]}],listeners:{cellclick:function(e,t,i,a,o,n,s,l){2!=i&&this.editModule(a)},scope:this}}]},{region:"center",xtype:"panel",flex:1,title:"Module Sources",layout:"fit",items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",border:0,layout:"border",name:"m_s",hidden:!0,items:[{name:"javasrc",region:"center",flex:1,html:"<div class='idv-jcl-edtr'></div>",split:!0,listeners:{resize:function(e,t,i,a,o,n){s.scriptview&&s.scripteditor&&(IG$.j$ext._w(s.scriptview,t),IG$.j$ext._h(s.scriptview,i),s.scripteditor.resize(!0))}}},{xtype:"panel",region:"east",width:200,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"g_iparams",title:"Input Parameters",flex:1,store:{xtype:"store",fields:["name"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},plugins:[{ptype:"cellediting",clicksToEdit:1}],columns:[{text:IRm$.r1("B_NAME"),flex:1,dataIndex:"name",editor:{xtype:"textfield",allowBlank:!1}}],tbar:[{xtype:"button",text:IRm$.r1("B_ADD"),handler:function(){this.down("[name=g_iparams]").store.add({name:"",value:""})},scope:this},{xtype:"button",text:IRm$.r1("B_REMOVE"),handler:function(){var e,t=this.down("[name=g_iparams]"),i=t.store,a=t.getSelectionModel().selected;for(e=a.length-1;0<=e;e--)i.remove(a.items[e])},scope:this}]},{xtype:"gridpanel",title:"Output Parameters",name:"g_oparams",flex:1,store:{xtype:"store",fields:["name"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},plugins:[{ptype:"cellediting",clicksToEdit:1}],columns:[{text:IRm$.r1("B_NAME"),flex:1,dataIndex:"name",editor:{xtype:"textfield",allowBlank:!1}}],tbar:[{xtype:"button",text:IRm$.r1("B_ADD"),handler:function(){this.down("[name=g_oparams]").store.add({name:"",value:""})},scope:this},{xtype:"button",text:IRm$.r1("B_REMOVE"),handler:function(){var e,t=this.down("[name=g_oparams]"),i=t.store,a=t.getSelectionModel().selected;for(e=a.length-1;0<=e;e--)i.remove(a.items[e])},scope:this}]}]}]}]}]}]},{xtype:"panel",title:"Source View (ReadOnly)",layout:"border",items:[{name:"javasrc_all",flex:1,region:"center",html:"<div class='idv-jcl-edtr'></div>",split:!0,listeners:{resize:function(e,t,i,a,o,n){s.scriptview_all&&s.scripteditor_all&&(IG$.j$ext._w(s.scriptview_all,t),IG$.j$ext._h(s.scriptview_all,i),s.scripteditor_all.resize(!0))}}},{xtype:"panel",title:"Compile Messages",height:200,region:"south",layout:"fit",items:[{xtype:"textarea",name:"compileres"}]}]}]}],tbar:[{iconCls:"icon-toolbar-save",name:"t_save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this.toolbarHandler("cmd_save")},scope:this},{iconCls:"icon-toolbar-saveas",name:"t_save_as",tooltip:IRm$.r1("L_SAVE_CONTENT_AS"),handler:function(){this.toolbarHandler("cmd_compile")},scope:this},{xtype:"combobox",name:"t_ds",tooltip:IRm$.r1("L_DATA_SOURCE"),fieldLabel:IRm$.r1("L_DATA_SOURCE"),labelPosition:"right",queryMode:"local",displayField:"name",valueField:"poolname",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","uid","poolname","isuserdb","savepwd"]}},{text:"Package Lists",handler:function(){new IG$.classModuleClsImport({litem:this.item}).show()},scope:this},"->",{name:"t_source",text:"View Source",handler:function(){this.setViewMode(-1)},scope:this}]}),IG$.classmodule.superclass.initComponent.call(this)},listeners:{afterrender:function(e){this._init()}}}),IG$.classModuleClsImport=$s.extend($s.window,{width:300,height:200,modal:!0,layout:"fit",closable:!1,resizable:!1,title:"Package Lists",_init:function(){var e=this.down("[name=ltx]"),t=this.litem;t&&e.setValue(t.cls||"")},_confirm:function(){var e=this.down("[name=ltx]"),t=this.litem;t&&(t.cls=e.getValue()),this.close()},items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"textarea",name:"ltx",flex:1},{xtype:"displayfield",value:"* Add class lists with Java : import java.util.*;"}]}],initComponent:function(){$s.apply(this,{buttons:["->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$.classModuleClsImport.superclass.initComponent.call(this)},listeners:{afterrender:function(e){e._init()}}});
!function(e,t){"object"==typeof exports?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):t(e.jQuery)}(this,function(n){function o(e,o){var n,t=document.createElement("canvas");e.appendChild(t),"undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(t);var i=t.getContext("2d");t.width=t.height=o.size;var a=1;1<window.devicePixelRatio&&(a=window.devicePixelRatio,t.style.width=t.style.height=[o.size,"px"].join(""),t.width=t.height=o.size*a,i.scale(a,a)),i.translate(o.size/2,o.size/2),i.rotate((o.rotate/180-.5)*Math.PI);var r=(o.size-o.lineWidth)/2;function s(e,t,n){var a=(n=Math.min(Math.max(-1,n||0),1))<=0;i.beginPath(),i.arc(0,0,r,0,2*Math.PI*n,a),i.strokeStyle=e,i.lineWidth=t,i.stroke()}function d(){o.scaleColor&&function(){var e,t;i.lineWidth=1,i.fillStyle=o.scaleColor,i.save();for(var n=24;0<n;--n)e=n%6==0?(t=o.scaleLength,0):(t=.6*o.scaleLength,o.scaleLength-t),i.fillRect(-o.size/2+e,0,t,1),i.rotate(Math.PI/12);i.restore()}(),o.trackColor&&s(o.trackColor,o.lineWidth,1)}o.scaleColor&&o.scaleLength&&(r-=o.scaleLength+2),Date.now=Date.now||function(){return+new Date};var h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};this.getCanvas=function(){return t},this.getCtx=function(){return i},this.clear=function(){i.clearRect(o.size/-2,o.size/-2,o.size,o.size)},this.draw=function(e){var t;o.scaleColor||o.trackColor?i.getImageData&&i.putImageData?n?i.putImageData(n,0,0):(d(),n=i.getImageData(0,0,o.size*a,o.size*a)):(this.clear(),d()):this.clear(),i.lineCap=o.lineCap,t="function"==typeof o.barColor?o.barColor(e):o.barColor,s(t,o.lineWidth,e/100)}.bind(this),this.animate=function(n,a){var i=Date.now();o.onStart(n,a);var r=function(){var e=Math.min(Date.now()-i,o.animate.duration),t=o.easing(this,e,n,a-n,o.animate.duration);this.draw(t),o.onStep(n,a,t),e>=o.animate.duration?o.onStop(n,a):h(r)}.bind(this);h(r)}.bind(this)}function a(t,n){var a={barColor:"#ef1e25",trackColor:"#f9f9f9",scaleColor:"#dfe0e0",scaleLength:5,lineCap:"round",lineWidth:3,size:110,rotate:0,animate:{duration:1e3,enabled:!0},easing:function(e,t,n,a,i){return(t/=i/2)<1?a/2*t*t+n:-a/2*(--t*(t-2)-1)+n},onStart:function(e,t){},onStep:function(e,t,n){},onStop:function(e,t){}};if(void 0!==o)a.renderer=o;else{if("undefined"==typeof SVGRenderer)throw new Error("Please load either the SVG- or the CanvasRenderer");a.renderer=SVGRenderer}var i={},r=0,e=function(){for(var e in this.el=t,this.options=i,a)a.hasOwnProperty(e)&&(i[e]=n&&void 0!==n[e]?n[e]:a[e],"function"==typeof i[e]&&(i[e]=i[e].bind(this)));"string"==typeof i.easing&&"undefined"!=typeof jQuery&&jQuery.isFunction(jQuery.easing[i.easing])?i.easing=jQuery.easing[i.easing]:i.easing=a.easing,"number"==typeof i.animate&&(i.animate={duration:i.animate,enabled:!0}),"boolean"!=typeof i.animate||i.animate||(i.animate={duration:1e3,enabled:i.animate}),this.renderer=new i.renderer(t,i),this.renderer.draw(r),t.dataset&&t.dataset.percent?this.update(parseFloat(t.dataset.percent)):t.getAttribute&&t.getAttribute("data-percent")&&this.update(parseFloat(t.getAttribute("data-percent")))}.bind(this);this.update=function(e){return e=parseFloat(e),i.animate.enabled?this.renderer.animate(r,e):this.renderer.draw(e),r=e,this}.bind(this),this.disableAnimation=function(){return i.animate.enabled=!1,this},this.enableAnimation=function(){return i.animate.enabled=!0,this},e()}n.fn.easyPieChart=function(t){return this.each(function(){var e;n.data(this,"easyPieChart")||(e=n.extend({},t,n(this).data()),n.data(this,"easyPieChart",new a(this,e)))})}});
IG$.relationMgr=$s.extend($s.window,{modal:!0,closable:!1,resizable:!0,layout:"fit",width:600,autoHeight:!0,layout:{type:"fit"},bodyPadding:0,loadRelation:function(s,d){var e=this,t=new IG$._rpc$;t.init(e,{ack:"helpcontent",payload:{uid:s||e.uid},mbody:{option:"relations",isdown:e.isdown?"T":"F",detail:"info"}},e,function(e){var t,n,i=this.down("[name="+(d||"grd_rel")+"]"),l=e&&e.children?e.children:[],a=this.down("[name=txtrel]"),o=[];for(s||a.setValue("Relations : "+e.name+"("+e.nodepath+")"),t=0;t<l.length;t++)(n=l[t]).iconcls=IG$.get_metatype_icon(n.type.toLowerCase(),n),o.push(n);i.store.loadData(o)},!1),t.send()},initComponent:function(){$s.apply(this,{title:IRm$.r1("T_Resources"),items:[{xtype:"panel",bodyPadding:10,minHeight:500,layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",name:"txtrel",value:"Relations"},{xtype:"gridpanel",name:"grd_rel",flex:1,store:{xtype:"store",fields:["name","nodepath","uid","type","iconcls"]},columns:[{xtype:"templatecolumn",text:IRm$.r1("B_NAME"),menuDisabled:!0,flex:1,minWidth:160,tdCls:"ig-navi-namecol",tpl:"<div class='ig-navi-itemicon {iconcls}'></div><span title='{name} ({type})'>{name}</span>"},{text:"Location",flex:1,minWidth:200,dataIndex:"nodepath"}],listeners:{cellclick:function(e,t,n,i,l,a,o,s){var d=this.down("[name=png_rel_sub]"),p=i.get("uid");0==n&&(d.show(),this.loadRelation(p,"grd_rel_sub"))},scope:this}},{xtype:"panel",name:"png_rel_sub",flex:1,hidden:!0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",value:"Sub relations"},{xtype:"gridpanel",flex:1,name:"grd_rel_sub",store:{xtype:"store",fields:["name","nodepath","uid","type","iconcls"]},columns:[{xtype:"templatecolumn",text:IRm$.r1("B_NAME"),menuDisabled:!0,flex:1,minWidth:160,tdCls:"ig-navi-namecol",tpl:"<div class='ig-navi-itemicon {iconcls}'></div><span title='{name} ({type})'>{name}</span>"},{text:"Location",flex:1,minWidth:200,dataIndex:"nodepath"}]}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.close()},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}]}),IG$.relationMgr.superclass.initComponent.call(this)},listeners:{afterrender:function(e){e.loadRelation()}}});
IG$.mgrFeatures=$s.extend(IG$.v$pnl,{scroll:!1,closable:!0,layout:"border",userinfo:null,groupinfo:null,iconCls:"icon-doc-features",loadAuth:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"usercontent",payload:{address:"/Auth"},mbody:{option:"select"}},e,e.r_loadAuth,!1),t.send()},r_loadAuth:function(e){var t,s,a,o=this.down("[name=gridduty]");o.getSelectionModel();if(e)for(t=0;t<e.length;t++){switch((s=e[t]).active="1"==s.status?"Active":"Disabled",s.dutytype){case"A":a="Default";break;case"G":a="Group";break;case"C":a="Custom";break;case"U":a="User";break;default:a=s.dutytype}s.dutytype_d=a}o.store.loadData(e),this.loadFeatures()},loadFeatures:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"usercontent",payload:{address:"/Features"},mbody:{option:"get"}},e,e.r_loadFeatures,!1),t.send()},r_loadFeatures:function(e){var t,s=this,a=s.down("[name=tf]");e&&(t={name:"Root",children:e},a.store.setRootNode(t),a.store.getRootNode().expand(!0),s.recordmap=[],s.getRecordMap(a.store.getRootNode()))},saveFeatures:function(){var e,t=this,s=t.down("[name=gridduty]").getSelectionModel().selected,a=t.down("[name=tf]").store.getRootNode(),o={features:[]};if(s&&0<s.length){e=s.items[0].get("sid"),o.uid=e,t.updateFeature(a,o.features);var n=this,d=new IG$._rpc$;d.init(n,{ack:"writecontent",payload:{uid:e,type:"feature"},mbody:o,meta_type:"features"},n,n.r_saveFeatures,!1),d.send()}},r_saveFeatures:function(e){IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},updateFeature:function(e,t){if(e.childNodes){var s,a,o;for(s=0;s<e.childNodes.length;s++)(a=e.childNodes[s]).get("mshow")&&(o={name:a.get("name"),cls:a.get("cls"),clspath:a.get("clspath"),show:a.get("mshow")||!1},t.push(o)),this.updateFeature(a,t)}},loadFeature:function(){var e,t=this,s=t.down("[name=dfn]"),a=t.down("[name=btn_save]"),o=t.down("[name=gridduty]").getSelectionModel().selected;if(0<o.length){t.setLoading(!0),e=o.items[0].get("sid"),s.setValue("Duty: "+o.items[0].get("name")),a.setDisabled(!1);var n=this,d=new IG$._rpc$;d.init(n,{ack:"usercontent",payload:{address:"/Features",sid:e},mbody:{option:"content"}},n,n.r_loadFeature,!1),d.send()}},r_loadFeature:function(e){var t,s,a,o,n=this,d=n.recordmap,i=n.down("[name=tf]"),r={};if(n.setLoading(!1),e&&e.features)for(t=0;t<e.features.length;t++)r[(s=e.features[t]).clspath]=s;for(i.suspendLayouts(),i.suspendEvents(!1),i.store.suspendEvents(!1),t=0;t<d.length;t++)o=!!(s=r[(a=d[t]).get("clspath")])&&s.show,a.get("mshow")!=o&&a.set("mshow",o);i.store.resumeEvents(),i.resumeEvents(),i.resumeLayouts()},getRecordMap:function(e){if(e.childNodes){var t,s;for(t=0;t<e.childNodes.length;t++)s=e.childNodes[t],this.recordmap.push(s),this.getRecordMap(s)}},updateTreeNode:function(e,t){var s;if(e.childNodes&&e.childNodes.length)for(s=0;s<e.childNodes.length;s++)this.updateTreeNode(e.childNodes[s],t),e.childNodes[s].set("mshow",t)},initComponent:function(){this.title=IRm$.r1("T_FEATURES"),$s.apply(this,{items:[{xtype:"panel",width:270,region:"west",title:"Duties",layout:"fit",items:[{xtype:"grid",name:"gridduty",selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"SINGLE"},store:{xtype:"store",fields:["sid","name","active","status","dutytype","dutytype_d"]},columns:[{dataIndex:"dutytype_d",text:"Type",width:60},{dataIndex:"name",text:"Name",flex:1},{dataIndex:"active",width:80,text:"Status"}],tbar:[{text:"Load Auth",handler:function(){this.loadAuth()},scope:this},{text:"Refresh",handler:function(){this.loadFeatures()},scope:this}],listeners:{selectionchange:function(e,t,s){this.loadFeature()},scope:this}}]},{xtype:"panel",region:"center",flex:1,title:"Features",layout:"fit",items:[{xtype:"treepanel",name:"tf",store:{xtype:"treestore",fields:["name","cls","clspath","mshow"]},columns:[{xtype:"treecolumn",text:"Name",dataIndex:"name",flex:1},{xtype:"gridcolumn",dataIndex:"cls"},{xtype:"checkcolumn",dataIndex:"mshow",text:"Show",width:80}],tbar:[{xtype:"displayfield",name:"dfn",value:"Click Duty to set features"},"-",{text:"Save",name:"btn_save",xtype:"button",disabled:!0,iconCls:"icon-toolbar-save",handler:function(){this.saveFeatures()},scope:this}],listeners:{cellclick:function(e,t,s,a,o,n,d,i){1==s&&a.expand(!0)},checkchange:function(e,t){this.updateTreeNode(e,t)},scope:this}}]}]}),IG$.mgrFeatures.superclass.initComponent.call(this)},listeners:{afterrender:function(){this.loadAuth()}}});
IG$.mgrRevision=$s.extend(IG$.v$pnl,{scroll:!1,closable:!0,layout:"border",iconCls:"icon-group",loadUID:function(e){var t=this,i=new IG$._rpc$;t.setLoading(!0),i.init(t,{ack:"helpcontent",payload:{uid:e},mbody:{option:"translate"}},t,function(e){t.setLoading(!1),e&&e.length&&(t.metaobj=e[0],t.applyMetaObj.call(t))},!1),i.send()},applyMetaObj:function(){var e,t=this,i=t.metaobj,n=i.type.toLowerCase(),o=t.down("[name=f_1]"),a=t.down("[name=f_2]"),d=t.down("[name=_f1]");e=t.checkFolderType(n),t.folderhierarchy=[],o.setVisible(0!=e),0!=e?(t.folderhierarchy.push(i),d.setValue(i.name),a.store.loadData([]),2==e&&t.down("[name=_f3]").show(),this.loadFolderContent()):t.loadRevision(i.uid)},loadRevision:function(e){var c=this,t=new IG$._rpc$;c.setLoading(!0),c._loadedUID=e,t.init(c,{ack:"revision",payload:{uid:e},mbody:{option:"get"}},c,function(e){c.setLoading(!1);var t,i,n,o=c.down("[name=f_3]"),a=c.down("[name=f_4]"),d=c.down("[name=f_5]"),l=c.down("[name=f_6]"),s=c.down("[name=f_7]"),r=[];if(e){if(t=e,a.setValue(t.name),d.setValue(t.nodepath),l.setValue(t.description),s.setValue(t.revision),tnode=e.revisions,tnode)for(n=0;n<tnode.length;n++)(i=tnode[n]).uid=t.uid,i.iscurrent=t.revision==i.revision?"YES":"",i.writable=t.writable,r.push(i);t._history=r,c.minfo=t,o.store.loadData(r)}},!1),t.send()},updateRevision:function(){var e,t,i,n=this,o=n.minfo,a=n.down("[name=f_7]"),d=!1,l=n.minfo.uid;if(a.clearInvalid(),o){for(e=a.getValue(),t=0;t<o._history.length;t++)if(o._history[t].revision==e){d=!0;break}if(0==d)return a.markInvalid("Not valid revision"),void IG$.ShowError("Not valid revision",n);i=new IG$._rpc$,n.setLoading(!0),i.init(n,{ack:"revision",payload:{uid:l,revision:""+e},mbody:{option:"setrevision"}},n,function(e){n.setLoading(!1),n.loadRevision.call(n,l),IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},!1),i.send()}},loadFolderContent:function(){var d=this,e=d.metaobj,t=new IG$._rpc$,i=d.down("[name=_f1]");d.setLoading(!0),i.setValue(e.name),t.init(d,{ack:"content",payload:{uid:e.uid},mbody:{subfolder:"T"}},d,function(e){d.setLoading(!1);var t,i,n=e?e.children:null,o=(d.folderhierarchy,[]),a=d.down("[name=f_2]");if(n)for(t=0;t<n.length;t++)i=n[t],o.push(i);a.store.loadData(o)},!1),t.send()},checkFolderType:function(e){var t=0;return"cubemodel"==e?t=0:/folder|javapackage/.test(e)?t=1:/datacube|cube|metrics|mcube|nosql|sqlcube|mdbcube/.test(e)&&(t=2),t},updateRevisionDesc:function(e){var t=new IG$._rpc$;t.init(this,{ack:"revision",payload:{uid:e.get("uid"),revision:""+e.get("revision")},mbody:{option:"updatedesc",name:"desc",value:e.get("description")}},this,function(e){},!1),t.send()},openRevision:function(e,t){var i=this.down("[name=f_3]"),n=this.minfo,o=i.store.data.items[e],a=IG$.mainPanel;a&&n&&o&&o.get("uid")&&a.navigateApp.call(a,n.uid,n.type.toLowerCase(),n.name,n.nodepath,!0,n.writable,{revision:""+o.get("revision")})},removeItem:function(e,t){var i,n=this,o=n.down("[name=f_3]").store.data.items[e];o&&o.get("uid")&&((i=new IG$._rpc$).init(n,{ack:"revision",payload:{uid:o.get("uid"),revision:""+o.get("revision")},mbody:{option:"clear_rev"}},n,function(e){n._loadedUID&&n.loadRevision(n._loadedUID)},!1),i.send())},initComponent:function(){var n=this;n.title=IRm$.r1("T_REVISION"),$s.apply(this,{border:0,bodyPadding:5,items:[{xtype:"panel",title:"List of Items",region:"west",width:420,name:"f_1",layout:{type:"vbox",align:"stretch"},hidden:!0,split:!0,collapseMode:"mini",collapsible:!0,padding:5,items:[{xtype:"fieldset",title:"Folder Info",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",flex:1,fieldLabel:null,readOnly:!0,name:"_f1"},{xtype:"button",text:"Up",hidden:!0,name:"_f2",handler:function(){var e,t=this,i=t.folderhierarchy,n=t.down("[name=_f2]"),o=t.down("[name=_f3]");i.splice(i.length-1,1),t.metaobj=i[i.length-1],e=t.checkFolderType(t.metaobj.type.toLowerCase()),n.setVisible(1<i.length),o.setVisible(2==e),t.loadFolderContent(),2==e&&t.loadRevision(t.metaobj.uid)},scope:this},{xtype:"button",text:"->",hidden:!0,name:"_f3",handler:function(){var e=this.folderhierarchy[this.folderhierarchy.length-1];e&&this.loadRevision(e.uid)},scope:this}]},{xtype:"fieldset",title:"Search",hidden:!0,layout:{type:"vbox",align:"stretch"},defaults:{labelWidth:70},items:[{xtype:"textfield",fieldLabel:"Keyword"},{xtype:"combobox",queryMode:"local",displayField:"name",valueField:"value",editable:!1,fieldLabel:"Last Modified",value:"",store:{xtype:"store",fields:["name","value"],data:[{name:"Select",value:""},{name:"1 Day",value:"1d"},{name:"2 Day",value:"2d"},{name:"3 Day",value:"3d"},{name:"1 Week",value:"1w"}]}},{xtype:"fieldcontainer",layout:"hbox",items:[{xtype:"container",flex:1},{xtype:"button",text:"Run",handler:function(){this.loadFolderContent()},scope:this}]}]},{xtype:"gridpanel",name:"f_2",store:{xtype:"store",fields:["name","nodepath","revision","updatedate","updatedatefm","uid","type"]},flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"SINGLE"},$v:{scrollX:!0},columns:[{text:"Name",dataIndex:"name",minWidth:120},{text:"Revision",dataIndex:"revision",minWidth:80},{text:"Path",dataIndex:"nodepath",flex:1,minWidth:300},{text:"Last Updated",dataIndex:"updatedatefm",minWidth:160}],listeners:{cellclick:function(e,t,i,n,o,a,d,l){var s,r=this,c=n.get("uid"),p=n.get("type"),u=r.down("[name=_f2]"),h=r.down("[name=_f3]");0==(s=r.checkFolderType(p.toLowerCase()))?r.loadRevision(c):(r.metaobj={uid:c,name:n.get("name"),type:p,nodepath:n.get("nodepath")},r.folderhierarchy.push(r.metaobj),u.setVisible(1<r.folderhierarchy.length),h.setVisible(2==s),r.loadFolderContent(),2==s&&r.loadRevision(c))},scope:this}}]},{xtype:"panel",region:"center",title:"Revision Management",flex:1,padding:5,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Information",layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",layout:"anchor",flex:1,border:1,padding:"0 5 0",bodyPadding:4,defaults:{labelAlign:"right"},items:[{xtype:"textfield",fieldLabel:"Name",readOnly:!0,name:"f_4"},{xtype:"textfield",anchor:"100%",fieldLabel:"Location",readOnly:!0,name:"f_5"},{xtype:"textarea",anchor:"100%",height:120,fieldLabel:"Description",readOnly:!0,name:"f_6"}]},{xtype:"panel",layout:{type:"vbox",align:"stretch"},width:240,flex:1,border:1,padding:"0 5 0",bodyPadding:4,defaults:{labelAlign:"right"},items:[{xtype:"fieldcontainer",fieldLabel:"Current Revision",anchor:"100%",layout:"anchor",items:[{xtype:"numberfield",width:60,maxWidth:80,minValue:0,name:"f_7"},{xtype:"fieldcontainer",layout:"hbox",fieldLabel:null,items:[{xtype:"button",text:"Change Revision",handler:function(){this.updateRevision()},scope:this}]}]},{xtype:"container",flex:1}]}]},{xtype:"fieldcontainer",layout:{type:"hbox"},items:[{xtype:"button",text:"Refresh",width:80,margin:"0 4 0",handler:function(){this._loadedUID&&this.loadRevision(this._loadedUID)},scope:this},{xtype:"button",text:"Clear",width:80,handler:function(){var e,t=this;t._loadedUID&&((e=new IG$._rpc$).init(t,{ack:"revision",payload:{uid:t._loadedUID},mbody:{option:"clear_hist"}},t,function(e){t._loadedUID&&t.loadRevision(t._loadedUID)},!1),e.send())},scope:this},{xtype:"displayfield",flex:1,value:"Clear previous revision history",padding:"0 5 0"}]},{xtype:"gridpanel",name:"f_3",selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},store:{xtype:"store",fields:["uid","revision","updatedate","updatedatefm","description","username","userid","iscurrent","writable"]},defaults:{menuDisabled:!0},plugins:[{ptype:"cellediting",clicksToEdit:1}],columns:[{text:"Revision",dataIndex:"revision"},{text:"Updated Date",dataIndex:"updatedatefm",width:150},{text:"Modified By",dataIndex:"username"},{text:"Description",dataIndex:"description",flex:1,editor:{xtype:"textfield",allowBlank:!0}},{text:"Current",dataIndex:"iscurrent"},{xtype:"actioncolumn",width:50,menuDisabled:!0,items:[{iconCls:"icon-grid-add",tooltip:"Open This Revision",handler:function(e,t,i){n.openRevision.call(n,t,i)}},{iconCls:"icon-grid-delete",tooltip:"Remove History",handler:function(e,t,i){n.removeItem.call(n,t,i)}}]}],listeners:{edit:function(e,t,i){var n=t.record;this.updateRevisionDesc(n)},scope:this}}]}]}),IG$.mgrRevision.superclass.initComponent.call(this)},listeners:{afterrender:function(e){this.loadUID(this.uid)}}});
IG$.userdbTemplate=$s.extend($s.window,{modal:!0,region:"center",closable:!1,resizable:!1,width:320,height:400,confirm:function(){var e,a,t,l=this,n=l.fielditems;for(t=0;t<n.length;t++)if(e=n[t].fname,a=l.down("[name="+e+"]").getValue(),n[t].uvalue=a,1!=n[t].optional&&!a)return void IG$.alertmsg(ig$.appname,IRm$.r1("T_DB_BLANK"),null,l,null,null,1,"error");var i=l.applyValue();l.callback&&l.callback.execute(i),l.close()},applyValue:function(){var e,a=this,t=a.fieldvalue,l=a.fielditems,n={};for(e=0;e<l.length;e++)n[l[e].fname]=l[e].uvalue;return a.processValue(t,n,!1)},processValue:function(e,a,t){var l,n,i,s,r=[],o=!1,u=!1,c=!1;for(l=0;l<e.length;l++)switch(n=e[l]){case"<":1==u?s+=n:(o=!0,i="");break;case"[":o=!(u=!0),s="";break;case">":0==u&&1==o?(a[i]&&(r.push(a[i]),c=!0),o=!1):1==u&&(s+=n);break;case"]":u=!1;var p=this.processValue(s,a,!0);r.push(p);break;default:1==u?s+=n:1==o?i+=n:r.push(n)}return 0==c&&1==t?"":r.join("")},parseValue:function(e){var a,t,l,n=[],i=!1,s=!1;for(a=0;a<e.length;a++)switch(t=e[a]){case"<":s=!0,l=t;break;case"[":i=!0;break;case">":1==s&&(s=!1,l+=t,n.push({field:l,fname:l.substring(1,l.length-1),optional:i}));break;case"]":i=!1;break;default:1==s&&(l+=t)}return n},initComponent:function(){var e,a,t=this,l=[],n=t.fieldvalue;for(t.title=IRm$.r1("T_DB_TMPL"),t.fielditems=e=t.parseValue(n),a=0;a<e.length;a++)l.push({fieldLabel:e[a].fname,name:e[a].fname,value:"",allowBlank:e[a].optional,blankText:"Item name is required!"});$s.apply(this,{padding:10,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},autoScroll:!0,items:[{region:"center",id:"dlgmakemetaform",defaultType:"textfield",layout:{type:"vbox",align:"stretch"},defaults:{labelWidth:80},items:l}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.confirm()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$.userdbTemplate.superclass.initComponent.apply(this,arguments)}});
IG$.resourcemgr=$s.extend($s.panel,{closable:!0,iconCls:"icon-ing-docdef",layout:"fit",bodyPadding:10,init_f:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"content",payload:{uid:e.pp},mbody:{}},e,e.rs_loadLocales,e.rs_loadLocales),t.send()},rs_loadLocales:function(e){var t,n,a=e?e.children:null,o=this.down("[name=c_loc]"),l=this.down("[name=c_loc2]"),i=[{name:"Select locale",value:""}];if(a&&a.length)for(t=0;t<a.length;t++)n=a[t],i.push({name:n.name,value:n.uid});o.store.loadData(i),o.setValue(""),l.store.loadData(i),l.setValue("")},changeLocale:function(e){var t,n=this,a=n.down("[name=c_loc"+(e?"2":"")+"]"),o=n.down("[name=grdrcs]"),l=n.down("[name=vcol1]"),i=n.down("[name=vcol2]"),s=a.getValue();if(s)n.loadCnt(s,e);else if(e){for(i.setText("-"),t=0;t<o.store.data.items.length;t++)o.store.data.items[t].set("value2","");for(t=0;t<o.__dp.length;t++)o.__dp[t].value2=""}else l.setText("-"),i.setText("-"),n.loadGrid([])},loadGrid:function(e){var t,n=this,a=n.down("[name=grdrcs]"),o=n.down("[name=_pb_d]"),l=n.down("[name=_pb_c]"),i=Math.ceil(e.length/100),s=[];for(a.__dp=e,t=a.__p=0;t<i;t++)s.push({name:""+(t+1),value:t});l.store.loadData(s),l.setValue(0),l.setDisabled(!(1<i)),o.setValue("Count : "+e.length),n.refreshPg()},refreshPg:function(e){var t,n=this,a=n.down("[name=grdrcs]"),o=n.down("[name=_pb_c]"),l=n.down("[name=_pb_p]"),i=n.down("[name=_pb_d]"),s=n.down("[name=_pb_n]"),r=a.__dp,d=a.__p,c=[],p=100,u=Math.ceil(r.length/p);for(2==e?a.__p=d+=1:1==e&&0<d&&(a.__p=d-=1),3==e&&i.setValue("Count : "+r.length),d*p>r.length&&(a.__p=d=u),o.setValue(a.__p),t=d*p;t<Math.min(r.length,(d+1)*p);t++)c.push(r[t]);l.setDisabled(!(0<d)),s.setDisabled(!(0<u&&d<u)),a.store.loadData(c)},loadCnt:function(e,t){var n,a=this;(n=new IG$._rpc$).init(a,{ack:"content",payload:{uid:e},mbody:{}},a,a.rs_loadContent,null,t),n.send()},rs_loadContent:function(e,t){var n,a,o,l=this,i=l.down("[name=grdrcs]"),s=l.down("[name=vcol1]"),r=l.down("[name=vcol2]"),d={},c=[];if(e&&e.data&&(e.uid,n=e.name,c=e.data),t){for(o=0;o<i.__dp.length;o++)d[(a=i.__dp[o]).name]=a;for(o=0;o<i.store.data.length;o++)d[(a=i.__dp[o]).name]=a;for(o=0;o<c.length;o++)(a=d[c[o].name])&&(a.value2=c[o].value);l.refreshPg(),r.setText(n)}else s.setText(n),r.setText("-"),l.loadGrid(c)},toolbarHandler:function(e){var t=this;switch(e){case"cmd_save":t.save_content();break;case"cmd_refresh":t.init_f();break;case"cmd_delete":var n,a,o,l=(s=t.down("[name=grdrcs]")).getSelectionModel().selected,i=s.__dp;s.__p;for(a=0;a<l.length;a++)n=l.items[a],o=s.store.indexOf(n),s.store.remove(n),i.splice(o,1);t.refreshPg(3);break;case"cmd_add_lcs":var s;(i=(s=t.down("[name=grdrcs]")).__dp).splice(0,0,{name:"",value:""}),s.__p=0,t.refreshPg(3);break;case"cmd_add_lang":var r=new IG$.makeItem({parentnodepath:t.pp,itemtype:"PrivateContent",parentuid:t.pp,meta_type:"locales",callback:new IG$.callBackObj(t,t.r_createMetaObject)});IG$.checkLogin(this,r);break;case"cmd_import":t.down("[name=pimp]").setVisible(!0);break;case"cmd_export":t.down("[name=pimp]").setVisible(!0),t.expCnt()}},r_createMetaObject:function(e){this.init_f()},save_content:function(){var e=this.down("[name=c_loc]").getValue();this.saveRcsCnt(e,!0)},saveRcsCnt:function(e,t){var n,a,o,l,i,s=this,r=s.down("[name=grdrcs]");if(e){for(cnt={name:e.substring(e.lastIndexOf("/")+1),data:[]},n=0;n<r.__dp.length;n++)l=(a=r.__dp[n]).name,o=t?a.value:a.value2,l&&(s.dicmode||!s.dicmode&&o)&&cnt.data.push({name:l,group:a.group,value:o});(i=new IG$._rpc$).init(s,{ack:"writecontent",payload:{uid:e,is_locale:"T"},mbody:cnt,meta_type:"locales"},s,s.rs_save_content,null,t),i.send()}else t&&IG$.alertmsg(null,IRm$.r1("E_LM_SEL"),null,null,1,"error")},rs_save_content:function(e,t){if(t){var n=this.down("[name=c_loc2]").getValue();if(n)return void this.saveRcsCnt(n,!1)}IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,this,0,"success")},impCnt:function(){var e,t,n,a,o,l,i,s=this.down("[name=timp]").getValue(),r=(this.down("[name=grdrcs]"),{}),d=[];for(i="group",e=s.split("\n"),l=0;l<e.length;l++)(t=e[l])&&(";"==t.charAt(0)?(i=t.replace(/;/g,""),i=IG$.trim12(i)):1<(n=t.split("\t")).length&&(a=IG$.trim12(n[1]),r[o=IG$.trim12(n[0])]||('"'==a.charAt(0)&&'"'==a.charAt(a.length-1)&&(a=a.substring(1,a.length-1)),d.push({group:i,name:o,value:a}),r[o]=1)));this.loadGrid(d)},downloadResources:function(){var e=new IG$._rpc$,a=this.dicmode?"dictionary.xlsx":"resource.xlsx";e.init(this,{ack:"helpcontent",payload:{uid:"/SYS_Config/"+this.rcsname},mbody:{output:"file",option:"download_resources"}},this,function(e){var t,n;e&&(t=e.downloadurl,n=e.filename||a,t&&n&&$.download(ig$.servlet,[{name:"ack",value:"download"},{name:"_mts_",value:IG$._g$a||""},{name:"payload",value:t},{name:"mbody",value:n}],"POST"))},null),e.send()},loadResourceExcel:function(e){var t=new IG$._rpc$;t.init(this,{ack:"helpcontent",payload:{uid:"/SYS_Config/"+this.rcsname,fileuid:e},mbody:{option:"excel_resources"}},this,function(e){},null),t.send()},expCnt:function(){var e,t,n,a=this.down("[name=timp]"),o=this.down("[name=grdrcs]"),l=[],i=[];for(t=0;t<o.__dp.length;t++)e=o.__dp[t],l.push({group:e.group,value:e.name+"\t"+e.value});for(l.sort(function(e,t){var n=0;return e.group!=t.group&&(n=e.group>t.group?-1:1),n}),n=null,t=0;t<l.length;t++)l[t].group!=n&&(i.push(";;; "+l[t].group),n=l[t].group),i.push(l[t].value);a.setValue(i.join("\n"))},appendLocale:function(e){var t,n,a=this.down("[name=grdrcs]").store,o=[],l=[];for(t=0;t<e.records.length;t++)n=e.records[t],l.push({uid:n.get("uid"),name:n.get("name"),type:n.get("type")});for(t=0;t<a.data.items.length;t++)o[(n=a.data.items[t]).get("name")]=1;this.loadItem(l,o)},loadItem:function(e,o){var l=this,i=[];if($.each(e,function(e,t){var n,a=l.isFolder(t);o[t.name]||(i.push({name:t.name,value:""}),o[t.name]=1),a&&((n=new IG$._rpc$).init(l,{ack:"content",payload:{uid:t.uid,name:t.name,type:t.type},mbody:{subfolder:"T"}},l,function(e){var t,n,a=[];if(e.children){for(n=0;n<e.children.length;n++)t=e.children[n],a.push(t);a.length&&l.loadItem(a,o)}},null),n.send())}),i.length){var t,n=l.down("[name=grdrcs]"),a=n.__dp;for(t=0;t<i.length;t++)a.splice(0,0,i[t]);n.__p=0,l.refreshPg(3)}},isFolder:function(e){var t=e.type.toLowerCase(),n=0;return/folder|bobj|dataset|userdb|table|inlineview/.test(t)&&(n=1),n},initComponent:function(){var i=this;i.rcsname=i.dicmode?"dictionary":"locale",i.pp="/SYS_Config/"+i.rcsname,$s.apply(this,{items:[{xtype:"form",layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"fieldset",name:"pimp",title:"Copy-paste your locale document here",hidden:!0,flex:2,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textarea",name:"timp",flex:1},{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",text:"Import",handler:function(){this.impCnt()},scope:this},{xtype:"button",text:"Close",handler:function(){this.down("[name=pimp]").setVisible(!1)},scope:this},{xtype:"container",flex:1},{xtype:"button",text:"Download",name:"btn_download",handler:function(){this.downloadResources()},scope:this},{xtype:"button",text:"Upload",name:"btn_upload",handler:function(){var n=this,e=new IG$.ExcelFileUploader({mode:"rcs",callback:new IG$.callBackObj(n,function(t){t.fileuid&&IG$.confirmMessages(ig$.appname,IRm$.r1("B_CONFIRM"),function(e){"yes"==e&&n.loadResourceExcel(t.fileuid)})})});IG$.checkLogin(n,e)},scope:this}]}]},{xtype:"container",layout:{type:"hbox",align:"stretch"},flex:3,items:[{xtype:"gridpanel",name:"grdrcs",store:{xtype:"store",fields:["name","value","value2","locale","group"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},flex:3,plugins:[{ptype:"cellediting",clicksToEdit:!1,listeners:{edit:function(e,t,n){var a=t.record,o=t.field,l=t.value,i=this.down("[name=grdrcs]"),s=i.store.indexOf(a);(a=i.__dp[100*i.__p+s])[o]=l},scope:this}}],viewConfig:i.dicmode?{plugins:{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_1"},__ing:1,listeners:{beforedrop:function(e,t,n,a,o){var l=i.down("[name=c_loc]");return t.copy=!0,l.getValue()?i.appendLocale.call(i,t):IG$.alertmsg(null,IRm$.r1("E_LM_SEL"),null,null,1,"error"),!1},drop:function(e,t,n,a){return!1}}}:null,bbar:{xtype:"toolbar",name:"_pb_",items:[{xtype:"button",name:"_pb_p",disabled:!0,iconCls:"x-tbar-page-prev",handler:function(){this.refreshPg(1)},scope:this},"-",{xtype:"combobox",name:"_pb_c",fieldLabel:"Page",labelWidth:50,width:120,queryMode:"local",displayField:"name",labelField:"name",valueField:"value",editable:!1,autoSelect:!0,disabled:!0,store:{fields:["name","value"]},listeners:{select:function(e,t,n,a){this.down("[name=grdrcs]").__p=Number(e.getValue()),this.refreshPg()},scope:this}},"-",{xtype:"button",name:"_pb_n",disabled:!0,iconCls:"x-tbar-page-next",handler:function(){this.refreshPg(2)},scope:this},"->",{xtype:"displayfield",name:"_pb_d",value:"No data to display"}]},columns:[{xtype:"gridcolumn",text:"Name",dataIndex:"name",width:200,editor:{allowBlank:!1}},{xtype:"gridcolumn",text:"Value",name:"vcol1",flex:1,dataIndex:"value",editor:{allowBlank:!0}},{xtype:"gridcolumn",text:"Value",name:"vcol2",flex:1,dataIndex:"value2",editor:{allowBlank:!0}}]}]}]}],tbar:[{iconCls:"icon-toolbar-save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this.toolbarHandler("cmd_save")},scope:this},"-",{iconCls:"icon-toolbar-add",tooltip:IRm$.r1("L_LM_ADD"),handler:function(){this.toolbarHandler("cmd_add_lang")},scope:this},{xtype:"combobox",name:"c_loc",fieldLabel:"Base Language",labelWidth:100,queryMode:"local",displayField:"name",labelField:"name",valueField:"value",editable:!1,autoSelect:!0,store:{fields:["name","value"]},listeners:{change:function(e,t,n,a){this.changeLocale()},scope:this}},{iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){this.toolbarHandler("cmd_refresh")},scope:this},{iconCls:"icon-toolbar-remove",tooltip:IRm$.r1("B_DELETE_ITEM"),handler:function(){this.toolbarHandler("cmd_delete")},scope:this},"-",{iconCls:"icon-toolbar-add",tooltip:IRm$.r1("L_LM_LCS"),handler:function(){this.toolbarHandler("cmd_add_lcs")},scope:this},"-",{iconCls:"icon-ing-dwn",tooltip:IRm$.r1("L_LM_IMP"),handler:function(){this.toolbarHandler("cmd_import")},scope:this},{iconCls:"icon-ing-upl",tooltip:IRm$.r1("L_LM_EXP"),handler:function(){this.toolbarHandler("cmd_export")},scope:this},"-",{xtype:"combobox",name:"c_loc2",fieldLabel:"Second Language",labelWidth:100,queryMode:"local",displayField:"name",labelField:"name",valueField:"value",editable:!1,autoSelect:!0,store:{fields:["name","value"]},listeners:{change:function(e,t,n,a){this.changeLocale(!0)},scope:this}}]}),IG$.resourcemgr.superclass.initComponent.call(this)},listeners:{afterrender:function(e){this.init_f()}}});
IG$.mgrdb_config=$s.extend(IG$.v$pnl,{scroll:!1,initialized:!1,closable:!0,hideMode:"offsets",layout:"fit",bodyPadding:5,iconCls:"icon-mgr-db",_init:function(){this.loadUserDBList()},loadUserDBList:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"userdb",payload:{address:"/Connections",option:"list"},mbody:{}},e,e.rs_loadUserDBList,!1),t.send()},rs_loadUserDBList:function(e){var t=this,i=t.down("[name=dbgrid]"),n=e.children;n&&(t.rootnode=e.uid,$.each(n,function(e,t){t.dbtype=t.attributes.attrb2}),i.store.loadData(n),n.length&&t._validateTlineView(i.store.data.items[n.length-1]))},toolbarHandler:function(e){switch(e){case"cmd_add_db":this.rs_loadDBDetail(null)}},loadDBDetail:function(e){var t=this,i=new IG$._rpc$;i.init(t,{ack:"content",payload:{address:e},mbody:{}},t,t.rs_loadDBDetail,!1),i.send()},rs_loadDBDetail:function(e){var t,i,n,a=e?e.content:null,d=this.down("[name=dbgrid]"),o=[];for(i=0;i<d.store.data.items.length;i++)"sforce"!=(n=d.store.data.items[i]).get("dbtype")&&o.push({dbtype:n.get("dbtype"),name:n.get("name"),uid:n.get("uid")});t=new IG$.mgrdb_editor({dbinfo:a,dbitems:o,callback:new IG$.callBackObj(this,this.rs_afterEdit)}),IG$.checkLogin(this,t)},rs_afterEdit:function(e){this.dbinfo=null,this.loadUserDBList(),"saved"==e&&IG$.alertmsg(ig$.appname,IRm$.r1("M_"+e.toUpperCase()),null,null,0,"success")},_validateTlineView:function(n){var a=this,e=a.down("[name=timelineview]"),t=$(".timelineview",e.el.dom),d=$("#vertical-timeline",t);$("#title",t).text(n?n.get("name"):""),(a.__dbnode=n)&&$.each(a.timeline,function(e,t){var i=t.el;t.el||(i=$("<div class='vertical-timeline-block'><div class='vertical-timeline-icon gray-bg'><span class='"+t.iconcls+"'></span></div><div class='vertical-timeline-content' id='content'></div></div>"),$("<p id='pdesc'>"+(t.desc||"")+"</p>").appendTo($(".vertical-timeline-content",i)),i.appendTo(d),i.bind("click",function(){t.handler&&a.__dbnode&&t.handler.call(a)}),t.el=i),1==t.hidden?t.el.hide():1==t.writable&&t.el[1==n.get("writable")?"show":"hide"](),$("#pdesc",i).text(t.desc),$("#content",i).html(t.content)})},openDSLayer:function(e,i){var n=this,a=IG$.mainPanel;switch(e){case"cmd_edit_config":i.get("writable")&&n.loadDBDetail(i.get("uid"));break;case"cmd_tables":var t=new IG$.metaSelectDlg({mode:"newitem",initpath:null,callback:new IG$.callBackObj(n,function(e){var t=new IG$._rpc$;t.init(n,{ack:"writecontent",payload:{address:e.nodepath+"/"+e.name,name:e.name,type:"Bobject",pid:e.uid},mbody:{datasource:{uid:i.get("uid"),name:i.get("name"),type:i.get("type")}},meta_type:"business_object"},n,function(e){a.navigateApp.call(a,e.uid,e.type.toLowerCase(),e.name,e.nodepath,!0,e.writable)}),t.send()})});IG$.checkLogin(this,t);break;case"cmd_object_auth":var d;if(1==i.get("writable"))d=new IG$.objectAuth({uid:i.get("uid"),itemtype:i.get("type")}),IG$.checkLogin(this,d)}},initComponent:function(){$s.apply(this,{timeline:[{iconcls:"igc-dbicon",name:"edit_db",desc:"Edit",content:"Setup JDBC Driver Information.",writable:!0,handler:function(){this.openDSLayer("cmd_edit_config",this.__dbnode)}},{iconcls:"igc-import",name:"import_tb",desc:"Import",content:"Import Tables. Import tables to analysis.",writable:!0,handler:function(){this.openDSLayer("cmd_tables",this.__dbnode)}},{iconcls:"igc-sql",name:"import_sql",desc:"Import",content:"SQL View. Use advanced SQL view and define inline sql object.",writable:!0,handler:function(){this.openDSLayer("cmd_tables",this.__dbnode)}},{iconcls:"igc-model",name:"edit_rel",desc:"Relation",content:"Relation diagram. Define relationships and join conditions between tables",writable:!0,handler:function(){this.openDSLayer("cmd_tables",this.__dbnode)}},{iconcls:"igc-share",name:"object_auth",desc:IRm$.r1("L_OBJECT_AUTH"),hidden:ig$.features.ig_n_oauth,content:"Security and permission to use this datasource.",writable:!0,handler:function(){this.openDSLayer("cmd_object_auth",this.__dbnode)}}],items:[{xtype:"panel",region:"center",layout:{type:"vbox",align:"stretch"},bodyPadding:4,items:[{xtype:"panel",flex:1,border:!1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"dbgrid",flex:1,store:{xtype:"store",fields:[]},columns:[{text:IRm$.r1("B_TYPE"),width:80,sortable:!1,hideable:!1,dataIndex:"dbtype"},{text:IRm$.r1("B_NAME"),flex:1,tdCls:"igc-td-link",sortable:!1,hideable:!1,dataIndex:"name",xtype:"templatecolumn",renderer:function(e,t,i){var n=i.get("locale_name")||i.get("name");return i.get("locale_name")&&(n+="("+i.get("locale_name")+")"),n+="\n==>"+(i.get("nodepath")||""),"<span title='"+IG$.hEE(n)+"'>"+IG$.hEE(i.get("locale_name")||i.get("name"))+"</span>"+(i.data.attributes&&"T"==i.data.attributes.attrb1?"  <span class='db_writable'></span>":"")}},{text:IRm$.r1("B_OWNER"),width:120,dataIndex:"owner"},{text:IRm$.r1("B_MODI"),width:120,dataIndex:"modifier"},{text:IRm$.r1("B_LASTUPD"),width:150,dataIndex:"updatedatefm"},{xtype:"actioncolumn",width:60,items:[{iconCls:"icon-grid-dbicon",handler:function(e,t,i){var n=e.store.data.items[t];this.openDSLayer("cmd_edit_config",n)},scope:this},{iconCls:"igc-share",tooltip:IRm$.r1("L_OBJECT_AUTH"),hidden:ig$.features.ig_n_oauth,handler:function(e,t,i){var n=e.store.data.items[t];this.openDSLayer("cmd_object_auth",n)},scope:this},{iconCls:"icon-grid-delete",tooltip:IRm$.r1("L_REMOVE"),handler:function(e,t,i){var n=e.store,a=n.getAt(t);IG$.deleteMetaObject(a.get("uid"),a,IG$.callBackObj(this,function(){n.removeAt(t)}))},scope:this}]}],listeners:{cellclick:function(e,t,i,n,t,a,d){this._validateTlineView(n),1==i&&this.openDSLayer("cmd_edit_config",n)},scope:this}},{xtype:"panel",width:230,layout:{type:"vbox",align:"stretch"},autoScroll:!0,items:[{name:"timelineview",html:"<div class='timelineview'><strong id='title'></strong><div id='vertical-timeline' class='vertical-container dark-timeline'></div></div>"}]}],tbar:[{iconCls:"icon-toolbar-add",hidden:ig$.features.ig_n_db_add,text:IRm$.r1("L_ADD_DB_INST"),handler:function(){this.toolbarHandler("cmd_add_db")},scope:this},{iconCls:"icon-toolbar-refresh",text:IRm$.r1("L_REFRESH"),handler:function(){this.loadUserDBList()},scope:this}]}]}],listeners:{afterrender:function(e){e._init.call(e)}}}),IG$.mgrdb_config.superclass.initComponent.call(this)}});
IG$.mgrdb_editor=$s.extend($s.window,{width:500,height:520,layout:"fit",_init:function(){this._loadDBInfo()},_loadDBInfo:function(){var e=new IG$._rpc$;e.init(this,{ack:"helpcontent",payload:{},mbody:{option:"dblist"}},this,function(e){var t,a,n=this,i=e.items||[],o=[{gid:0,name:"ALL"}],l={};for(a=0;a<i.length;a++)l[(t=i[a]).gid]||(l[t.gid]=1,o.push({gid:t.gid,name:t.group_name}));n.dblist=i,n.dblist_grp=o;var s=n.down("[name=dbtype]"),d=n.down("[name=dbtypegrp]");d.store.loadData(o),s.store.loadData(i),d.setValue(0),n.getPkey(),n.updateDBListView(i),n.updateDBDtl()},!1),e.send()},updateDBDtl:function(){var e,t,a,n,i=this,o=i.dbinfo,l=(IG$.dlgLogin.logininfo,i.down("[name=mainpanel]")),s=(IRm$.r1("L_LAST_UPD"),i.down("[name=tudate]")),d=i.down("[name=p_sforce]"),r=i.down("[name=p_ldap]"),m=i.down("[name=p_sapbw]"),c=i.down("[name=p_essbase]");if(o&&l.setActiveItem(1),d.down("[name=sf_targetdb]").store.loadData(i.dbitems),r.down("[name=ldap_targetdb]").store.loadData(i.dbitems),m.down("[name=sapbw_targetdb]").store.loadData(i.dbitems),c.down("[name=essbase_targetdb]").store.loadData(i.dbitems),o){if(i.down("[name=cname]").setValue(o.name),$.each(["form01","form02","form03","form04"],function(e,t){i.down("[name="+t+"]").setAllValues(o)}),i.down("[name=excel_loader]").setValue("T"==o.excel_loader),s.setValue(o.updatedate),o.options=o.options||{},d.setAllValues(o.options),r.setAllValues(o.options),m.setAllValues(o.options),c.setAllValues(o.options),n=[],o.pre_exec_pkg){for(t=i.down("[name=grdprestmt]"),a=0;a<o.pre_exec_pkg.length;a++)n.push({name:o.pre_exec_pkg[a]});t.store.loadData(n)}if(n=[],o.post_exec_pkg){for(t=i.down("[name=grdpoststmt]"),a=0;a<o.post_exec_pkg.length;a++)n.push({name:o.post_exec_pkg[a]});t.store.loadData(n)}(e=i.down("[name=sf_securitykey]").getValue())&&0==e.startsWith("{ENC}")&&i.down("[name=sf_securitykey]").setValue("")}},changeDriverHeler:function(){var e,t,a=this,n=a.dblist,i=a.down("[name=dbtype]"),o=a.down("[name=driver]"),l=a.down("[name=jdbcurl]");if(1!=a.changelock){for(t=i.getValue(),e=0;e<n.length;e++)if(n[e].name==t){i=n[e];break}o.setValue(i?i.driver:""),l.setValue(i?i.url:"")}},getPkey:function(){var e;IG$.rsaPublicKeyModules||((e=new IG$._rpc$).init(this,{ack:"security",payload:{},mbody:{}},this,function(e){e.p1&&e.p2&&(IG$.rsaPublicKeyModules=e.p1,IG$.rsaPublicKeyExpoenent=e.p2)},!1),e.send())},testConnection:function(){var e=this,t={};if(e.checkFields(!0)){e.updateInfo(t);var a=new IG$._rpc$;a.init(e,{ack:"userdb",payload:{address:"/Connections",option:"testcon"},mbody:t,meta_type:"datasource"},e,function(e){IG$.alertmsg(ig$.appname,IRm$.r1("M_SUC_DBCON"),null,null,0,"success")},!1),a.send()}},setParameter:function(e){var t,a=this.down("[name="+e+"]").getValue();t=new IG$.userdbTemplate({fieldvalue:a,callback:new IG$.callBackObj(this,this.rs_setParameter,e)}),IG$.checkLogin(this,t)},rs_setParameter:function(e,t){this.down("[name="+t+"]").setValue(e)},checkFields:function(e){var n,i=this,t=i.down("[name=cname]"),a=e?["username","passwd"]:["username","cname","passwd"];return"sforce"==i.down("[name=dbtype]").getValue()&&(a=a.concat(e?["sf_securitykey"]:["sf_securitykey","sf_endpoint","sf_targetdb"])),t.clearInvalid(),$.each(a,function(e,t){var a=i.down("[name="+t+"]");a.clearInvalid(),a.getValue()||(a.markInvalid(),n=1)}),!n},_confirm:function(e){var t,a,n,i,o=this,l=new IG$._rpc$,s=o.dbinfo||{},d=o.down("[name=cname]");o.down("[name=dbtype]").getValue();if("confirm"==e){if(!o.checkFields())return;i=d.getValue(),t="writecontent",a={address:o.dbinfo?s.uid:"/Connections/"+i,name:i,type:"UserDB",pid:o.rootnode,memo:i,description:""},o.updateInfo(s),l.init(o,{ack:t,payload:a,mbody:s,meta_type:"datasource"},o,o.rs_saveContent,!1),l.send()}else"delete"==e&&IG$.confirmMessages(IRm$.r1("B_CONFIRM"),IRm$.r1("B_C_DELETE"),function(e){if("yes"==e){if(!s)return;t="deletecontent",a={address:s.uid,name:i,type:"UserDB",description:""},n={},l.init(o,{ack:t,payload:a,mbody:n},o,o.rs_deleteContent,!1),l.send()}},this,this)},rs_deleteContent:function(e){this.callback&&this.callback.execute("saved"),this.close()},rs_saveContent:function(e){this.callback&&this.callback.execute("saved"),this.close()},updateInfo:function(a){var e,t,n,i,o=this,l=o.down("[name=p_sforce]"),s=o.down("[name=p_ldap]"),d=o.down("[name=p_sapbw]"),r=o.down("[name=p_essbase]");for(a.name=a.memo=o.down("[name=cname]").getValue(),$.each(["form01","form02","form03","form04"],function(e,t){o.down("[name="+t+"]").getAllValues(a)}),a.options=a.options||{},l.getAllValues(a.options),s.getAllValues(a.options),d.getAllValues(a.options),r.getAllValues(a.options),a.pre_exec_pkg=[],a.post_exec_pkg=[],i=o.down("[name=grdprestmt]"),n=0;n<i.store.data.items.length;n++)a.pre_exec_pkg.push(i.store.data.items[n].get("name"));for(i=o.down("[name=grdpoststmt]"),n=0;n<i.store.data.items.length;n++)a.post_exec_pkg.push(i.store.data.items[n].get("name"));a.passwd&&0==a.passwd.startsWith("{ENC}")&&(t=IG$.encryptKey([a.passwd]),a.passwd=t[0]),(e=a.options.sf_securitykey)&&0==e.startsWith("{ENC}")&&(t=IG$.encryptKey([e]),a.options.sf_securitykey=t[0]),a.excel_loader=o.down("[name=excel_loader]").getValue()?"T":"F"},_changeLayout:function(){var e=this,t=e.down("[name=dbtype]").getValue(),a=e.down("[name=form02]"),n=e.down("[name=form04]"),i=e.down("[name=m_a1]"),o=e.down("[name=rdbms_adv]"),l=e.down("[name=p_sforce]"),s=e.down("[name=p_ldap]"),d=e.down("[name=p_sapbw]"),r=e.down("[name=p_essbase]");a.setVisible("mongodb"!=t&&"sforce"!=t),n.setVisible("mongodb"==t),i.setVisible("mongodb"!=t),o.setVisible("sforce"!=t&&"ldap"!=t&&"sapbw"!=t&&"essbase"!=t),l.setVisible("sforce"==t),s.setVisible("ldap"==t),d.setVisible("sapbw"==t),r.setVisible("essbase"==t)},updateDBListView:function(e){var i=this,t=i.down("[name=c_dblist]"),o=i.down("[name=dbtypegrp]").getValue(),l=$("#dblist_container",t.el.dom);$.each(e,function(e,t){var a=0;if(o&&t.gid!=o&&(a=1,t.el))t.el.hide();else{if(!t.el){var n=$("<div class='dblist_item'><div class='dbicon db-"+t.name+"'></div><h3>"+t.description+"</h3></div></div>").appendTo(l);n.bind("click",function(){i.selectDB(t)}),t.el=n}t.el[a?"hide":"show"]()}})},selectDB:function(e){var t=this.down("[name=mainpanel]"),a=this.down("[name=dbtype]");t.setActiveItem(1),a.setValue(e.name)},moveGridSelection:function(e,t){var a=e.getSelectionModel().getSelection(),n=a&&a.length?a[0]:null;if(n){var i=e.getStore().indexOf(n);if(t<0){if(--i<0)return}else if(++i>=e.getStore().getCount())return;e.getStore().remove(n),n=e.getStore().insert(i,n),e.getSelectionModel().select(n,!0)}},addPkg:function(i){var e,o=this,l={};for(e=0;e<i.store.data.items.length;e++)l[i.store.data.items[e].get("name")]=1;var t=new IG$.dlgExeStmt({citem:l,callback:new IG$.callBackObj(o,function(e,t){var a,n;if(1!=t)for(a=0;a<e.length;a++)n=e[a],l[n.name]||i.store.add({name:n.name});else o.close()})});IG$.checkLogin(o,t)},initComponent:function(){$s.apply(this,{title:IRm$.r1("T_DB_CON"),padding:10,items:[{xtype:"panel",layout:"card",name:"mainpanel",bodyPadding:10,items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},items:[{xtype:"combobox",displayField:"name",valueField:"gid",name:"dbtypegrp",fieldLabel:"Category",queryMode:"local",editable:!1,autoSelect:!0,store:{fields:["name","gid"]},listeners:{change:function(e,t,a,n){this.updateDBListView(this.dblist)},scope:this}},{html:"<div id='dblist_container'></div>",name:"c_dblist",flex:1,autoScroll:!0}]},{xtype:"panel",layout:{type:"vbox",align:"stretch"},padding:10,autoScroll:!0,items:[{xtype:"textfield",fieldLabel:IRm$.r1("L_DB_NAME"),name:"cname"},{xtype:"fieldcontainer",name:"form01",fieldLabel:IRm$.r1("L_DB_TYPE"),layout:{type:"hbox",align:"stretch"},items:[{xtype:"combobox",labelField:"description",valueField:"gid",name:"dbtype",queryMode:"local",displayField:"description",valueField:"name",editable:!1,autoSelect:!0,store:{fields:["name","description","driver","url"]},listeners:{change:function(e,t,a,n){this._changeLayout()},scope:this}},{xtype:"button",name:"m_a1",text:IRm$.r1("L_APPLY_TMPL"),handler:function(){this.changeDriverHeler.call(this)},scope:this}]},{xtype:"fieldcontainer",layout:{type:"vbox",align:"stretch"},name:"form02",items:[{xtype:"textfield",fieldLabel:IRm$.r1("L_JDBC_DRV"),name:"driver"},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_JDBC_URL"),layout:"hbox",items:[{xtype:"textfield",fieldLabel:"",name:"jdbcurl",width:280},{xtype:"button",text:"Set",handler:function(){""!=this.down("[name=jdbcurl]").getValue()&&this.setParameter("jdbcurl")},scope:this}]}]},{xtype:"fieldcontainer",name:"form03",layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:IRm$.r1("L_DB_UNAME"),name:"username"},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_DB_PWD"),layout:"hbox",items:[{xtype:"textfield",fieldLabel:"",inputType:"password",name:"passwd",width:220},{xtype:"button",text:"Test",handler:function(){this.testConnection.call(this)},scope:this}]},{xtype:"displayfield",value:IRm$.r1("L_LAST_UPD"),name:"tudate"},{xtype:"fieldset",title:IRm$.r1("L_ADV_OPTION"),name:"rdbms_adv",layout:"anchor",items:[{xtype:"textarea",height:80,fieldLabel:IRm$.r1("L_DB_VAL"),name:"validationSQL"},{xtype:"numberfield",name:"max_pool_size",fieldLabel:"Max pool size",minValue:0,maxValue:1e3},{xtype:"numberfield",name:"query_timeout",fieldLabel:IRm$.r1("L_DB_QUERYTIMEOUT"),minValue:0,maxValue:1e5},{xtype:"numberfield",name:"schedule_query_timeout",fieldLabel:IRm$.r1("L_DB_SCHEDULE_QUERYTIMEOUT"),minValue:0,maxValue:1e5},{xtype:"combobox",labelField:"name",valueField:"value",name:"charset_db",queryMode:"local",displayField:"name",editable:!1,autoSelect:!0,fieldLabel:IRm$.r1("L_DB_CHARSET"),store:{xtype:"store",fields:["name","value"],data:[{name:"Not use",value:""},{name:"UTF-8",value:"utf-8"},{name:"ksc5601",value:"ksc5601"},{name:"x-windows-949",value:"x-windows-949"},{name:"iso-8859-1",value:"iso-8859-1"},{name:"euc-kr",value:"euc-kr"}]}},{xtype:"combobox",labelField:"name",valueField:"value",name:"charset_out",queryMode:"local",displayField:"name",editable:!1,autoSelect:!0,fieldLabel:IRm$.r1("L_OUTPUT_CHARSET"),store:{xtype:"store",fields:["name","value"],data:[{name:"Not use",value:""},{name:"UTF-8",value:"utf-8"},{name:"ksc5601",value:"ksc5601"},{name:"x-windows-949",value:"x-windows-949"},{name:"iso-8859-1",value:"iso-8859-1"},{name:"euc-kr",value:"euc-kr"}]}},{xtype:"numberfield",name:"userowlimit",anchor:"50%",fieldLabel:IRm$.r1("L_ROW_LIMIT_COUNT"),minValue:0,maxValue:1e7},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"checkbox",fieldLabel:IRm$.r1("L_USE_CACHE"),name:"enableCache",flex:1,boxLabel:IRm$.r1("B_ENABLED")},{xtype:"button",text:"Cache Info",name:"cacheInfo",handler:function(){},scope:this}]},{xtype:"combobox",fieldLabel:IRm$.r1("L_CACHE_RULE"),name:"cacheRule",displayField:"name",valueField:"value",queryMode:"local",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","value"],data:[{name:IRm$.r1("L_EV_MIN"),value:"min"},{name:IRm$.r1("L_EV_HOUR"),value:"hour"},{name:IRm$.r1("L_EV_DAY"),value:"day"}]},listeners:{change:function(e){var t=this.down("[name=cacheInterval]"),a=e.getValue();t.setFieldLabel("day"==a?IRm$.r1("L_CLC_HOUR"):IRm$.r1("L_CLC_PERI"))},scope:this}},{xtype:"numberfield",fieldLabel:IRm$.r1("L_CACHE_PERI"),name:"cacheInterval",value:5,minValue:1,maxValue:1e3},{xtype:"checkbox",fieldLabel:IRm$.r1("L_DB_MON"),boxLabel:IRm$.r1("B_ENABLED"),name:"enableMonitor"},{xtype:"checkbox",fieldLabel:IRm$.r1("L_EXCEL_LOADER"),boxLabel:IRm$.r1("B_ENABLED"),name:"excel_loader"},{xtype:"fieldset",title:"Pre Execution Statement",layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"grdprestmt",height:150,selType:"checkboxmodel",selModel:{mode:"MULTI"},tbar:[{xtype:"button",text:"Add",handler:function(){var e=this.down("[name=grdprestmt]");this.addPkg(e)},scope:this},{xtype:"button",text:"Move Up",handler:function(){var e=this.down("[name=grdprestmt]");this.moveGridSelection(e,-1)},scope:this},{xtype:"button",text:"Move Down",handler:function(){var e=this.down("[name=grdprestmt]");this.moveGridSelection(e,1)},scope:this}],store:{fields:["name"]},columns:[{text:"Name",dataIndex:"name",flex:1},{xtype:"actioncolumn",width:40,items:[{iconCls:"icon-grid-delete",handler:function(e,t,a){e.store.data.items[t];e.store.removeAt(t)},scope:this}]}]}]},{xtype:"fieldset",title:"Post Execution Statement",layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"grdpoststmt",height:150,selType:"checkboxmodel",selModel:{mode:"MULTI"},tbar:[{xtype:"button",text:"Add",handler:function(){var e=this.down("[name=grdpoststmt]");this.addPkg(e)},scope:this},{xtype:"button",text:"Move Up",handler:function(){var e=this.down("[name=grdpoststmt]");this.moveGridSelection(e,-1)},scope:this},{xtype:"button",text:"Move Down",handler:function(){var e=this.down("[name=grdpoststmt]");this.moveGridSelection(e,1)},scope:this}],store:{fields:["name"]},columns:[{text:"Name",dataIndex:"name",flex:1},{xtype:"actioncolumn",width:40,items:[{iconCls:"icon-grid-delete",handler:function(e,t,a){e.store.data.items[t];e.store.removeAt(t)},scope:this}]}]}]}]}]},{xtype:"fieldset",layout:"anchor",name:"p_sforce",title:"Salesforce Connection",hidden:!0,items:[{xtype:"radiogroup",name:"sf_authmethod",vertical:!0,hidden:!0,fieldLabel:IRm$.r1("L_SF_AUTHMETHOD"),items:[{boxLabel:IRm$.r1("L_SF_SECTOKEN"),name:"cb_sf_token",inputValue:"token",checked:!0},{boxLabel:IRm$.r1("L_ALIGN_CENTER"),name:"cb_sf_oauth",inputValue:"oauth",checked:!1}]},{xtype:"textfield",name:"sf_securitykey",inputType:"password",fieldLabel:"Security Key",flex:1},{xtype:"textfield",fieldLabel:"Salesforce URL",name:"sf_endpoint",value:"https://login.salesforce.com/services/Soap/u/37.0"},{xtype:"combobox",fieldLabel:IRm$.r1("L_TARGET_DB"),name:"sf_targetdb",displayField:"name",valueField:"uid",queryMode:"local",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","uid"]}},{xtype:"fieldcontainer",hidden:!0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"Client ID",name:"sf_clientid"},{xtype:"textfield",fieldLabel:"Client Secret",name:"sf_clientsecret"},{xtype:"textfield",fieldLabel:"Callback Host",name:"sf_callbackhost"},{xtype:"textfield",fieldLabel:"Callback Port",name:"sf_callbackport"},{xtype:"textfield",fieldLabel:"Token File",name:"sf_tokenfile"}]}]},{xtype:"fieldcontainer",layout:"fit",height:280,hidden:!0,name:"form04",items:[{xtype:"textarea",name:"mongodb_hosts",flex:1,fieldLabel:"Connection String"}]},{xtype:"fieldset",layout:"anchor",name:"p_ldap",title:"LDAP Connection",hidden:!0,items:[{xtype:"combobox",fieldLabel:IRm$.r1("L_TARGET_DB"),name:"ldap_targetdb",displayField:"name",valueField:"uid",queryMode:"local",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","uid"]}}]},{xtype:"fieldset",layout:"anchor",name:"p_sapbw",title:"SAP BW Connection",hidden:!0,items:[{xtype:"combobox",fieldLabel:IRm$.r1("L_TARGET_DB"),name:"sapbw_targetdb",displayField:"name",valueField:"uid",queryMode:"local",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","uid"]}}]},{xtype:"fieldset",layout:"anchor",name:"p_essbase",title:"Hyperion Essbase Connection",hidden:!0,items:[{xtype:"combobox",fieldLabel:IRm$.r1("L_TARGET_DB"),name:"essbase_targetdb",displayField:"name",valueField:"uid",queryMode:"local",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","uid"]}}]}]}]}],buttons:[{xtype:"button",text:"Remove Connection",hidden:!this.dbinfo,handler:function(){this._confirm("delete")},scope:this},"->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm("confirm")},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$.mgrdb_editor.superclass.initComponent.call(this)},listeners:{afterrender:function(e){e._init()}}}),IG$.dlgExeStmt=$s.extend($s.window,{width:500,height:520,layout:"fit",_init:function(){var o=this,e=new IG$._rpc$;e.init(o,{ack:"content",payload:{uid:"/SYS_Config/systemconfig"},mbody:{}},o,function(e){var t,a=e.data,n=o.down("[name=grd]"),i=[];for(t=0;t<a.length;t++)"PKG"==a[t].type&&i.push(a[t]);n.store.loadData(i)}),e.send()},_confirm:function(){var e,t=this.down("[name=grd]").getSelectionModel().selected,a=[];for(e=0;e<t.length;e++)a.push({name:t.items[e].get("name")});this.callback&&this.callback.execute(a),this.close()},initComponent:function(){$s.apply(this,{title:IRm$.r1("T_DB_CON"),padding:10,items:[{xtype:"panel",padding:5,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Analysis environments",padding:5,flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"grd",flex:1,selType:"checkboxmodel",selModel:{mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",dataIndex:"name",flex:1}]}]}]}],buttons:[{xtype:"button",text:"Config variables",handler:function(){IG$.procMenuCommand("CMD_VAR"),this.callback.execute([],!0),this.close()},scope:this},"->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){e._init()}}}),IG$.dlgExeStmt.superclass.initComponent.call(this)}});
IG$.ExcelFileUploader=$s.extend($s.window,{modal:!0,region:"center",layout:"fit",closable:!1,resizable:!1,ufiles:null,width:360,autoHeight:!0,processUploadedFile:function(e){var l=this,a=l.down("[name=fieldvalue]"),i=l.down("[name=uploadmode]"),n=l.down("[name=delimiter]"),t=l.down("[name=deletemode]"),o=l.down("[name=targetsheet]"),d=l.down("[name=file_encoding]");l.datalabel=a.getValue(),l.uploadmode=i.getValue(),l.deletemode=t.getValue(),l.delimiter=n.getValue(),l.targetsheet=o.getValue(),l.file_encoding=d.getValue(),l.fileuid=e,"rcs"==l.mode||""!=a.getValue()||0!=l.uploadmode?(l.callback&&l.callback.execute(l),l.close()):IG$.ShowError(IRm$.r1("L_MSG_TABNAME"),l)},_confirm:function(){var n=this,e=n.down("[name=mform]"),l=n.down("[name=orig_filename]"),a=n.down("[name=photo]");n.down("[name=file_encoding]");if(e.getForm().isValid()){e.getForm();document.charset="UTF-8";var i=a.getRawValue();-1<i.indexOf("\\")&&(i=i.substring(i.lastIndexOf("\\")+1)),l.setValue(i),e.submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(e,l){var a=e.errorReader.jsonData,i=a&&a.result?a.result.uid:null;n.processUploadedFile(i),n.__cprog=0}})}else n.__cprog=0},initComponent:function(){var e=this;e.title=IRm$.r1("T_DATA_UPLOAD"),$s.apply(e,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"form",name:"mform",layout:"anchor",items:[{xtype:"hiddenfield",name:"_mts_",value:IG$._g$a},{xtype:"textfield",name:"orig_filename",hidden:!0,fieldLabel:"Original name"},{xtype:"fileuploadfield",name:"photo",fieldLabel:"Data",msgTarget:"side",allowBlank:!1,anchor:"100%",buttonText:IRm$.r1("L_SELECT_FILE"),buttonConfig:{margin:"0 2 0"}},{xtype:"combobox",fieldLabel:"Delimiter",hidden:"rcs"==e.mode,name:"delimiter",queryMode:"local",autoSelect:!0,autoScroll:!0,editable:!1,labelField:"name",displayField:"name",valueField:"value",store:{fields:["name","value"],data:[{name:",",value:","},{name:"Tab",value:"tab"},{name:"space",value:"space"},{name:"|",value:"|"}]}},{xtype:"textfield",name:"fieldvalue",hidden:"rcs"==e.mode,fieldLabel:"Field Value",allowBlank:"rcs"==e.mode},{xtype:"combobox",name:"file_encoding",hidden:!(window.ig$.file_encoding&&0<window.ig$.file_encoding.length),fieldLabel:"Encoding",editable:!1,queryMode:"local",labelField:"name",valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"],data:window.ig$.file_encoding||[]},listeners:{afterrender:function(e){window.ig$.file_encoding&&0<window.ig$.file_encoding.length&&e.select(window.ig$.file_encoding[0].value)}}},{xtype:"fieldset",title:"Replace Data Options",hidden:!("rcs"!=e.mode&&e.ufiles&&0<e.ufiles.length),layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"checkbox",name:"uploadmode",hidden:!(e.ufiles&&0<e.ufiles.length),hideLabel:!0,boxLabel:IRm$.r1("L_FILE_APPEND"),listeners:{change:function(e,l,a,i){var n=this,t=e,o=n.down("[name=deletemode]"),d=n.down("[name=targetsheet]"),r=n.down("[name=fieldvalue]"),s=t.getValue();r.allowBlank=s,d.setVisible(s),o.setVisible(s)},scope:this}},{xtype:"combobox",fieldLabel:"Data File",name:"targetsheet",queryMode:"local",hidden:!0,autoSelect:!0,autoScroll:!0,editable:!1,labelField:"name",displayField:"name",valueField:"uid",store:{fields:["name","uid","type","nodepath"],data:e.ufiles}},{xtype:"checkbox",name:"deletemode",hidden:!0,fieldLabel:" ",hideLabel:!0,boxLabel:IRm$.r1("L_FILE_DELETE")}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){var e=this;e.__cprog?IG$.alertmsg(ig$.appname,"Still progressing. Please wait!",null,null,0,"warning"):(e.__cprog=1,e._confirm())},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){var l,a=this,i=a.down("[name=delimiter]"),n=a.down("[name=targetsheet]"),t=a.ufiles,o=0;if(i.setValue(","),t&&0<t.length){for(l=0;l<t.length;l++)if(1==t[l].selected){o=l;break}n.setValue(t[o].uid)}e.down("[name=mform]").getForm().errorReader=new IG$.m2ER}}}),IG$.ExcelFileUploader.superclass.initComponent.apply(this,arguments)}});
IG$.p$DataMgr=$s.extend(IG$.v$pnl,{closable:!0,hideMode:"offsets",layout:"fit",bodyPadding:0,iconCls:"icon-dataset",_init:function(){var e=this;e.uid?e.loadContent():(e._mc=e._mc||{},e.loadUserDB())},loadContent:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"content",payload:{uid:e.uid,revision:e.revision},mbody:{option:"content"}},e,function(e){var t=this;t._mc=e.content||{},t.down("[name=t_save]").setVisible(t._mc.writable),t.loadUserDB()}),t.send()},loadUserDB:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"userdb",payload:{address:"/Connections",option:"list"},mbody:{}},e,e.rs_loadUserDBList,!1),t.send()},rs_loadUserDBList:function(e){var t,a=this,n=e.children,i=[];if(n&&n.length){for(t=0;t<n.length;t++)n[t].attributes&&"T"==n[t].attributes.attrb1&&!n[t].scid&&i.push(n[t]);var s;if(i.length){if(a._mc.datasource){for(t=0;t<i.length;t++)if(i[t].uid==a._mc.datasource.uid){s=i[t];break}}else 1==i.length&&(s=i[0]);if(!s&&a._mc.datasource)return void IG$.ShowError("The datasource does not allow uploading file.",a);if(!s)return dlg=new IG$.dlg_select_ds({callback:new IG$.callBackObj(a,function(e){a._mc.datasource={uid:e.data.uid,name:e.data.name},a._startapp()})}),void IG$.checkLogin(a,dlg);a._mc.datasource={uid:s.uid,name:s.name},a._startapp()}else IG$.ShowError("There is no excel uploadable datasources.",a)}},_startapp:function(){var e=this;e.down("[name=_m5]").store.loadData(e._mc.datafiles),e.uid?e.getTbls():e.uploadFile()},getTbls:function(){var o=this,e=new IG$._rpc$;o.setLoading(!0),e.init(o,{ack:"content",payload:{uid:o.uid},mbody:{subfolder:"T"}},o,function(e){var t,a,n=e&&e.children?e.children:null,i=o.down("[name=m1]"),s=[];if(n)for(a=0;a<n.length;a++)t=n[a],s.push(t);i.store.loadData(s)}),e.send()},uploadFile:function(e){var t=this,a=new IG$.ExcelFileUploader({callback:new IG$.callBackObj(t,t.rs_uploadFile,e)});IG$.checkLogin(t,a)},rs_uploadFile:function(e,t){this.loadFileToTbl({fileuid:e.fileuid,datalabel:e.datalabel,uploadmode:e.uploadmode,delimiter:e.delimiter,targetsheet:e.targetsheet},t)},loadColumnInfo:function(e){var t,a=this.down("[name=m3]");t=e.get("columns"),a.store.loadData(t),this.updateColumnInfo(e)},previewData:function(e){var t=this,a=new IG$._rpc$,n=e.get("files"),i=n.length?n[n.length-1].uid:null;i?(t.setLoading(!0,!0),a.init(t,{ack:"uploadcontent",payload:{uid:i,sheetname:e.get("sheetname"),count:"100"},mbody:{option:"preview_mdt"}},t,function(e){if(IG$.dlgLoadPreview){new IG$.dlgLoadPreview({dataset:e}).show()}else{var t=ig$.bootconfig.scmap.igcn;IG$.getScriptCache(t,new IG$.callBackObj(this,function(){IG$.dlgLoadPreview?new IG$.dlgLoadPreview({dataset:e}).show():IG$.ShowError(IRm$.r1("L_ERR_L_MOD"))}))}}),a.send()):IG$.alertmsg(ig$.appname,"No file is registered on this item!",null,null,0,"warning")},updateColumns:function(){var e,t=this._m5sel,a=(this.down("[name=m3]"),{});return t&&(e=t.get("columns"),$.each(e,function(e,t){a[t.pname]=t})),t},appendColumn:function(e){var t,a,n=this._m5sel,i=this.down("[name=m3]");for(t=0;t<i.store.data.items.length;t++)if(i.store.data.items[t].get("fieldname").toUpperCase()==e){a=1;break}if(a)IG$.alertmsg(ig$.appname,"Already appended same field information!",null,null,0,"warning");else{var s={name:e,fieldname:e,fielduid:e,datatype:"string",datasize:50};i.store.add(s),n.get("columns").push(s)}},pstatus_map:{1:"WAITING",9:"REJECTed - {DESC}",2:"ACCEPTed and created table"},requestTable:function(){var e,a=this,t=new IG$._rpc$;a.uid?(e=a.updateColumns())&&(a.setLoading(!0,!0),t.init(a,{ack:"uploadcontent",payload:{uid:a._mc.uid,fuid:e.get("uid")},mbody:{option:"reqdba"}},a,function(e){if(e&&e.pstatus){var t="Data already requested (";t=(t+=a.pstatus_map[e.pstatus]).replace("{DESC}",e.description||""),t+=")",IG$.alertmsg(ig$.appname,t,null,null,0,"success")}else IG$.alertmsg(ig$.appname,"Requested meta creation to admin! Please save content to update last information!",null,null,0,"success")}),t.send()):IG$.ShowError("Save content to continue.",a)},createTable:function(){var e,t=this,a=new IG$._rpc$;e=t.updateColumns(),t.uid?e&&(t.setLoading(!0,!0),a.init(t,{ack:"uploadcontent",payload:{uid:t._mc.uid,fuid:e.get("uid")},mbody:{option:"create_tb"}},t,function(e){IG$.alertmsg(ig$.appname,"Content saved successfully!",null,null,0,"success"),this._mc=e.content||{},this._startapp()}),a.send()):IG$.ShowError("Save content to continue.",t)},requestTableList:function(){var e=this,t=new IG$._rpc$,a=e.down("[name=dbareq]");e.setLoading(!0,!0),t.init(e,{ack:"uploadcontent",payload:{uid:e._m5sel?e._m5sel.get("uid"):"",mode:"ALL"},mbody:{option:"reqdba_lists"}},e,function(e){var t;for(e=e||[],t=0;t<e.length;t++)e[t].status=this.pstatus_map[e[t].pstatus];a.store.loadData(e)}),t.send()},getCreateScript:function(){var e,t=this,a=new IG$._rpc$;(e=t.updateColumns())&&(t.setLoading(!0,!0),a.init(t,{ack:"uploadcontent",payload:{uid:e.get("uid"),sheetname:e.get("sheetname"),option:"create_script"},mbody:t._mc,meta_type:"dataset"},t,function(e){var t=new IG$.dlgsqlview({sql:e.CREATE});IG$.checkLogin(this,t),IG$.alertmsg(ig$.appname,"Save content to finalize query!",null,null,0,"success")}),a.send())},getPhysicalTable:function(e){var t,a,n,i=this.down("[name=m1]");for(t=0;t<i.store.data.items.length;t++)if((n=(a=i.store.data.items[t]).get("attributes"))&&n.attrb2==e.get("pname"))return a},updateColumnInfo:function(e){var t=this,a=new IG$._rpc$,n=t.getPhysicalTable(e),i=(t.down("[name=m3]"),t.down("[name=btn_create_req]")),s=t.down("[name=btn_create]"),o=t.down("[name=btn_sys_key]"),l=t.down("[name=btn_sql]");o.setVisible(!0),l.setVisible(!0),i.setVisible(!n&&!ig$.features.ig_n_ds_reqb),s.setVisible(!n&&!ig$.features.ig_n_ds_sddlb),n&&(prop={uid:n.get("uid"),option:"StoredContent"},a.init(t,{ack:"tablecontent",payload:prop,mbody:{option:prop.option}},t,function(e){},!1),a.send())},loadFileToTbl:function(o,l){var e=this,d=(e._ltb,e.down("[name=_m5]")),t=new IG$._rpc$;e.setLoading(!0,!0),t.init(e,{ack:"uploadcontent",payload:{fileuid:o.fileuid,datalabel:o.datalabel,uploadmode:o.uploadmode,delimiter:o.delimiter,targetsheet:o.targetsheet},mbody:{option:"register_mdt"}},e,function(e){var t,n,a,i,s=this._mc;if(s.datafiles=this.datafiles||[],e.results&&e.results.length){for(t=0;t<e.results.length;t++)if(a=e.results[t],n={uid:a.uid,name:e.name,filename:e.name,sheetid:t,sheetname:a.name||"sheet_"+t,pname:a.pname,columns:[],files:[]},!(l&&l.get("sheetname")!=n.sheetname&&1<e.results.length)){if(l){(n=l.data).files.push({uid:o.fileuid,name:e.name}),i=1;break}$.each(e.results[t].headers,function(e,t){var a=t;n.columns.push(a)}),n.files.push({uid:o.fileuid,name:e.name}),s.datafiles.push(n),d.store.add(n)}l&&!i&&IG$.alertmsg(ig$.appname,"Same sheet item not found for this upload!",null,null,0,"warning")}}),t.send()},saveAsContent:function(e){var t=new IG$.metaSelectDlg({mode:"newitem",tree_options:{rootuid:this._mc.datasource.uid},callback:new IG$.callBackObj(this,this.saveNewContent,e)});IG$.checkLogin(this,t)},saveNewContent:function(e,t){$s.apply(this._mc,{name:e.name,address:e.nodepath+"/"+e.name,pid:e.uid}),this.saveContent(!0)},saveContent:function(e){var t,a=this._mc,n=new IG$._rpc$,i=a;this.setLoading(!0),t=e?{pid:a.pid,address:a.address,name:a.name,type:"DataSet"}:{uid:a.uid},n.init(this,{ack:"writecontent",payload:t,mbody:i,meta_type:"dataset"},this,function(e){this.uid=e.uid,this._mc.uid=e.uid,this._mc.name=e.name,this.setTitle(e.name),IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},null),n.send()},_load_ds:function(){var e=this,t=IG$.mainPanel;return e._mc&&e._mc.datasource&&e._mc.datasource.uid&&t.navigateApp(e._mc.datasource.uid,"userdb",e._mc.datasource.name,null,!1,!0,{}),!0},initComponent:function(){var t=this;$s.apply(t,{layout:"border",hasintro:"eloader",intro:[{selector:"$tb_upload",text:"Upload File"},{selector:"$_m5",text:"Welcome"},{selector:"$m3",text:"<div>Check column names and properties</div>"},{selector:"$m1",text:"Server side data"}],tbar:[{xtype:"button",iconCls:"icon-toolbar-save",name:"t_save",text:"Save",tooltip:IRm$.r1("L_SAVE_REPORT"),handler:function(){this.uid?this.saveContent():this.saveAsContent(!1)},scope:this},{iconCls:"icon-upload",tooltip:"Upload File",name:"tb_upload",handler:function(){this.uploadFile()},scope:this},{iconCls:"icon-refresh",tooltip:"Refresh",handler:function(){this.getTbls()},scope:this},"->",{iconCls:"icon-report",text:IRm$.r1("M_REPORT"),handler:function(){var e=IG$.mainPanel;t.uid?e.navigateApp.call(e,null,"report","New Report",null,!0,!0,{cubeuid:t._mc.datasource.uid,load_cube:{cube_objects:[{uid:t._mc.uid,name:t._mc.name,cubeuid:t._mc.datasource.uid,type:t._mc.type||"DataSet"}],ds_object:{uid:t._mc.datasource.uid,name:t._mc.datasource.name}}}):IG$.ShowError("Save content to continue.",t)},scope:this}],items:[{xtype:"panel",region:"center",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",title:"Uploaded File",flex:1,name:"_m5",store:{fields:["filename","uid","sheetname"]},selType:"checkboxmodel",selModel:{mode:"MULTI"},columns:[{text:"Name",flex:1,tdCls:"igc-td-link",dataIndex:"filename"},{text:"Sheet Name",flex:1,dataIndex:"sheetname",tdCls:"itc-td-link"},{text:"Physical Name",flex:1,dataIndex:"pname",tdCls:"itc-td-link"},{xtype:"actioncolumn",width:60,items:[{iconCls:"icon-grid-config",tooltip:"Config item",handler:function(e,t,a){var n=e.store.getAt(t);this.loadColumnInfo(n)},scope:this},{iconCls:"icon-upload",tooltip:"Upload item",handler:function(e,t,a){var n=e.store.getAt(t);this.uploadFile(n)},scope:this},{iconCls:"icon-history",tooltip:"History",handler:function(e,t,a){var n,i=e.store.getAt(t);n=new IG$.dlg_file_history({uid:this._mc.uid,rec:i}),IG$.checkLogin(this,n)},scope:this}]}],listeners:{cellclick:function(e,t,a,n,i,s,o,l){var d,r=this;r._m5sel=n,1==a?r.loadColumnInfo(n):2==a?r.previewData(n):3==a&&(d=new IG$.dlg_file_history({uid:r._mc.uid,rec:n}),IG$.checkLogin(r,d))},scope:this}},{xtype:"gridpanel",title:"Column Fields",name:"m3",flex:1,store:{xtype:"store",fields:[]},columns:[{xtype:"checkcolumn",text:"Key",dataIndex:"iskey",width:40},{text:"Name",dataIndex:"name",tdCls:"igc-td-link",minWidth:120,flex:1},{text:"Physical Name",dataIndex:"fieldname"},{text:"DataType",dataIndex:"datatype",width:80},{text:"Size",width:60,dataIndex:"datasize"}],listeners:{cellclick:function(e,t,a,n,i,s,o,l){var d;1==a&&(d=new IG$.dlg_column_prop({rec:n}),IG$.checkLogin(this,d))},scope:this},bbar:[{xtype:"displayfield",value:" "},{xtype:"button",hidden:!0,name:"btn_sys_key",text:"Add system key",menu:{xtype:"menu",items:[{text:"Filename",handler:function(){this.appendColumn("FILENAME")},scope:this},{text:"UserID",handler:function(){this.appendColumn("USERID")},scope:this},{text:"Date Imported",hidden:ig$.features.ig_n_fm,handler:function(){this.appendColumn("DATE")},scope:this}]}},"->",{xtype:"button",hidden:!0,name:"btn_create_req",text:"Request Create Table",handler:function(){this.requestTable()},scope:this},{xtype:"button",hidden:!0,name:"btn_create",text:"Create Table",handler:function(){this.createTable()},scope:this},{xtype:"button",hidden:!0,name:"btn_sql",text:"Script",handler:function(){this.getCreateScript()},scope:this}]}]},{xtype:"container",region:"south",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"m1",title:"Table List",flex:2,store:{xtype:"store",fields:["type","name","uid"]},columns:[{text:"Type",dataIndex:"type",width:80},{text:"Name",dataIndex:"name",tdCls:"igc-td-link",flex:1}],tbar:[{text:"Edit Source",handler:function(){this._mc.uid?this._load_ds():IG$.ShowError("Save content to continue.",this)},scope:this}]},{xtype:"gridpanel",name:"dbareq",title:"DBA Requests",hidden:ig$.features.ig_n_dataset_dba,flex:1,store:{fields:[]},tbar:["->",{text:"Refresh",handler:function(){this.requestTableList()},scope:this}],columns:[{text:IRm$.r1("B_NAME"),flex:1,dataIndex:"cname"},{text:"UserID",dataIndex:"userid"},{text:"Status",dataIndex:"status"},{text:"Date",dataIndex:"createdatefm"},{text:"Updated",dataIndex:"updatedatefm"}]}]}],listeners:{afterrender:function(e){e._init()},scope:this}}),IG$.p$DataMgr.superclass.initComponent.call(this)}}),IG$.dlg_file_history=$s.extend($s.window,{width:400,layout:"fit",padding:5,height:500,loadDatasetData:function(e){var t,a=this,n=new IG$._rpc$,i=a.down("[name=grdupload]").getSelectionModel().selected,s=a.rec,o={children:[],items:[]};if(e||0!=i.length)if(a.uid){if(a.setLoading(!0,!0),!e)for(t=0;t<i.items.length;t++)o.children.push({uid:i.items[t].get("uid"),name:i.items[t].get("name")});n.init(a,{ack:"uploadcontent",payload:{uid:a.uid,fuid:s.get("uid"),option:"insert_mdt"},mbody:o,meta_type:"metrics"},a,function(e){IG$.alertmsg(ig$.appname,"Data insert completed (record count : "+(e.datacount||"")+")",null,null,0,"success")}),n.send()}else IG$.ShowError("Save content to continue.",a);else IG$.alertmsg(ig$.appname,"No items selected!",null,null,0,"warning")},previewData:function(e){var t=new IG$._rpc$,a=e.get("uid"),n=this.rec;this.setLoading(!0,!0),t.init(this,{ack:"uploadcontent",payload:{uid:a,sheetname:n.get("sheetname"),count:"100"},mbody:{option:"preview_mdt"}},this,function(e){if(IG$.dlgLoadPreview){new IG$.dlgLoadPreview({dataset:e}).show()}else{var t=ig$.bootconfig.scmap.igcn;IG$.getScriptCache(t,new IG$.callBackObj(this,function(){IG$.dlgLoadPreview?new IG$.dlgLoadPreview({dataset:e}).show():IG$.ShowError(IRm$.r1("L_ERR_L_MOD"))}))}}),t.send()},initComponent:function(){$s.apply(this,{title:"File upload history",items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},padding:5,items:[{xtype:"gridpanel",name:"grdupload",selType:"checkboxmodel",selModel:{mode:"MULTI"},flex:1,store:{fields:[]},bbar:[{xtype:"button",text:"Load into table",handler:function(){this.loadDatasetData()},scope:this},{xtype:"button",text:"Clear table",handler:function(){var t=this;t.uid?IG$.confirmMessages(IRm$.r1("B_CONFIRM"),IRm$.r1("L_TB_BN"),function(e){"yes"==e&&t.loadDatasetData(!0)}):IG$.ShowError("Save content to continue.",t)},scope:this}],columns:[{flex:1,text:IRm$.r1("B_NAME"),dataIndex:"name",tdCls:"igc-td-link"},{xtype:"actioncolumn",width:40,items:[{iconCls:"icon-grid-delete",tooltip:"Delete Item",handler:function(e,t,a){var n,i=e.store.getAt(t),s=this.rec;for(e.store.removeAt(t),n=0;n<s.data.files.length;n++)if(s.data.files[n].uid==i.get("uid")){s.data.files.splice(n,1);break}},scope:this}]}],listeners:{cellclick:function(e,t,a,n,i,s,o,l){1==a&&this.previewData(n)},scope:this}}]}],buttons:["->",{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){this.rec&&this.down("[name=grdupload]").store.loadData(this.rec.data.files)}}}),IG$.dlg_file_history.superclass.initComponent.call(this)}}),IG$.dlg_column_prop=$s.extend($s.window,{width:400,layout:"fit",padding:5,autoHeight:!0,initComponent:function(){$s.apply(this,{title:"Column properties",items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},padding:5,items:[{xtype:"fieldset",title:"Column property",layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"name",fieldLabel:IRm$.r1("B_NAME"),required:!0},{xtype:"textfield",name:"fieldname",readOnly:!0,fieldLabel:"Physical name",required:!0},{xtype:"combobox",name:"datatype",fieldLabel:"Data type",required:!0,displayField:"name",valueField:"value",store:{data:[{name:"string",value:"string"},{name:"number",value:"number"},{name:"decimal",value:"decimal"},{name:"date",value:"date"}]}},{xtype:"numberfield",name:"datasize",fieldLabel:"Data size",required:!0},{xtype:"checkbox",boxLabel:IRm$.r1("B_ENABLED"),fieldLabel:"Is Key",name:"iskey"}]}]}],buttons:["->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){var e=this;e.rec&&(e.getAllValues(e.rec.data),e.rec.refresh()),e.close()},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){this.rec&&e.setAllValues(this.rec.data)}}}),IG$.dlg_column_prop.superclass.initComponent.call(this)}});
IG$.dlg_select_ds||(IG$.dlg_select_ds=$s.extend($s.window,{width:500,height:520,layout:"fit",padding:5,_init:function(){var t=new IG$._rpc$;t.init(this,{ack:"userdb",payload:{address:"/Connections",option:"list"},mbody:{}},this,function(t){var e,n=t.children,i=this.down("[name=dsource]"),s=[];if(n&&n.length)for(e=0;e<n.length;e++)(1==this.sel_mode||n[e].attributes&&"T"==n[e].attributes.attrb1)&&s.push(n[e]);i.store.loadData(s)},!1),t.send()},_confirm:function(t){var e=this,n=e.down("[name=dsource]"),i=t?null:n.getSelectionModel().selected;t?(e.callback&&e.callback.execute(t),e.close()):i&&i.length?(e.callback&&e.callback.execute(i.items[0]),e.close()):IG$.ShowError("Select datasource to continue!",e)},initComponent:function(){$s.apply(this,{title:"Select DataSource",items:[{xtype:"panel",padding:10,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"dsource",flex:1,selType:"checkboxmodel",selModel:{mode:"SINGLE"},store:{fields:[]},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name",tdCls:"igc-td-link"},{text:IRm$.r1("B_DESC"),dataIndex:"description"}],listeners:{cellclick:function(t,e,n,i,e,s,l){1==n&&this._confirm(i)},scope:this}}]}],buttons:["->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(t){t._init()}}}),IG$.dlg_select_ds.superclass.initComponent.call(this)}}));
IG$.mgrUserDuty=$s.extend($s.window,{modal:!0,layout:"fit",closable:!1,resizable:!1,width:500,autoHeight:!0,bodyPadding:10,bodyStyle:{background:"#ffffff"},_confirm:function(){var e=this;if(e.callback){var t,o=e.down("[name=gridduty_sel]"),s=[];for(t=0;t<o.store.data.length;t++)s.push(o.store.data.items[t]);e.callback.execute(s)}e.close()},loadDutyList:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"usercontent",payload:{address:"/Auth"},mbody:{option:"select"}},e,e.rs_loadDutyList,!1),t.send()},rs_loadDutyList:function(e){var t,o,s=[],i=[],d=this.down("[name=gridduty]"),l=this.down("[name=gridduty_sel]"),a={};if(this.sel)for(t=0;t<this.sel.length;t++)a[this.sel[t].sid]=this.sel[t];if(e)for(t=0;t<e.length;t++)a[(o=e[t]).sid]?i.push(o):s.push(o);d.store.loadData(s),l.store.loadData(i)},moveDuty:function(e){var t,o=this.down("[name=gridduty"+(0==e?"_sel":"")+"]"),s=this.down("[name=gridduty"+(1==e?"_sel":"")+"]"),i=o.getSelectionModel().getSelection();if(0<i.length)for(t=0;t<i.length;t++)o.store.remove(i[t]),s.store.add(i[t])},initComponent:function(){this.title=IRm$.r1("L_MGR_UD");var e=[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},border:0,bodyPadding:5,items:[{xtype:"displayfield",value:IRm$.r1("L_UD_DESC")},{xtype:"panel",border:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"gridduty",border:1,flex:1,height:300,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},multiSelect:!0,store:{fields:["name","dutytype","sid","status","type"]},columns:[{header:IRm$.r1("B_NAME"),dataIndex:"name",flex:1,sortable:!0,hideable:!1},{header:IRm$.r1("B_TYPE"),dataIndex:"type",flex:1,sortable:!0,hideable:!1}]},{xtype:"container",bodyPadding:"0 4 0 4",border:0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",flex:1},{xtype:"button",text:">>",handler:function(){this.moveDuty(!0)},scope:this},{xtype:"button",text:"<<",handler:function(){this.moveDuty(!1)},scope:this},{xtype:"container",flex:1}]},{xtype:"gridpanel",name:"gridduty_sel",flex:1,border:1,height:300,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},multiSelect:!0,store:{fields:["name","dutytype","sid","status","type"]},columns:[{header:IRm$.r1("B_NAME"),dataIndex:"name",flex:1,sortable:!0,hideable:!1},{header:IRm$.r1("B_TYPE"),dataIndex:"type",flex:1,sortable:!0,hideable:!1}]}]}]}],t=[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}];$s.apply(this,{items:e,buttons:t}),IG$.mgrUserDuty.superclass.initComponent.apply(this,arguments)},listeners:{afterrender:function(e){this.loadDutyList()}}});
IG$.groupPrivSetting=$s.extend($s.window,{title:"Group Privilege Setting",modal:!0,layout:"fit",closable:!1,resizable:!1,width:400,autoHeight:!0,plain:!0,bodyPadding:10,bodyStyle:{background:"#ffffff"},_confirm:function(){this.close()},loadPrivilege:function(e){var t=this,a=new IG$._rpc$;a.init(t,{ack:"usercontent",payload:{address:"/usergroup",gid:e,action:"privilege"},mbody:{option:"standard"}},t,t.rs_loadPrivilege,!1),a.send()},rs_loadPrivilege:function(e){},setGroupActive:function(e){var t,a=this,n=new IG$._rpc$;a.groupname;t={gid:a.gid},n.init(a,{ack:"usercontent",payload:{address:"/usergroup",action:e},mbody:t},a,a.rs_setGroupActive,!1,[e]),n.send()},rs_setGroupActive:function(e,t){var a=this,n=t[0],i=a.ugroup,s=a.down("[name=btn_erase]");switch(n){case"activate":i.set("status","Active"),i.set("active","1"),s.setVisible(!1);break;case"delete":i.set("status","Blocked"),i.set("active","0"),s.setVisible(!0);break;case"erase":i.parentNode.removeChild(i),a.close()}},initComponent:function(){var e=this;$s.apply(e,{items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},border:0,items:[{xtype:"displayfield",value:"Check to allow each priviege."},{xtype:"textfield",readOnly:!0,fieldLabel:"Group name",name:"groupname"},{xtype:"fieldset",title:"Enable/Disable",name:"p_activate",hidden:!1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",iconCls:"icon-toolbar-activate",flex:1,text:"Activate",handler:function(){this.setGroupActive("activate")},scope:e},{xtype:"container",width:10},{xtype:"button",iconCls:"icon-toolbar-deprivation",flex:1,text:"Deprivate",handler:function(){this.setGroupActive("delete")},scope:e}]}]}],buttons:[{text:"Erase Group",name:"btn_erase",hidden:"1"==e.ugroup.get("active"),handler:function(){this.setGroupActive("erase")},scope:e},"->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:e},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:e}],listeners:{afterrender:function(e){var t=this;t.gid&&(t.loadPrivilege(t.gid),t.down("[name=groupname]").setValue(t.groupname||""))}}}),IG$.groupPrivSetting.superclass.initComponent.apply(e,arguments)}}),IG$.TenantSetting=$s.extend($s.window,{title:"Tenant Setting",modal:!0,layout:"fit",closable:!1,resizable:!1,width:400,autoHeight:!0,plain:!0,bodyPadding:10,bodyStyle:{background:"#ffffff"},_confirm:function(){this.close()},setTenantActive:function(n){var i=this,e=new IG$._rpc$,s={},o=(i.down("[name=tenantname]"),i.gid,i.mts);("rename"==n?i.getAllValues(s):0)||(s.mts=o.get("uid"),e.init(i,{ack:"usercontent",payload:{address:"/tenants/"+o.get("name"),action:n},mbody:s},i,function(e,t){if("rename"==n)for(var a in s)o.set(a,s[a]);i.rs_setTenantActive(e,t)},!1,[n]),e.send())},rs_setTenantActive:function(e,t){var a=this,n=t[0],i=a.mts,s=a.down("[name=btn_erase]");switch(n){case"activate":i.set("pstatname","Active"),i.set("pstatus","1"),s.setVisible(!1);break;case"delete":i.set("pstatname","Blocked"),i.set("pstatus","0"),s.setVisible(!0);break;case"erase":i.remove(),a.close();break;case"rename":a.close()}},loadTemplates:function(){var e=new IG$._rpc$;e.init(this,{ack:"helpcontent",payload:{},mbody:{option:"timezone"}},this,function(e){var t,a,n,i=this,s=[],o=[],l=i.down("[name=a1]"),r=i.down("[name=a2]");if(s.push({name:"Select",value:""}),e.app_tmpl)for(a=0;a<e.app_tmpl.length;a++)n=e.app_tmpl[a],s.push(n);if(l.store.loadData(s),o.push({name:"Select",value:""}),e.themes)for(t=e.themes,a=0;a<t.length;a++)(n=t[a]).name=n.value,o.push(n);r.store.loadData(o),i.mts&&i.setAllValues(i.mts.data)}),e.send()},initComponent:function(){var e=this;$s.apply(e,{items:[{xtype:"form",layout:"anchor",defaults:{anchor:"100%"},border:0,padding:5,items:[{xtype:"fieldset",title:"General Information",layout:"anchor",items:[{xtype:"textfield",readOnly:e.mts&&"A"==e.mts.get("pstatus"),fieldLabel:IRm$.r1("B_NAME"),required:!0,name:"name",mapname:"name"},{xtype:"textfield",fieldLabel:IRm$.r1("L_TENANT_NAME"),name:"tenantname",required:!0},{xtype:"textfield",fieldLabel:"Logo image",name:"logoimage"}]},{xtype:"fieldset",title:"Options",layout:"anchor",items:[{xtype:"combobox",fieldLabel:IRm$.r1("B_TEMPLATES"),name:"a1",editable:!1,queryMode:"local",valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"]}},{xtype:"combobox",fieldLabel:"Themes",name:"a2",editable:!1,queryMode:"local",valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"]}}]},{xtype:"fieldset",title:IRm$.r1("L_LICENSE_INFO"),layout:"anchor",items:[{xtype:"textfield",name:"turl",labelPosition:"top",fieldLabel:"URL",readOnly:!0},{xtype:"numberfield",name:"userlimit",fieldLabel:IRm$.r1("L_ALLOWED_USERS"),value:5},{xtype:"textfield",name:"reg_date",fieldLabel:IRm$.r1("L_REG_DATE"),editable:!1},{xtype:"datefield",fieldLabel:"Expire on",name:"expire_date",required:!0}]},{xtype:"container",height:10}]}],buttons:[{xtype:"button",iconCls:"icon-toolbar-activate",flex:1,tooltip:IRm$.r1("L_ACTIVATE"),hidden:e.mts&&"A"==e.mts.get("pstatus"),handler:function(){this.setTenantActive("activate")},scope:e},{xtype:"button",iconCls:"icon-toolbar-deprivation",flex:1,tooltip:IRm$.r1("L_DEPRIVATE"),hidden:e.mts&&"A"==e.mts.get("pstatus"),handler:function(){this.setTenantActive("delete")},scope:e},{text:"Erase Tenant",name:"btn_erase",hidden:"1"==e.mts.get("pstatus")||"A"==e.mts.get("pstatus"),handler:function(){this.setTenantActive("erase")},scope:e},"->",{text:IRm$.r1("B_CONFIRM"),handler:function(){this.setTenantActive("rename")},scope:e},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:e}],listeners:{afterrender:function(e){var t=this;if(t.mts){var a=t.down("[name=turl]"),n=t.mts.get("name");t.setAllValues(t.mts.data),n=(n=n.split(" ")).join("%20"),a.setValue("http://hostname.com/amplix/?lang=en_US&mts="+n),t.loadTemplates()}}}}),IG$.TenantSetting.superclass.initComponent.apply(e,arguments)}});
IG$.mgrUserEditor=$s.extend($s.window,{modal:!0,layout:"fit",closable:!1,resizable:!1,width:480,height:550,plain:!0,bodyPadding:10,bodyStyle:{background:"#ffffff"},callback:null,initapp:function(){var e=this;e.down("[name=gid]").store.loadData(this.groupinfo),e.buildCustomForm(),e.updateUserDetail(),e.loadTemplates(),e.loadAuthModule()},buildCustomForm:function(){var e,t,a,n=this.down("[name=c_area]"),i=IG$.uform;for(e=0;e<i.length;e++)a={xtype:(t=i[e]).type,fieldLabel:t.displayname,name:t.fieldname},n.add(a)},updateUserDetail:function(){var e,t,a,n=this,i=n.userinfo,s=IG$.dlgLogin.logininfo,d=n.down("[name=userid]"),o=n.down("[name=username]"),l=n.down("[name=email]"),r=n.down("[name=password]"),u=n.down("[name=gid]"),m=n.down("[name=pupdatedate]"),c=IRm$.r1("L_LAST_UPD"),p=n.down("[name=duties]"),f=i&&i.auth?i.auth:[],h=n.down("[name=btnaddduty]"),y=n.down("[name=fieldstatus]");if(h.setVisible(!i||s.userid!=i.id),d.setReadOnly(!!i),d.setValue(i&&i.id||""),o.setValue(i&&i.name||""),r.setValue(i?"":IG$.generateUniqueTest(10)),l.setValue(i&&i.email||""),u.setValue(i?i.gid||"":n.currentGroup||""),y.setVisible(!!i),c=i&&i.updatedate?c+i.updatedatefm:c,m.setValue(c),p.store.loadData(f),IG$.uform)for(e=0;e<IG$.uform.length;e++)a=IG$.uform[e],(t=n.down("[name="+a.fieldname+"]"))&&t.setValue(i&&i.additional_info?i.additional_info[a.fieldname]:"")},confirmChanges:function(e){var t,a,n,i,s,d,o,l,r,u=this,m=this,c=IG$.dlgLogin.logininfo,p=m.down("[name=userid]"),f=m.down("[name=username]"),h=m.down("[name=email]"),y=m.down("[name=password]"),g=m.down("[name=gid]"),b=m.down("[name=duties]"),I=y.getValue(),_=!1,v=u.userinfo;if("confirm"==e){if(!IG$.rsaPublicKeyModules)return(x=new IG$._rpc$).init(u,{ack:"security",payload:{},mbody:{}},u,function(e){var t=e?e.p1:null,a=e?e.p2:null;t&&a&&(IG$.rsaPublicKeyModules=t,IG$.rsaPublicKeyExpoenent=a,this.confirmChanges("confirm"))},null),void x.send();if(t="usercontent",a={address:"/user/"+p.getValue(),updatemode:"change"},n={},$.each([p,f,g],function(e,t){t.clearInvalid(),t.getValue()||(t.markInvalid("Required"),_=!0)}),_)return;if(I=I&&IG$.encryptKey([I])[0],n={sid:v?v.sid:null,wid:v?v.wid:null,id:p.getValue(),name:f.getValue(),password:I,email:h.getValue(),gid:g.getValue(),a1:u.down("[name=a1]").getValue(),ssomod:u.down("[name=ssomod]").getValue(),additional_info:{}},IG$.uform)for(s=0;s<IG$.uform.length;s++)if(d=(l=IG$.uform[s]).fieldname,o=u.down("[name="+d+"]")){if(!l.optional&&(o.clearInvalid(),!o.getValue()))return void o.markInvalid("Required");n.additional_info[d]=o.getValue()}for(n.duties=[],s=0;s<b.store.data.items.length;s++)i=b.store.data.items[s],n.duties.push({dutytype:i.get("dutytype"),name:i.get("name"),sid:i.get("sid"),status:i.get("status")});r="user"}else{if("delete"!=e)return;if(p.getValue()==c.userid)return void IG$.ShowError("You cannot remove yourself.",m);t="usercontent",a={address:"/user/"+p.getValue(),updatemode:"delete"},n={sid:u.userinfo?u.userinfo.sid:""},r="user"}var w=this,x=new IG$._rpc$;w.setLoading(!0),x.init(w,{ack:t,payload:a,mbody:n,meta_type:r},w,w.rs_confirmChanges,null),x.send()},rs_confirmChanges:function(e){this.setLoading(!1),this.callback&&this.callback.execute(),IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success"),this.close()},setUserActive:function(e,t){var a,n=new IG$._rpc$;"activate"==t||"admin"!=e.name?(a={option:"changestatus",status:t,uid:e.sid},n.init(this,{ack:"usercontent",payload:{address:"/user/"+e.name},mbody:a},this,this.rs_setUserActive,!1,t),n.send()):IG$.alertmsg(ig$.appname,IRm$.r1("M_NA"),null,null,0,"error")},rs_setUserActive:function(e,t){this.drow&&this.drow.set("status","1"==t?"Active":"Blocked"),IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},toolbarHandler:function(e){var t,a=this,n=a.userinfo;switch(e){case"cmd_activate_user":n&&a.setUserActive(n,"1");break;case"cmd_deprivate_user":n&&a.setUserActive(n,"2");break;case"cmd_add_duty":var i,s,d=[],o=a.down("[name=duties]").store.data.items;for(s=0;s<o.length;s++)i=o[s],d.push({dutytype:i.get("dutytype"),name:i.get("name"),sid:i.get("sid"),type:i.get("type"),status:i.get("status")});t=new IG$.mgrUserDuty({sel:d,callback:new IG$.callBackObj(a,a.rs_addDuty)}),IG$.checkLogin(a,t)}},rs_addDuty:function(e){var t,a,n=this.down("[name=duties]"),i=[];for(a=0;a<e.length;a++)t=e[a],i.push({dutytype:t.get("dutytype"),name:t.get("name"),sid:t.get("sid"),type:t.get("type"),status:t.get("status")});n.store.loadData(i)},loadTemplates:function(){var e=new IG$._rpc$;e.init(this,{ack:"helpcontent",payload:{},mbody:{option:"timezone"}},this,function(e){var t,a,n,i=[],s=this.down("[name=a1]"),d=this.userinfo;for(t=e.app_tmpl,i.push({name:"Select",value:""}),a=0;a<t.length;a++)(n=t[a]).name=n.value,i.push(n);s.store.loadData(i),s.setValue(d&&d.a1||"")}),e.send()},loadAuthModule:function(){var i=this,e=new IG$._rpc$,s=i.down("[name=ssomod]"),d=i.userinfo?i.userinfo:null;if(IG$._ssomod){var t,a=IG$._ssomod,n=[{name:"Select Module",value:""}];for(t in a)n.push({name:t,value:t}),s.store.loadData(n),s.setValue(d&&d.ssomod||"")}else e.init(i,{ack:"usercontent",payload:{address:"/Features"},mbody:{option:"auth_module"}},i,function(e){var t,a=e?e.authorization:{},n=[{name:"Select Module",value:""}];i.down("[name=dmodule]");for(t in a)n.push({name:t,value:t});IG$._ssomod=a,s.store.loadData(n),s.setValue(d&&d.ssomod||"")}),e.send()},initComponent:function(){this.title=IRm$.r1("T_REG_USER"),$s.apply(this,{items:[{xtype:"panel",layout:"anchor",bodyPadding:4,autoScroll:!0,defaults:{anchor:"100%"},items:[{xtype:"textfield",fieldLabel:IRm$.r1("L_USERID"),name:"userid"},{xtype:"textfield",fieldLabel:IRm$.r1("L_USERNAME"),name:"username"},{xtype:"textfield",fieldLabel:IRm$.r1("L_EMAIL"),name:"email"},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_INPUT_PASSWORD"),layout:"hbox",items:[{xtype:"textfield",name:"password",readOnly:!1,flex:1},{xtype:"button",name:"pgetpwd",text:"Generate",width:70,handler:function(){var e=this.down("[name=password]"),t=IG$.generateUniqueTest(10);e.setValue(t)},scope:this}]},{xtype:"combobox",fieldLabel:IRm$.r1("L_GROUP_NAME"),labelField:"name",valueField:"gid",name:"gid",queryMode:"local",displayField:"name",valueField:"gid",editable:!1,autoSelect:!0,store:{fields:["name","gid"]}},{xtype:"container",name:"c_area",layout:{type:"vbox",align:"stretch"}},{xtype:"combobox",name:"a1",fieldLabel:IRm$.r1("L_APPL_TMPL"),queryMode:"local",editable:!1,valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"]}},{xtype:"displayfield",value:IRm$.r1("L_LAST_UPD"),name:"pupdatedate"},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("L_USER_DUTY"),layout:"hbox",items:[{xtype:"gridpanel",fieldLabel:"User Duty",flex:1,height:160,hideLabel:!0,name:"duties",store:{xtype:"store",fields:["dutytype","name","sid","status"]},columns:[{header:IRm$.r1("B_NAME"),flex:1,sortable:!1,hideable:!1,dataIndex:"name"}]},{xtype:"button",iconCls:"icon-toolbar-add",tooltip:"Add Duty",name:"btnaddduty",hidden:!0,handler:function(){this.toolbarHandler("cmd_add_duty")},scope:this}]},{xtype:"fieldset",title:"Single Sign On",layout:{type:"vbox",align:"stretch"},items:[{xtype:"combobox",name:"ssomod",fieldLabel:"SSO Module",displayField:"name",valueField:"value",store:{fields:["name","value"]},readOnly:!1}]},{xtype:"fieldcontainer",fieldLabel:IRm$.r1("B_STATUS"),name:"fieldstatus",hidden:!0,layout:"hbox",items:[{xtype:"button",text:IRm$.r1("L_ACTIVATE"),name:"btnactuser",handler:function(){this.toolbarHandler("cmd_activate_user")},scope:this},{xtype:"button",text:IRm$.r1("L_DEPRIVATE"),name:"btndeprivuser",handler:function(){this.toolbarHandler("cmd_deprivate_user")},scope:this}]}]}],buttons:[{xtype:"button",text:IRm$.r1("L_E_DEL"),handler:function(){this.confirmChanges("delete")},scope:this},"->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){this.confirmChanges("confirm")},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){this.initapp()}}}),IG$.mgrUserEditor.superclass.initComponent.call(this)}});
IG$.mgrUser=$s.extend(IG$.v$pnl,{scroll:!1,closable:!0,layout:"border",userinfo:null,groupinfo:null,iconCls:"icon-group",currentGroup:null,init_f:function(){this.loadCustForm()},loadCustForm:function(){var t=new IG$._rpc$;t.init(this,{ack:"usercontent",payload:{address:"/userform"},mbody:{option:"standard"}},this,function(t){var e,i,s=this,n=IG$.dlgLogin.logininfo,o=[];if(t&&t.length)for(e=0;e<t.length;e++)"textinput"==(i=t[e]).type&&(i.type="textfield"),o.push(i);IG$.uform=o,1==n.hasDuty("admins","A")&&s.down("[name=v_tenant]").show(),s.loadMTS(),s.getDuties(),s.loadUsrGrp("",null)},!1),t.send()},loadMTS:function(){var t=new IG$._rpc$;t.init(this,{ack:"usercontent",payload:{address:"/tenants",action:"get"},mbody:{option:"select"}},this,function(t){var e,i,s=[];if(t)for(e=0;e<t.length;e++){switch((i=t[e]).status){case"A":i.pstatname="App";break;case"1":i.pstatname="Active";break;default:i.pstatname="Disabled"}s.push(i)}this.down("[name=mtsgrd]").store.loadData(s)},!1),t.send()},getDuties:function(){var t=new IG$._rpc$;t.init(this,{ack:"usercontent",payload:{address:"/Auth"},mbody:{option:"select"}},this,function(t){var e,i,s=[],n=this.down("[name=gridduty]");n.getSelectionModel();if(t)for(e=0;e<t.length;e++)(i=t[e]).active=1==i.status?"Active":"Disabled",s.push(i);n.store.loadData(s)},!1),t.send()},createDuty:function(){var t=this;new IG$.makeItem({itemtype:"Auth",callback:new IG$.callBackObj(t,t.rs_createDuty)}).show(t)},rs_createDuty:function(t){this.getDuties()},createMTS:function(){new IG$.makeItem({itemtype:"tenant",callback:new IG$.callBackObj(this,function(t){this.loadMTS()})}).show(this)},getDutyUsrs:function(t){var e=this,i=new IG$._rpc$;i.init(e,{ack:"usercontent",payload:{address:"/user"},mbody:{option:"get",sid:t}},e,e.rs_getUsrs,null,!0),i.send()},loadUsrGrp:function(t,e){var i=this,s=new IG$._rpc$,n=IG$.dlgLogin.logininfo;0==n.hasDuty("admins","A")&&1==n.hasDuty("LocalAdmin","A")&&(t=auth.gid),this.groupinfo=[],s.init(i,{ack:"usercontent",payload:{address:"/usergroup",action:"get",pid:t},mbody:{option:"standard"}},i,i.rs_loadUsrGrp,null,[t,e]),s.send()},rs_loadUsrGrp:function(t,e){e[0],e[1];var i,s,n=this.down("[name=grouptree]");if(t){for(i={name:"Groups",expanded:!0,children:[]},s=0;s<t.length;s++)i.children.push(this.parseUsrGrp(t[s],null,0));n.store.setRootNode(i),n.store.getRootNode().expand()}},parseUsrGrp:function(t,e,i){var s,n,o={};for($s.defaults(o,{gid:t.gid,name:t.name,updatedate:t.updatedate,description:t.description,groupid:t.groupid,active:t.active,loadData:!1}),n=0;n<i;n++)o.name=t.name,o.depth=i;switch(this.groupinfo.push(t),t.active){case 1:o.status="Active";break;case 2:o.status="Blocked";break;default:o.status="Error"}if(e&&(e.expanded=!0,e.children=e.children||[],e.children.push(o)),t.subgroups)for(s=0;s<t.subgroups.length;s++)this.parseUsrGrp(t.subgroups[s],o,i+1);return o},getUsrs:function(t){var e=new IG$._rpc$;e.init(this,{ack:"usercontent",payload:{address:"/user"},mbody:{option:"get",gid:t}},this,this.rs_getUsrs,null),e.send()},rs_getUsrs:function(t,e){var i,s,n=[],o=this.down("[name=usergrid]");if(t)for(i=0;i<t.length;i++){switch((s=t[i]).active){case 1:s.status="Active",s.change="Block user";break;case 3:s.status="Email Valid",s.change="Activate user";break;case 4:s.status="Email Process",s.change="Deprivate";break;default:s.status="Blocked",s.change="Activate"}n.push(s)}o.store.loadData(n)},getUsrDtl:function(t,e){var i=new IG$._rpc$;i.init(this,{ack:"usercontent",payload:{address:"/user"},mbody:{option:"detail",uid:t}},this,function(t,e){if(t){var i,s=t;if(s.auth=[],t.duties)for(i=0;i<t.duties.length;i++)s.auth.push(t.duties[i]);var n=new IG$.mgrUserEditor({groupinfo:this.groupinfo,userinfo:s,drow:e,currentGroup:this.currentGroup,callback:new IG$.callBackObj(this,this.rs_modifyUsr)});IG$.checkLogin(this,n)}},null,e),i.send()},getSelection:function(){var t=this.down("[name=grouptree]").getSelectionModel();return t&&t.selected&&t.selected.items&&0<t.selected.items.length?t.selected.items[0]:null},toolbarHandler:function(t){var e,i,s=this;switch(t){case"cmd_add_group":(e=s.getSelection())&&(i=new IG$.makeItem({itemtype:"Group",parentuid:e.get("gid"),parentnodepath:"",callback:new IG$.callBackObj(s,s.rs_addGrp,e)})).show(s);break;case"cmd_edit_group":(e=s.getSelection())?e.isRoot()?IG$.ShowError(IRm$.r1("M_NOT_EDITABLE"),this):(i=new IG$.makeItemEditor({uid:e.get("gid"),itemname:e.get("name"),itemtype:"Group",groupid:e.get("groupid"),group_active:e.get("active"),callback:new IG$.callBackObj(s,s.rs_addGrp,e)})).show(s):IG$.ShowError(IRm$.r1("M_SEL_ITEM"),this);break;case"cmd_add_user":e=s.getSelection(),i=new IG$.mgrUserEditor({groupinfo:s.groupinfo,userinfo:null,currentGroup:s.currentGroup,callback:new IG$.callBackObj(s,s.rs_modifyUsr)}),IG$.checkLogin(s,i);break;case"cmd_sync_user":IG$.procMenuCommand("CMD_SYNC_USER");break;case"cmd_new_duty":this.createDuty();break;case"cmd_add_mts":this.createMTS();break;case"cmd_edit_mts":var n=this.down("[name=mtsgrd]").getSelectionModel().selected;n&&0<n.length?(i=new IG$.TenantSetting({mts:n.items[0],callback:new IG$.callBackObj(s,function(){this.loadMTS()})}),IG$.checkLogin(this,i)):IG$.ShowError(IRm$.r1("M_SEL_ITEM"),this)}},rs_modifyUsr:function(){this.currentGroup&&this.getUsrs(this.currentGroup)},rs_addGrp:function(t,e){this.loadUsrGrp("",null)},setViewMode:function(t){var e,i=this.down("[name=mpanel]");for(e=0;e<i.items.items.length;e++)e!=t&&i.items.items[e].hide();i.items.items[t].show()},initComponent:function(){$s.apply(this,{items:[{xtype:"panel",name:"mpanel",border:1,layout:{type:"fit",align:"stretch"},region:"west",split:!0,width:400,collapsible:!1,hideHeaders:!0,tbar:[{text:"User",toggle:!0,handler:function(){this.setViewMode(0)},scope:this},{text:"Role",toggle:!0,handler:function(){this.setViewMode(1)},scope:this},{text:"Tenant",name:"v_tenant",hidden:!0,toggle:!0,handler:function(){this.setViewMode(2)},scope:this}],items:[{xtype:"treepanel",border:0,name:"grouptree",layout:"fit",title:IRm$.r1("T_USER_GROUP"),rootVisible:!0,store:{xtype:"store",fields:["name","active","description","gid","updatedate","loadData","status","groupid"],data:[]},columns:[{xtype:"treecolumn",text:IRm$.r1("B_NAME"),flex:1,sortable:!1,dataIndex:"name"},{text:"GroupID",width:60,sortable:!1,dataIndex:"groupid"},{text:IRm$.r1("B_STATUS"),width:60,sortable:!1,dataIndex:"status"}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{iconCls:"icon-toolbar-add",text:IRm$.r1("L_ADD_GROUP"),tooltip:"Add",handler:function(){this.toolbarHandler("cmd_add_group")},scope:this},{iconCls:"icon-toolbar-edit",tooltip:IRm$.r1("L_EDIT"),handler:function(){this.toolbarHandler("cmd_edit_group")},scope:this},{iconCls:"icon-refresh",tooltip:"Refresh",handler:function(){this.loadUsrGrp("",null)},scope:this}]}],listeners:{itemclick:function(t,e,i,s,n,o){var r=e.get("gid");this.currentGroup=r,this.getUsrs(r)},beforeitemexpand:function(t,e){0==t.hasChildNodes()&&t.get("loadData")},scope:this}},{xtype:"gridpanel",title:IRm$.r1("T_DUTY_LIST"),name:"gridduty",hideHeaders:!1,layout:"fit",hidden:!1,border:0,store:{xtype:"store",fields:["sid","name","dutytype","status","type","active"]},dockedItems:[{xtype:"toolbar",dock:"top",items:[{iconCls:"icon-toolbar-add",text:IRm$.r1("L_ADD_DUTY"),tooltip:"Add duty",handler:function(){this.toolbarHandler("cmd_new_duty")},scope:this},{iconCls:"icon-toolbar-remove",tooltip:"Remove",name:"btn_r_duty",hidden:!0,handler:function(){this.toolbarHandler("cmd_remove_duty")},scope:this},{iconCls:"icon-refresh",tooltip:"Refresh",handler:function(){this.getDuties()},scope:this},{xtype:"button",text:IRm$.r1("B_SHOW_ALL"),menu:{xtype:"menu",items:[{text:IRm$.r1("B_SHOW_ALL"),handler:function(){this.down("[name=gridduty]").store.clearFilter()},scope:this},{text:"Pre defined",handler:function(){this.down("[name=gridduty]").store.filter("dutytype","A")},scope:this},{text:"Custom duty",handler:function(){this.down("[name=gridduty]").store.filter("dutytype","C")},scope:this},{text:"Group duty",handler:function(){this.down("[name=gridduty]").store.filter("dutytype","G")},scope:this},{text:"User duty",handler:function(){this.down("[name=gridduty]").store.filter("dutytype","U")},scope:this}]}}]},{xtype:"toolbar",dock:"top",items:[{xtype:"textfield",flex:1,name:"_filter",enableKeyEvents:!0,listeners:{keyup:function(t,e,i){13==e.keyCode&&IG$._dofilter(this,"gridduty",["name"])},scope:this}},{xtype:"button",text:"..",handler:function(){IG$._dofilter(this,"gridduty",["name"])},scope:this}]}],columns:[{text:"",width:25,dataIndex:"dutytype"},{xtype:"gridcolumn",text:"Duty name",dataIndex:"name",flex:1},{xtype:"gridcolumn",text:IRm$.r1("B_STATUS"),dataIndex:"active",width:50}],listeners:{cellclick:function(t,e,i,s,n,o,r,a){if(s.get("sid")){s.get("dutytype");var d=s.get("type"),l=this.down("[name=btn_r_duty]");l.setVisible(!1),"PreDefined"!=d&&l.setVisible(!0),this.getDutyUsrs(s.get("sid"))}},scope:this}},{xtype:"gridpanel",border:0,title:IRm$.r1("T_M_TENANT"),name:"mtsgrd",hidden:!1,hideHeaders:!0,store:{xtype:"store",fields:["name","pstatus","uid","pstatname","a1","a2"]},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name",flex:1},{text:IRm$.r1("B_STATUS"),width:60,dataIndex:"pstatname"}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{iconCls:"icon-toolbar-add",text:IRm$.r1("L_ADD_TENANT"),tooltip:"Add",handler:function(){this.toolbarHandler("cmd_add_mts")},scope:this},{iconCls:"icon-toolbar-edit",tooltip:IRm$.r1("L_EDIT"),handler:function(){this.toolbarHandler("cmd_edit_mts")},scope:this}]}]}]},{xtype:"panel",region:"center",layout:"fit",border:1,bodyPadding:2,items:[{xtype:"panel",flex:1,border:!1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",title:"Users",name:"usergrid",border:0,flex:1,store:{xtype:"store",fields:["name","active","gid","groupname","id","sid","updatedate","status","email"]},columns:[{text:"ID",flex:1,sortable:!0,hideable:!1,dataIndex:"id",minwidth:120},{text:IRm$.r1("B_NAME"),flex:1,sortable:!0,hideable:!1,dataIndex:"name",minwidth:120},{text:IRm$.r1("L_GROUP_NAME"),flex:1,sortable:!0,hideable:!1,dataIndex:"groupname",minwidth:120},{text:IRm$.r1("L_AUTH"),flex:1,sortable:!0,hideable:!1,dataIndex:"authmodule",minwidth:120},{text:"Email",flex:1,sortable:!0,hideable:!1,dataIndex:"email",minwidth:200},{text:IRm$.r1("B_STATUS"),flex:1,sortable:!0,hideable:!1,dataIndex:"status",minwidth:80}],listeners:{itemclick:function(t,e,i,s,n,o){var r=e.get("sid");this.getUsrDtl(r,e)},scope:this},tbar:[{text:IRm$.r1("L_ADD_USER"),iconCls:"icon-toolbar-add",handler:function(){this.toolbarHandler("cmd_add_user")},scope:this},{xtype:"button",name:"t_1",text:IRm$.r1("B_SHOW_ALL"),menu:{xtype:"menu",items:[{text:IRm$.r1("B_SHOW_ALL"),handler:function(){this.down("[name=usergrid]").store.clearFilter(),this.down("[name=t_1]").setText(IRm$.r1("B_SHOW_ALL"))},scope:this},{text:IRm$.r1("L_A_USR"),handler:function(){this.down("[name=usergrid]").store.filter("active",1),this.down("[name=t_1]").setText(IRm$.r1("L_A_USR"))},scope:this},{text:IRm$.r1("L_B_USR"),handler:function(){this.down("[name=usergrid]").store.filterBy(function(t,e){return 1!=t.get("active")},this),this.down("[name=t_1]").setText(IRm$.r1("L_B_USR"))},scope:this}]}},{xtype:"textfield",flex:1,name:"_filter",enableKeyEvents:!0,listeners:{keyup:function(t,e,i){13==e.keyCode&&IG$._dofilter(this,"usergrid",["id","name","email"])},scope:this}},{xtype:"button",text:"..",handler:function(){IG$._dofilter(this,"usergrid",["id","name","email"])},scope:this},"->",{xtype:"button",text:"SyncUser",handler:function(){this.toolbarHandler("cmd_sync_user")},scope:this}]}]}]}],listeners:{afterrender:function(){this.setViewMode(0),this.init_f()},scope:this}}),IG$.mgrUser.superclass.initComponent.call(this)}});
IG$.sync_user=$s.extend(IG$.v$pnl,{layout:"fit",iconCls:"icon-group",closable:!0,toolbarHandler:function(e,t){var a=this,n=a.down("[name=msync]").getActiveItem().dname;switch(e){case"cmd_s_run":a.executeAuth(n);break;case"cmd_l_run":IG$.confirmMessages(ig$.appname,IRm$.r1("W_SYNC_"+n.toUpperCase()),function(e){"yes"==e&&a.executeSync(t,n)},a)}},loadPool:function(){var e=new IG$._rpc$;e.init(this,{ack:"tablecontent",payload:{address:"/"},mbody:{option:"standard"}},this,function(e){this._dsource=e,this.loadAuthModule()},!1),e.send()},loadAuthModule:function(){var l=this,e=(this.down("[name=m_navi]"),new IG$._rpc$);e.init(l,{ack:"usercontent",payload:{address:"/Features"},mbody:{option:"auth_module"}},l,function(e){var t,a=e?e.authorization:{},n=[{name:"Select Module",value:""}],o=l.down("[name=dmodule]");for(t in a)n.push({name:t,value:t});l._dmodules=a,o.store.loadData(n),o.setValue("")}),e.send()},executeAuth:function(n){var e,o,l=this,t=new IG$._rpc$;$.each(["dmodule"],function(e,t){var a=l.down("[name="+t+"]");if(a.clearInvalid(),!a.getValue())return o=1,a.markInvalid("required"),!1}),o?IG$.alertmsg(ig$.appname,IRm$.r1("M_ERROR"),null,null,0,"error"):(o=l.checkParams())?l.setParameters():(e={address:"/Authorization/"+n,module:l.down("[name=dmodule]").getValue(),keyword:l.down("[name=keyword]").getValue(),target:n,option:"get_data"},t=new IG$._rpc$,l.setLoading(!0,!0),t.init(l,{ack:"usercontent",payload:e,mbody:{}},l,function(e){var t,a=null,o=[];switch(n){case"group":a="g_group1";break;case"user":a="g_user1";break;case"role":a="g_role1"}t=l.down("[name="+a+"]"),$.each(e,function(e,t){var a,n={name:t.name};if(t.additional_info)for(a in t.additional_info)n[a]=t.additional_info[a];o.push(n)}),t.store.loadData(o)},!1),t.send())},checkParams:function(){var e,t=this._dmodules[this.down("[name=dmodule]").getValue()],a=!1;if(t.parameters&&t.parameters.length)for(i=0;i<t.parameters.length&&(!(e=t.parameters[i]).isnecessary||(!e.initial_values||e.initial_values&&0==e.initial_values.length?a=!0:e.initial_values[0].value||(a=!0),!a));i++);return a},executeSync:function(e){var t,n,o=this,a=[],l=new IG$._rpc$;if($.each(["dmodule"],function(e,t){var a=o.down("[name="+t+"]");if(a.clearInvalid(),!a.getValue())return n=1,a.markInvalid("required"),!1}),n)IG$.alertmsg(ig$.appname,IRm$.r1("M_ERROR"),null,null,0,"error");else if(n=o.checkParams())o.setParameters();else{t={address:"/Authorization/"+e,module:o.down("[name=dmodule]").getValue(),keyword:o.down("[name=keyword]").getValue(),target:e,option:"sync_data"};var i,s,r,d=null;switch(e){case"group":d="g_group2";break;case"user":d="g_user2";break;case"role":d="g_role2"}for(i=o.down("[name="+d+"]").store,s=0;s<i.data.items.length;s++)r=i.data.items[s],a.push(r.data);l=new IG$._rpc$,o.setLoading(!0,!0),l.init(o,{ack:"usercontent",payload:t,mbody:a,meta_type:"list"},o,function(e){IG$.alertmsg(ig$.appname,IRm$.r1("M_SUCCESS"),null,null,0,"success")},!1),l.send()}},moveGrid:function(e,t){var a,n=this.down("[name="+e+"]"),o=this.down("[name="+t+"]"),l=n.getSelectionModel().getSelection();if(0<l.length)for(a=0;a<l.length;a++)n.store.remove(l[a]),o.store.add(l[a])},setParameters:function(){var e,o,t=this,a=t.down("[name=dmodule]");if(a.clearInvalid(),!a.getValue())return haserror=1,a.markInvalid("required"),!1;o=t._dmodules[a.getValue()],e=new IG$.sync_user_param({dsource:t._dsource,dmodule:t._dmodules[a.getValue()],callback:new IG$.callBackObj(t,function(n){var e=new IG$._rpc$,t=n;e.init(this,{ack:"usercontent",payload:{address:"/Features",option:"auth_module_sync",ssomod:a.getValue()},mbody:t},this,function(e){var t,a;if(o.parameters)for(t=0;t<o.parameters.length;t++)a=o.parameters[t].name,o.parameters[t].initial_values=[],n[a]&&o.parameters[t].initial_values.push({value:n[a]});IG$.alertmsg(ig$.appname,IRm$.r1("M_SUCCESS"),null,null,0,"success")}),e.send()})}),IG$.checkLogin(t,e)},initComponent:function(){$s.apply(this,{title:IRm$.r1("T_SYNC_USER"),bodyPadding:0,items:[{xtype:"panel",border:0,bodyPadding:10,layout:{type:"vbox",align:"stretch"},tbar:[{text:"Group",handler:function(){this.down("[name=msync]").setActiveItem(0)},scope:this},{text:"Role",handler:function(){this.down("[name=msync]").setActiveItem(2)},scope:this},"-",{text:"User",handler:function(){this.down("[name=msync]").setActiveItem(1)},scope:this},"->",{text:"Parameters",handler:function(){this.setParameters()},scope:this}],items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch"},items:[{xtype:"combobox",fieldLabel:"Dynamic Module",name:"dmodule",valueField:"value",displayField:"name",queryMode:"local",editable:!1,store:{fields:["name"]}},{xtype:"textfield",fieldLabel:"Keyword",name:"keyword"},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"container",flex:1},{xtype:"button",text:"Execute",handler:function(){this.toolbarHandler("cmd_s_run")},scope:this}]}]},{xtype:"container",flex:2,name:"msync",layout:"card",items:[{xtype:"fieldset",flex:1,dname:"group",title:"Group Syncronization",layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",value:"No options are available for this module"},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"g_group1",title:"Groups on Remote System",flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}]},{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",flex:1},{xtype:"button",text:">",handler:function(){this.moveGrid("g_group1","g_group2")},scope:this},{xtype:"button",text:"<",handler:function(){this.moveGrid("g_group2","g_group1")},scope:this},{xtype:"container",flex:1}]},{xtype:"gridpanel",name:"g_group2",title:"Selected Groups",flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}],bbar:["->",{text:"Import",handler:function(){this.toolbarHandler("cmd_l_run","group")},scope:this}]}]}]},{xtype:"fieldset",flex:1,dname:"user",title:"User Syncronization",layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",value:"No options are available for this module"},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"g_user1",title:"Remote System Users",flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}]},{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",flex:1},{xtype:"button",text:">",handler:function(){this.moveGrid("g_user1","g_user2")},scope:this},{xtype:"button",text:"<",handler:function(){this.moveGrid("g_user2","g_user1")},scope:this},{xtype:"container",flex:1}]},{xtype:"gridpanel",name:"g_user2",title:"Selected Users",flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}],bbar:["->",{text:"Import",handler:function(){this.toolbarHandler("cmd_l_run","user")},scope:this}]}]}]},{xtype:"fieldset",flex:1,dname:"role",title:"Role Syncronization",layout:{type:"vbox",align:"stretch"},items:[{xtype:"displayfield",value:"No options are available for this module"},{xtype:"container",flex:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"gridpanel",name:"g_role1",title:"Remote System Roles",flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}]},{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",flex:1},{xtype:"button",text:">",handler:function(){this.moveGrid("g_role1","g_role2")},scope:this},{xtype:"button",text:"<",handler:function(){this.moveGrid("g_role2","g_role1")},scope:this},{xtype:"container",flex:1}]},{xtype:"gridpanel",name:"g_role2",title:"Selected Roles",flex:1,selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{fields:["name"]},columns:[{text:"Name",flex:1,dataIndex:"name"}],bbar:["->",{text:"Import",handler:function(){this.toolbarHandler("cmd_l_run","role")},scope:this}]}]}]}]}]}]}),IG$.sync_user.superclass.initComponent.call(this)},listeners:{afterrender:function(e){this.loadPool()}}}),IG$.sync_user_param=$s.extend($s.window,{modal:!0,layout:"fit",closable:!1,resizable:!1,width:600,height:500,_init:function(){var i=this,s=i.down("[name=params]"),e=i.dmodule;e&&e.parameters&&($.each(e.parameters,function(e,t){var a,n,o,l={xtype:t.type,name:t.name,fieldLabel:t.label||t.name,required:t.isnecessary};if("datasource"==l.xtype)for(l.xtype="combobox",l.valueField="uid",l.displayField="name",l.queryMode="local",l.editable=!1,l.store={data:[{name:"Select Database Instance",uid:""}]},a=IG$.dlgLogin.jS2,n=0;n<i.dsource.length;n++)t=i.dsource[n],(1==a||0==a&&"IGCBASE"!=t.name.toUpperCase())&&l.store.data.push({uid:t.uid,name:t.name});else"textarea"==l.xtype&&(l.height=150);s.add(l),t.description&&(o={xtype:"textarea",fieldLabel:" ",readOnly:!0,required:!1,value:t.description,height:150},s.add(o))}),setTimeout(function(){$.each(e.parameters,function(e,t){var a=i.down("[name="+t.name+"]");a&&(t.initial_values&&t.initial_values.length?a.setValue(t.initial_values[0].value):a.setValue(""))})},10))},initComponent:function(){$s.apply(this,{defaults:{padding:10},title:"SSO Parameters",items:[{xtype:"container",defaults:{padding:10},autoScroll:!0,layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Parameters",name:"params",layout:{type:"vbox",align:"stretch"},items:[]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){var e={};this.down("[name=params]").getAllValues(e)||(this.callback&&this.callback.execute(e),this.close())},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){e._init()}}}),IG$.sync_user_param.superclass.initComponent.apply(this,arguments)}});
IG$.makeStyle=$s.extend($s.window,{modal:!0,region:"center",layout:"fit",closable:!1,resizable:!1,width:320,autoHeight:!0,parentnodepath:null,callback:null,processMakeStyleItem:function(){var e,t=this,l=t.m_theme,n=t.down("[name=fitemname]"),a=n.getValue(),i=t.down("[name=basetypeselect]"),s=i.getValue();if(n.clearInvalid(),i.clearInvalid(),a){if(l||s)if(l&&t.themes[a])n.setInvalid("Duplicated");else{if(!l)for(e=0;e<t.styleinfo.length;e++)if(t.styleinfo[e].name==a)return i.setInvalid("Duplicated"),!1;t.callback.execute([a,s]),t.close()}}else n.setInvalid("Required Field")},_init:function(){var e,t=this,l=[],n=t.m_theme,a=t.down("[name=basetypeselect]");if(!n){for(e=0;e<t.styleinfo.length;e++)t.styleinfo[e].basestylename||l.push({name:t.styleinfo[e].name});a.store.loadData(l)}},initComponent:function(){this.title=IRm$.r1("L_MAKESTYLE"),$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{html:IRm$.r1("L_MAKESTYLE"),flex:1,border:0},{xtype:"panel",region:"center",flex:3,border:!0,region:"center",height:120,defaultType:"textfield",layout:"anchor",defaults:{anchor:"100%"},items:[{fieldLabel:IRm$.r1("L_STYLENAME"),labelWidth:130,name:"fitemname",value:"",allowBlank:!1,blankText:"Style name is required!",enableKeyEvents:!0,listeners:{keyup:function(e,t){13==t.keyCode&&this.processMakeStyleItem.call(this)},scope:this}},{xtype:"combobox",name:"basetypeselect",hidden:!!this.m_theme,fieldLabel:"Inherit Style from",labelWidth:130,store:{fields:[{name:"name"}]},displayField:"name",valueField:"name",editable:!1,queryMode:"local",selectOnTab:!1}],listeners:{afterrender:function(){this._init()},scope:this}}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.processMakeStyleItem()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$.makeStyle.superclass.initComponent.apply(this,arguments)}});
IG$.styleWizard=$s.extend(IG$.v$pnl,{layout:"border",closable:!0,iconCls:"icon-style",reportoption:null,callback:null,loadGlobalStyle:function(){var e=this,t=e.down("[name=p_h]").getLayout(),a=new IG$._rpc$;t.setActiveItem(0),a.init(e,{ack:"appoption",payload:{address:"ReportStyle"},mbody:{}},e,e.rs_loadGlobalStyle,null),a.send()},rs_loadGlobalStyle:function(e){var m,t,a,c,l=this,n=e.themes,o=l.down("[name=c_themes]"),s=l.down("[name=stylelist]"),i=[],r=[],d={},h={},y={},_=[];if(l.themes={},l._mc=e,n){for(d[(a={name:"Default",leaf:!1,expanded:!0,children:[]}).name]=a,r.push(a),d[(a={name:"Custom",leaf:!1,expanded:!0,children:[]}).name]=a,r.push(a),t=0;t<n.length;t++)(m=n[t]).name,m.c_cset,c={_mc:m,name:m.name,styleinfo:[]},i.push({name:c.name,value:c.name}),l.themes[c.name]=c,$.each([{name:"Default",custom:!1,nodename:"default_styles"},{name:"Custom",custom:!0,nodename:"custom_styles"}],function(e,t){var a,l,n,o,s,i=m[t.nodename];if(i)for(l=d[t.name],a=0;a<i.length;a++)o={name:(n=new IG$.clStyleObject(i[a],t.name.toLowerCase(),t.custom)).name,leaf:!0,custom:t.custom},c.styleinfo.push(n),s=t.name.toLowerCase()+"_"+n.name,h[s]||(l.children.push(o),h[s]=o,t.custom&&!y[n.name]&&(y[n.name]=i[a],_.push({name:n.name,kname:t.name,custom:t.custom,node:i[a]})))});$.each(l.themes,function(e,t){var a,l,n,o,s,i=0;for(a=0;a<_.length;a++){for(n=_[a],l=i=0;l<t.styleinfo.length;l++)if((o=t.styleinfo[l]).custom&&o.name==n.name){i=1;break}0==i&&(s=new IG$.clStyleObject(n.node,n.kname.toLowerCase(),n.custom),t.styleinfo.push(s))}for(a=0;a<t.styleinfo.length;a++)if(1==(n=t.styleinfo[a]).custom&&n.basestylename)for(l=0;l<t.styleinfo.length;l++)if(t.styleinfo[l].name==n.basestylename){o=t.styleinfo[l],n.applyBaseStyle.call(n,o);break}})}s.store.setRootNode({expanded:!0,text:"Style",name:"Style",children:r}),o.store.loadData(i),o.setValue(i.length?i[0].value:null)},loadStyle:function(){var e=this,t=e.down("[name=c_themes]").getValue(),a=e.themes[t],l=e.down("[name=c_cset]"),n=e.down("[name=gs_enable]"),o=e.down("[name=gs_col]"),s=e.down("[name=gs_opa]"),i=e.down("[name=p_h]"),m=e.down("[name=b_r]");e.__cth&&(e.__cth.c_cset=l.getValue(),e.__cth.gs_enable=n.getValue(),e.__cth.gs_col=o.getValue(),e.__cth.gs_opa=s.getValue(),e.commitStyleItem()),a&&(e.__cth=a,l.setValue(a._mc.c_cset||""),n.setValue(a._mc.gs_enable),o.setValue(a._mc.gs_col),s.setValue(a._mc.gs_opa),i.getLayout().setActiveItem(0),m.setVisible(!1))},editStyleItem:function(e){var t,a,l,n,o=this.__cth,s=this.down("[name=form_header]"),i=this.down("[name=form_data]");if(o)for(this.commitStyleItem(),t=0;t<o.styleinfo.length;t++)if(o.styleinfo[t].name==e){if("custom"==(n=o.styleinfo[t]).itemtype)for(a=0;a<o.styleinfo.length;a++)if(o.styleinfo[a].name==n.basestylename){l=o.styleinfo[a];break}s.loadStyleData.call(s,n.header,l?l.header:null),i.loadStyleData.call(i,n.data,l?l.data:null);break}},commitStyleItem:function(){this.__cth;var e=this.down("[name=form_header]"),t=this.down("[name=form_data]");t.updateStyleData.call(t),e.updateStyleData.call(e)},_confirm:function(){var e=this,t=e.down("[name=c_cset]"),a=e.down("[name=gs_enable]"),l=e.down("[name=gs_col]"),n=e.down("[name=gs_opa]");e.__cth&&(e.__cth.c_cset=t.getValue(),e.__cth.gs_enable=a.getValue(),e.__cth.gs_col=l.getValue(),e.__cth.gs_opa=n.getValue()),e.commitStyleItem(),e.saveStyleItem()},saveStyleItem:function(){var e=new IG$._rpc$,s={},t=this.themes;s={meta_type:"report_themes",name:"ReportStyle",type:"AppOption",uid:"ReportStyle",themes:[]},$.each(t,function(e,t){var a,l,n={};for(a=0;a<t.styleinfo.length;a++)n[t.styleinfo[a].name]=t.styleinfo[a];var o={name:t.name,c_cset:t.c_cset,gs_enable:t.gs_enable,gs_opa:t.gs_opa||.6,gs_col:t.gs_col,default_styles:[],custom_styles:[]};for(a=0;a<t.styleinfo.length;a++)0==t.styleinfo[a].custom?o.default_styles.push(t.styleinfo[a].getData()):(l=n[t.styleinfo[a].basestylename],o.custom_styles.push(t.styleinfo[a].getData(l)));s.themes.push(o)}),e.init(this,{ack:"appoption",payload:{address:"ReportStyle",option:"updatecontent"},mbody:s,meta_type:"report_themes"},this,function(e){IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},null),e.send()},copyThemes:function(e,t){var a,l,n;for(a=0;a<e.styleinfo.length;a++)l=e.styleinfo[a],(n=new IG$.clStyleObject(null,l.itemtype,l.custom)).name=l.name,n.nodename=l.nodename,n.basestylename=l.basestylename,n.header=new IG$.clStyleItem(null,"Header"),n.data=new IG$.clStyleItem(null,"Data"),n.applyBaseStyle.call(n,l),t.styleinfo.push(n)},toolbarHandler:function(e){var t,n=this,a=n.down("[name=stylelist]");n.styleinfo;switch(e){case"cmd_refresh":n.loadGlobalStyle();break;case"cmd_add_custom":var l=new IG$.makeStyle({styleinfo:n.__cth.styleinfo,callback:new IG$.callBackObj(n,n.rs__appendCustomStyle)});IG$.checkLogin(n,l);break;case"cmd_add_theme":l=new IG$.makeStyle({m_theme:1,themes:n.themes,callback:new IG$.callBackObj(n,function(e){var t,a=e[0],l=(e[1],this.down("[name=c_themes]"));a&&(t={name:a,c_cset:null,gs_enable:!1,gs_col:0,gs_opa:.6,styleinfo:[]},this.copyThemes(this.__cth,t),this.themes[t.name]=t,l.store.add({name:a,value:a}))})});IG$.checkLogin(n,l);break;case"cmd_remove_theme":IG$.confirmMessages(null,null,function(e){if("yes"==e){var t,a,l=n.down("[name=c_themes]");if(n.__cth&&1<l.store.data.items.length){for(t=0;t<l.store.data.items.length;t++)if((a=l.store.data.items[t]).get("name")==n.__cth.name){l.store.remove(a);break}delete n.themes[n.__cth.name],n.__cth=null,l.setValue(l.store.data.items[0].get("value"))}}},n,n);break;case"cmd_remove":n.down("[name=b_r]").setVisible(!1);(t=(t=a.getSelectionModel().getSelection())&&0<t.length?t[0]:null)&&1==t.get("custom")&&(stylename=t.get("name"),$.each(n.themes,function(e,t){var a,l=t.styleinfo;for(a=0;a<l.length;a++)if(l[a].custom&&l[a].name==stylename){l.splice(a,1);break}}),t.remove())}},rs__appendCustomStyle:function(e){var t,s=e[0],i=e[1];if(i&&s){$.each(this.themes,function(e,t){var a,l,n,o=t.styleinfo;for(a=0;a<o.length;a++)if(o[a].name==i){l=o[a];break}l&&((n=new IG$.clStyleObject(null,"item",!0)).name=s,n.nodename="ItemStyle",n.basestylename=i,n.header=new IG$.clStyleItem(null,"Header"),n.data=new IG$.clStyleItem(null,"Data"),o.push(n),n.applyBaseStyle.call(n,l))});var a,l,n=this.down("[name=stylelist]").store.getRootNode();for(t=0;t<n.childNodes.length;t++)if("Custom"==n.childNodes[t].get("name")){l=n.childNodes[t];break}a={name:s,leaf:!0,custom:!0},l.appendChild(a)}},initComponent:function(){var e,t=new IG$.styleEditor({title:IRm$.r1("L_STYLE_TITLE"),name:"form_header",htype:"hd",flex:1}),a=new IG$.styleEditor({title:IRm$.r1("L_STYLE_DATA"),name:"form_data",htype:"dt",flex:1}),l=[{name:"Select",value:""}],n=IG$.__chartoption.chartcolors;for(e in n)l.push({name:e,value:e});this.title=IRm$.r1("T_STYLE_WIZARD"),$s.apply(this,{defaults:{bodyStyle:"padding:3px"},dockedItems:[{xtype:"toolbar",dock:"top",plain:!0,items:[{iconCls:"icon-toolbar-save",tooltip:IRm$.r1("L_SAVE_CONTENT"),handler:function(){this._confirm()},scope:this},"-",{xtype:"combobox",fieldLabel:"Themes",name:"c_themes",displayField:"name",labelWidth:60,labelAlign:"right",valueField:"value",editable:!1,queryMode:"local",store:{fields:["name","value"]},listeners:{change:function(e,t,a,l){this.loadStyle()},scope:this}},{iconCls:"icon-toolbar-add",tooltip:"Add Theme",text:"Add Theme",handler:function(){this.toolbarHandler("cmd_add_theme")},scope:this},{iconCls:"icon-toolbar-remove",tooltip:"Remove Theme",handler:function(){this.toolbarHandler("cmd_remove_theme")},scope:this}]}],items:[{xtype:"panel",width:270,border:1,region:"west",layout:"anchor",tbar:[{xtype:"displayfield",value:"Basic Options"}],items:[{xtype:"combobox",fieldLabel:"Chart Style",name:"c_cset",displayField:"name",labelAlign:"right",labelWidth:60,valueField:"value",editable:!1,queryMode:"local",store:{fields:["name","value"],data:l}},{xtype:"fieldset",title:"Grid stripe",anchor:"100%",layout:"anchor",items:[{xtype:"checkbox",fieldLabel:IRm$.r1("L_GS_ENABLED"),name:"gs_enable",boxLabel:IRm$.r1("B_ENABLED")},{xtype:"fieldcontainer",anchor:"100%",fieldLabel:IRm$.r1("L_ALT_COLOR"),layout:"hbox",items:[{xtype:"textfield",name:"gs_col",width:60},{xtype:"splitter"},{xtype:"splitbutton",width:30,menu:{showSeparator:!1,items:[{xtype:"colorpicker",listeners:{select:function(e,t){this.down("[name=gs_col]").setValue("#"+t)},scope:this}},"-"]}}]},{xtype:"numberfield",fieldLabel:"Opacity",name:"gs_opa",width:200,minValue:0,maxValue:1,step:.1,value:.4}]},{xtype:"container",flex:1}]},{xtype:"treepanel",title:"Style",name:"stylelist",preventHeader:!0,region:"west",width:220,split:!0,border:1,rootVisible:!1,hideHeaders:!0,autoScroll:!0,store:{xtype:"treestore",fields:["name","text","custom"],root:{expanded:!0,name:"Style",children:[]},folderSort:!1},columns:[{xtype:"treecolumn",text:"text",flex:1,sortable:!1,dataIndex:"name"}],listeners:{itemclick:function(e,t,a,l,n){var o,s=this,i=t.get("name"),m=s.down("[name=b_r]"),c=s.down("[name=p_h]"),r=s.down("[name=p_d]"),d=s.__cth?s.__cth.styleinfo:null,h=!1,y=!1;if(d){for(o=0;o<d.length;o++)if(d[o].name==i){h=!0;break}h&&(1==t.get("custom")&&(y=!0),r.setTitle("Edit : "+i),s.editStyleItem.call(s,i)),c.getLayout().setActiveItem(h?1:0),m.setVisible(y)}},scope:this},tbar:[{iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){this.toolbarHandler("cmd_refresh")},scope:this},"-",{iconCls:"icon-toolbar-add",tooltip:"Add Custom Style",text:"Add Style",handler:function(){this.toolbarHandler("cmd_add_custom")},scope:this},{iconCls:"icon-toolbar-remove",tooltip:"Remove Style",name:"b_r",hidden:!0,handler:function(){this.toolbarHandler("cmd_remove")},scope:this}]},{xtype:"panel",region:"center",layout:"card",name:"p_h",items:[{html:"Click stylename to edit"},{xtype:"tabpanel",title:"Edit :",name:"p_d",layout:{type:"fit",align:"stretch"},items:[a,t]}]}],listeners:{afterrender:function(){"g"==this.styletype&&this.loadGlobalStyle()}}}),IG$.styleWizard.superclass.initComponent.apply(this,arguments)}});
IG$.cubeStyle=$s.extend($s.window,{modal:!0,layout:"border",closable:!1,resizable:!0,width:720,height:500,reportoption:null,callback:null,globalstyle:null,globalstylemap:null,styleinfo:null,loadGlobalStyle:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"appoption",payload:{address:"ReportStyle"},mbody:{}},e,e.rs_loadGlobalStyle,null),t.send()},rs_loadGlobalStyle:function(e){var t,l,a,o,n,s=e.themes[0],i=[{name:"Select Item",value:""}],d=(ig$.theme_id,["default_styles","custom_styles"]);if(this.globalstyle=[],this.globalstylemap={},s){for(o=0;o<d.length;o++)if(t=s[a=d[o]])for(n=0;n<t.length;n++)l=t[n],this.globalstyle.push(l),i.push({name:l.name,value:l.name}),this.globalstylemap[l.name]=l;for(a in this.globalstylemap)(l=this.globalstylemap[a]).basestylename&&this.globalstylemap[l.basestylename]&&this.globalstylemap[l.basestylename]}this.down("[name=base_style]").store.loadData(i),this.loadLocalStyle()},loadLocalStyle:function(){var e,t,l,a,o=this,n=o.down("[name=stylelist]"),s=[];if(o.down("[name=c_cset]").setValue(o.c_cset||""),o.styleinfo){for(a={name:"LocalStyle",leaf:!1,children:[]},s.push(a),e=0;e<o.styleinfo.length;e++)l={name:(t=o.styleinfo[e]).name,leaf:!0,custom:!1},t.basestylename&&o.globalstylemap[t.basestylename]&&o.globalstylemap[t.basestylename],a.children.push(l);n.store.setRootNode({expanded:!0,text:"Style",name:"Style",title:"Style",children:s})}},editStyleItem:function(e){var t,l=this,a=l.down("[name=form_header]"),o=l.down("[name=form_data]");for(l.commitStyleItem(),t=0;t<l.styleinfo.length;t++)if(l.styleinfo[t].name==e){l._edtItem=l.styleinfo[t],l._valForm=1,l.down("[name=sname]").setValue(l.styleinfo[t].name),l.down("[name=base_style]").setValue(l.styleinfo[t].basestylename||""),a.loadStyleData.call(a,l.styleinfo[t].header),o.loadStyleData.call(o,l.styleinfo[t].data),l._valForm=0;break}},commitStyleItem:function(){var e=this,t=e.down("[name=form_header]"),l=e.down("[name=form_data]"),a=e.down("[name=sname]").getValue();nvalue=e.down("[name=base_style]").getValue(),e._edtItem&&nvalue&&a&&(e._edtItem.basestylename=nvalue,e._edtItem.name=a,l.updateStyleData.call(l),t.updateStyleData.call(t))},_confirm:function(){var e,t,l=this;for(l.commitStyleItem(),e=0;e<l.styleinfo.length;e++)(t=l.styleinfo[e]).basestylename&&l.globalstylemap[t.basestylename]&&l.globalstylemap[t.basestylename];l.c_cset=l.down("[name=c_cset]").getValue(),l.callback&&l.callback.execute(l),l.close()},toolbarHandler:function(e){var t=this;switch(e){case"cmd_add_custom":var l=new IG$.makeStyle({styleinfo:this.globalstyle,callback:new IG$.callBackObj(this,this.rs__appendCustomStyle)});IG$.checkLogin(this,l);break;case"cmd_delete":var a,o=this.down("[name=stylelist]").getSelectionModel().selected,n=o&&0<o.length?o.items[0]:null;if(n)for(a=0;a<t.styleinfo.length;a++)if(n.get("name")==t.styleinfo[a].name){t.styleinfo.splice(a,1),n.remove();break}}},rs__appendCustomStyle:function(e){var t=e[0],l=e[1];if(l&&t&&this.globalstylemap[l]){var a,o,n,s=this.down("[name=stylelist]"),i=s.store.getRootNode();n=i.childNodes[i.childNodes.length-1],o={name:t,leaf:!0,custom:!0},(a={}).name=t,a.nodename="ItemStyle",a.basestylename=l,a.header={},a.data={},this.styleinfo.push(a);var d=[s.store._record(o)];s.store._appendNode(d,n)}},initComponent:function(){var e,s=this,t=new IG$.styleEditor({title:IRm$.r1("L_STYLE_TITLE"),name:"form_header",htype:"hd"}),l=new IG$.styleEditor({title:IRm$.r1("L_STYLE_DATA"),name:"form_data",htype:"dt"}),a=[{name:"Default",value:""}],o=IG$.__chartoption.chartcolors;for(e in o)a.push({name:e,value:e});s.title=IRm$.r1("T_STYLE_WIZARD"),$s.apply(this,{defaults:{bodyStyle:"padding:3px"},items:[{xtype:"treepanel",title:"Style",name:"stylelist",preventHeader:!0,region:"west",width:160,split:!0,border:!1,rootVisible:!1,hideHeaders:!0,autoScroll:!0,store:{xtype:"treestore",fields:["name","text","type","pname","region","custom"],root:{expanded:!0,name:"Style",children:[]},folderSort:!1},useArrows:!0,dockedItems:[{xtype:"toolbar",dock:"top",plain:!0,items:[{iconCls:"icon-toolbar-add",tooltip:"Add Custom Style",text:"Add New",handler:function(){this.toolbarHandler("cmd_add_custom")},scope:this},{iconCls:"icon-grid-delete",tooltip:"Delete",handler:function(){this.toolbarHandler("cmd_delete")},scope:this}]}],columns:[{xtype:"treecolumn",text:"text",flex:2,sortable:!1,dataIndex:"name"},{xtype:"actioncolumn",width:26,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(e,t,l){e.store.getAt(t)},getClass:function(e,t,l,a,o,n){return 0==a||0==l.isLeaf()||l.data&&0==l.data.custom?"idv-hd-val":""}}]}],listeners:{afterrender:function(){},itemclick:function(e,t,l,a,o){var n=t.get("name");0==t.isRoot()&&n&&s.editStyleItem.call(s,n)}}},{xtype:"form",region:"center",layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"sname",fieldLabel:"Name"},{xtype:"combobox",fieldLabel:"Inherit",name:"base_style",displayField:"name",valueField:"value",editable:!1,queryMode:"local",store:{fields:["name","value"]},listeners:{change:function(e,t,l){var a,o=this,n=o.down("[name=base_style]").getValue(),s=o.down("[name=form_header]"),i=o.down("[name=form_data]");o._valForm||n&&(a=o.globalstylemap[n])&&(s.loadStyleData.call(s,a.header),i.loadStyleData.call(i,a.data))},scope:this}},{xtype:"combobox",fieldLabel:"Chart Style",name:"c_cset",displayField:"name",valueField:"value",editable:!1,queryMode:"local",store:{fields:["name","value"],data:a}},{xtype:"tabpanel",plain:!0,flex:1,items:[l,t]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(){this.loadGlobalStyle()}}}),IG$.cubeStyle.superclass.initComponent.apply(this,arguments)}});
IG$.folderManager=$s.extend($s.gridpanel,{cpath:null,mpath:null,loadRoot:function(e){var t,a,n=this;n.root=e,n.mpath=[n.root],a=n.root,(t=new IG$._rpc$).init(n,{ack:"content",payload:{uid:a.uid,nodepath:a.nodepath,name:a.name,type:a.type},mbody:{}},n,n.rs_loadRoot,null),t.send()},topWS:function(){this.loadRoot({uid:"/",nodepath:"/",name:"Workspace",type:"Folder"})},naviFolder:function(e){var t,a=this,n=e.get("type").toLowerCase();/(folder|cube)/.test(n)&&(meta={uid:e.get("uid"),type:e.get("type"),nodepath:e.get("nodepath"),name:e.get("oname")||e.get("name"),manage:e.get("manage"),writable:e.get("writable")},".."==e.get("name")?a.mpath.splice(a.mpath.length-1,1):a.mpath.push(meta),(t=new IG$._rpc$).init(a,{ack:"content",payload:{uid:meta.uid,nodepath:meta.nodepath,name:meta.name,type:meta.type},mbody:{subfolder:"T"}},a,a.rs_loadRoot,null),t.send())},rs_loadRoot:function(e){var t,a,n,o=this,i=e,l=e.children||[],r=[];if(n=1<o.mpath.length?o.mpath[o.mpath.length-2]:null,o.cpath={uid:i.uid,name:i.name,nodepath:i.nodepath,type:i.type,writable:i.writable,manage:i.manage},i.uid!=o.root.uid&&(n.oname=n.name,n.name="..",r.push(n)),l){for(t=0;t<l.length;t++)(a=l[t]).iconcls=IG$.get_metatype_icon(a.type.toLowerCase(),a),r.push(a);IG$.sortMeta(r)}o.store.loadData(r)},refresh:function(){var e,t=this,a=t.cpath;(e=new IG$._rpc$).init(t,{ack:"content",payload:{uid:a.uid,nodepath:a.nodepath,name:a.name,type:a.type},mbody:{}},t,t.rs_loadRoot,null),e.send()},_createMetaObject:function(e,t,a,n){var o=new IG$.makeItem({parentnodepath:a,itemtype:e,parentuid:t});o.callback=new IG$.callBackObj(this,this.r_createMetaObject,n),IG$.checkLogin(this,o)},r_createMetaObject:function(){this.refresh()},_renameMetaObject:function(e,t,a,n){var o=this,i=new IG$.makeItemEditor({itemname:e,uid:t,nodepath:a,itemtype:n,callback:new IG$.callBackObj(o,o.r_renameMetaObject,null)});IG$.checkLogin(o,i)},r_renameMetaObject:function(){this.refresh()},toolbarHandler:function(e){var t=this;switch(e){case"cmd_new_folder":t._createMetaObject("Folder",t.cpath.uid,t.cpath.nodepath,null);break;case"cmd_refresh":t.refresh();break;case"cmd_gotop":t.loadRoot(t.root);break;case"cmd_top_ws":t.topWS();break;case"cmd_delete":t.deleteMetaObject();break;case"cmd_rename":var a,n=t.getSelectionModel();0<n.selected.items.length&&".."!=(a=n.selected.items[0]).get("name")&&(a.get("writable")||a.get("manage"))&&t._renameMetaObject(a.get("name"),a.get("uid"),a.get("nodepath"),a.get("type"))}},deleteMetaObject:function(){var e,t,a=this,n=[],o=0;if(0<(t=a.getChecked()).length){for(e=0;e<t.length;e++)if(".."!=t[e].name&&(t[e].manage||t[e].writable))n.push({uid:t[e].uid,option:"delete"}),o++;else if(".."!=t[e].name){o=0,IG$.ShowError("Privilege error on content: "+t[e].name,a);break}0<o&&(req=new IG$._rpc$,req.init(a,{ack:"batchcontent",payload:n,mbody:{option:"delete"}},a,a.rdeleteMetaObject,null),req.send())}},rdeleteMetaObject:function(e){this.refresh()},getChecked:function(){var e,t,a=this,n=[];for(e=0;e<a.store.data.items.length;e++)a.store.data.items[e].get("selected")&&(t=a.store.data.items[e],n.push({uid:t.get("uid"),type:t.get("type"),nodepath:t.get("nodepath"),name:t.get("name"),manage:t.get("manage"),writable:t.get("writable")}));return n},initComponent:function(){var d=this;$s.apply(this,{name:"grd",store:{xtype:"store",fields:["uid","name","oname","nodepath","type","writable","manage","updatedate","updatedatafm","selected","iconcls"]},columns:[{xtype:"checkcolumn",dataIndex:"selected",width:30,editor:{xtype:"checkbox",cls:"x-grid-checkheader-editor"}},{xtype:"templatecolumn",text:"",tpl:"<div class='{iconcls}' style='width:16px;height:16px'></div>",dataIndex:"iconcls",width:28},{text:"Name",dataIndex:"name",flex:1,minWidth:200},{text:"Type",dataIndex:"type",width:60},{text:"Updated",dataIndex:"updatedatefm",width:140}],dockedItems:[{xtype:"toolbar",dock:"top",items:[{xtype:"textfield",flex:1,name:"_filter",enableKeyEvents:!0,listeners:{keyup:function(e,t,a){13==t.keyCode&&IG$._dofilter(this,"grd",["name"])},scope:this}},{xtype:"button",text:"..",handler:function(){IG$._dofilter(this,"grd",["name"])},scope:this}]},{xtype:"toolbar",dock:"top",items:[{xtype:"splitbutton",text:"New",menu:[{text:"Folder",handler:function(){this.toolbarHandler("cmd_new_folder")},scope:this}]},{text:"Rename",handler:function(){this.toolbarHandler("cmd_rename")},scope:this},{iconCls:"icon-toolbar-remove",handler:function(){var t=this;IG$.confirmMessages(IRm$.r1("B_CONFIRM"),IRm$.r1("B_CD_CHS"),function(e){"yes"==e&&t.toolbarHandler("cmd_delete")})},scope:this},"->",{iconCls:"icon-tb-refresh",handler:function(){this.toolbarHandler("cmd_refresh")},scope:this},{xtype:"button",name:"t_btn",text:"Shortcut",disabled:!0,menu:{xtype:"menu",items:[{text:"Go Top",handler:function(){this.toolbarHandler("cmd_gotop")},scope:this},{text:"Workspace",handler:function(){this.toolbarHandler("cmd_top_ws")},scope:this}]}}]}],listeners:{cellclick:function(e,t,a,n,o,i,l,r){2==a&&d.naviFolder.call(d,n)}}}),IG$.folderManager.superclass.initComponent.apply(this,arguments)}}),IG$.dlgFolderMgr=$s.extend($s.window,{modal:!0,region:"center",layout:"fit",closable:!1,resizable:!1,width:950,autoHeight:!0,dbscan:1,_init:function(){var e=this.grd_l,t=this.grd_r;e.loadRoot.call(e,this.root),t.loadRoot.call(t,this.root)},moveChecked:function(e,t){var a,n=this.grd_l,o=this.grd_r;if(a=e?n.getChecked.call(n):o.getChecked.call(o),n.cpath.uid!=o.cpath.uid){if(a&&0<a.length){var i,l,r=[],d=0;for(l=0;l<a.length;l++)".."!=a[l].name&&(a[l].writable||a[l].manage)&&(r.push({uid:a[l].uid}),d++);0<d&&(this.setLoading(!0),(i=new IG$._rpc$).init(this,{ack:"helpcontent",payload:r,mbody:{option:1==t?"copy":"move",target:e?o.cpath.uid:n.cpath.uid}},this,this.r_moveSelItems,null,null),i.send())}}else IG$.alertmsg(ig$.appname,IRm$.r1("E_DUP_FOLDER"),null,null,1,"error")},r_moveSelItems:function(e){var t=this.grd_l,a=this.grd_r;this.setLoading(!1),IG$.alertmsg(ig$.appname,"Moved items successfully",null,this,0,"success"),t.refresh.call(t),a.refresh.call(a)},initComponent:function(){var e=this;e.title=IRm$.r1("T_MGR_FOLDER"),e.grd_l=new IG$.folderManager({name:"grd_l",height:500,flex:1}),e.grd_r=new IG$.folderManager({name:"grd_r",height:500,flex:1});$s.apply(this,{defaults:{bodyStyle:"padding:10px"},layout:"fit",items:[{xtype:"panel",layout:{type:"hbox",align:"stretch"},border:0,items:[e.grd_l,{width:60,layout:{type:"vbox",align:"stretch",pack:"center"},items:[{xtype:"container",flex:1},{xtype:"displayfield",value:"Move"},{xtype:"button",text:">>",$w:60,tooltip:"Move items",handler:function(){this.moveChecked(!0,!1)},scope:this},{xtype:"button",text:"<<",$w:60,tooltip:"Move items",handler:function(){this.moveChecked(!1,!1)},scope:this},{xtype:"container",height:10},{xtype:"displayfield",value:"Copy"},{xtype:"button",text:">",$w:60,tooltip:"Copy items",handler:function(){this.moveChecked(!0,!0)},scope:this},{xtype:"button",text:"<",$w:60,tooltip:"Copy items",handler:function(){this.moveChecked(!1,!0)},scope:this},{xtype:"container",flex:1}]},e.grd_r]}],buttons:[{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){this._init()}}}),IG$.dlgFolderMgr.superclass.initComponent.apply(this,arguments)}});
IG$.MetaEditorPanel=$s.extend($s.panel,{autoScroll:!1,collapseFirst:!1,layout:"fit",closable:!0,autoScroll:!0,initComponent:function(){$s.apply(this,{tbar:[{text:"Save Content",handler:function(){this.saveContent()},scope:this}]}),IG$.MetaEditorPanel.superclass.initComponent.call(this)},items:[{xtype:"textarea",name:"metaview"}],listeners:{render:function(t){var e=t;e.uid&&0<e.uid.length&&this.loadMetaContent(e.uid,e.itemtype)},resize:function(t,e,n,a,i){t.validateSize.call(t,e,n)}},saveContent:function(){var t=this;t.setLoading(!0);var e=t.down("[name=metaview]"),n=new IG$._rpc$,a=e.getValue();n.init(t,{ack:"31",payload:{uid:t.uid},mbody:a},t,t.rs_saveContent(),null),n.send()},rs_saveContent:function(t){IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},loadMetaContent:function(t,e){var n=this;n.uid=t,n.setLoading(!0);var a=new IG$._rpc$,i="cube"==e,o=i?"cubecontent":"content",l=i?{option:"CubeContent"}:{};a.init(n,{ack:o,payload:{uid:t},mbody:l},n,n.rs_loadMetaContent,null),a.send()},rs_loadMetaContent:function(t){content=JSON.stringify(t,null,2),metaview=this.down("[name=metaview]"),metaview.setValue(content)},validateSize:function(t,e,n){}}),IG$.MetaEditorMainPanel=function(){IG$.MetaEditorMainPanel.superclass.constructor.call(this,{id:"doc-body",region:"center",margins:"0 5 5 0",resizeTabs:!0,minTabWidth:135,tabWidth:135,enableTabScroll:!0,activeTab:0,layout:"fit",items:[{id:"welcome-panel",title:"MetaEditor",autoLoad:{url:"./html/metaeditor.html",callback:null,scope:this},iconCls:"icon-docs",autoScroll:!0}]})},IG$.MetaEditorMainPanel=$s.extend($s.tabpanel,{initEvents:function(){IG$.MetaEditorMainPanel.superclass.initEvents.call(this),this.body.on("click",this.onClick,this)},navigateApp:function(t,e,n,a){var i=this.getComponent(a);if(i)this.setActiveTab(i);else{var o=IG$.createAppPanel(t,"metaeditor",n,a,null);if(null!=o){o.uid=t,o.address=a,o.itemtype=e,o.title=n;var l=this.add(o);this.setActiveTab(l)}}}});
IG$.sysmon=$s.extend(IG$.v$pnl,{title:"System Logs",region:"center",layout:"fit",closable:!0,resizable:!1,autoHeight:!0,callback:null,bodyPadding:10,iconCls:"icon-ing-docdef",in$t:function(){this.down("[name=status]").setValue(""),this.down("[name=e_stat]").setValue("F")},loadJobList:function(e,t){var a=this,n=new IG$._rpc$,i=a.down("[name=status]"),l=a.down("[name=ellapsetime]"),o=a.down("[name=bufsize]");n.init(a,{ack:"helpcontent",payload:{vopt:t||"1"},mbody:{option:"sysmon",ellapsetime:""+l.getValue(),bufsize:o.getValue(),status:i.getValue()}},a,a.rs_loadJobList,!1,[e,t]),n.send()},rs_loadJobList:function(e,t){var a,n,i,l,o=this,s=t[0],d=t[1],r=[],c=o.down("[name=grdjoblist]"),u=o.down("[name=grd_sql]"),m=o.down("[name=grd_esql]");if("2"==d){if(tnode=e.sql,tnode)for(n=0;n<tnode.length;n++){for(a=tnode[n],l={},i=0;i<a.length;i++)a[i],l["c"+i]=a[i];r.push(l)}if(u.store.loadData(r),r=[],tnode=e.sqlexec,tnode)for(n=0;n<tnode.length;n++){for(a=tnode[n],l={},i=0;i<a.length;i++)l["c"+i]=a[i];r.push(l)}m.store.loadData(r)}else c.store.loadData(e);s&&0<s&&(o.rtimer=setTimeout(function(){o.loadJobList.call(o,s,d)},s))},getJobDetail:function(e){var t=this,a=new IG$._rpc$;a.init(t,{ack:"helpcontent",payload:{jobid:e},mbody:{option:"jobdetail"}},t,t.rs_getJobDetail,!1),a.send()},rs_getJobDetail:function(e){var t=e&&e.length?e[0]:null,a=this.down("[name=grdjobdetail]");this.jobdetail=t,a.store.loadData(t?t.runs:null)},cancelQuery:function(){var e=this,t=new IG$._rpc$;e.jobdetail&&e.jobdetail.uid&&(t.init(e,{ack:"olapservice",payload:{jobid:e.jobdetail.uid,option:"cancel"},mbody:{}},e,e.rcancelQuery,null),t.showerror=!1,t.send())},rcancelQuery:function(){var e=this;e.jobdetail&&e.jobdetail.uid&&e.getJobDetail(e.jobdetail.uid)},refreshControl:function(e,t){var a=this,n=a.down("[name=btn_start]"),i=a.down("[name=btn_stop]"),l=a.down("[name=btn_refresh]"),o=a.down("[name=rsec]"),s=1e3*o.getValue();i.setDisabled(!e),n.setDisabled(e),l.setDisabled(e),o.setDisabled(e),clearTimeout(a.rtimer),a.rtimer=-1,1==e&&(a.rtimer=setTimeout(function(){a.loadJobList.call(a,s,t)},s))},emailstatus:{A:"Waiting",F:"Failed",S:"Success",P:"Processing"},getEmailContent:function(){var i=this,l=i.down("[name=grd_email]"),e=new IG$._rpc$;e.init(i,{ack:"helpcontent",payload:{stat:i.down("[name=e_stat]").getValue()},mbody:{option:"mail_stat"}},i,function(e){var t,a=e,n=i.emailstatus;for(t=0;t<a.length;t++)a[t].stat=n[a[t].status]||"Unknown";l.store.loadData(a)},!1),e.send()},showMailDetail:function(e){var t=new IG$._rpc$;t.init(this,{ack:"helpcontent",payload:{sid:e},mbody:{option:"mail_content"}},this,function(e){var t=IG$.XGetNode(e,"/smsg/mail"),a=this.emailstatus,n={},i=this.down("[name=m_d1]"),l=this.down("[name=m_d2]"),o=$("#ig_mail",l.body.dom);t&&((n=IG$.XGetAttrProp(t)).subject=IG$.XGetSubNodeText(t,"subject"),n.content=IG$.XGetSubNodeText(t,"content"),n.stat=a[n.mstat]||"Unknown"),o.contents().find("html").html(n?n.content:""),i.show()},!1),t.send()},initComponent:function(){$s.apply(this,{items:[{xtype:"tabpanel",items:[{xtype:"container",title:"Report Logs",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"System Monitoring and Control",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldcontainer",layout:{type:"hbox",align:"stretch",defaultMargins:{top:0,left:0,right:10,bottom:0}},items:[{xtype:"numberfield",labelAlign:"right",name:"rsec",fieldLabel:"Auto Refresh (sec)",value:60},{xtype:"button",name:"btn_start",text:"Start",handler:function(){0<this.down("[name=rsec]").getValue()&&this.refreshControl(!0)},scope:this},{xtype:"button",name:"btn_stop",text:"Stop",disabled:!0,handler:function(){this.refreshControl(!1)},scope:this},{xtype:"container",flex:1},{xtype:"button",text:"Refresh",name:"btn_refresh",handler:function(){this.loadJobList()},scope:this}]},{xtype:"fieldcontainer",layout:{type:"hbox",defaultMargins:{top:0,left:0,right:10,bottom:0}},items:[{xtype:"combobox",queryMode:"local",fieldLabel:"Conditions",name:"status",labelAlign:"right",displayField:"name",valueField:"value",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","value"],data:[{name:"All",value:""},{name:"STAT_START",value:"STAT_START"},{name:"STAT_FAILED_ERROR",value:"STAT_FAILED_ERROR"},{name:"STAT_PREPARE_STATEMENT",value:"STAT_PREPARE_STATEMENT"},{name:"STAT_BEFORE_EXECUTE_QRY",value:"STAT_BEFORE_EXECUTE_QRY"},{name:"STAT_END_QUERY_EXECUTION",value:"STAT_END_QUERY_EXECUTION"},{name:"STAT_CANCELED",value:"STAT_CANCELED"},{name:"STAT_FINISHED_WITH_ERROR",value:"STAT_FINISHED_WITH_ERROR"},{name:"STAT_FINISHED",value:"STAT_FINISHED"}]}},{xtype:"numberfield",name:"ellapsetime",labelAlign:"right",fieldLabel:"Ellapsed more then (second)",labelWidth:180,value:60},{xtype:"numberfield",name:"bufsize",labelAlign:"right",fieldLabel:"Buffer Size",minValue:10,maxValue:1e3,value:100}]}]},{xtype:"gridpanel",name:"grdjoblist",flex:1,store:{xtype:"store",fields:["uid","userid","status","statuscode","totalellapsed","haserror","errormsg","starttime","endtime","objectname","objectpath","objectuid"]},columns:[{xtype:"gridcolumn",text:"UserID",dataIndex:"userid",flex:1},{xtype:"gridcolumn",text:"Status",dataIndex:"status",width:120},{xtype:"gridcolumn",text:"Name",dataIndex:"objectname",width:120},{xtype:"gridcolumn",text:"Path",dataIndex:"objectpath",width:200},{xtype:"gridcolumn",text:"JobID",hidden:!0,dataIndex:"uid",width:80},{xtype:"gridcolumn",text:"Ellapsed",width:60,dataIndex:"totalellapsed"},{xtype:"gridcolumn",text:"Start",width:80,dataIndex:"starttime"},{xtype:"gridcolumn",text:"End",width:80,dataIndex:"endtime"},{xtype:"gridcolumn",text:"Error",width:40,dataIndex:"haserror"}],listeners:{itemclick:function(e,t,a,n,i,l){var o=t.get("uid");this.getJobDetail(o)},scope:this}},{xtype:"fieldset",collapsible:!1,flex:1,layout:"fit",title:"Action Detail",items:[{xtype:"gridpanel",name:"grdjobdetail",store:{xtype:"store",fields:["status","statuscode","ellapsed"]},buttons:[{xtype:"button",text:"Cancel Job",handler:function(){this.cancelQuery()},scope:this},{xtype:"button",text:"Open in folder",handler:function(){IG$.mainPanel&&window.api&&this.jobdetail&&this.jobdetail.objectpath&&api.navigateTree.call(api,{name:this.jobdetail.objectname,nodepath:this.jobdetail.objectpath,uid:this.jobdetail.objectuid})},scope:this}],columns:[{xtype:"gridcolumn",flex:1,text:"Action type",dataIndex:"status"},{xtype:"gridcolumn",text:"Ellapsed time",dataIndex:"ellapsed"}]}]}]},{xtype:"container",title:"JDBC Monitoring",layout:"border",items:[{xtype:"panel",region:"north",layout:"vbox",items:[{xtype:"button",text:"Refresh",handler:function(){this.loadJobList(null,"2")},scope:this}]},{xtype:"container",flex:1,layout:{type:"vbox",align:"stretch"},region:"center",items:[{xtype:"gridpanel",flex:1,title:"SQL Details",name:"grd_sql",store:{xtype:"store",fields:["c0","c1","c2","c4","c5"]},columns:[{text:"No.",dataIndex:"c0",width:40},{text:"Date",dataIndex:"c1"},{text:"ExecTime",dataIndex:"c2",width:50},{text:"SQL",dataIndex:"c4",flex:1},{text:"Error",dataIndex:"c5",flex:1}]},{xtype:"gridpanel",flex:1,title:"Exec SQL",name:"grd_esql",store:{xtype:"store",fields:["c0","c1","c2","c4"]},columns:[{text:"No.",dataIndex:"c0",width:40},{text:"Date",dataIndex:"c1"},{text:"ExecTime",dataIndex:"c2",width:50},{text:"SQL",dataIndex:"c4",flex:1}]}]},{xtype:"container",region:"east",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"panel",flex:1,title:"Request Count"},{xtype:"panel",flex:1,title:"Running"}]}]},{xtype:"container",title:"Email Sender Logs",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",layout:"hbox",items:[{xtype:"fieldcontainer",flex:1,layout:"hbox",items:[{xtype:"combobox",queryMode:"local",fieldLabel:"Status",name:"e_stat",labelAlign:"right",displayField:"name",valueField:"value",editable:!1,autoSelect:!0,store:{xtype:"store",fields:["name","value"],data:[{name:"Failed",value:"F"},{name:"Sending",value:"P"},{name:"Waiting",value:"A"},{name:"Success",value:"S"},{name:"All",value:""}]}}]},{xtype:"button",text:"Run",handler:function(){this.getEmailContent()},scope:this}]},{xtype:"gridpanel",flex:1,title:"Email Logs",name:"grd_email",store:{xtype:"store",fields:["sid","iuid","snder","email","cdate","mdate","mstat","stat","msgtype","subject"]},columns:[{text:"Sender",dataIndex:"snder",width:120},{text:"Email",dataIndex:"email",width:120},{text:"Modified Date",dataIndex:"mdate",width:50},{text:"Created Date",dataIndex:"cdate",width:50},{text:"Subject",dataIndex:"subject",tdCls:"igc-td-link",flex:1},{text:"Status",dataIndex:"stat",width:80}],listeners:{cellclick:function(e,t,a,n,i,l,o,s){4==a&&this.showMailDetail(n.get("sid"))},scope:this}},{xtype:"panel",layout:"fit",hidden:!0,flex:1,name:"m_d1",items:[{name:"m_d2",html:"<div class='igc-mail-detail'><iframe id='ig_mail' class='igc-mail-detail-if'></iframe></div>"}]}]}]}],listeners:{afterrender:function(e){this.in$t()}}}),IG$.sysmon.superclass.initComponent.apply(this,arguments)}});
IG$.sys_resource=$s.extend(IG$.v$pnl,{region:"center",layout:"fit",closable:!0,resizable:!1,autoHeight:!0,callback:null,bodyPadding:10,iconCls:"icon-ing-docdef",in$t:function(){this.getSvrInfo()},getRcs:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"infosvr",payload:{address:"/resources"},mbody:{option:"getrs"}},e,e.rs_getRcs,!1),t.send()},getSvrInfo:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"infosvr",payload:{address:"/serverinfo"},mbody:{option:"getrs"}},e,e.rs_getSvrInfo,!1),t.send()},rs_getRcs:function(e){var t=this;t.setMemory(e.meminfo),t.setDisk(e.diskinfo),t.setOS(e.osinfo)},rs_getSvrInfo:function(e){this.licinfo=e,this.getRcs()},formatMem:function(e){var t="b",s=e;return 1e3<s&&(t="M",1e3<(s/=1e3)&&(t="G",s/=1e3)),s.toFixed(0)+" "+t},setMemory:function(e){var t,i,l=this,s=l.down("[name=g_mem]"),n=[];if(!l.m_charts){var a=l.down("[name=p_mem]"),r=$(".idv-rcs-mem",a.el.dom),d=[{name:"free",title:"Free Memory"},{name:"allocated",title:"Allocated"},{name:"appfree",title:"Application Free"},{name:"max",title:"Max Memory",chart:!1},{name:"totalfree",title:"Free Total",chart:!1}];r.empty(),l.clen=0,$.each(d,function(e,t){if(0!=t.chart){var s=$("<div class='idv-rcs-pnl'><div class='idv-rcs-title'>"+t.title+"</div><div class='idv-rcs-chart'></div></div>").appendTo(r);t.el=s,t.dc=$(".idv-rcs-chart",t.el),t.clabel=$("<div class='idv-rcs-label'></div>").appendTo(t.dc),t.chart=t.dc.easyPieChart({size:IG$.j$ext._w(t.dc)}),l.clen++}}),l.m_charts=d,l.resizeMemChart()}if(t=l.m_charts,e){i=e;var o=Number(i.totalfree),c=Number(i.max);$.each(t,function(e,t){var s,a=Number(i[t.name]);switch(n.push({name:t.title,value:a}),t.name){case"free":case"appfree":t.value=100*a/o,s=l.formatMem(a)+"<br>"+l.formatMem(o);break;case"allocated":t.value=100*a/c,s=l.formatMem(a)+"<br>"+l.formatMem(c)}t.chart&&(t.chart.data("easyPieChart").update(t.value),t.clabel.html(s))})}s.store.loadData(n)},resizeMemChart:function(){var e,t,s,a=this,i=a.down("[name=p_mem]"),l=$(i.body.dom),n=$(".idv-rcs-mem",l),r=IG$.j$ext._w(l),d=IG$.j$ext._h(l),o=a.m_charts,c=0;if(IG$.j$ext._w(n,r),IG$.j$ext._h(n,d),o)for(t=r/a.clen,e=0;e<o.length;e++)(s=o[e]).chart&&(IG$.j$ext._w(s.el,t),IG$.j$ext._h(s.el,d),s.el.css("left",c),s.dc.css({left:(t-90)/2,top:(d-90)/2+20}),c+=t)},setDisk:function(e){var t,s,a,i,l=this,n=l.down("[name=g_disk]"),r=[],d=l.down("[name=p_dsk]"),o=$(".idv-rcs-dsk",d.el.dom);if(l.dlen=0,l.m_dsks=[],l.h_dsks=l.h_dsks||{},e){for(a=0;a<e.length;a++)p=e[a],l.h_dsks[p.name]?s=l.h_dsks[p.name]:((s={el:t=$("<div class='idv-rcs-pnl-dsk'><div class='idv-rcs-title'>"+p.name+"</div><div class='idv-rcs-chart'></div></div>").appendTo(o),dc:$(".idv-rcs-chart",t)}).clabel=$("<div class='idv-rcs-label'></div>").appendTo(s.dc),s.chart=s.dc.easyPieChart({size:IG$.j$ext._w(s.dc)}),l.h_dsks[p.name]=s),i=Number(p.total)-Number(p.usable),i=0<Number(p.total)?100*i/Number(p.total):0,s.chart.data("easyPieChart").update(i),s.clabel.text(p.name+" : "+i.toFixed(0)+"%"),l.dlen++,r.push(p),l.m_dsks.push(s);l.resizeDiskChart()}n.store.loadData(r)},resizeDiskChart:function(){var e,t,s,a=this.down("[name=p_dsk]"),i=$(a.body.dom),l=$(".idv-rcs-dsk",i),n=IG$.j$ext._w(i),r=IG$.j$ext._h(i),d=this.m_dsks;if(IG$.j$ext._w(l,n),IG$.j$ext._h(l,r),d)for(e=0;e<d.length;e++)(s=d[e]).chart&&(IG$.j$ext._w(s.el,n),t=IG$.j$ext._h(s.el),s.dc.css({left:(n-90)/2,top:(t-90)/2+20}))},setOS:function(e){var t,s,a,i=this.down("[name=p_os]"),l=$(".idv-os-pnl",i.el.dom),n=this.licinfo;if(l.empty(),e){for(a in ul=$("<ul class='idv-os-ul'></ul>").appendTo(l),e)t=$("<li><span class='idv-os-type'>"+a+"</span> : <span class='idv-os-val'>"+e[a]+"</span></li>"),ul.append(t);if(ul=$("<div class='idv-lic-dv'><span>License Information</span></div>").appendTo(l),ul=$("<ul class='idv-lic-ul'></ul>").appendTo(ul),n){for(s in n)"access_ip"!=s&&"update_history"!=s&&(t=$("<li><span class='idv-os-type'>"+s+"</span> : <span class='idv-os-val'>"+n[s]+"</span></li>"),ul.append(t));if(n.access_ip)for(ul=$("<div class='idv-lic-dv'><span>Accessed IP</span></div>").appendTo(l),a=0;a<n.access_ip.length;a++)t=$("<li><span class='idv-os-val'>"+n.access_ip[a]+"</span></li>"),ul.append(t)}}},initComponent:function(){this.title=IRm$.r1("T_SYS_RES"),$s.apply(this,{tbar:[{xtype:"button",iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){this.getSvrInfo()},scope:this}],items:[{xtype:"panel",layout:"border",border:0,items:[{xtype:"panel",region:"north",height:200,border:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",name:"p_mem",title:"Memory Resources",layout:"fit",flex:1,html:"<div class='idv-rcs-mem'></div>",listeners:{resize:function(){this.resizeMemChart()},scope:this}}]},{xtype:"panel",region:"center",border:1,layout:{type:"hbox",align:"stretch"},flex:1,items:[{xtype:"panel",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",title:"Memory",name:"g_mem",flex:1,store:{xtype:"store",fields:["name","value"]},columns:[{xtype:"gridcolumn",text:"Name",flex:1,dataIndex:"name"},{xtype:"gridcolumn",text:"Value",dataIndex:"value",flex:1}]},{xtype:"gridpanel",title:"Disk",name:"g_disk",flex:1,store:{xtype:"store",fields:["name","total","free","usable"]},columns:[{xtype:"gridcolumn",text:"Name",flex:1,dataIndex:"name"},{xtype:"gridcolumn",text:"Total",dataIndex:"total",flex:1},{xtype:"gridcolumn",text:"Free",dataIndex:"free",flex:1},{xtype:"gridcolumn",text:"usable",dataIndex:"usable",flex:1}]}]},{xtype:"panel",name:"p_dsk",flex:1,layout:"fit",html:"<div class='idv-rcs-dsk'></div>",listeners:{resize:function(){this.resizeDiskChart()},scope:this}},{xtype:"panel",title:"System Info",name:"p_os",layout:"fit",flex:1,html:"<div class='idv-os-pnl'></div>"}]}]}],listeners:{afterrender:function(e){this.in$t()}}}),IG$.sys_resource.superclass.initComponent.apply(this,arguments)}});
IG$._I7a_=$s.extend($s.window,{modal:!0,title:"Page Config",layout:"fit",width:400,autoHeight:!0,initApp:function(){var e,t=this;t.rec&&(e=t.rec.get("options")||{},t.down("[name=ltype]").setValue(e.ltype||""),t.down("[name=_h]").setValue(e.html),t.down("[name=_t]").setValue(e.tmpl),t.down("[name=_ra]").setValue(e.rptl),t.rptl_uid=e.rptl_uid,t.down("[name=_s]").setValue(e.scrp))},_2:function(){var n=this,i=n.down("[name=ltype]").getValue();$.each(["_h","_r","_t"],function(e,t){n.down("[name="+t+"]").setVisible(!(!i||"_"+i.charAt(0)!=t))})},_3:function(){var e,t=this,n=t.rec;n&&((e=n.get("options")||{}).ltype=t.down("[name=ltype]").getValue(),e.html=t.down("[name=_h]").getValue(),e.tmpl=t.down("[name=_t]").getValue(),e.rptl=t.down("[name=_ra]").getValue(),e.rptl_uid=t.rptl_uid,e.scrp=t.down("[name=_s]").getValue(),n.set("options",e)),this.close()},initComponent:function(){$s.apply(this,{items:[{xtype:"panel",layout:"anchor",bodyPadding:10,defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"Load Type",name:"ltype",queryMode:"local",editable:!1,valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"],data:[{name:"No Action",value:""},{name:"Template",value:"template"},{name:"Load HTML",value:"html"},{name:"Open Report",value:"report"}]},listeners:{change:function(){this._2()},scope:this}},{xtype:"textfield",name:"_h",fieldLabel:"Default HTMLPage"},{xtype:"fieldcontainer",name:"_r",layout:"hbox",fieldLabel:"Report",items:[{xtype:"textfield",name:"_ra",readOnly:!0,flex:1},{xtype:"button",text:"..",handler:function(){var t=this,e=new IG$.metaSelectDlg({visibleItems:"workspace;folder;report;dashboard",tree_options:{cubebrowse:!1},callback:new IG$.callBackObj(t,function(e){t.down("[name=_ra]").setValue(e.name),t.rptl_uid=e.uid})});IG$.checkLogin(this,e)},scope:this}]},{xtype:"combobox",name:"_t",queryMode:"local",fieldLabel:"Template Name",editable:!1,valueField:"value",displayField:"name",store:{xtype:"store",fields:["name","value"]}},{xtype:"textfield",fieldLabel:"After Javascript",name:"_s"}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._3()},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}]}),IG$._I7a_.superclass.initComponent.call(this)},listeners:{afterrender:function(e){this.initApp()}}}),IG$.dashboardmenu=$s.extend(IG$.v$pnl,{scroll:!1,initialized:!1,hideMode:"offsets",layout:"fit",bodyPadding:5,border:0,load_content:function(){var i=this,e=new IG$._rpc$,o="/SYS_Config/dashboardmenu";e.showerror=!1,e.init(i,{ack:"content",payload:{uid:o},mbody:{}},i,i._l1,function(e){var t,n=!0;return"0x1400"==e.errorcode&&((t=new IG$._rpc$).init(i,{ack:"writecontent",payload:{address:o,name:"dashboardmenu",type:"PrivateContent"},mbody:{},meta_type:"dashboard_menu"},i,i.load_content),t.send(),n=!1),n}),e.send()},_l1:function(e){var t,n=this,i=n.down("[name=menust]");n.appinfo=e,t={name:"Menu",level:-1,option:{},description:"Top Menu",expanded:!0,children:n.appinfo.menustructure},i.store.setRootNode(t,1)},_l2:function(e){var t,n,i,o=this,a=o.down("[name=menust]"),l=a.getSelectionModel().selected,r=o.appinfo._a;switch(e){case 0:l&&0<l.length&&(t={name:"New Menu"},l.items[0].appendChild(t,!1,!0),l.items[0].expand());break;case 1:l&&0<l.length&&((i=l.items[0]).isRoot()||(n=i.get("sid"),delete r.map[n],i.remove()));break;case 2:o._m3(a,-1,!1);break;case 3:o._m3(a,0,!1);break;case 4:o._m3(a,1,!0)}},_l3:function(){var e=this,t=e.down("[name=menust]").store.getRootNode(),n={children:[]},i=e.appinfo,o=i.menustructure;e._l8(),e._l5(o,t,n),i.menustructure=n.children},_l5:function(e,t,n){var i,o,a;for(i=0;i<t.childNodes.length;i++)a={name:(o=t.childNodes[i]).get("name"),sid:o.get("sid"),description:o.get("description"),items:o.get("items"),children:null,level:n.level+1,options:o.get("options")},n.children=n.children||[],n.children.push(a),o.hasChildNodes()&&this._l5(e,o,a)},l4:function(e){switch(e){case 0:this._l3(),this._l6()}},_l6:function(){var e=this,t=new IG$._rpc$,n=e.appinfo;t.init(e,{ack:"writecontent",payload:{uid:n.uid},mbody:n,meta_type:"dashboard_menu"},e,function(e){IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")}),t.send()},moveGridSelection:function(e,t){var n=e.getSelectionModel().getSelection(),i=n&&n.length?n[0]:null;if(i){var o=e.getStore().indexOf(i);if(t<0){if(--o<0)return}else if(++o>=e.getStore().getCount())return;e.getStore().remove(i),i=e.getStore().insert(o,i),e.getSelectionModel().select(i,!0)}},_m3:function(e,t,n){var i=e.getSelectionModel().getSelection(),o=i&&i.length?i[0]:null;if(o&&(!o||o.parentNode)){var a,l=o.parentNode,r=l.indexOf(o);if(n){if(!(a=l.parentNode))return;l.removeChild(o),o=a.insertChild(a.childNodes.length,o),e.getSelectionModel().select(o,!0)}else{if(t<0){if(--r<0)return}else if(++r>=l.childNodes.length)return;l.removeChild(o),o=l.insertChild(r,o),e.getSelectionModel().select(o,!0)}}},_l7:function(e){var t,n,i,o,a,l=this.down("[name=mgrid]"),r=this.appinfo._a;switch(e){case 0:break;case 1:for(t=l.getSelectionModel().selected,i=0;i<t.length;i++)if(n=t.items[i],l.store.remove(n),a=r.map[n.get("sid")])for(o=0;o<a.items.length;o++)if(a.items[o].uid==n.get("uid")){a.items.splice(o,1);break}break;case 2:this.moveGridSelection(l,-1);break;case 3:this.moveGridSelection(l,1)}},updateGridContent:function(e,t){var n,i,o=this.down("[name=mg]"),a=[];for(n=0;n<e.length;n++)i=e[n].type.toLowerCase(),/report|folder/.test(i)&&a.push(e[n]);o.store.loadData(a)},_l8:function(){var e,t,n,i,o=this.down("[name=menust]").getSelectionModel().selected,a=this.down("[name=mgrid]"),l=(this.appinfo._a,[]);if(o&&0<o.length){for(i=(n=o.items[0]).get("sid"),e=0;e<a.store.data.items.length;e++)t=a.store.data.items[e],l.push({uid:t.get("uid"),name:t.get("name"),type:t.get("type"),sid:i,nodepath:t.get("nodepath")});n.set("items",l)}},_1:function(e){this.appinfo,e.get("sid");var t=new IG$._I7a_({rec:e});IG$.checkLogin(this,t)},initComponent:function(){var e=this;$s.apply(this,{items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},border:0,defaults:{anchor:"100%"},items:[{xtype:"panel",border:0,flex:1,layout:{type:"border"},tbar:[{text:IRm$.r1("B_SAVE"),handler:function(){this.l4(0)},scope:this},{text:IRm$.r1("L_REFRESH"),handler:function(){this.load_content()},scope:this}],items:[{xtype:"panel",region:"center",flex:2,border:0,layout:"border",items:[{xtype:"treepanel",region:"center",flex:1,title:"Menu Structures",name:"menust",rootVisible:!0,plugins:[{ptype:"cellediting"}],store:{xtype:"treestore",proxy:{type:"memory"},fields:["name","description","sid"]},columns:[{xtype:"treecolumn",text:IRm$.r1("B_TITLE"),dataIndex:"name",editor:"textfield",minWidth:200},{text:IRm$.r1("B_DESC"),dataIndex:"description",editor:"textfield",flex:1,minWidth:200},{xtype:"actioncolumn",width:50,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("B_CONFIG_ITEM"),handler:function(e,t,n,i,o,a){this._1(a)},scope:this}]}],listeners:{beforeselect:function(e,t,n,i){this._l8()},cellclick:function(e,t,n,i,o,a,l,r){i.get("sid");var s=i.get("items")||[],d=this.down("[name=mgrid]");this.appinfo;d.store.loadData(s)},scope:this},tbar:[{text:IRm$.r1("L_ADD_NEW"),handler:function(){e._l2.call(e,0)}},{text:IRm$.r1("L_REMOVE_SELECTED"),handler:function(){e._l2.call(e,1)}},{text:IRm$.r1("B_MOVE_UP"),handler:function(){e._l2.call(e,2)}},{text:IRm$.r1("B_MOVE_DOWN"),handler:function(){e._l2.call(e,3)}},{text:"Move Left",hidden:!0,handler:function(){e._l2.call(e,4)}}]},{xtype:"gridpanel",region:"south",name:"mgrid",selModel:{selection:"checkboxmodel",checkSelector:".x-grid-cell"},viewConfig:{plugins:{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_",enableDrop:!0,enableDrag:!1}},split:!0,flex:1,title:IRm$.r1("L_C_ITEMS"),tbar:[{text:IRm$.r1("L_ADD_NEW"),hidden:!0,handler:function(){this._l7(0)},scope:this},{text:IRm$.r1("L_REMOVE_SELECTED"),handler:function(){this._l7(1)},scope:this},{text:IRm$.r1("B_MOVE_UP"),handler:function(){this._l7(2)},scope:this},{text:IRm$.r1("B_MOVE_DOWN"),handler:function(){this._l7(3)},scope:this}],store:{xtype:"store",fields:["uid","name","nodepath","type","sid"]},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name"},{text:IRm$.r1("B_TYPE"),dataIndex:"type"},{text:IRm$.r1("B_DESC"),dataIndex:"description"},{text:IRm$.r1("B_LOC"),dataIndex:"nodepath",flex:1}]}]},{xtype:"panel",region:"east",split:!0,collapsible:!0,collapsed:!1,flex:1,title:IRm$.r1("L_NAVIGATOR"),layout:{type:"vbox",align:"stretch"},items:[new IG$.n$navTreeCom({name:"mtree",flex:1,gridupdate:{handler:e.updateGridContent,scope:e}}),{xtype:"gridpanel",name:"mg",enabledrag:!0,viewConfig:{plugins:[{ptype:"gridviewdragdrop",ddGroup:"_I$RD_G_",enableDrop:!1,enableDrag:!0}]},flex:1,store:{xtype:"store",fields:["uid","name","type","nodepath"]},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name"},{text:IRm$.r1("B_TYPE"),dataIndex:"type"},{text:IRm$.r1("B_LOC"),dataIndex:"nodepath"}]}]}]}]}]}),IG$.dashboardmenu.superclass.initComponent.call(this)},listeners:{afterrender:function(e){this.load_content()}}});
IG$.dashboardRcsMgrPreview=$s.extend($s.window,{title:IRm$.r1("L_PRV_DATA"),modal:!0,width:400,height:350,layout:"fit",loadContent:function(){var e=this,t=new IG$._rpc$;t.init(e,{ack:"content",payload:{uid:e.uid},mbody:{}},e,function(e){},!1),t.send()},initComponent:function(){$s.apply(this,{items:[{xtype:"panel",bodyPadding:10,layout:{type:"vbox",align:"stretch"},items:[{html:"<div style='height: 200px;overflow: auto;'><img src='"+ig$.servlet+"?sreq=resource&_rcs_="+this.uid+"&_mts_="+IG$._g$a+"'></img></div>",name:"img_prev"}]}],buttons:[{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}]}),IG$.dashboardRcsMgrPreview.superclass.initComponent.call(this)},listeners:{afterrender:function(e){e.uid&&e.loadContent.call(e)}}}),IG$.dashboardRcsEdit=$s.extend($s.window,{title:"Dashboard Resource Config",modal:!0,width:400,height:350,layout:"fit",loadContent:function(){var i=this,e=new IG$._rpc$;e.init(i,{ack:"content",payload:{uid:i.rec.get("uid")},mbody:{}},i,function(e){var t=e.content;i._citem=t,i.down("[name=itemname]").setValue(t.name),i.down("[name=description]").setValue(t.description)},!1),e.send()},_confirm:function(){var e,o=this,t=o.down("[name=mform]"),i=o.down("[name=orig_filename]"),n=o.down("[name=photo]");if(t.getForm().isValid()){t.getForm();document.charset="UTF-8";var a=n.getRawValue();-1<a.indexOf("\\")&&(a=a.substring(a.lastIndexOf("\\")+1)),i.setValue(a),t.submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(e,t){var i=e.errorReader.jsonData,n=i&&i.result?i.result.uid:null;o.processUploadedFile(n),o.__cprog=0}})}else(e=new IG$._rpc$).init(o,{ack:"writecontent",payload:{uid:o.rec.get("uid"),name:o.down("[name=itemname]").getValue(),description:o.down("[name=description]").getValue()},mbody:{option:"rename"}},o,function(e){o.rec.set("name",e.name),o.close()},function(){o._proc=0}),e.send()},processUploadedFile:function(e){var t=this,i=new IG$._rpc$,n=[],o=t.rec;n.push({uid:e,name:t.down("[name=itemname]").getValue(),ouid:o.get("uid")}),i.init(t,{ack:"helpcontent",payload:n,mbody:{option:"reg_rcs",buid:t.buid}},t,function(e){o.set("name",n[0].name),t.close()},!1),i.send()},initComponent:function(){$s.apply(this,{items:[{xtype:"panel",bodyPadding:10,layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",name:"itemname",_fasl:1,fieldLabel:IRm$.r1("B_NAME")},{xtype:"textarea",name:"description",fieldLabel:IRm$.r1("B_DESC"),height:50},{xtype:"form",name:"mform",layout:"anchor",items:[{xtype:"hiddenfield",name:"_mts_",value:IG$._g$a},{xtype:"textfield",name:"orig_filename",hidden:!0,fieldLabel:"Original name"},{xtype:"fileuploadfield",name:"photo",fieldLabel:"Data",msgTarget:"side",allowBlank:!1,anchor:"100%",buttonText:IRm$.r1("L_SELECT_FILE"),buttonConfig:{margin:"0 2 0"}}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm()},scope:this},{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}]}),IG$.dashboardRcsEdit.superclass.initComponent.call(this)},listeners:{afterrender:function(e){e.down("[name=mform]").getForm().errorReader=new IG$.m2ER,e.loadContent.call(e)}}}),IG$.dashboardRcsMgr=$s.extend(IG$.v$pnl,{layout:"fit",framecontent:null,confirmSettings:function(){var e=this;e.updateSetting()&&(e.callback&&e.callback.execute(),e.close())},initF:function(){},commitCode:function(){var e,t,i,n=this.framecontent,o=n?n.rcs:null,a=this.down("[name=dgrid]");if(n)for(o.length&&o.splice(0,o.length),e=0;e<a.store.data.items.length;e++)t={uid:(i=a.store.data.items[e]).get("uid"),name:i.get("name")},o.push(t);return 1},refreshCode:function(){},init_f:function(){this.loadResources(9)},toolbarHandler:function(e){var t=this;switch(e){case"cmd_import":t.down("[name=d_file]").show();break;case"cmd_reload":t.loadResources();break;case"cmd_mgr_rcs":break;case"cmd_c_files":t.registerFiles()}},initApp:function(){var e,t,o,s=this,i=s.down("[name=d_file]").el.dom,n=$(".m_fileupload",i),l=s.down("[name=d_upfiles]");n.empty(),e=$("<input type='file' name='files[]' data-url='upload' multiple></input>").appendTo(n),t=$("<div class='filedropzone fade well'>Drop files here</div>").appendTo(n),o=$("<div class='file-progress'><div class='bar' style='width: 0%;'></div></div>").appendTo(n),e.fileupload({url:ig$.servlet,dataType:"json",done:function(e,t){var i,n,o,a=t.result||{errorcode:"0xffff",errormsg:"Server incorrect responding"},d=[];if(a.errorcode)IG$.ShowErrorMessage(a,s,null);else if(a.result)for(i=a.result.length?a.result:[a.result],n=0;n<i.length;n++)o=i[n],d.push(o);if(d&&d.length)for(l.show(),n=0;n<d.length;n++)l.store.add(d[n])},progressall:function(e,t){var i=parseInt(t.loaded/t.total*100,10),n=$(".bar",o);n.css("width",i+"%"),n.text("Loaded "+t.loaded+" / "+t.total)},dropZone:t}).bind("fileuploadsubmit",function(e,t){}),e.fileupload("option","url",ig$.servlet),s.loadResources()},registerFiles:function(){var e,t,i=this,n=i.down("[name=d_upfiles]"),o=i.down("[name=dgrid]"),a=n.store,d=[],s=new IG$._rpc$,l=o.store,r={};for(e=0;e<l.data.items.length;e++)r[(t=l.data.items[e]).get("name")]=t.get("uid");for(e=0;e<a.data.items.length;e++)t=a.data.items[e],d.push({uid:t.get("uid"),name:t.get("filename"),ouid:r[t.get("filename")]});d.length&&(s.init(i,{ack:"helpcontent",payload:d,mbody:{option:"reg_rcs",buid:i.uid}},i,function(e){i.loadResources(1)},!1),s.send())},loadResources:function(t){var i=this,e=(i.down("[name=dgrid]"),new IG$._rpc$),n="DashboardResources";1==t&&(d_upfiles=i.down("[name=d_upfiles]"),d_upfiles.store.removeAll(),d_upfiles.hide(),i.down("[name=d_file]").hide()),i.gobj?i.loadResource(i.gobj.uid,t,"global",new IG$.callBackObj(i,function(){this.uid&&"page"==this.cmode&&this.loadResource(this.gobj.uid,t,"page")})):(e.init(i,{ack:"helpcontent",payload:{uid:"/"+n,name:n,type:"Folder",post:"create",duty:"everyone",mode:"s"},mbody:{option:"translate"}},i,function(e){e&&e.length&&(i.gobj=e[0],i.loadResource(i.gobj.uid,t,"global",new IG$.callBackObj(i,function(){this.uid&&"page"==this.cmode&&this.loadResource(this.gobj.uid,t,"page")})))},!1),e.send())},loadResource:function(e,d,s,l){var r=this,t=new IG$._rpc$,c=r.down("[name=dgrid]");t.init(r,{ack:"content",payload:{uid:e},mbody:{option:"folder"}},r,function(e){var t,i,n,o=e?e.children:null,a=[];if(o)for(t=0;t<o.length;t++)(i=o[t]).btype=s,-1<i.name.indexOf(".")&&(i.fileext=i.name.substring(i.name.lastIndexOf(".")+1)),a.push(i);for(t=c.store.data.items.length-1;0<=t;t--)(n=c.store.data.items[t]).get("btype")==s&&c.store.remove(n);for(t=0;t<a.length;t++)c.store.add(a[t]);9==d&&r.commitCode(),l&&l.execute()},!1),t.send()},removeItem:function(t){var e=new IG$._rpc$,i={uid:t.get("uid")},n=this.down("[name=dgrid]");e.init(this,{ack:"batchcontent",payload:i,mbody:{option:"delete"}},this,function(e){n.store.remove(t)},null),e.send()},initComponent:function(){$s.apply(this,{tbar:[{iconCls:"icon-toolbar-import",tooltip:IRm$.r1("L_IMPORT_FILE"),text:IRm$.r1("L_IMPORT_FILE"),handler:function(){this.toolbarHandler("cmd_import")},scope:this},{iconCls:"icon-refresh",tooltip:"Reload",handler:function(){this.toolbarHandler("cmd_reload")},scope:this}],items:[{xtype:"container",layout:{type:"vbox",align:"stretch"},items:[{html:"<div class='m_fileupload'></div>",name:"d_file",height:120,hidden:!0,bodyPadding:10},{name:"d_upfiles",xtype:"gridpanel",height:120,hidden:!0,selType:"checkboxmodel",selModel:{mode:"MULTI"},store:{fields:["uid","filename","fileext"]},columns:[{text:IRm$.r1("L_FILENAME"),dataIndex:"filename",flex:1},{text:IRm$.r1("L_FILEEXT"),dataIndex:"fileext",flex:1},{xtype:"actioncolumn",width:20,items:[{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(e,t,i){var n=e.store.getAt(t);e.store.remove(n)}}]}],bbar:["->",{xtype:"button",text:"Commit All Files",handler:function(){this.toolbarHandler("cmd_c_files")},scope:this},{xtype:"button",text:"Cancel All Files",handler:function(){var e=this.down("[name=d_upfiles]");e.store.removeAll(),e.hide(),this.down("[name=d_file]").hide()},scope:this}]},{xtype:"gridpanel",name:"dgrid",flex:1,selType:"checkboxmodel",selModel:{mode:"MULTI"},store:{fields:["uid","name","type","filename","btype","memo","imgwidth","imgheight","fileext"]},columns:[{text:IRm$.r1("B_TYPE"),width:100,dataIndex:"btype"},{text:IRm$.r1("B_NAME"),flex:1,dataIndex:"name"},{text:IRm$.r1("L_FILEEXT"),width:120,dataIndex:"fileext"},{text:"Download",width:80,renderer:function(e){return"<span class='igc-download'>Download</span>"}},{xtype:"actioncolumn",width:40,items:[{iconCls:"icon-grid-config",tooltip:"Config item",handler:function(e,t,i){var n=e.store.getAt(t),o=new IG$.dashboardRcsEdit({rec:n,buid:this.uid});IG$.checkLogin(this,o)},scope:this},{iconCls:"icon-grid-delete",tooltip:"Delete item",handler:function(e,t,i){var n=this,o=e.store.getAt(t);IG$.confirmMessages(IRm$.r1("B_CONFIRM"),IRm$.r1("B_CD_MHS",o.get("name")),function(e){"yes"==e&&o&&n.removeItem(o)})},scope:this}]}],listeners:{cellclick:function(e,t,i,n,o,a,d,s){var l,r=n.get("fileext"),c=/png|gif|jpg|jpeg/.test(r);if(2==i&&c){var m=new IG$.dashboardRcsMgrPreview({uid:n.get("uid")});IG$.checkLogin(this,m)}else 4==i&&((l=new IG$._rpc$).init(this,{ack:"content",payload:{uid:n.get("uid")},mbody:{}},this,function(e){r&&$.download(ig$.servlet,[{name:"ack",value:"download"},{name:"payload",value:n.get("uid")},{name:"mtype",value:"resource"},{name:"mbody",value:n.get("name")},{name:"_mts_",value:IG$._g$a||""}],"POST")},!1),l.send())},scope:this}}]}]}),IG$.dashboardRcsMgr.superclass.initComponent.apply(this,arguments)},listeners:{afterrender:function(e){e.initApp()}}});
IG$.mgr_dashboard=$s.extend(IG$.v$pnl,{scroll:!1,initialized:!1,closable:!0,layout:"fit",bodyPadding:5,iconCls:"icon-ing-docdef",curnode:null,cursop:null,init:function(){var e=this;2==e._cmode?e.init_f("BusinessLogic",0):(e.init_f("BusinessProcess",0),e.init_f("DashboardResources",1))},init_f:function(e,a){var o,s=this.down("[name=m_navi]"),t=new IG$._rpc$;t.init(this,{ack:"helpcontent",payload:{uid:"/"+e,name:e,type:"Folder",post:"create",duty:"everyone",mode:"s"},mbody:{option:"translate"}},this,function(e){var t,n=this,i=e&&e.length?e[0].uid:null;i&&(0==a?(o=new IG$.n$navTreeCom({name:"mtree",rootuid:i,showCustomMenu:function(e){var t=this.customMenu,n=e.get("type").toLowerCase(),i=(e.get("name"),e.get("nodepath")),a=e.get("uid"),o=(e.get("type"),!(!e.get("writable")&&!e.get("manage"))),s=!!e.get("manage"),d=!1;return t.removeAll(),(o||s)&&(d=!0,t.add({text:IRm$.r1("B_FOLDER"),hidden:ig$.features.ig_n_f_f,handler:function(){this._createMetaObject.call(this,"Folder",a,i,e)},scope:this}),"folder"==n&&t.add({text:IRm$.r1("L_REMOVE"),hidden:ig$.features.ig_n_f_f,handler:function(){this.deleteMetaObject.call(this,a,e)},scope:this})),d},itemExpandHandler:new IG$.callBackObj(n,n.rs_cellClickHandler),cellClickHandler:new IG$.callBackObj(n,n.rs_cellClickHandler)}),s.add(o)):1==a&&((t=n.down("[name=m_1]")).uid=i,t.init_f.call(t)))}),t.send()},rs_cellClickHandler:function(e){var t=this,n=t.down("[name=t_btn]");n.setDisabled(!0),((t._s1=e).get("writable")||e.get("manageable"))&&n.setDisabled(!1),t.load_content(e)},load_content:function(e){var s=this,t=new IG$._rpc$;t.init(s,{ack:"content",payload:{uid:e.get("uid")},mbody:{option:""}},s,function(e){var t,n,i=e?e.children:null,a=[],o=this.down("[name=g1]");if(i)for(t=0;t<i.length;t++)n=i[t],(2==s._cmode&&"JavaClass"==n.type||2!=s._cmode&&"ClassModule"==n.type)&&a.push(n);o.store.loadData(a)},!1),t.send()},createItem:function(e){var t=this,n=t.down("[name=mtree]");t._s1&&n._createMetaObject.call(n,e,t._s1.get("uid"),t._s1.get("nodepath"),t._s1)},initComponent:function(){var e=this;e.title=IRm$.r1("I_MGR_DBD"),e.items=[{xtype:"panel",layout:"card",border:0,defaults:{deferredRender:!1},name:"n_c",dockedItems:[{xtype:"toolbar",dock:"top",hidden:2==e._cmode,items:[{xtype:"displayfield",value:IRm$.r1("L_SEL_MODE")},"-",{xtype:"button",text:IRm$.r1("L_CLASS_MOD"),name:"b_0",pressed:1,handler:function(){var e=this,t=e.down("[name=n_c]").getLayout();e.down("[name=b_0]").toggle(!0),e.down("[name=b_1]").toggle(!1),e.down("[name=b_2]").toggle(!1),t.setActiveItem(0)},scope:this},{xtype:"button",name:"b_1",text:IRm$.r1("L_RESOURCE"),handler:function(){var e=this,t=e.down("[name=n_c]").getLayout();e.down("[name=b_0]").toggle(!1),e.down("[name=b_1]").toggle(!0),e.down("[name=b_2]").toggle(!1),t.setActiveItem(1)},scope:this},{xtype:"button",name:"b_2",text:IRm$.r1("L_MENU"),handler:function(){var e=this,t=e.down("[name=n_c]").getLayout();e.down("[name=b_0]").toggle(!1),e.down("[name=b_1]").toggle(!1),e.down("[name=b_2]").toggle(!0),t.setActiveItem(2)},scope:this}]}],items:[{xtype:"panel",layout:"border",name:"m_0",border:!1,title:IRm$.r1("L_CLASS_MOD"),items:[{xtype:"panel",layout:"fit",region:"west",collapsed:!1,width:200,title:IRm$.r1("L_NAVIGATOR"),name:"m_navi",tbar:[{xtype:"button",name:"t_btn",text:IRm$.r1("L_CREATE_ITEM"),disabled:!0,menu:{xtype:"menu",items:2==e._cmode?[{text:IRm$.r1("D_JAVAPACKAGE"),hidden:ig$.features.ig_n_f_f,handler:function(){this.createItem("JavaPackage")},scope:this},"-",{text:IRm$.r1("D_JAVACLASS"),hidden:ig$.features.ig_n_jcm,handler:function(){this.createItem("JavaClass")},scope:this}]:[{text:IRm$.r1("B_FOLDER"),hidden:ig$.features.ig_n_f_f,handler:function(){this.createItem("Folder")},scope:this},"-",{text:IRm$.r1("D_CLASSMODULE"),hidden:ig$.features.ig_n_jcm,handler:function(){this.createItem("ClassModule")},scope:this}]}},{xtype:"button",iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){var e=this.down("[name=mtree]"),t=e.getRootNode();e.refreshNode.call(e,t)},scope:this}],items:[]},{xtype:"panel",region:"center",flex:1,layout:"fit",tbar:[{text:"Compile",handler:function(){var t,r=this,e=r.down("[name=g1]"),n={items:[]},a=e.getSelectionModel().selected,o=0,s=new IG$._rpc$;IG$.confirmMessages(ig$.appname,"Confirm to compile selected content?",function(e){if("yes"==e&&0<a.length){for(i=0;i<a.length;i++)t=a.items[i],n.items.push({uid:t.get("uid"),option:"compile"}),o++;0<o&&(r.setLoading(!0),s.init(r,{ack:"plugin",payload:n,mbody:{option:"compile"}},r,function(e){var t,n,i,a,o,s=r.down("[name=g1]"),d=IG$.XGetNode(e,"/smsg"),l=IG$.XGetChildNodes(d);for(t=0;t<l.length;t++){for(a=IG$.XGetAttr(l[t],"uid"),o=IG$.XGetAttr(l[t],"status"),i=null,n=0;n<s.store.data.items.length;n++)if(s.store.data.items[n].get("uid")==a){i=s.store.data.items[n];break}i&&i.set("msg","S"==o?"Success":"Error")}},null),s.send())}})},scope:this},{text:IRm$.r1("B_REMOVE"),handler:function(){var t,n=this,a=n.down("[name=g1]"),o={items:[]},s=a.getSelectionModel().selected,d=0,l=new IG$._rpc$;IG$.confirmMessages(ig$.appname,"Confirm to delete content?",function(e){if("yes"==e&&0<s.length){for(i=0;i<s.length;i++)t=s.items[i],o.items.push({uid:t.get("uid")}),d++;0<d&&(n.setLoading(!0),l.init(n,{ack:"batchcontent",payload:o,mbody:{option:"delete"}},n,function(e){var t;for(t=s.length-1;0<=t;t--)a.store.remove(s.items[t])},null),l.send())}})},scope:this}],items:[{xtype:"gridpanel",name:"g1",selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"MULTI"},store:{xtype:"store",fields:["uid","name","description","nodepath","type","writable","msg"]},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name",width:250},{text:IRm$.r1("B_DESC"),dataIndex:"description",flex:1},{text:"Message",dataIndex:"msg",width:80},{xtype:"actioncolumn",width:30,menuDisabled:!0,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("L_EDIT"),handler:function(e,t,n){var i=e.store.getAt(t),a=IG$.mainPanel;a&&a.navigateApp.call(a,i.get("uid"),i.get("type").toLowerCase(),i.get("name"),i.get("nodepath"),!0,i.get("writable"))},scope:this}]}],listeners:{cellclick:function(e,t,n,i,a,o,s,d){if(3==n){var l=e.store.getAt(o),r=IG$.mainPanel;r&&r.navigateApp.call(r,l.get("uid"),l.get("type").toLowerCase(),l.get("name"),l.get("nodepath"),!0,l.get("writable"))}},scope:this}}]}]},new IG$.dashboardRcsMgr({cmode:"global",title:IRm$.r1("L_RESOURCE"),name:"m_1"}),new IG$.dashboardmenu({title:IRm$.r1("L_MENU"),name:"m_2"})]}],this.listeners={afterrender:function(e){e.init.call(e)}},IG$.mgr_dashboard.superclass.initComponent.call(this)}});
IG$.systemlookup=$s.extend(IG$.v$pnl,{scroll:!1,initialized:!1,closable:!0,layout:"fit",bodyPadding:5,iconCls:"icon-ing-docdef",init_f:function(){var n,a=this,o=this.down("[name=m_navi]"),e=new IG$._rpc$;e.init(a,{ack:"helpcontent",payload:{uid:"/SYS_Lookup",name:"SYS_Lookup",type:"Folder",post:"create",duty:"everyone",mode:"s"},mbody:{option:"translate"}},a,function(e){var t=e&&e.length?e[0].uid:null;t&&(a.tuid=t,n=new IG$.n$navTreeCom({name:"mtree",rootuid:t,btype:"codemap",rootname:"Code Mapping",visibleItems:"folder;",showCustomMenu:function(e){var t=this.customMenu,n=(e.get("type").toLowerCase(),e.get("name")),a=e.get("nodepath"),o=e.get("uid"),i=(e.get("type"),!(!e.get("writable")&&!e.get("manage"))),l=!!e.get("manage"),d=!1;return t.removeAll(),(i||l)&&(d=!0,t.add({text:IRm$.r1("B_FOLDER"),hidden:ig$.features.ig_n_f_f,handler:function(){this._createMetaObject.call(this,"Folder",o,a,e)},scope:this}),t.add({text:IRm$.r1("L_RENAME_ITEM",n),hidden:ig$.features.ig_n_ren,handler:function(){this._renameMetaObject.call(this,n,o,a,record)},scope:this}),t.add({text:IRm$.r1("L_DELETE_ITEM",n),hidden:ig$.features.ig_n_del,handler:function(){this.deleteMetaObject.call(this,o,record)},scope:this})),d},custom_expand_func:new IG$.callBackObj(a,a.rs_cellClickHandler),custom_click_func:new IG$.callBackObj(a,a.rs_cellClickHandler)}),o.add(n))}),e.send()},rs_cellClickHandler:function(e){var t=this,n=t.down("[name=t_btn]");n.setDisabled(!0),((t._s1=e).get("writable")||e.get("manageable"))&&n.setDisabled(!1),t.load_content(e)},load_content:function(e){var t=new IG$._rpc$;t.init(this,{ack:"content",payload:{uid:e.get("uid")},mbody:{}},this,function(e){var t,n,a=e?e.children:null,o=[],i=this.down("[name=g1]");if(a)for(t=0;t<a.length;t++)"CodeMap"==(n=a[t]).type&&o.push(n);i.store.loadData(o)},!1),t.send()},createItem:function(e){var t=this,n=t.down("[name=mtree]");t._s1&&n._createMetaObject.call(n,e,t._s1.get("uid"),t._s1.get("nodepath"),t._s1)},toolbarHandler:function(e){var n,a,o,l=this,d=0;switch(e){case"cmd_rename":if(n=l.down("[name=g1]"),(a=n.getSelectionModel().selected)&&0<a.length){o=a.items[0];var t=new IG$.makeItemEditor({itemname:o.get("name"),uid:o.get("uid"),nodepath:o.get("nodepath"),itemtype:o.get("type"),memo:o.get("memo")||"",callback:new IG$.callBackObj(l,function(e){})});IG$.checkLogin(this,t)}break;case"cmd_move":if(n=l.down("[name=g1]"),(a=n.getSelectionModel().selected)&&0<a.length){l=this;var r=new IG$.metaSelectDlg({visibleItems:"folder",targetobj:"folder",tree_options:{cubebrowse:!1,rootuid:l.tuid},callback:new IG$.callBackObj(l,function(t){t&&IG$.confirmMessages(IRm$.r1("B_CONFIRM"),IRm$.r1("B_CD_MHS",t.name),function(e){if("yes"==e){for(address=[],i=d=0;i<a.length;i++)((o=a.items[i]).get("writable")||o.get("manage"))&&(address.push({uid:o.get("uid")}),d++);0<d&&(l.setLoading(!0),req=new IG$._rpc$,req.init(l,{ack:"helpcontent",payload:address,mbody:{option:"move",target:t.uid}},l,function(e){var t=this.down("[name=mtree]"),n=t.getRootNode();t.refreshNode.call(t,n)},null,null),req.send())}})})});IG$.checkLogin(this,r)}break;case"cmd_delete":n=l.down("[name=g1]"),(a=n.getSelectionModel().selected)&&0<a.length&&(o=a.items[0],IG$.confirmMessages(ig$.appname,"Confirm to delete content?",function(e){if("yes"==e){var t=new IG$._rpc$;t.init(l,{ack:"deletecontent",payload:{uid:o.get("uid")},mbody:{}},l,function(e){n.store.remove(o)},null),t.send()}}));break;case"cmd_export_meta":IG$.confirmMessages(IRm$.r1("T_EXP_MC"),IRm$.r1("T_EXP_MC_Q"),function(e){var t,n,a=l,o=new IG$._rpc$;(t={uid:a.tuid,name:"SYS_Lookup",type:"Folder",nodepath:"/SYS_Lookup"}).uid&&"yes"==e&&(n={uid:t.uid,nodepath:t.nodepath,name:t.name,type:t.type},o.init(a,{ack:"content",payload:n,mbody:{output:"file"}},a,function(e){var t,n;e&&(t=e.luid,n=e.filename,t&&n&&$.download(ig$.servlet,[{name:"ack",value:"download"},{name:"payload",value:t},{name:"mbody",value:n},{name:"_mts_",value:IG$._g$a||""}],"POST"))},null),o.send())},l,l)}},initComponent:function(){this.items=[{xtype:"panel",layout:"border",border:!1,items:[{xtype:"panel",layout:"fit",region:"west",collapsed:!1,width:200,title:"Navigator",name:"m_navi",tbar:[{xtype:"button",name:"t_btn",text:IRm$.r1("B_CR"),disabled:!0,menu:{xtype:"menu",items:[{text:IRm$.r1("B_FOLDER"),hidden:ig$.features.ig_n_f_f,handler:function(){this.createItem("Folder")},scope:this},"-",{text:IRm$.r1("L_CODEMAPPING"),hidden:ig$.features.ig_n_lk,handler:function(){this.createItem("CodeMap")},scope:this}]}},{xtype:"button",iconCls:"icon-refresh",tooltip:IRm$.r1("L_REFRESH"),handler:function(){var e=this.down("[name=mtree]"),t=e.getRootNode();e.refreshNode.call(e,t)},scope:this}],items:[]},{xtype:"panel",region:"center",flex:1,layout:"fit",tbar:[{xtype:"button",text:IRm$.r1("L_RENAME"),handler:function(){this.toolbarHandler("cmd_rename")},scope:this},{xtype:"button",text:IRm$.r1("L_MOVE"),handler:function(){this.toolbarHandler("cmd_move")},scope:this},{xtype:"button",text:IRm$.r1("L_REMOVE"),handler:function(){this.toolbarHandler("cmd_delete")},scope:this},"->",{text:IRm$.r1("L_EXPORT_META"),handler:function(){this.toolbarHandler("cmd_export_meta")},scope:this}],items:[{xtype:"gridpanel",name:"g1",store:{xtype:"store",fields:["uid","name","description","nodepath","type","writable"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell",mode:"SINGLE"},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name",tdCls:"igc-td-link"},{text:IRm$.r1("B_DESC"),dataIndex:"description",flex:1},{xtype:"actioncolumn",width:30,menuDisabled:!0,items:[{iconCls:"icon-grid-config",tooltip:IRm$.r1("L_EDIT"),handler:function(e,t,n){var a=e.store.getAt(t),o=IG$.mainPanel;o&&o.navigateApp.call(o,a.get("uid"),a.get("type").toLowerCase(),a.get("name"),a.get("nodepath"),!1,a.get("writable"))},scope:this}]}],listeners:{cellclick:function(e,t,n,a,o,i,l,d){if(1==n){var r=e.store.getAt(i),s=IG$.mainPanel;s&&s.navigateApp.call(s,r.get("uid"),r.get("type").toLowerCase(),r.get("name"),r.get("nodepath"),!1,r.get("writable"))}},scope:this}}]}]}],this.listeners={afterrender:function(e){e.init_f.call(e)}},IG$.systemlookup.superclass.initComponent.call(this)}});
IG$.uipage=$s.extend(IG$.v$pnl,{padding:0,closable:!0,layout:"fit",init_f:function(){var e,t=this,i=t.down("[name=t_save]"),a=t.down("[name=t_save_as]");1!=this.writable&&""!=this.uid||i.setVisible(!0),a.setVisible(!0),(e=new IG$._rpc$).init(t,{ack:"content",payload:{uid:t.uid},mbody:{option:"standard"}},t,t.rs_loadContent,!1),e.send()},rs_loadContent:function(e){},toolbarHandler:function(e){switch(e){case"cmd_save":var t=this.uid;if(t){this.saveCnt(t,null,target)}else this.saveAsContent(!1);break;case"cmd_saveas":this.saveAsContent(!1)}},saveCnt:function(e,t,i){var a=this,l=new IG$._rpc$;l.init(a,{ack:"writecontent",payload:{uid:e},mbody:t},a,a.rs_saveCnt,null,[i]),l.send()},rsaveContent:function(e,t){1==(!!t&&t[0])?this.doClose():(this.contentchanged=!1,IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success"))},saveAsContent:function(e){var t=new IG$.metaSelectDlg({mode:"newitem",initpath:this.nodepath});t.callback=new IG$.callBackObj(this,this.saveNewContent,e),IG$.checkLogin(this,t)},saveNewContent:function(e,t){var i=this,a=this.reportoption.getCurrentPivot.call(this.reportoption),l=new IG$._rpc$;l.init(i,{ack:"writecontent",payload:{address:e.nodepath+"/"+e.name,name:e.name,type:this.itemtype||"Report",pid:e.uid},mbody:a},i,i._rs_procMakeItem,i.rs_procMakeItem,[e.name,t,e.nodepath,e.uid,a]),l.showerror=!1,l.send()},rs_procMakeItem:function(e,t){var i=this,a=t[0],l=t[1],n=t[2],o=t[3],s=t[4];"0x12e0"==IG$.getErrorCode(e)?IG$.confirmMessages(ig$.appname,a+" already exist on the server. Would you overwrite existing item with this copy?",function(e){if("yes"==e){var t=new IG$._rpc$;t.init(i,{ack:"writecontent",payload:{address:n+"/"+a,name:a,type:this.itemtype||"UIPage",pid:o,overwrite:"T"},mbody:s},i,i._rs_procMakeItem,null,[a,l,n]),t.send()}},i,i):IG$.ShowErrorMessage(e,i)},_rs_procMakeItem:function(e,t){t[0];var i=t[1],a=IG$.XGetNode(e,"/smsg/item"),l=IG$.XGetAttr(a,"name");1!=i?(this.contentchanged=!1,this.uid=IG$.XGetAttr(a,"uid"),this.uid=this.uid,this.setTitle(l)):this.doClose()},doClose:function(e){var t=this;if("no"==e)(i=new IG$._rpc$).init(t,{ack:"helpcontent",payload:{uid:t.uid},mbody:{option:"lock",detail:"close"}},t,function(e){this.doClose()},!1),i.send();else if("yes"==e){var i;(i=new IG$._rpc$).init(t,{ack:"helpcontent",payload:{uid:t.uid},mbody:{option:"lock",detail:"close"}},t,function(e){this.toolbarHandler("cmd_save",!0)},!1),i.send()}},initComponent:function(){this.items=[{xtype:"panel",padding:10,layout:{type:"vbox",align:"stretch"},border:0,items:[{xtype:"fieldset",title:"Global Filter",layout:{type:"vbox",align:"none"},items:[{xtype:"fieldcontainer",fieldLabel:"Filter Item",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",name:"gfilter"},{xtype:"button",text:".."}]},{xtype:"combobox",fieldLabel:"Selection type",labelField:"disp",valueField:"type",store:{xtype:"store",fields:["disp","type"],data:[]}}]},{xtype:"fieldset",title:"Dashboard Items",layout:"fit",flex:1,items:[{xtype:"gridpanel",store:{xtype:"store",fields:["title","type","dispoption","nodepath","uid","name"]},selType:"checkboxmodel",selModel:{checkSelector:".x-grid-cell"},columns:[{xtype:"gridcolumn",text:"Title"},{xtype:"gridcolumn",text:"Display type"},{xtype:"gridcolumn",text:"Display Option"},{xtype:"gridcolumn",text:"Bind report",flex:1}],tbar:[{xtype:"button",text:"Add View",handler:function(){var e=new IG$._Ia8({});IG$.checkLogin(this,e)},scope:this},{xtype:"button",text:"Add Filter",handler:function(){var e=new IG$._Ia7({});IG$.checkLogin(this,e)},scope:this},{xtype:"button",text:"Edit",handler:function(){var e=new IG$._Ia8({});IG$.checkLogin(this,e)},scope:this}]}]},{xtype:"textarea",name:"layouthtml",fieldLabel:"Layout HTML",height:200}]}],this.tbar=[{iconCls:"icon-toolbar-save",name:"t_save",tooltip:IRm$.r1("L_SAVE_CONTENT"),hidden:!0,handler:function(){this.toolbarHandler("cmd_save")},scope:this},{iconCls:"icon-toolbar-saveas",name:"t_save_as",tooltip:IRm$.r1("L_SAVE_REPORT_AS"),hidden:!0,handler:function(){this.toolbarHandler("cmd_saveas")},scope:this}],IG$.uipage.superclass.initComponent.call(this)},listeners:{afterrender:function(e){e.init_f()}}}),IG$._Ia8=$s.extend($s.window,{modal:!0,region:"center",layout:"fit",closable:!1,resizable:!1,width:360,height:400,autoHeight:!1,parentnodepath:null,itemtype:null,parentuid:null,callback:null,fV9:function(){},initComponent:function(){this.title=IRm$.r1("L_MAKEITEM"),$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"form",layout:"anchor",autoScroll:!0,defaults:{anchor:"100%"},items:[{xtype:"fieldset",title:"Basic Option",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"View type",labelField:"label",displayField:"label",valueField:"value",editable:!1,store:{xtype:"store",fields:["label","value"],data:[{label:"Chart",value:"chart"},{label:"Report",value:"report"},{label:"As saved",value:"saved"},{label:"R statistics",value:"R"},{label:"Filter",value:"filter"}]}},{xtype:"fieldcontainer",fieldLabel:"Report Item",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield"},{xtype:"button",text:".."}]}]},{xtype:"fieldset",title:"Size option",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",fieldLabel:"Height",minValue:50}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.fV9()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$._Ia8.superclass.initComponent.apply(this,arguments)}}),IG$._Ia6=function(e){this.container=e,this.table=$("<table></table>").appendTo(e)},IG$._Ia6.prototype={},IG$._Ia7=$s.extend($s.window,{modal:!0,region:"center",layout:"fit",closable:!1,resizable:!1,width:400,autoHeight:!0,callback:null,fV9:function(){},r1:function(){var e,t,i=this.R1;i||(e=this.down("[name=filterarea]"),t=$("[name=filterdiv]",e.el.dom),i=this.R1=new IG$._Ia6(t)),i.table.empty()},initComponent:function(){this.title=IRm$.r1("L_MAKEITEM"),$s.apply(this,{defaults:{bodyStyle:"padding:10px"},items:[{xtype:"form",layout:"anchor",autoScroll:!0,defaults:{anchor:"100%"},items:[{xtype:"fieldset",title:"Basic Option",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"combobox",fieldLabel:"View type",labelField:"label",displayField:"label",valueField:"value",editable:!1,store:{xtype:"store",fields:["label","value"],data:[{label:"Chart",value:"chart"},{label:"Report",value:"report"},{label:"As saved",value:"saved"},{label:"R statistics",value:"R"},{label:"Filter",value:"filter"}]}},{html:"<div name='filterdiv'></div>",name:"filterarea",height:300},{xtype:"fieldcontainer",fieldLabel:"Report Item",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield"},{xtype:"button",text:".."}]}]},{xtype:"fieldset",title:"Size option",layout:"anchor",defaults:{anchor:"100%"},items:[{xtype:"numberfield",fieldLabel:"Height",minValue:50}]}]}],buttons:[{text:IRm$.r1("B_CONFIRM"),handler:function(){this.fV9()},scope:this},{text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}],listeners:{afterrender:function(e){this.r1()}}}),IG$._Ia7.superclass.initComponent.apply(this,arguments)}});
IG$.metaImport=$s.extend($s.panel,{bodyStyle:"padding:5px",closable:!0,iconCls:"icon-ing-docdef",layout:{type:"vbox",align:"stretch"},defaults:{anchor:"100%"},uploadFile:function(){var i=this.down("[name=mform]");i.getForm().isValid()&&i.getForm().submit({url:ig$.servlet,waitMsg:"Uploading your data file",success:function(e,t){var o=e.errorReader.jsonData,a=o?o.result.uid:null;i.customowner.processUploadedFile.call(i.customowner,a)},failure:function(e,t){}})},processUploadedFile:function(e){var t=this,o=(this.down("[name=uploadset]"),new IG$._rpc$);t.uid=e,t.setLoading(!0,!0),o.init(t,{ack:"uploadcontent",payload:{uid:e},mbody:{option:"meta_imp"}},t,t.rs_processUploadedFile,null),o.send()},rs_processUploadedFile:function(e){var t,o,a,i,d,l=this.down("[name=metadata]").store.getRootNode(),n=[],s={};for(t=0;t<e.length;t++)d=(o=e[t]).type.toLowerCase(),o.iconCls=IG$.get_metatype_icon(d,o),o.checked=!1,1==/(metrics|folder|table|inlineview|rfolder|datemetric|mdbcube|javapackage)/.test(d)&&"cubemodel"!=d?o.leaf=!1:0==/(folder|datemetric|table|inlineview|pool)/.test(d)&&(o.leaf=!0),s[o.nodepath]=o,0==t?n.push(o):((i=o.nodepath.split("/")).splice(i.length-1,1),(a=s[i.join("/")])?a.children?a.children.push(o):a.children=[o]:1==i.length&&n.push(o));for(;l.firstChild;)l.removeChild(l.firstChild);for(t=0;t<n.length;t++)l.appendChild(n[t])},toolbarHandler:function(e){var t=this;switch(e){case"cmd_imp":this.uid&&IG$.confirmMessages("ImportMeta","Would you include meta to server?",t.do_importMeta,t,t)}},do_importMeta:function(e){if("yes"==e){var t,o,a,i=this,d=i.down("[name=metadata]").store,l=[],n=new IG$._rpc$,s=[];if(i.getChecked(l,d.getRootNode()),0<l.length){for(i.setLoading(!0,!0),t=0;t<l.length;t++)o={name:(a=l[t]).get("name"),uid:a.get("uid"),nodepath:a.get("nodepath"),type:a.get("type")},s.push(o);n.init(i,{ack:"uploadcontent",payload:{uid:i.uid,option:"imp_load"},mbody:{children:s},meta_type:"metrics"},i,i.rs_importMeta,null),n.send()}}},getChecked:function(e,t){var o;for(o=0;o<t.childNodes.length;o++)t.childNodes[o].get("checked")&&t.childNodes[o].get("uid")&&e.push(t.childNodes[o]),t.childNodes[o].childNodes&&this.getChecked(e,t.childNodes[o])},updNodeRs:function(e,o){var a,i,d,l=0;for(a=0;a<o.childNodes.length;a++){if((i=o.childNodes[a].get("uid"))&&e[i]){switch(d=parseInt(e[i])){case 0:msg="Not processed";break;case 1:msg="Success";break;case 5:msg="STAT_CONTENT_MISSING";break;case 6:msg="STAT_FAIL_PARENT";break;case 7:msg="STAT_UPPER_NODE_MISSING";break;case 8:msg="STAT_NO_PARENT";break;default:msg="Unknown "+t.status}o.childNodes[a].set("logresult",msg),1!=d&&l++}o.childNodes[a].childNodes&&(l+=this.updNodeRs(e,o.childNodes[a]))}return l},rs_importMeta:function(e,t){var o=e,a=this.down("[name=metadata]").store,i=0;o&&(i+=this.updNodeRs(o,a.getRootNode())),0<i?IG$.alertmsg(ig$.appname,i+" item failed to import!",null,null,1,"error"):IG$.alertmsg(ig$.appname,IRm$.r1("M_SAVED"),null,null,0,"success")},updateCheckStatus:function(e,t){var o,a;for(o=0;o<e.childNodes.length;o++)(a=e.childNodes[o]).set("checked",t),a.childNodes&&a.childNodes.length&&!a.childNodes[0].data._loading&&this.updateCheckStatus(a,t)},initComponent:function(){var e=this;this.items=[{xtype:"fieldset",title:"Load File",region:"north",name:"uploadset",layout:"anchor",collapsible:!0,items:[{xtype:"form",name:"mform",border:0,customowner:this,layout:{type:"hbox",align:"stretch"},items:[{xtype:"hiddenfield",name:"_mts_",value:IG$._g$a},{xtype:"fileuploadfield",name:"photo",flex:1,fieldLabel:"Data",msgTarget:"side",allowBlank:!1,anchor:"100%",buttonText:IRm$.r1("L_SELECT_FILE"),buttonConfig:{margin:"0 2 0"}},{xtype:"button",text:"Upload file",handler:function(){e.uploadFile.call(e)}}]}]},{xtype:"form",layout:{type:"vbox",align:"stretch"},flex:1,border:0,defaults:{anchor:"100%"},items:[{xtype:"fieldcontainer",border:0,layout:{type:"hbox",align:"stretch"},items:[{xtype:"displayfield",value:"Items on file",flex:1},{xtype:"button",plain:!0,text:"Import Selected",handler:function(){this.toolbarHandler("cmd_imp")},scope:this}]},{xtype:"treepanel",flex:1,name:"metadata",collapsible:!1,rootVisible:!1,useArrows:!0,store:{type:"treestore",root:{expanded:!0},fields:["name","uid","type","nodepath","exist","existname","checked","logresult","iconCls"]},selModel:{selType:"treecheckbox",mode:"MULTI"},tbar:[{xtype:"button",text:"Select All",handler:function(){var e=this.down("[name=metadata]").getRootNode();e.expand(),this.updateCheckStatus(e,!0)},scope:this}],columns:[{xtype:"treecolumn",flex:1,width:320,text:"Data name",dataIndex:"name",editor:{allowBlank:!1}},{xtype:"gridcolumn",width:40,text:"Exist",dataIndex:"exist",editor:{allowBlank:!1}},{xtype:"gridcolumn",flex:1,text:"Type",dataIndex:"type",width:80,editor:{allowBlank:!1}},{xtype:"gridcolumn",flex:1,text:"Path",dataIndex:"nodepath",editor:{allowBlank:!1}},{xtype:"gridcolumn",flex:1,text:"Log Result",dataIndex:"logresult"},{xtype:"checkcolumn",dataIndex:"checked",text:"Selected",width:80}],listeners:{checkchange:function(e,t,o){e.isRoot()&&e.expand(),this.updateCheckStatus(e,t)},scope:this}}]}],IG$.metaImport.superclass.initComponent.apply(this,arguments)},listeners:{afterrender:function(){var e=this.down("[name=mform]");e.getForm().errorReader=new IG$.m2ER,e.customowner=this}}}),IG$.metaImportDlg=$s.extend($s.window,{width:400,autoHeight:!0,layout:"fit",initComponent:function(){this.title=IRm$.r1("T_META_IMP"),this.items=[new IG$.metaImport],this.buttons=[{text:IRm$.r1("B_CLOSE"),handler:function(){this.close()},scope:this}],IG$.metaImportDlg.superclass.initComponent.apply(this,arguments)}});
IG$.mgr_deploy=$s.extend(IG$.v$pnl,{closable:!0,layout:"fit",bodyPadding:0,padding:0,iconCls:"icon-ing-docdef",_init:function(){var i=this,e=new IG$._rpc$;e.init(i,{ack:"deploy",payload:{option:"get_servers"},mbody:{}},i,function(e){var t=i.down("[name=dpsvr]"),n=[];for(k in e)n.push(e[k]);i.dp_svr=e,t.store.loadData(n)},!1),e.send()},testConnection:function(){var e=this,t=e.down("[name=c_info]"),n=new IG$._rpc$,i={};t.getAllValues(i)||(n.init(e,{ack:"deploy",payload:{option:"testconnection"},mbody:i},e,function(e){},!1),n.send())},initComponent:function(){$s.apply(this,{items:[{xtype:"panel",bodyPadding:0,border:1,layout:{type:"hbox",align:"stretch"},items:[{xtype:"panel",flex:1,layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:"Search",flex:1,labelWidth:60},{xtype:"button",text:".."},{xtype:"container",flex:1}]},new IG$.explorer({name:"mexplorer",vmode:"tree",border:0,flex:1,split:!1,custom_click_func:new IG$.callBackObj(this,function(e,t){var n=e.get("type").toLowerCase();return("root"==n||IG$.isFolder(n)<5)&&(e.isExpanded()||e.expand()),!1}),show_tree_items:!0})]},{xtype:"container",layout:{type:"vbox",align:"stretch",pack:"center"},padding:5,width:50,items:[{xtype:"container",flex:1,border:0},{xtype:"button",text:">",width:50},{xtype:"button",text:"<",width:50},{xtype:"container",flex:1,border:0}]},{xtype:"panel",flex:1,text:"Target Server",layout:{type:"vbox",align:"stretch"},items:[{xtype:"fieldset",title:"Connection Information",name:"c_info",layout:"anchor",items:[{xtype:"combobox",name:"dpsvr",fieldLabel:IRm$.r1("L_DEPLOY_SVR"),displayField:"name",valueField:"name",store:{fields:["name"]},listeners:{change:function(e){var t=this.down("[name=c_info]"),n=this.dp_svr;n&&n[e.getValue()]&&t.setAllValues(n[e.getValue()].properties)},scope:this}},{xtype:"textfield",name:"server_url",placeholder:"http://localhost:8280",required:!0,fieldLabel:IRm$.r1("L_SERVER_HOST")},{xtype:"textfield",name:"endpoint",placeholder:"/boguenon/servlet/krcp",required:!0,fieldLabel:IRm$.r1("L_ENDPOINT_URL")},{xtype:"textfield",name:"tenant_name",required:!0,fieldLabel:IRm$.r1("L_TENANT")},{xtype:"textfield",name:"tsvr_userid",required:!0,fieldLabel:IRm$.r1("L_USERID")},{xtype:"textfield",name:"tsvr_passwd",inputType:"password",required:!0,fieldLabel:IRm$.r1("L_PASSWORD")},{xtype:"container",layout:{type:"hbox",align:"stretch"},items:[{xtype:"container",flex:1},{xtype:"button",text:"Test Connection",handler:function(){this.testConnection()},scope:this}]}]},{xtype:"gridpanel",title:"Deploy Items",tbar:[{xtype:"button",text:"Validate status"},{xtype:"button",text:"Execute"}],columns:[{text:"Name",dataIndex:"name",flex:1},{text:"Full path",dataIndex:"nodepath",flex:1},{text:"Status",dataIndex:"status"},{text:"Execution Results",dataIndex:"execution_results"}]}]}]}],listeners:{afterrender:function(e){this._init()}}}),IG$.mgr_deploy.superclass.initComponent.call(this)}});