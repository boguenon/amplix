IG$.mongoJobs=$s.extend(IG$.v$pnl,{scroll:!1,closable:!0,layout:"border",_ld:function(){var t="MongoJobs",e=new IG$._rpc$;e.init(this,{ack:"helpcontent",payload:{uid:"/"+t,name:t,type:"Folder",post:"create",duty:"everyone",mode:"s"},mbody:{option:"translate"}},this,(function(t){var e=t&&t.length?t[0].uid:null;e&&(this._tuid=e,this._ldc())})),e.send()},_ldc:function(){var t=this._tuid;if(t){var e=new IG$._rpc$;e.init(this,{ack:"content",payload:{uid:t},mbody:{option:""}},this,(function(t){var e=t?t.children:null;this.down("[name=g1]").store.loadData(e)}),!1),e.send()}},_add:function(){var t=this,e=t._tuid;e&&IG$._createMetaObject.call(t,"MongoMR",e,null,null,new IG$.callBackObj(t,(function(){t._ldc()})))},_edit:function(t){var e=this,n=new IG$.mongoJobEdt({instance:e.instance,titem:t,callback:new IG$.callBackObj(e,(function(){e._ldc()}))});IG$.checkLogin(e,n)},initComponent:function(){this.title=IRm$.r1("L_MONGO_DPROC"),$s.apply(this,{items:[{xtype:"panel",region:"center",flex:1,title:IRm$.r1("L_MONGO_DPROC"),layout:"fit",tbar:[{iconCls:"icon-toolbar-add",text:IRm$.r1("B_ADD"),handler:function(){this._add()},scope:this},{iconCls:"icon-toolbar-refresh",text:IRm$.r1("L_REFRESH"),handler:function(){this._ldc()},scope:this}],items:[{xtype:"gridpanel",name:"g1",store:{xtype:"store",fields:[]},columns:[{text:IRm$.r1("B_TYPE"),width:80,sortable:!1,hideable:!1,dataIndex:"dbtype"},{text:IRm$.r1("B_NAME"),flex:1,tdCls:"igc-td-link",sortable:!1,hideable:!1,dataIndex:"name",xtype:"templatecolumn",renderer:function(t,e,n){var i=n.get("locale_name")||n.get("name");return n.get("locale_name")&&(i+="("+n.get("locale_name")+")"),i+="\n==>"+(n.get("nodepath")||""),"<span title='"+IG$.hEE(i)+"'>"+IG$.hEE(n.get("locale_name")||n.get("name"))+"</span>"+(n.data.attributes&&"T"==n.data.attributes.attrb1?"  <span class='db_writable'></span>":"")}},{text:IRm$.r1("B_OWNER"),width:120,dataIndex:"owner"},{text:IRm$.r1("B_MODI"),width:120,dataIndex:"modifier"},{text:IRm$.r1("B_LASTUPD"),width:150,dataIndex:"updatedatefm"},{xtype:"actioncolumn",width:60,items:[{iconCls:"icon-grid-dbicon",handler:function(t,e,n){var i=t.store.data.items[e];this._edit(i)},scope:this},{iconCls:"igc-share",tooltip:IRm$.r1("L_OBJECT_AUTH"),hidden:!1!==ig$.features.ig_n_oauth,handler:function(t,e,n){var i=t.store.data.items[e];this.openDSLayer("cmd_object_auth",i)},scope:this},{iconCls:"icon-grid-delete",tooltip:IRm$.r1("L_REMOVE"),handler:function(t,e,n){var i=t.store,a=i.getAt(e);IG$.deleteMetaObject(a.get("uid"),a,new IG$.callBackObj(this,(function(){i.removeAt(e)})))},scope:this}]}],listeners:{cellclick:function(t,e,n,i,a,o){1==n&&this._edit(i)},scope:this}}]}]}),IG$.mongoJobs.superclass.initComponent.call(this)},listeners:{afterrender:function(){this._ld()}}});
IG$.mongoJobAct=$s.extend($s.window,{width:650,height:580,layout:"fit",_init:function(){var t=this.ditem||{};this.setAllValues(t)},_confirm:function(t){var e=this,i=e.ditem||{};e.getAllValues(i)||(e.callback&&e.callback.execute(i),e.close())},initComponent:function(){$s.apply(this,{title:IRm$.r1("T_DB_CON"),padding:ig$.padding,items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},padding:ig$.padding,autoScroll:!0,items:[{xtype:"fieldset",title:IRm$.r1("B_SOURCE"),layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",fieldLabel:IRm$.r1("B_NAME"),required:!0,name:"name"},{xtype:"combobox",fieldLabel:IRm$.r1("B_"),required:!0,valueField:"value",displayField:"name",editable:!1,autoSelect:!0,name:"action_type",store:{data:[{name:"increment",value:"increment"},{name:"add",value:"add"}]}},{xtype:"textarea",fieldLabel:"Catalog",name:"catalog"}]}]}],buttons:[{xtype:"button",text:IRm$.r1("B_DELETE"),hidden:!this.dbinfo,handler:function(){this._confirm("delete")},scope:this},"->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm("confirm")},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$.mongoJobAct.superclass.initComponent.call(this)},listeners:{afterrender:function(t){t._init()}}}),IG$.mongoJobEdt=$s.extend($s.window,{width:650,height:580,layout:"fit",_init:function(){var t=this,e=t.titem,i=new IG$._rpc$;e&&(i.init(t,{ack:"content",payload:{uid:e.get("uid")},mbody:{option:""}},t,(function(e){t.titem_d=e;var i=e.content=e.content||{};t.setAllValues(i),t.down("[name=g1]").store.loadData(i.mr_actions)}),!1),i.send())},_confirm:function(t){var e,i,n,o=this,a=(o.titem,{}),l=o.down("[name=g1]"),c=o.titem_d;if(!o.getAllValues(a)){for(c.name=a.name,c.description=a.description,a.meta_type="MongoMR",a.mr_actions=e=[],i=0;i<l.store.data.items.length;i++)n=l.store.data.items[i],e.push({name:n.get("name"),action_type:n.get("action_type"),catalog:n.get("catalog")});var s=new IG$._rpc$;s.init(o,{ack:"writecontent",payload:{name:c.name,description:c.description,uid:c.uid},mbody:a,meta_type:"MongoMR"},o,(function(t){o.callback&&o.callback.execute(),o.close()})),s.send()}},_act:function(t){var e=t?t.data:null,i=this,n=i.down("[name=g1]"),o=new IG$.mongoJobAct({instance:i.instance,ditem:e,callback:new IG$.callBackObj(i,(function(e){t||n.store.add(e)}))});IG$.checkLogin(i,o)},initComponent:function(){$s.apply(this,{title:IRm$.r1("T_DB_CON"),padding:ig$.padding,items:[{xtype:"panel",layout:{type:"vbox",align:"stretch"},padding:ig$.padding,autoScroll:!0,items:[{xtype:"fieldset",title:IRm$.r1("B_GENERAL"),layout:{type:"vbox",align:"stretch"},items:[{xtype:"textfield",required:!0,fieldLabel:IRm$.r1("B_NAME"),name:"name"},{xtype:"textarea",fieldLabel:IRm$.r1("B_DESC"),name:"description"}]},{xtype:"fieldset",title:IRm$.r1("B_SOURCE"),layout:{type:"vbox",align:"stretch"},items:[{xtype:"textarea",fieldLabel:IRm$.r1("B_SQL"),required:!0,name:"sql_query"}]},{xtype:"fieldset",title:IRm$.r1("B_TARGET"),layout:{type:"vbox",align:"stretch"},items:[{xtype:"gridpanel",name:"g1",height:300,store:{xtype:"store",fields:[]},columns:[{text:IRm$.r1("B_NAME"),dataIndex:"name"}],listeners:{cellclick:function(t,e,i,n,o,a){0==i&&this._act(n)},scope:this},tbar:[{iconCls:"icon-toolbar-add",text:IRm$.r1("B_ADD"),handler:function(){this._act()},scope:this},{iconCls:"icon-toolbar-remove",text:IRm$.r1("B_DELETE"),handler:function(){this._ldc()},scope:this},"-",{iconCls:"icon-toolbar-up",text:IRm$.r1("B_UP"),handler:function(){this._ldc()},scope:this},{iconCls:"icon-toolbar-down",text:IRm$.r1("B_DOWN"),handler:function(){this._ldc()},scope:this}]}]}]}],buttons:[{xtype:"button",text:IRm$.r1("B_DELETE"),hidden:!this.dbinfo,handler:function(){this._confirm("delete")},scope:this},"->",{xtype:"button",text:IRm$.r1("B_CONFIRM"),handler:function(){this._confirm("confirm")},scope:this},{xtype:"button",text:IRm$.r1("B_CANCEL"),handler:function(){this.close()},scope:this}]}),IG$.mongoJobEdt.superclass.initComponent.call(this)},listeners:{afterrender:function(t){t._init()}}});