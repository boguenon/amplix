!function(yr,br,xr,wr){function Ar(e){var t=new XMLHttpRequest;if(t.open("GET",e,!1),t.overrideMimeType&&t.overrideMimeType("text/plain"),t.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),t.send(null),200!==t.status&&0!==t.status)throw"XMLHttpRequest failed, status code "+t.status;return t.responseText}var Cr=function(){},e="console"in yr?function(e){yr.console.log("Processing.js: "+e)}:Cr(),i="document"in this&&!("fake"in this.document);function t(e,t){return e in yr?yr[e]:"function"==typeof yr[t]?yr[t]:function(e){if(e instanceof Array)return e;if("number"==typeof e){var t=[];return t.length=e,t}}}br.head=br.head||br.getElementsByTagName("head")[0];var Tr=t("Float32Array","WebGLFloatArray"),Sr=t("Int32Array","WebGLIntArray"),Pr=t("Uint16Array","WebGLUnsignedShortArray"),Er=t("Uint8Array","WebGLUnsignedByteArray"),_r={X:0,Y:1,Z:2,R:3,G:4,B:5,A:6,U:7,V:8,NX:9,NY:10,NZ:11,EDGE:12,SR:13,SG:14,SB:15,SA:16,SW:17,TX:18,TY:19,TZ:20,VX:21,VY:22,VZ:23,VW:24,AR:25,AG:26,AB:27,DR:3,DG:4,DB:5,DA:6,SPR:28,SPG:29,SPB:30,SHINE:31,ER:32,EG:33,EB:34,BEEN_LIT:35,VERTEX_FIELD_COUNT:36,P2D:1,JAVA2D:1,WEBGL:2,P3D:2,OPENGL:2,PDF:0,DXF:0,OTHER:0,WINDOWS:1,MAXOSX:2,LINUX:3,EPSILON:1e-4,MAX_FLOAT:34028235e31,MIN_FLOAT:-34028235e31,MAX_INT:2147483647,MIN_INT:-2147483648,PI:xr.PI,TWO_PI:2*xr.PI,HALF_PI:xr.PI/2,THIRD_PI:xr.PI/3,QUARTER_PI:xr.PI/4,DEG_TO_RAD:xr.PI/180,RAD_TO_DEG:180/xr.PI,WHITESPACE:" \t\n\r\fÂ ",RGB:1,ARGB:2,HSB:3,ALPHA:4,CMYK:5,TIFF:0,TARGA:1,JPEG:2,GIF:3,BLUR:11,GRAY:12,INVERT:13,OPAQUE:14,POSTERIZE:15,THRESHOLD:16,ERODE:17,DILATE:18,REPLACE:0,BLEND:1,ADD:2,SUBTRACT:4,LIGHTEST:8,DARKEST:16,DIFFERENCE:32,EXCLUSION:64,MULTIPLY:128,SCREEN:256,OVERLAY:512,HARD_LIGHT:1024,SOFT_LIGHT:2048,DODGE:4096,BURN:8192,ALPHA_MASK:4278190080,RED_MASK:16711680,GREEN_MASK:65280,BLUE_MASK:255,CUSTOM:0,ORTHOGRAPHIC:2,PERSPECTIVE:3,POINT:2,POINTS:2,LINE:4,LINES:4,TRIANGLE:8,TRIANGLES:9,TRIANGLE_STRIP:10,TRIANGLE_FAN:11,QUAD:16,QUADS:16,QUAD_STRIP:17,POLYGON:20,PATH:21,RECT:30,ELLIPSE:31,ARC:32,SPHERE:40,BOX:41,GROUP:0,PRIMITIVE:1,GEOMETRY:3,VERTEX:0,BEZIER_VERTEX:1,CURVE_VERTEX:2,BREAK:3,CLOSESHAPE:4,OPEN:1,CLOSE:2,CORNER:0,CORNERS:1,RADIUS:2,CENTER_RADIUS:2,CENTER:3,DIAMETER:3,CENTER_DIAMETER:3,BASELINE:0,TOP:101,BOTTOM:102,NORMAL:1,NORMALIZED:1,IMAGE:2,MODEL:4,SHAPE:5,SQUARE:"butt",ROUND:"round",PROJECT:"square",MITER:"miter",BEVEL:"bevel",AMBIENT:0,DIRECTIONAL:1,SPOT:3,BACKSPACE:8,TAB:9,ENTER:10,RETURN:13,ESC:27,DELETE:127,CODED:65535,SHIFT:16,CONTROL:17,ALT:18,CAPSLK:20,PGUP:33,PGDN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLK:144,META:157,INSERT:155,ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",NOCURSOR:"url('data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=='), auto",DISABLE_OPENGL_2X_SMOOTH:1,ENABLE_OPENGL_2X_SMOOTH:-1,ENABLE_OPENGL_4X_SMOOTH:2,ENABLE_NATIVE_FONTS:3,DISABLE_DEPTH_TEST:4,ENABLE_DEPTH_TEST:-4,ENABLE_DEPTH_SORT:5,DISABLE_DEPTH_SORT:-5,DISABLE_OPENGL_ERROR_REPORT:6,ENABLE_OPENGL_ERROR_REPORT:-6,ENABLE_ACCURATE_TEXTURES:7,DISABLE_ACCURATE_TEXTURES:-7,HINT_COUNT:10,SINCOS_LENGTH:720,PRECISIONB:15,PRECISIONF:32768,PREC_MAXVAL:32767,PREC_ALPHA_SHIFT:9,PREC_RED_SHIFT:1,NORMAL_MODE_AUTO:0,NORMAL_MODE_SHAPE:1,NORMAL_MODE_VERTEX:2,MAX_LIGHTS:8};function Rr(e){if("string"!=typeof e)return"object"!=typeof e?4294967295&e:e.hashCode instanceof Function?e.hashCode():(e.$id===wr&&(e.$id=xr.floor(65536*xr.random())-32768<<16|xr.floor(65536*xr.random())),e.$id);for(var t=0,n=0;n<e.length;++n)t=31*t+e.charCodeAt(n)&4294967295;return t}function f(e,t){return null===e||null===t?null===e&&null===t:"string"==typeof e?e===t:"object"!=typeof e?e===t:e.equals instanceof Function?e.equals(t):e===t}function s(e){if(e.iterator instanceof Function)return e.iterator();if(!(e instanceof Array))throw"Unable to iterate: "+e;var t=-1;this.hasNext=function(){return++t<e.length},this.next=function(){return e[t]}}function n(){var r;0===arguments.length?r=[]:0<arguments.length&&"number"!=typeof arguments[0]?r=arguments[0].toArray():(r=[]).length=0|arguments[0],this.get=function(e){return r[e]},this.contains=function(e){return-1<this.indexOf(e)},this.indexOf=function(e){for(var t=0,n=r.length;t<n;++t)if(f(e,r[t]))return t;return-1},this.add=function(){if(1===arguments.length)r.push(arguments[0]);else{if(2!==arguments.length)throw"Please use the proper number of parameters.";var e=arguments[0];if("number"!=typeof e)throw typeof e+" is not a number";if(!(0<=e&&e<=r.length))throw e+" is not a valid index";r.splice(e,0,arguments[1])}},this.addAll=function(e,t){var n;if("number"==typeof e){if(e<0||e>r.length)throw"Index out of bounds for addAll: "+e+" greater or equal than "+r.length;for(n=new s(t);n.hasNext();)r.splice(e++,0,n.next())}else for(n=new s(e);n.hasNext();)r.push(n.next())},this.set=function(){if(2!==arguments.length)throw"Please use the proper number of parameters.";var e=arguments[0];if("number"!=typeof e)throw typeof e+" is not a number";if(!(0<=e&&e<r.length))throw e+" is not a valid index.";r.splice(e,1,arguments[1])},this.size=function(){return r.length},this.clear=function(){r.length=0},this.remove=function(e){return"number"==typeof e?r.splice(e,1)[0]:-1<(e=this.indexOf(e))&&(r.splice(e,1),!0)},this.isEmpty=function(){return!r.length},this.clone=function(){return new n(this)},this.toArray=function(){return r.slice(0)},this.iterator=function(){return new o(r)}}function o(e){var t=0;this.hasNext=function(){return t<e.length},this.next=function(){return e[t++]},this.remove=function(){e.splice(t,1)}}function c(){if(1===arguments.length&&arguments[0]instanceof c)return arguments[0].clone();var e=0<arguments.length?arguments[0]:16,o=1<arguments.length?arguments[1]:.75,a=[];a.length=e;var l=0,r=this;function h(e){var t=Rr(e)%a.length;return t<0?a.length+t:t}function u(){if(!(l<=o*a.length)){for(var e=[],t=0;t<a.length;++t)a[t]!==wr&&(e=e.concat(a[t]));var n=2*a.length;(a=[]).length=n;for(var r=0;r<e.length;++r){var i=h(e[r].key),s=a[i];s===wr&&(a[i]=s=[]),s.push(e[r])}}}function n(t,e){var n=0,r=-1,i=!1;function s(){for(;!i;)if(++r,n>=a.length)i=!0;else{if(!(a[n]===wr||r>=a[n].length))return;r=-1,++n}}this.hasNext=function(){return!i},this.next=function(){var e=t(a[n][r]);return s(),e},this.remove=function(){e(this.next()),--r},s()}function t(e,t,s){this.clear=function(){r.clear()},this.contains=function(e){return t(e)},this.containsAll=function(e){for(var t=e.iterator();t.hasNext();)if(!this.contains(t.next()))return!1;return!0},this.isEmpty=function(){return r.isEmpty()},this.iterator=function(){return new n(e,s)},this.remove=function(e){return!!this.contains(e)&&(s(e),!0)},this.removeAll=function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.contains(n)&&s(n)}return!0},this.retainAll=function(e){for(var t=this.iterator(),n=[];t.hasNext();){var r=t.next();e.contains(r)||n.push(r)}for(var i=0;i<n.length;++i)s(n[i]);return 0<n.length},this.size=function(){return r.size()},this.toArray=function(){for(var e=[],t=this.iterator();t.hasNext();)e.push(t.next());return e}}function i(n){this._isIn=function(e){return e===r&&n.removed===wr},this.equals=function(e){return f(n.key,e.getKey())},this.getKey=function(){return n.key},this.getValue=function(){return n.value},this.hashCode=function(e){return Rr(n.key)},this.setValue=function(e){var t=n.value;return n.value=e,t}}this.clear=function(){l=0,(a=[]).length=e},this.clone=function(){var e=new c;return e.putAll(this),e},this.containsKey=function(e){var t=h(e),n=a[t];if(n===wr)return!1;for(var r=0;r<n.length;++r)if(f(n[r].key,e))return!0;return!1},this.containsValue=function(e){for(var t=0;t<a.length;++t){var n=a[t];if(n!==wr)for(var r=0;r<n.length;++r)if(f(n[r].value,e))return!0}return!1},this.entrySet=function(){return new t(function(e){return new i(e)},function(e){return e instanceof i&&e._isIn(r)},function(e){return r.remove(e.getKey())})},this.get=function(e){var t=h(e),n=a[t];if(n===wr)return null;for(var r=0;r<n.length;++r)if(f(n[r].key,e))return n[r].value;return null},this.isEmpty=function(){return 0===l},this.keySet=function(){return new t(function(e){return e.key},function(e){return r.containsKey(e)},function(e){return r.remove(e)})},this.values=function(){return new t(function(e){return e.value},function(e){return r.containsValue(e)},function(e){return r.removeByValue(e)})},this.put=function(e,t){var n=h(e),r=a[n];if(r===wr)return++l,a[n]=[{key:e,value:t}],u(),null;for(var i=0;i<r.length;++i)if(f(r[i].key,e)){var s=r[i].value;return r[i].value=t,s}return++l,r.push({key:e,value:t}),u(),null},this.putAll=function(e){for(var t=e.entrySet().iterator();t.hasNext();){var n=t.next();this.put(n.getKey(),n.getValue())}},this.remove=function(e){var t=h(e),n=a[t];if(n===wr)return null;for(var r=0;r<n.length;++r)if(f(n[r].key,e)){--l;var i=n[r].value;return n[r].removed=!0,1<n.length?n.splice(r,1):a[t]=wr,i}return null},this.removeByValue=function(e){var t,n,r;for(t in a)if(a.hasOwnProperty(t))for(n=0,r=a[t].length;n<r;n++)if(a[t][n].value===e)return a[t].splice(n,1),!0;return!1},this.size=function(){return l}}var kr=function(){function i(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function e(r){return function(e,t){var n=e.get();return n[r](t),n}}for(var t in i.dist=function(e,t){return e.dist(t)},i.dot=function(e,t){return e.dot(t)},i.cross=function(e,t){return e.cross(t)},i.angleBetween=function(e,t){return xr.acos(e.dot(t)/(e.mag()*t.mag()))},i.prototype={set:function(e,t,n){1===arguments.length?this.set(e.x||e[0]||0,e.y||e[1]||0,e.z||e[2]||0):(this.x=e,this.y=t,this.z=n)},get:function(){return new i(this.x,this.y,this.z)},mag:function(){var e=this.x,t=this.y,n=this.z;return xr.sqrt(e*e+t*t+n*n)},add:function(e,t,n){1===arguments.length?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=t,this.z+=n)},sub:function(e,t,n){1===arguments.length?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=t,this.z-=n)},mult:function(e){"number"==typeof e?(this.x*=e,this.y*=e,this.z*=e):(this.x*=e.x,this.y*=e.y,this.z*=e.z)},div:function(e){"number"==typeof e?(this.x/=e,this.y/=e,this.z/=e):(this.x/=e.x,this.y/=e.y,this.z/=e.z)},dist:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return xr.sqrt(t*t+n*n+r*r)},dot:function(e,t,n){return 1===arguments.length?this.x*e.x+this.y*e.y+this.z*e.z:this.x*e+this.y*t+this.z*n},cross:function(e){var t=this.x,n=this.y,r=this.z;return new i(n*e.z-e.y*r,r*e.x-e.z*t,t*e.y-e.x*n)},normalize:function(){var e=this.mag();0<e&&this.div(e)},limit:function(e){this.mag()>e&&(this.normalize(),this.mult(e))},heading2D:function(){return-xr.atan2(-this.y,this.x)},toString:function(){return"["+this.x+", "+this.y+", "+this.z+"]"},array:function(){return[this.x,this.y,this.z]}})i.prototype.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e(t));return i}();function r(){}r.prototype=_r;var Lr=new r;function a(e,n){function t(t){Lr.defineProperty(e,t,{get:function(){return n[t]},set:function(e){n[t]=e},enumerable:!0})}var r=[];for(var i in n)"function"==typeof n[i]?e.hasOwnProperty(i)||(e[i]=n[i]):"$"===i.charAt(0)||i in e||r.push(i);for(;0<r.length;)t(r.shift())}Lr.ArrayList=n,Lr.HashMap=c,Lr.PVector=kr,Lr.ObjectIterator=s,Lr.PConstants=_r,Lr.defineProperty=function(e,t,n){"defineProperty"in Object?Object.defineProperty(e,t,n):(n.hasOwnProperty("get")&&e.__defineGetter__(t,n.get),n.hasOwnProperty("set")&&e.__defineSetter__(t,n.set))},Lr.extendClassChain=function(e){for(var t=[e],n=e.$upcast;n;n=n.$upcast)a(n,e),t.push(n),e=n;for(;0<t.length;)t.pop().$self=e},Lr.extendStaticMembers=function(e,t){a(e,t)},Lr.extendInterfaceMembers=function(e,t){a(e,t)},Lr.addMethod=function(e,t,n,r){if(e[t]){var i=n.length,s=e[t];e[t]=function(){return arguments.length===i?n.apply(this,arguments):s.apply(this,arguments)}}else e[t]=n},Lr.createJavaArray=function(e,t){var n=null;if("number"==typeof t[0]){var r=0|t[0];if(t.length<=1){(n=[]).length=r;for(var i=0;i<r;++i)n[i]=0}else{n=[];for(var s=t.slice(1),o=0;o<r;++o)n.push(Lr.createJavaArray(e,s))}}return n};var Dr={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};!function(e){var t,n="open() createOutput() createInput() BufferedReader selectFolder() dataPath() createWriter() selectOutput() beginRecord() saveStream() endRecord() selectInput() saveBytes() createReader() beginRaw() endRaw() PrintWriter delay()".split(" "),r=n.length;function i(e){return function(){throw"Processing.js does not support "+e+"."}}for(;r--;)e[(t=n[r]).replace("()","")]=i(t)}(Lr),Lr.defineProperty(Lr,"screenWidth",{get:function(){return yr.innerWidth}}),Lr.defineProperty(Lr,"screenHeight",{get:function(){return yr.innerHeight}});var Ir=[],Or={};function Nr(e,t){e===wr&&(e=""),this.name=e,t===wr&&(t=0),this.size=t,this.glyph=!1,this.ascent=0,this.descent=0,this.leading=1.2*t;var n=e.indexOf(" Italic Bold");-1!==n&&(e=e.substring(0,n)),this.style="normal";var r=e.indexOf(" Italic");-1!==r&&(e=e.substring(0,r),this.style="italic"),this.weight="normal";var i=e.indexOf(" Bold");if(-1!==i&&(e=e.substring(0,i),this.weight="bold"),this.family="sans-serif",e!==wr)switch(e){case"sans-serif":case"serif":case"monospace":case"fantasy":case"cursive":this.family=e;break;default:this.family='"'+e+'", sans-serif'}this.context2d=null,function(e){var t=e.size/250,n=br.createElement("canvas");n.width=500,n.height=500,n.style.opacity=0;var r=e.getCSSDefinition("250px","normal"),i=n.getContext("2d");i.font=r,e.context2d=i;var s="dbflkhyjqpg";n.width=i.measureText(s).width,i.font=r;var o=br.createElement("div");o.style.position="absolute",o.style.opacity=0,o.style.fontFamily='"'+e.name+'"',o.style.fontSize="250px",o.innerHTML=s+"<br/>"+s,br.body.appendChild(o);var a=n.width,l=n.height,h=l/2;i.fillStyle="white",i.fillRect(0,0,a,l),i.fillStyle="black",i.fillText(s,0,h);for(var u=i.getImageData(0,0,a,l).data,f=0,c=4*a,p=u.length;++f<p&&255===u[f];)Cr();var g=xr.round(f/c);for(f=p-1;0<--f&&255===u[f];)Cr();var m=xr.round(f/c);if(e.ascent=t*(h-g),e.descent=t*(m-h),br.defaultView.getComputedStyle){var d=br.defaultView.getComputedStyle(o,null).getPropertyValue("height");(d=t*d.replace("px",""))>=2*e.size&&(e.leading=xr.round(d/2))}br.body.removeChild(o)}(this),this.css=this.getCSSDefinition(),this.context2d.font=this.css}Nr.prototype.getCSSDefinition=function(e,t){return e===wr&&(e=this.size+"px"),t===wr&&(t=this.leading+"px"),[this.style,"normal",this.weight,e+"/"+t,this.family].join(" ")},Nr.prototype.measureTextWidth=function(e){return this.context2d.measureText(e).width},Nr.PFontCache={},Nr.get=function(e,t){var n=Nr.PFontCache,r=e+"/"+t;return n[r]||(n[r]=new Nr(e,t)),n[r]},Nr.list=function(){return["sans-serif","serif","monospace","fantasy","cursive"]},Nr.preloading={template:{},initialized:!1,initialize:function(){var e=br.createElement("style");e.setAttribute("type","text/css"),e.innerHTML='@font-face {\n  font-family: "PjsEmptyFont";\n  src: url(\'data:application/x-font-ttf;base64,'+"#E3KAI2wAgT1MvMg7Eo3VmNtYX7ABi3CxnbHlm7Abw3kaGVhZ7ACs3OGhoZWE7A53CRobXR47AY3AGbG9jYQ7G03Bm1heH7ABC3CBuYW1l7Ae3AgcG9zd7AI3AE#B3AQ2kgTY18PPPUACwAg3ALSRoo3#yld0xg32QAB77#E777773B#E3C#I#Q77773E#Q7777777772CMAIw7AB77732B#M#Q3wAB#g3B#E#E2BB//82BB////w#B7#gAEg3E77x2B32B#E#Q#MTcBAQ32gAe#M#QQJ#E32M#QQJ#I#g32Q77#".replace(/[#237]/g,function(e){return"AAAAAAAA".substr(~~e?7-e:6)})+"')\n       format('truetype');\n}",br.head.appendChild(e);var t=br.createElement("span");t.style.cssText='position: absolute; top: 0; left: 0; opacity: 0; font-family: "PjsEmptyFont", fantasy;',t.innerHTML="AAAAAAAA",br.body.appendChild(t),this.template=t,this.initialized=!0},getElementWidth:function(e){return br.defaultView.getComputedStyle(e,"").getPropertyValue("width")},timeAttempted:0,pending:function(e){this.initialized||this.initialize();for(var t,n,r=this.getElementWidth(this.template),i=0;i<this.fontList.length;i++){if(t=this.fontList[i],n=this.getElementWidth(t),this.timeAttempted<4e3&&n===r)return this.timeAttempted+=e,!0;br.body.removeChild(t),this.fontList.splice(i--,1),this.timeAttempted=0}return 0!==this.fontList.length},fontList:[],addedList:{},add:function(e){this.initialized||this.initialize();var t="object"==typeof e?e.fontFace:e,n="object"==typeof e?e.url:e;if(!this.addedList[t]){var r=br.createElement("style");r.setAttribute("type","text/css"),r.innerHTML="@font-face{\n  font-family: '"+t+"';\n  src:  url('"+n+"');\n}\n",br.head.appendChild(r),this.addedList[t]=!0;var i=br.createElement("span");i.style.cssText="position: absolute; top: 0; left: 0; opacity: 0;",i.style.fontFamily='"'+t+'", "PjsEmptyFont", fantasy',i.innerHTML="AAAAAAAA",br.body.appendChild(i),this.fontList.push(i)}}},Lr.PFont=Nr;var Fr=this.Processing=function(e,t){if(!(this instanceof Fr))throw"called Processing constructor as if it were a function: missing 'new'.";var l,n=e===wr&&t===wr;if(!((l=n?br.createElement("canvas"):"string"==typeof e?br.getElementById(e):e)instanceof HTMLCanvasElement))throw"called Processing constructor without passing canvas element reference or id.";function r(e){Fr.debug("Unimplemented - "+e)}var $=this;$.externals={canvas:l,context:wr,sketch:wr},$.name="Processing.js Instance",$.use3DContext=!1,$.focused=!1,$.breakShape=!1,$.glyphTable={},$.pmouseX=0,$.pmouseY=0,$.mouseX=0,$.mouseY=0,$.mouseButton=0,$.mouseScroll=0,$.mouseClicked=wr,$.mouseDragged=wr,$.mouseMoved=wr,$.mousePressed=wr,$.mouseReleased=wr,$.mouseScrolled=wr,$.mouseOver=wr,$.mouseOut=wr,$.touchStart=wr,$.touchEnd=wr,$.touchMove=wr,$.touchCancel=wr,$.key=wr,$.keyCode=wr,$.keyPressed=Cr,$.keyReleased=Cr,$.keyTyped=Cr,$.draw=wr,$.setup=wr,$.__mousePressed=!1,$.__keyPressed=!1,$.__frameRate=60,$.frameCount=0,$.width=100,$.height=100;var m,h,A,c,i,s,P,d,o,v,y,p,g,u,f,b,x,w,C,T,a,S,E,_,R,k,L,D,I,O,N,F,M,z,B,V,U=!0,G=[1,1,1,1],X=4294967295,Y=!0,H=!0,Z=[0,0,0,1],W=4278190080,j=!0,q=1,K=!1,J=!0,Q=0,ee=0,te=3,ne=0,re=0,ie=0,se=0,oe=60,ae=1e3/oe,le=l.style.cursor,he=20,ue=0,fe=20,ce=!1,pe=-3355444,ge=20,me=255,de=255,ve=255,ye=255,be=0,xe=0,we=1,Ae=null,Ce=null,Te=Date.now(),Se=Te,Pe=0,Ee={attributes:{},locations:{}},_e={width:0,height:0},Re=2,ke=!1,Le=37,De=0,Ie=4,Oe="Arial",Ne=12,Fe=9,Me=2,$e=14,ze=Nr.get(Oe,Ne),Be=null,Ve=!1,Ue=1e3,Ge=[],Xe=null,Ye=[16,17,18,20,33,34,35,36,37,38,39,40,144,155,112,113,114,115,116,117,118,119,120,121,122,123,157];br.defaultView&&br.defaultView.getComputedStyle&&(M=parseInt(br.defaultView.getComputedStyle(l,null).paddingLeft,10)||0,z=parseInt(br.defaultView.getComputedStyle(l,null).paddingTop,10)||0,B=parseInt(br.defaultView.getComputedStyle(l,null).borderLeftWidth,10)||0,V=parseInt(br.defaultView.getComputedStyle(l,null).borderTopWidth,10)||0);var He,Ze,We,je,qe,Ke,Je,Qe,et,tt=0,nt=0,rt=0,it=[],st=[],ot=[],at=new Tr(720),lt=new Tr(720),ht=!1,ut=xr.PI/180*60,ft=$.width/2,ct=$.height/2,pt=ct/xr.tan(ut/2),gt=pt/10,mt=10*pt,dt=$.width/$.height,vt=[],yt=[],bt=0,xt=!1,wt=!1,At=!0,Ct=0,Tt=[],St=new Tr([.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]),Pt=new Tr([.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5]),Et=new Tr([0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]),_t=new Tr([0,0,0,0,1,0,1,1,0,1,0,0]),Rt=new Tr([0,0,1,0,0,1,0,0,1,0,0,1]),kt="varying vec4 frontColor;attribute vec3 Vertex;attribute vec3 Normal;attribute vec4 aColor;attribute vec2 aTexture;varying   vec2 vTexture;uniform vec4 color;uniform bool usingMat;uniform vec3 specular;uniform vec3 mat_emissive;uniform vec3 mat_ambient;uniform vec3 mat_specular;uniform float shininess;uniform mat4 model;uniform mat4 view;uniform mat4 projection;uniform mat4 normalTransform;uniform int lightCount;uniform vec3 falloff;struct Light {  int type;  vec3 color;  vec3 position;  vec3 direction;  float angle;  vec3 halfVector;  float concentration;};uniform Light lights0;uniform Light lights1;uniform Light lights2;uniform Light lights3;uniform Light lights4;uniform Light lights5;uniform Light lights6;uniform Light lights7;Light getLight(int index){  if(index == 0) return lights0;  if(index == 1) return lights1;  if(index == 2) return lights2;  if(index == 3) return lights3;  if(index == 4) return lights4;  if(index == 5) return lights5;  if(index == 6) return lights6;  return lights7;}void AmbientLight( inout vec3 totalAmbient, in vec3 ecPos, in Light light ) {  float d = length( light.position - ecPos );  float attenuation = 1.0 / ( falloff[0] + ( falloff[1] * d ) + ( falloff[2] * d * d ));  totalAmbient += light.color * attenuation;}void DirectionalLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float powerfactor = 0.0;  float nDotVP = max(0.0, dot( vertNormal, normalize(-light.position) ));  float nDotVH = max(0.0, dot( vertNormal, normalize(-light.position-normalize(ecPos) )));  if( nDotVP != 0.0 ){    powerfactor = pow( nDotVH, shininess );  }  col += light.color * nDotVP;  spec += specular * powerfactor;}void PointLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float powerfactor;   vec3 VP = light.position - ecPos;  float d = length( VP );   VP = normalize( VP );  float attenuation = 1.0 / ( falloff[0] + ( falloff[1] * d ) + ( falloff[2] * d * d ));  float nDotVP = max( 0.0, dot( vertNormal, VP ));  vec3 halfVector = normalize( VP - normalize(ecPos) );  float nDotHV = max( 0.0, dot( vertNormal, halfVector ));  if( nDotVP == 0.0) {    powerfactor = 0.0;  }  else{    powerfactor = pow( nDotHV, shininess );  }  spec += specular * powerfactor * attenuation;  col += light.color * nDotVP * attenuation;}void SpotLight( inout vec3 col, inout vec3 spec, in vec3 vertNormal, in vec3 ecPos, in Light light ) {  float spotAttenuation;  float powerfactor;  vec3 VP = light.position - ecPos;   vec3 ldir = normalize( -light.direction );  float d = length( VP );  VP = normalize( VP );  float attenuation = 1.0 / ( falloff[0] + ( falloff[1] * d ) + ( falloff[2] * d * d ) );  float spotDot = dot( VP, ldir );"+(/Windows/.test(navigator.userAgent)?"  spotAttenuation = 1.0; ":"  if( spotDot > cos( light.angle ) ) {    spotAttenuation = pow( spotDot, light.concentration );  }  else{    spotAttenuation = 0.0;  }  attenuation *= spotAttenuation;")+"  float nDotVP = max( 0.0, dot( vertNormal, VP ));  vec3 halfVector = normalize( VP - normalize(ecPos) );  float nDotHV = max( 0.0, dot( vertNormal, halfVector ));  if( nDotVP == 0.0 ) {    powerfactor = 0.0;  }  else {    powerfactor = pow( nDotHV, shininess );  }  spec += specular * powerfactor * attenuation;  col += light.color * nDotVP * attenuation;}void main(void) {  vec3 finalAmbient = vec3( 0.0, 0.0, 0.0 );  vec3 finalDiffuse = vec3( 0.0, 0.0, 0.0 );  vec3 finalSpecular = vec3( 0.0, 0.0, 0.0 );  vec4 col = color;  if(color[0] == -1.0){    col = aColor;  }  vec3 norm = normalize(vec3( normalTransform * vec4( Normal, 0.0 ) ));  vec4 ecPos4 = view * model * vec4(Vertex,1.0);  vec3 ecPos = (vec3(ecPos4))/ecPos4.w;  if( lightCount == 0 ) {    frontColor = col + vec4(mat_specular,1.0);  }  else {    for( int i = 0; i < 8; i++ ) {      Light l = getLight(i);      if( i >= lightCount ){        break;      }      if( l.type == 0 ) {        AmbientLight( finalAmbient, ecPos, l );      }      else if( l.type == 1 ) {        DirectionalLight( finalDiffuse, finalSpecular, norm, ecPos, l );      }      else if( l.type == 2 ) {        PointLight( finalDiffuse, finalSpecular, norm, ecPos, l );      }      else {        SpotLight( finalDiffuse, finalSpecular, norm, ecPos, l );      }    }   if( usingMat == false ) {     frontColor = vec4(       vec3(col) * finalAmbient +       vec3(col) * finalDiffuse +       vec3(col) * finalSpecular,       col[3] );   }   else{     frontColor = vec4(        mat_emissive +        (vec3(col) * mat_ambient * finalAmbient) +        (vec3(col) * finalDiffuse) +        (mat_specular * finalSpecular),        col[3] );    }  }  vTexture.xy = aTexture.xy;  gl_Position = projection * view * model * vec4( Vertex, 1.0 );}";function Lt(e,t,n,r){var i=Ee.locations[e];i===wr&&(i=m.getUniformLocation(t,n),Ee.locations[e]=i),null!==i&&(4===r.length?m.uniform4fv(i,r):3===r.length?m.uniform3fv(i,r):2===r.length?m.uniform2fv(i,r):m.uniform1f(i,r))}function Dt(e,t,n,r){var i=Ee.locations[e];i===wr&&(i=m.getUniformLocation(t,n),Ee.locations[e]=i),null!==i&&(4===r.length?m.uniform4iv(i,r):3===r.length?m.uniform3iv(i,r):2===r.length?m.uniform2iv(i,r):m.uniform1i(i,r))}function It(e,t,n,r,i){var s=Ee.locations[e];s===wr&&(s=m.getUniformLocation(t,n),Ee.locations[e]=s),-1!==s&&(16===i.length?m.uniformMatrix4fv(s,r,i):9===i.length?m.uniformMatrix3fv(s,r,i):m.uniformMatrix2fv(s,r,i))}function Ot(e,t,n,r,i){var s=Ee.attributes[e];s===wr&&(s=m.getAttribLocation(t,n),Ee.attributes[e]=s),-1!==s&&(m.bindBuffer(m.ARRAY_BUFFER,i),m.vertexAttribPointer(s,r,m.FLOAT,!1,0,0),m.enableVertexAttribArray(s))}function Nt(e,t,n){var r=Ee.attributes[e];r===wr&&(r=m.getAttribLocation(t,n),Ee.attributes[e]=r),-1!==r&&m.disableVertexAttribArray(r)}function Ft(e,t,n){var r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw e.getShaderInfoLog(r);var i=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw e.getShaderInfoLog(i);var s=e.createProgram();if(e.attachShader(s,r),e.attachShader(s,i),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS))throw"Error linking shaders.";return s}function Mt(e,t,n,r,i){return{x:e,y:t,w:n,h:r}}function $t(e,t,n,r,i){return{x:e,y:t,w:i?n:n-e,h:i?r:r-t}}function zt(e,t,n,r,i){return{x:e-n/2,y:t-r/2,w:n,h:r}}function Bt(){}var Vt=Mt,Ut=function(){},Gt=function(){},Xt=function(){};Ut.prototype=new Bt,Ut.prototype.constructor=Ut,Gt.prototype=new Bt,Gt.prototype.constructor=Gt,Xt.prototype=new Bt,Xt.prototype.constructor=Xt,Bt.prototype.a3DOnlyFunction=Cr;var Yt={},Ht=$.Character=function(e){return"string"==typeof e&&1===e.length?this.code=e.charCodeAt(0):this.code="number"==typeof e?e:e instanceof Ht?e:NaN,Yt[this.code]===wr?Yt[this.code]=this:Yt[this.code]};Ht.prototype.toString=function(){return String.fromCharCode(this.code)},Ht.prototype.valueOf=function(){return this.code};var Zt=$.PShape=function(e){this.family=e||0,this.visible=!0,this.style=!0,this.children=[],this.nameTable=[],this.params=[],this.name="",this.image=null,this.matrix=null,this.kind=null,this.close=null,this.width=null,this.height=null,this.parent=null};Zt.prototype={isVisible:function(){return this.visible},setVisible:function(e){this.visible=e},disableStyle:function(){this.style=!1;for(var e=0,t=this.children.length;e<t;e++)this.children[e].disableStyle()},enableStyle:function(){this.style=!0;for(var e=0,t=this.children.length;e<t;e++)this.children[e].enableStyle()},getFamily:function(){return this.family},getWidth:function(){return this.width},getHeight:function(){return this.height},setName:function(e){this.name=e},getName:function(){return this.name},draw:function(){this.visible&&(this.pre(),this.drawImpl(),this.post())},drawImpl:function(){0===this.family?this.drawGroup():1===this.family?this.drawPrimitive():3===this.family?this.drawGeometry():21===this.family&&this.drawPath()},drawPath:function(){var e,t;if(0!==this.vertices.length){if($.beginShape(),0===this.vertexCodes.length)if(2===this.vertices[0].length)for(e=0,t=this.vertices.length;e<t;e++)$.vertex(this.vertices[e][0],this.vertices[e][1]);else for(e=0,t=this.vertices.length;e<t;e++)$.vertex(this.vertices[e][0],this.vertices[e][1],this.vertices[e][2]);else{var n=0;if(2===this.vertices[0].length)for(e=0,t=this.vertexCodes.length;e<t;e++)0===this.vertexCodes[e]?($.vertex(this.vertices[n][0],this.vertices[n][1]),!0===this.vertices[n].moveTo?vt[vt.length-1].moveTo=!0:!1===this.vertices[n].moveTo&&(vt[vt.length-1].moveTo=!1),$.breakShape=!1,n++):1===this.vertexCodes[e]?($.bezierVertex(this.vertices[n+0][0],this.vertices[n+0][1],this.vertices[n+1][0],this.vertices[n+1][1],this.vertices[n+2][0],this.vertices[n+2][1]),n+=3):2===this.vertexCodes[e]?($.curveVertex(this.vertices[n][0],this.vertices[n][1]),n++):3===this.vertexCodes[e]&&($.breakShape=!0);else for(e=0,t=this.vertexCodes.length;e<t;e++)0===this.vertexCodes[e]?($.vertex(this.vertices[n][0],this.vertices[n][1],this.vertices[n][2]),!0===this.vertices[n].moveTo?vt[vt.length-1].moveTo=!0:!1===this.vertices[n].moveTo&&(vt[vt.length-1].moveTo=!1),$.breakShape=!1):1===this.vertexCodes[e]?($.bezierVertex(this.vertices[n+0][0],this.vertices[n+0][1],this.vertices[n+0][2],this.vertices[n+1][0],this.vertices[n+1][1],this.vertices[n+1][2],this.vertices[n+2][0],this.vertices[n+2][1],this.vertices[n+2][2]),n+=3):2===this.vertexCodes[e]?($.curveVertex(this.vertices[n][0],this.vertices[n][1],this.vertices[n][2]),n++):3===this.vertexCodes[e]&&($.breakShape=!0)}$.endShape(this.close?2:1)}},drawGeometry:function(){var e,t;if($.beginShape(this.kind),this.style)for(e=0,t=this.vertices.length;e<t;e++)$.vertex(this.vertices[e]);else for(e=0,t=this.vertices.length;e<t;e++){var n=this.vertices[e];0===n[2]?$.vertex(n[0],n[1]):$.vertex(n[0],n[1],n[2])}$.endShape()},drawGroup:function(){for(var e=0,t=this.children.length;e<t;e++)this.children[e].draw()},drawPrimitive:function(){2===this.kind?$.point(this.params[0],this.params[1]):4===this.kind?4===this.params.length?$.line(this.params[0],this.params[1],this.params[2],this.params[3]):$.line(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]):8===this.kind?$.triangle(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5]):16===this.kind?$.quad(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5],this.params[6],this.params[7]):30===this.kind?null!==this.image?($.imageMode(0),$.image(this.image,this.params[0],this.params[1],this.params[2],this.params[3])):($.rectMode(0),$.rect(this.params[0],this.params[1],this.params[2],this.params[3])):31===this.kind?($.ellipseMode(0),$.ellipse(this.params[0],this.params[1],this.params[2],this.params[3])):32===this.kind?($.ellipseMode(0),$.arc(this.params[0],this.params[1],this.params[2],this.params[3],this.params[4],this.params[5])):41===this.kind?1===this.params.length?$.box(this.params[0]):$.box(this.params[0],this.params[1],this.params[2]):40===this.kind&&$.sphere(this.params[0])},pre:function(){this.matrix&&($.pushMatrix(),m.transform(this.matrix.elements[0],this.matrix.elements[3],this.matrix.elements[1],this.matrix.elements[4],this.matrix.elements[2],this.matrix.elements[5])),this.style&&($.pushStyle(),this.styles())},post:function(){this.matrix&&$.popMatrix(),this.style&&$.popStyle()},styles:function(){this.stroke?($.stroke(this.strokeColor),$.strokeWeight(this.strokeWeight),$.strokeCap(this.strokeCap),$.strokeJoin(this.strokeJoin)):$.noStroke(),this.fill?$.fill(this.fillColor):$.noFill()},getChild:function(e){var t,n,r;if("number"==typeof e)return this.children[e];if(""===e||this.name===e)return this;if(0<this.nameTable.length){for(t=0,n=this.nameTable.length;t<n||r;t++)if(this.nameTable[t].getName===e){r=this.nameTable[t];break}if(r)return r}for(t=0,n=this.children.length;t<n;t++)if(r=this.children[t].getChild(e))return r;return null},getChildCount:function(){return this.children.length},addChild:function(e){this.children.push(e),e.parent=this,null!==e.getName()&&this.addName(e.getName(),e)},addName:function(e,t){null!==this.parent?this.parent.addName(e,t):this.nameTable.push([e,t])},translate:function(){2===arguments.length?(this.checkMatrix(2),this.matrix.translate(arguments[0],arguments[1])):(this.checkMatrix(3),this.matrix.translate(arguments[0],arguments[1],0))},checkMatrix:function(e){null===this.matrix?this.matrix=2===e?new $.PMatrix2D:new $.PMatrix3D:3===e&&this.matrix instanceof $.PMatrix2D&&(this.matrix=new $.PMatrix3D)},rotateX:function(e){this.rotate(e,1,0,0)},rotateY:function(e){this.rotate(e,0,1,0)},rotateZ:function(e){this.rotate(e,0,0,1)},rotate:function(){1===arguments.length?(this.checkMatrix(2),this.matrix.rotate(arguments[0])):(this.checkMatrix(3),this.matrix.rotate(arguments[0],arguments[1],arguments[2],arguments[3]))},scale:function(){2===arguments.length?(this.checkMatrix(2),this.matrix.scale(arguments[0],arguments[1])):3===arguments.length?(this.checkMatrix(2),this.matrix.scale(arguments[0],arguments[1],arguments[2])):(this.checkMatrix(2),this.matrix.scale(arguments[0]))},resetMatrix:function(){this.checkMatrix(2),this.matrix.reset()},applyMatrix:function(e){1===arguments.length?this.applyMatrix(e.elements[0],e.elements[1],0,e.elements[2],e.elements[3],e.elements[4],0,e.elements[5],0,0,1,0,0,0,0,1):6===arguments.length?(this.checkMatrix(2),this.matrix.apply(e,arguments[1],arguments[2],0,arguments[3],arguments[4],arguments[5],0,0,0,1,0,0,0,0,1)):16===arguments.length&&(this.checkMatrix(3),this.matrix.apply(e,arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11],arguments[12],arguments[13],arguments[14],arguments[15]))}};var Wt=$.PShapeSVG=function(){if($.PShape.call(this),1===arguments.length){if(this.element=arguments[0],this.vertexCodes=[],this.vertices=[],this.opacity=1,this.stroke=!1,this.strokeColor=4278190080,this.strokeWeight=1,this.strokeCap="butt",this.strokeJoin="miter",this.strokeGradient=null,this.strokeGradientPaint=null,this.strokeName=null,this.strokeOpacity=1,this.fill=!0,this.fillColor=4278190080,this.fillGradient=null,this.fillGradientPaint=null,this.fillName=null,this.fillOpacity=1,"svg"!==this.element.getName())throw"root is not <svg>, it's <"+this.element.getName()+">"}else 2===arguments.length&&("string"==typeof arguments[1]?-1<arguments[1].indexOf(".svg")&&(this.element=new $.XMLElement(null,arguments[1]),this.vertexCodes=[],this.vertices=[],this.opacity=1,this.stroke=!1,this.strokeColor=4278190080,this.strokeWeight=1,this.strokeCap="butt",this.strokeJoin="miter",this.strokeGradient="",this.strokeGradientPaint="",this.strokeName="",this.strokeOpacity=1,this.fill=!0,this.fillColor=4278190080,this.fillGradient=null,this.fillGradientPaint=null,this.fillOpacity=1):arguments[0]&&(this.element=arguments[1],this.vertexCodes=arguments[0].vertexCodes.slice(),this.vertices=arguments[0].vertices.slice(),this.stroke=arguments[0].stroke,this.strokeColor=arguments[0].strokeColor,this.strokeWeight=arguments[0].strokeWeight,this.strokeCap=arguments[0].strokeCap,this.strokeJoin=arguments[0].strokeJoin,this.strokeGradient=arguments[0].strokeGradient,this.strokeGradientPaint=arguments[0].strokeGradientPaint,this.strokeName=arguments[0].strokeName,this.fill=arguments[0].fill,this.fillColor=arguments[0].fillColor,this.fillGradient=arguments[0].fillGradient,this.fillGradientPaint=arguments[0].fillGradientPaint,this.fillName=arguments[0].fillName,this.strokeOpacity=arguments[0].strokeOpacity,this.fillOpacity=arguments[0].fillOpacity,this.opacity=arguments[0].opacity));this.name=this.element.getStringAttribute("id");var e=this.element.getStringAttribute("display","inline");this.visible="none"!==e;var t=this.element.getAttribute("transform");t&&(this.matrix=this.parseMatrix(t));var n=this.element.getStringAttribute("viewBox");if(null!==n){var r=n.split(" ");this.width=r[2],this.height=r[3]}var i=this.element.getStringAttribute("width"),s=this.element.getStringAttribute("height");if(null!==i)this.width=this.parseUnitSize(i),this.height=this.parseUnitSize(s);else if(0===this.width||0===this.height)throw this.width=1,this.height=1,"The width and/or height is not readable in the <svg> tag of this file.";this.parseColors(this.element),this.parseChildren(this.element)};function jt(e){var n=[];return e.replace(/\((.*?)\)/,function(e,t){n=t.replace(/,+/g," ").split(/\s+/)}),n}Wt.prototype=new Zt,Wt.prototype.parseMatrix=function(e){this.checkMatrix(2);var t=[];if(e.replace(/\s*(\w+)\((.*?)\)/g,function(e){t.push($.trim(e))}),0===t.length)return null;for(var n=0,r=t.length;n<r;n++){var i=jt(t[n]);if(-1!==t[n].indexOf("matrix"))this.matrix.set(i[0],i[2],i[4],i[1],i[3],i[5]);else if(-1!==t[n].indexOf("translate")){var s=i[0],o=2===i.length?i[1]:0;this.matrix.translate(s,o)}else if(-1!==t[n].indexOf("scale")){var a=i[0],l=2===i.length?i[1]:i[0];this.matrix.scale(a,l)}else if(-1!==t[n].indexOf("rotate")){var h=i[0];1===i.length?this.matrix.rotate($.radians(h)):3===i.length&&(this.matrix.translate(i[1],i[2]),this.matrix.rotate($.radians(i[0])),this.matrix.translate(-i[1],-i[2]))}else-1!==t[n].indexOf("skewX")?this.matrix.skewX(parseFloat(i[0])):-1!==t[n].indexOf("skewY")&&this.matrix.skewY(i[0])}return this.matrix},Wt.prototype.parseChildren=function(e){for(var t=e.getChildren(),n=new $.PShape,r=0,i=t.length;r<i;r++){var s=this.parseChild(t[r]);s&&n.addChild(s)}this.children.push(n)},Wt.prototype.getName=function(){return this.name},Wt.prototype.parseChild=function(e){var t,n=e.getName();return"g"===n?t=new Wt(this,e):"defs"===n?t=new Wt(this,e):"line"===n?(t=new Wt(this,e)).parseLine():"circle"===n?(t=new Wt(this,e)).parseEllipse(!0):"ellipse"===n?(t=new Wt(this,e)).parseEllipse(!1):"rect"===n?(t=new Wt(this,e)).parseRect():"polygon"===n?(t=new Wt(this,e)).parsePoly(!0):"polyline"===n?(t=new Wt(this,e)).parsePoly(!1):"path"===n?(t=new Wt(this,e)).parsePath():"radialGradient"===n?r("PShapeSVG.prototype.parseChild, name = radialGradient"):"linearGradient"===n?r("PShapeSVG.prototype.parseChild, name = linearGradient"):"text"===n?r("PShapeSVG.prototype.parseChild, name = text"):"filter"===n?r("PShapeSVG.prototype.parseChild, name = filter"):"mask"===n?r("PShapeSVG.prototype.parseChild, name = mask"):Cr(),t},Wt.prototype.parsePath=function(){this.family=21,this.kind=0;var e=$.trim(this.element.getStringAttribute("d").replace(/[\s,]+/g," "));if(null!==e){e=$.__toCharArray(e);for(var t,n,r,i,s=0,o=0,a=0,l=0,h=0,u=0,f=0,c=0,p=0,g=0,m=0,d=0,v=0,y=0,b=0,x=0,w="",A=[],C=!1;b<e.length;)if(65<=(x=e[b].valueOf())&&x<=90||97<=x&&x<=122){if(r=b,++b<e.length)for(A=[],x=e[b].valueOf();!(65<=x&&x<=90||97<=x&&x<=100||102<=x&&x<=122)&&!1===C;)32===x?""!==w&&(A.push(parseFloat(w)),w=""):45===x?101===e[b-1].valueOf()?w+=e[b].toString():(""!==w&&A.push(parseFloat(w)),w=e[b].toString()):w+=e[b].toString(),++b===e.length?C=!0:x=e[b].valueOf();if(""!==w&&(A.push(parseFloat(w)),w=""),77===(x=(n=e[r]).valueOf())){if(2<=A.length&&A.length%2==0&&(s=A[0],o=A[1],this.parsePathMoveto(s,o),2<A.length))for(r=2,i=A.length;r<i;r+=2)s=A[r],o=A[r+1],this.parsePathLineto(s,o)}else if(109===x){if(2<=A.length&&A.length%2==0&&(s+=A[0],o+=A[1],this.parsePathMoveto(s,o),2<A.length))for(r=2,i=A.length;r<i;r+=2)s+=A[r],o+=A[r+1],this.parsePathLineto(s,o)}else if(76===x){if(2<=A.length&&A.length%2==0)for(r=0,i=A.length;r<i;r+=2)s=A[r],o=A[r+1],this.parsePathLineto(s,o)}else if(108===x){if(2<=A.length&&A.length%2==0)for(r=0,i=A.length;r<i;r+=2)s+=A[r],o+=A[r+1],this.parsePathLineto(s,o)}else if(72===x)for(r=0,i=A.length;r<i;r++)s=A[r],this.parsePathLineto(s,o);else if(104===x)for(r=0,i=A.length;r<i;r++)s+=A[r],this.parsePathLineto(s,o);else if(86===x)for(r=0,i=A.length;r<i;r++)o=A[r],this.parsePathLineto(s,o);else if(118===x)for(r=0,i=A.length;r<i;r++)o+=A[r],this.parsePathLineto(s,o);else if(67===x){if(6<=A.length&&A.length%6==0)for(r=0,i=A.length;r<i;r+=6)h=A[r],f=A[r+1],u=A[r+2],c=A[r+3],p=A[r+4],g=A[r+5],this.parsePathCurveto(h,f,u,c,p,g),s=p,o=g}else if(99===x){if(6<=A.length&&A.length%6==0)for(r=0,i=A.length;r<i;r+=6)h=s+A[r],f=o+A[r+1],u=s+A[r+2],c=o+A[r+3],p=s+A[r+4],g=o+A[r+5],this.parsePathCurveto(h,f,u,c,p,g),s=p,o=g}else if(83===x){if(4<=A.length&&A.length%4==0)for(r=0,i=A.length;r<i;r+=4)f="c"===t.toLowerCase()||"s"===t.toLowerCase()?(m=this.vertices[this.vertices.length-2][0],d=this.vertices[this.vertices.length-2][1],h=(v=this.vertices[this.vertices.length-1][0])+(v-m),(y=this.vertices[this.vertices.length-1][1])+(y-d)):(h=this.vertices[this.vertices.length-1][0],this.vertices[this.vertices.length-1][1]),u=A[r],c=A[r+1],p=A[r+2],g=A[r+3],this.parsePathCurveto(h,f,u,c,p,g),s=p,o=g}else if(115===x){if(4<=A.length&&A.length%4==0)for(r=0,i=A.length;r<i;r+=4)f="c"===t.toLowerCase()||"s"===t.toLowerCase()?(m=this.vertices[this.vertices.length-2][0],d=this.vertices[this.vertices.length-2][1],h=(v=this.vertices[this.vertices.length-1][0])+(v-m),(y=this.vertices[this.vertices.length-1][1])+(y-d)):(h=this.vertices[this.vertices.length-1][0],this.vertices[this.vertices.length-1][1]),u=s+A[r],c=o+A[r+1],p=s+A[r+2],g=o+A[r+3],this.parsePathCurveto(h,f,u,c,p,g),s=p,o=g}else if(81===x){if(4<=A.length&&A.length%4==0)for(r=0,i=A.length;r<i;r+=4)a=A[r],l=A[r+1],p=A[r+2],g=A[r+3],this.parsePathQuadto(s,o,a,l,p,g),s=p,o=g}else if(113===x){if(4<=A.length&&A.length%4==0)for(r=0,i=A.length;r<i;r+=4)a=s+A[r],l=o+A[r+1],p=s+A[r+2],g=o+A[r+3],this.parsePathQuadto(s,o,a,l,p,g),s=p,o=g}else if(84===x){if(2<=A.length&&A.length%2==0)for(r=0,i=A.length;r<i;r+=2)l="q"===t.toLowerCase()||"t"===t.toLowerCase()?(m=this.vertices[this.vertices.length-2][0],d=this.vertices[this.vertices.length-2][1],a=(v=this.vertices[this.vertices.length-1][0])+(v-m),(y=this.vertices[this.vertices.length-1][1])+(y-d)):(a=s,o),p=A[r],g=A[r+1],this.parsePathQuadto(s,o,a,l,p,g),s=p,o=g}else if(116===x){if(2<=A.length&&A.length%2==0)for(r=0,i=A.length;r<i;r+=2)l="q"===t.toLowerCase()||"t"===t.toLowerCase()?(m=this.vertices[this.vertices.length-2][0],d=this.vertices[this.vertices.length-2][1],a=(v=this.vertices[this.vertices.length-1][0])+(v-m),(y=this.vertices[this.vertices.length-1][1])+(y-d)):(a=s,o),p=s+A[r],g=o+A[r+1],this.parsePathQuadto(s,o,a,l,p,g),s=p,o=g}else 90!==x&&122!==x||(this.close=!0);t=n.toString()}else b++}},Wt.prototype.parsePathQuadto=function(e,t,n,r,i,s){if(!(0<this.vertices.length))throw"Path must start with M/m";this.parsePathCode(1),this.parsePathVertex(e+2*(n-e)/3,t+2*(r-t)/3),this.parsePathVertex(i+2*(n-i)/3,s+2*(r-s)/3),this.parsePathVertex(i,s)},Wt.prototype.parsePathCurveto=function(e,t,n,r,i,s){if(!(0<this.vertices.length))throw"Path must start with M/m";this.parsePathCode(1),this.parsePathVertex(e,t),this.parsePathVertex(n,r),this.parsePathVertex(i,s)},Wt.prototype.parsePathLineto=function(e,t){if(!(0<this.vertices.length))throw"Path must start with M/m";this.parsePathCode(0),this.parsePathVertex(e,t),this.vertices[this.vertices.length-1].moveTo=!1},Wt.prototype.parsePathMoveto=function(e,t){0<this.vertices.length&&this.parsePathCode(3),this.parsePathCode(0),this.parsePathVertex(e,t),this.vertices[this.vertices.length-1].moveTo=!0},Wt.prototype.parsePathVertex=function(e,t){var n=[];n[0]=e,n[1]=t,this.vertices.push(n)},Wt.prototype.parsePathCode=function(e){this.vertexCodes.push(e)},Wt.prototype.parsePoly=function(e){this.family=21,this.close=e;var t=$.trim(this.element.getStringAttribute("points").replace(/[,\s]+/g," "));if(null!==t){var n=t.split(" ");if(n.length%2!=0)throw"Error parsing polygon points: odd number of coordinates provided";for(var r=0,i=n.length;r<i;r++){var s=[];s[0]=n[r],s[1]=n[++r],this.vertices.push(s)}}},Wt.prototype.parseRect=function(){if(this.kind=30,this.family=1,this.params=[],this.params[0]=this.element.getFloatAttribute("x"),this.params[1]=this.element.getFloatAttribute("y"),this.params[2]=this.element.getFloatAttribute("width"),this.params[3]=this.element.getFloatAttribute("height"),this.params[2]<0||this.params[3]<0)throw"svg error: negative width or height found while parsing <rect>"},Wt.prototype.parseEllipse=function(e){var t,n;if(this.kind=31,this.family=1,this.params=[],this.params[0]=0|this.element.getFloatAttribute("cx"),this.params[1]=0|this.element.getFloatAttribute("cy"),e){if((t=n=this.element.getFloatAttribute("r"))<0)throw"svg error: negative radius found while parsing <circle>"}else if(t=this.element.getFloatAttribute("rx"),n=this.element.getFloatAttribute("ry"),t<0||n<0)throw"svg error: negative x-axis radius or y-axis radius found while parsing <ellipse>";this.params[0]-=t,this.params[1]-=n,this.params[2]=2*t,this.params[3]=2*n},Wt.prototype.parseLine=function(){this.kind=4,this.family=1,this.params=[],this.params[0]=this.element.getFloatAttribute("x1"),this.params[1]=this.element.getFloatAttribute("y1"),this.params[2]=this.element.getFloatAttribute("x2"),this.params[3]=this.element.getFloatAttribute("y2")},Wt.prototype.parseColors=function(e){if(e.hasAttribute("opacity")&&this.setOpacity(e.getAttribute("opacity")),e.hasAttribute("stroke")&&this.setStroke(e.getAttribute("stroke")),e.hasAttribute("stroke-width")&&this.setStrokeWeight(e.getAttribute("stroke-width")),e.hasAttribute("stroke-linejoin")&&this.setStrokeJoin(e.getAttribute("stroke-linejoin")),e.hasAttribute("stroke-linecap")&&this.setStrokeCap(e.getStringAttribute("stroke-linecap")),e.hasAttribute("fill")&&this.setFill(e.getStringAttribute("fill")),e.hasAttribute("style"))for(var t=e.getStringAttribute("style").toString().split(";"),n=0,r=t.length;n<r;n++){var i=$.trim(t[n].split(":"));"fill"===i[0]?this.setFill(i[1]):"fill-opacity"===i[0]?this.setFillOpacity(i[1]):"stroke"===i[0]?this.setStroke(i[1]):"stroke-width"===i[0]?this.setStrokeWeight(i[1]):"stroke-linecap"===i[0]?this.setStrokeCap(i[1]):"stroke-linejoin"===i[0]?this.setStrokeJoin(i[1]):"stroke-opacity"===i[0]?this.setStrokeOpacity(i[1]):"opacity"===i[0]&&this.setOpacity(i[1])}},Wt.prototype.setFillOpacity=function(e){this.fillOpacity=parseFloat(e),this.fillColor=255*this.fillOpacity<<24|16777215&this.fillColor},Wt.prototype.setFill=function(e){var t=4278190080&this.fillColor;"none"===e?this.fill=!1:0===e.indexOf("#")?(this.fill=!0,4===e.length&&(e=e.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3")),this.fillColor=t|16777215&parseInt(e.substring(1),16)):0===e.indexOf("rgb")?(this.fill=!0,this.fillColor=t|this.parseRGB(e)):0===e.indexOf("url(#")?this.fillName=e.substring(5,e.length-1):Dr[e]&&(this.fill=!0,this.fillColor=t|16777215&parseInt(Dr[e].substring(1),16))},Wt.prototype.setOpacity=function(e){this.strokeColor=255*parseFloat(e)<<24|16777215&this.strokeColor,this.fillColor=255*parseFloat(e)<<24|16777215&this.fillColor},Wt.prototype.setStroke=function(e){var t=4278190080&this.strokeColor;"none"===e?this.stroke=!1:"#"===e.charAt(0)?(this.stroke=!0,4===e.length&&(e=e.replace(/#(.)(.)(.)/,"#$1$1$2$2$3$3")),this.strokeColor=t|16777215&parseInt(e.substring(1),16)):0===e.indexOf("rgb")?(this.stroke=!0,this.strokeColor=t|this.parseRGB(e)):0===e.indexOf("url(#")?this.strokeName=e.substring(5,e.length-1):Dr[e]&&(this.stroke=!0,this.strokeColor=t|16777215&parseInt(Dr[e].substring(1),16))},Wt.prototype.setStrokeWeight=function(e){this.strokeWeight=this.parseUnitSize(e)},Wt.prototype.setStrokeJoin=function(e){"miter"===e?this.strokeJoin="miter":"round"===e?this.strokeJoin="round":"bevel"===e&&(this.strokeJoin="bevel")},Wt.prototype.setStrokeCap=function(e){"butt"===e?this.strokeCap="butt":"round"===e?this.strokeCap="round":"square"===e&&(this.strokeCap="square")},Wt.prototype.setStrokeOpacity=function(e){this.strokeOpacity=parseFloat(e),this.strokeColor=255*this.strokeOpacity<<24|16777215&this.strokeColor},Wt.prototype.parseRGB=function(e){var t=e.substring(e.indexOf("(")+1,e.indexOf(")")).split(", ");return t[0]<<16|t[1]<<8|t[2]},Wt.prototype.parseUnitSize=function(e){var t=e.length-2;return t<0?e:e.indexOf("pt")===t?1.25*parseFloat(e.substring(0,t)):e.indexOf("pc")===t?15*parseFloat(e.substring(0,t)):e.indexOf("mm")===t?3.543307*parseFloat(e.substring(0,t)):e.indexOf("cm")===t?35.43307*parseFloat(e.substring(0,t)):e.indexOf("in")===t?90*parseFloat(e.substring(0,t)):e.indexOf("px")===t?parseFloat(e.substring(0,t)):parseFloat(e)},$.shape=function(e,t,n,r,i){1<=arguments.length&&null!==e&&e.isVisible()&&($.pushMatrix(),3===Ct?5===arguments.length?($.translate(t-r/2,n-i/2),$.scale(r/e.getWidth(),i/e.getHeight())):3===arguments.length?$.translate(t-e.getWidth()/2,-e.getHeight()/2):$.translate(-e.getWidth()/2,-e.getHeight()/2):0===Ct?5===arguments.length?($.translate(t,n),$.scale(r/e.getWidth(),i/e.getHeight())):3===arguments.length&&$.translate(t,n):1===Ct&&(5===arguments.length?(r-=t,i-=n,$.translate(t,n),$.scale(r/e.getWidth(),i/e.getHeight())):3===arguments.length&&$.translate(t,n)),e.draw(),(1===arguments.length&&3===Ct||1<arguments.length)&&$.popMatrix())},$.shapeMode=function(e){Ct=e},$.loadShape=function(e){return 1===arguments.length&&-1<e.indexOf(".svg")?new Wt(null,e):null};function qt(e,t,n,r,i){this.fullName=e||"",this.name=t||"",this.namespace=n||"",this.value=r,this.type=i}qt.prototype={getName:function(){return this.name},getFullName:function(){return this.fullName},getNamespace:function(){return this.namespace},getValue:function(){return this.value},getType:function(){return this.type},setValue:function(e){this.value=e}};var Kt=$.XMLElement=function(){if(this.attributes=[],this.children=[],this.fullName=null,this.name=null,this.namespace="",this.content=null,this.parent=null,this.lineNr="",this.systemID="",this.type="ELEMENT",4===arguments.length){if(this.fullName=arguments[0]||"",arguments[1])this.name=arguments[1];else{var e=this.fullName.indexOf(":");this.name=0<=e?this.fullName.substring(e+1):this.fullName}this.namespace=arguments[1],this.lineNr=arguments[3],this.systemID=arguments[2]}else 2===arguments.length&&-1<arguments[1].indexOf(".")?this.parse(arguments[arguments.length-1]):1===arguments.length&&"string"==typeof arguments[0]&&this.parse(arguments[0])};Kt.prototype={parse:function(e){try{var t=e.substring(e.length-4);".xml"!==t&&".svg"!==t||(e=Ar(e));var n=(new DOMParser).parseFromString(e,"text/xml").documentElement;if(!n)throw"Error loading document";return this.parseChildrenRecursive(null,n),this}catch(e){throw e}},parseChildrenRecursive:function(e,t){var n,r,i,s,o,a;if(e?(n=new Kt(t.localName,t.nodeName,"","")).parent=e:(this.fullName=t.localName,this.name=t.nodeName,n=this),3===t.nodeType&&""!==t.textContent)return this.createPCDataElement(t.textContent);for(s=0,o=t.attributes.length;s<o;s++)i=t.attributes[s],r=new qt(i.getname,i.nodeName,i.namespaceURI,i.nodeValue,i.nodeType),n.attributes.push(r);for(s=0,o=t.childNodes.length;s<o;s++){var l=t.childNodes[s];1!==l.nodeType&&3!==l.nodeType||null!==(a=n.parseChildrenRecursive(n,l))&&n.children.push(a)}return n},createElement:function(){return 2===arguments.length?new Kt(arguments[0],arguments[1],null,null):new Kt(arguments[0],arguments[1],arguments[2],arguments[3])},createPCDataElement:function(e){if(""===e.replace(/^\s+$/g,""))return null;var t=new Kt;return t.content=e,t.type="TEXT",t},hasAttribute:function(){return 1===arguments.length?null!==this.getAttribute(arguments[0]):2===arguments.length?null!==this.getAttribute(arguments[0],arguments[1]):void 0},equals:function(e){if(!(e instanceof Kt))return!1;var t,n,r,i,s;if(this.name!==e.getLocalName())return!1;if(this.attributes.length!==e.getAttributeCount())return!1;if(this.attributes.length!==e.attributes.length)return!1;for(t=0,n=this.attributes.length;t<n;t++){if(r=this.attributes[t].getName(),i=this.attributes[t].getNamespace(),null===(s=e.findAttribute(r,i)))return!1;if(this.attributes[t].getValue()!==s.getValue())return!1;if(this.attributes[t].getType()!==s.getType())return!1}if(this.children.length!==e.getChildCount())return!1;if(0<this.children.length){var o,a;for(t=0,n=this.children.length;t<n;t++)if(o=this.getChild(t),a=e.getChild(t),!o.equals(a))return!1;return!0}return this.content===e.content},getContent:function(){if("TEXT"===this.type)return this.content;var e=this.children;return 1===e.length&&"TEXT"===e[0].type?e[0].content:null},getAttribute:function(){var e;return 2===arguments.length?(e=this.findAttribute(arguments[0]))?e.getValue():arguments[1]:1===arguments.length?(e=this.findAttribute(arguments[0]))?e.getValue():null:3===arguments.length?(e=this.findAttribute(arguments[0],arguments[1]))?e.getValue():arguments[2]:void 0},getStringAttribute:function(){return 1===arguments.length?this.getAttribute(arguments[0]):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getString:function(e){return this.getStringAttribute(e)},getFloatAttribute:function(){return 1===arguments.length?parseFloat(this.getAttribute(arguments[0],0)):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getFloat:function(e){return this.getFloatAttribute(e)},getIntAttribute:function(){return 1===arguments.length?this.getAttribute(arguments[0],0):2===arguments.length?this.getAttribute(arguments[0],arguments[1]):this.getAttribute(arguments[0],arguments[1],arguments[2])},getInt:function(e){return this.getIntAttribute(e)},hasChildren:function(){return 0<this.children.length},addChild:function(e){null!==e&&(e.parent=this).children.push(e)},insertChild:function(e,t){if(e){if(null===e.getLocalName()&&!this.hasChildren()){var n=this.children[this.children.length-1];if(null===n.getLocalName())return void n.setContent(n.getContent()+e.getContent())}(e.parent=this).children.splice(t,0,e)}},getChild:function(){if("number"==typeof arguments[0])return this.children[arguments[0]];if(-1!==arguments[0].indexOf("/"))return this.getChildRecursive(arguments[0].split("/"),0),null;for(var e,t,n=0,r=this.getChildCount();n<r;n++)if(null!==(t=(e=this.getChild(n)).getName())&&t===arguments[0])return e;return null},getChildren:function(){if(1!==arguments.length)return this.children;if("number"==typeof arguments[0])return this.getChild(arguments[0]);if(-1!==arguments[0].indexOf("/"))return this.getChildrenRecursive(arguments[0].split("/"),0);for(var e,t,n=[],r=0,i=this.getChildCount();r<i;r++)null!==(t=(e=this.getChild(r)).getName())&&t===arguments[0]&&n.push(e);return n},getChildCount:function(){return this.children.length},getChildRecursive:function(e,t){for(var n,r,i=0,s=this.getChildCount();i<s;i++)if(null!==(r=(n=this.getChild(i)).getName())&&r===e[t])return t===e.length-1?n:(t+=1,n.getChildRecursive(e,t));return null},getChildrenRecursive:function(e,t){if(t===e.length-1)return this.getChildren(e[t]);for(var n=this.getChildren(e[t]),r=[],i=0;i<n.length;i++)r=r.concat(n[i].getChildrenRecursive(e,t+1));return r},isLeaf:function(){return!this.hasChildren()},listChildren:function(){for(var e=[],t=0,n=this.children.length;t<n;t++)e.push(this.getChild(t).getName());return e},removeAttribute:function(e,t){this.namespace=t||"";for(var n=0,r=this.attributes.length;n<r;n++)if(this.attributes[n].getName()===e&&this.attributes[n].getNamespace()===this.namespace){this.attributes.splice(n,1);break}},removeChild:function(e){if(e)for(var t=0,n=this.children.length;t<n;t++)if(this.children[t].equals(e)){this.children.splice(t,1);break}},removeChildAtIndex:function(e){this.children.length>e&&this.children.splice(e,1)},findAttribute:function(e,t){this.namespace=t||"";for(var n=0,r=this.attributes.length;n<r;n++)if(this.attributes[n].getName()===e&&this.attributes[n].getNamespace()===this.namespace)return this.attributes[n];return null},setAttribute:function(){var e;if(3===arguments.length){var t=arguments[0].indexOf(":"),n=arguments[0].substring(t+1);(e=this.findAttribute(n,arguments[1]))?e.setValue(arguments[2]):(e=new qt(arguments[0],n,arguments[1],arguments[2],"CDATA"),this.attributes.push(e))}else(e=this.findAttribute(arguments[0]))?e.setValue(arguments[1]):(e=new qt(arguments[0],arguments[0],null,arguments[1],"CDATA"),this.attributes.push(e))},setString:function(e,t){this.setAttribute(e,t)},setInt:function(e,t){this.setAttribute(e,t)},setFloat:function(e,t){this.setAttribute(e,t)},setContent:function(e){0<this.children.length&&Fr.debug("Tried to set content for XMLElement with children"),this.content=e},setName:function(){if(1===arguments.length)this.name=arguments[0],this.fullName=arguments[0],this.namespace=null;else{var e=arguments[0].indexOf(":");this.name=null===arguments[1]||e<0?arguments[0]:arguments[0].substring(e+1),this.fullName=arguments[0],this.namespace=arguments[1]}},getName:function(){return this.fullName},getLocalName:function(){return this.name},getAttributeCount:function(){return this.attributes.length},toString:function(){if("TEXT"===this.type)return this.content;var e,t,n=(""!==this.namespace&&this.namespace!==this.name?this.namespace+":":"")+this.name,r="<"+n;for(e=0;e<this.attributes.length;e++){var i=this.attributes[e];r+=" "+i.getName()+'="'+i.getValue()+'"'}if(0===this.children.length)""===this.content?r+="/>":r+=">"+this.content+"</"+n+">";else{for(r+=">",t=0;t<this.children.length;t++)r+=this.children[t].toString();r+="</"+n+">"}return r}},Kt.parse=function(e){var t=new Kt;return t.parse(e),t};function Jt(e){for(var t=0,n=0;n<e.length;n++)t=0!==n?xr.max(t,xr.abs(e[n])):xr.abs(e[n]);var r=(t+"").indexOf(".");return 0===r?r=1:-1===r&&(r=(t+"").length),r}var Qt=$.PMatrix2D=function(){0===arguments.length?this.reset():1===arguments.length&&arguments[0]instanceof Qt?this.set(arguments[0].array()):6===arguments.length&&this.set(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5])};Qt.prototype={set:function(){if(6===arguments.length){var e=arguments;this.set([e[0],e[1],e[2],e[3],e[4],e[5]])}else 1===arguments.length&&arguments[0]instanceof Qt?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var e=new Qt;return e.set(this.elements),e},reset:function(){this.set([1,0,0,0,1,0])},array:function(){return this.elements.slice()},translate:function(e,t){this.elements[2]=e*this.elements[0]+t*this.elements[1]+this.elements[2],this.elements[5]=e*this.elements[3]+t*this.elements[4]+this.elements[5]},invTranslate:function(e,t){this.translate(-e,-t)},transpose:function(){},mult:function(e,t){var n,r;return e instanceof kr?(n=e.x,r=e.y,t=t||new kr):e instanceof Array&&(n=e[0],r=e[1],t=t||[]),t instanceof Array?(t[0]=this.elements[0]*n+this.elements[1]*r+this.elements[2],t[1]=this.elements[3]*n+this.elements[4]*r+this.elements[5]):t instanceof kr&&(t.x=this.elements[0]*n+this.elements[1]*r+this.elements[2],t.y=this.elements[3]*n+this.elements[4]*r+this.elements[5],t.z=0),t},multX:function(e,t){return e*this.elements[0]+t*this.elements[1]+this.elements[2]},multY:function(e,t){return e*this.elements[3]+t*this.elements[4]+this.elements[5]},skewX:function(e){this.apply(1,0,1,e,0,0)},skewY:function(e){this.apply(1,0,1,0,e,0)},determinant:function(){return this.elements[0]*this.elements[4]-this.elements[1]*this.elements[3]},invert:function(){var e=this.determinant();if(-2147483648<xr.abs(e)){var t=this.elements[0],n=this.elements[1],r=this.elements[2],i=this.elements[3],s=this.elements[4],o=this.elements[5];return this.elements[0]=s/e,this.elements[3]=-i/e,this.elements[1]=-n/e,this.elements[4]=t/e,this.elements[2]=(n*o-s*r)/e,this.elements[5]=(i*r-t*o)/e,!0}return!1},scale:function(e,t){e&&!t&&(t=e),e&&t&&(this.elements[0]*=e,this.elements[1]*=t,this.elements[3]*=e,this.elements[4]*=t)},invScale:function(e,t){e&&!t&&(t=e),this.scale(1/e,1/t)},apply:function(){var e;1===arguments.length&&arguments[0]instanceof Qt?e=arguments[0].array():6===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);for(var t=[0,0,this.elements[2],0,0,this.elements[5]],n=0,r=0;r<2;r++)for(var i=0;i<3;i++,n++)t[n]+=this.elements[3*r+0]*e[i+0]+this.elements[3*r+1]*e[i+3];this.elements=t.slice()},preApply:function(){var e;1===arguments.length&&arguments[0]instanceof Qt?e=arguments[0].array():6===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);var t=[0,0,e[2],0,0,e[5]];t[2]=e[2]+this.elements[2]*e[0]+this.elements[5]*e[1],t[5]=e[5]+this.elements[2]*e[3]+this.elements[5]*e[4],t[0]=this.elements[0]*e[0]+this.elements[3]*e[1],t[3]=this.elements[0]*e[3]+this.elements[3]*e[4],t[1]=this.elements[1]*e[0]+this.elements[4]*e[1],t[4]=this.elements[1]*e[3]+this.elements[4]*e[4],this.elements=t.slice()},rotate:function(e){var t=xr.cos(e),n=xr.sin(e),r=this.elements[0],i=this.elements[1];this.elements[0]=t*r+n*i,this.elements[1]=-n*r+t*i,r=this.elements[3],i=this.elements[4],this.elements[3]=t*r+n*i,this.elements[4]=-n*r+t*i},rotateZ:function(e){this.rotate(e)},invRotateZ:function(e){this.rotateZ(e-xr.PI)},print:function(){var e=Jt(this.elements),t=$.nfs(this.elements[0],e,4)+" "+$.nfs(this.elements[1],e,4)+" "+$.nfs(this.elements[2],e,4)+"\n"+$.nfs(this.elements[3],e,4)+" "+$.nfs(this.elements[4],e,4)+" "+$.nfs(this.elements[5],e,4)+"\n\n";$.println(t)}};var en=$.PMatrix3D=function(){this.reset()};en.prototype={set:function(){16===arguments.length?this.elements=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof en?this.elements=arguments[0].array():1===arguments.length&&arguments[0]instanceof Array&&(this.elements=arguments[0].slice())},get:function(){var e=new en;return e.set(this.elements),e},reset:function(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},array:function(){return this.elements.slice()},translate:function(e,t,n){n===wr&&(n=0),this.elements[3]+=e*this.elements[0]+t*this.elements[1]+n*this.elements[2],this.elements[7]+=e*this.elements[4]+t*this.elements[5]+n*this.elements[6],this.elements[11]+=e*this.elements[8]+t*this.elements[9]+n*this.elements[10],this.elements[15]+=e*this.elements[12]+t*this.elements[13]+n*this.elements[14]},transpose:function(){var e=this.elements[4];this.elements[4]=this.elements[1],this.elements[1]=e,e=this.elements[8],this.elements[8]=this.elements[2],this.elements[2]=e,e=this.elements[6],this.elements[6]=this.elements[9],this.elements[9]=e,e=this.elements[3],this.elements[3]=this.elements[12],this.elements[12]=e,e=this.elements[7],this.elements[7]=this.elements[13],this.elements[13]=e,e=this.elements[11],this.elements[11]=this.elements[14],this.elements[14]=e},mult:function(e,t){var n,r,i,s;return e instanceof kr?(n=e.x,r=e.y,i=e.z,s=1,t=t||new kr):e instanceof Array&&(n=e[0],r=e[1],i=e[2],s=e[3]||1,t&&(3===t.length||4===t.length)||(t=[0,0,0])),t instanceof Array&&(3===t.length?(t[0]=this.elements[0]*n+this.elements[1]*r+this.elements[2]*i+this.elements[3],t[1]=this.elements[4]*n+this.elements[5]*r+this.elements[6]*i+this.elements[7],t[2]=this.elements[8]*n+this.elements[9]*r+this.elements[10]*i+this.elements[11]):4===t.length&&(t[0]=this.elements[0]*n+this.elements[1]*r+this.elements[2]*i+this.elements[3]*s,t[1]=this.elements[4]*n+this.elements[5]*r+this.elements[6]*i+this.elements[7]*s,t[2]=this.elements[8]*n+this.elements[9]*r+this.elements[10]*i+this.elements[11]*s,t[3]=this.elements[12]*n+this.elements[13]*r+this.elements[14]*i+this.elements[15]*s)),t instanceof kr&&(t.x=this.elements[0]*n+this.elements[1]*r+this.elements[2]*i+this.elements[3],t.y=this.elements[4]*n+this.elements[5]*r+this.elements[6]*i+this.elements[7],t.z=this.elements[8]*n+this.elements[9]*r+this.elements[10]*i+this.elements[11]),t},preApply:function(){var e;1===arguments.length&&arguments[0]instanceof en?e=arguments[0].array():16===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,r=0;r<4;r++)for(var i=0;i<4;i++,n++)t[n]+=this.elements[i+0]*e[4*r+0]+this.elements[i+4]*e[4*r+1]+this.elements[i+8]*e[4*r+2]+this.elements[i+12]*e[4*r+3];this.elements=t.slice()},apply:function(){var e;1===arguments.length&&arguments[0]instanceof en?e=arguments[0].array():16===arguments.length?e=Array.prototype.slice.call(arguments):1===arguments.length&&arguments[0]instanceof Array&&(e=arguments[0]);for(var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0,r=0;r<4;r++)for(var i=0;i<4;i++,n++)t[n]+=this.elements[4*r+0]*e[i+0]+this.elements[4*r+1]*e[i+4]+this.elements[4*r+2]*e[i+8]+this.elements[4*r+3]*e[i+12];this.elements=t.slice()},rotate:function(e,t,n,r){if(n){var i=$.cos(e),s=$.sin(e),o=1-i;this.apply(o*t*t+i,o*t*n-s*r,o*t*r+s*n,0,o*t*n+s*r,o*n*n+i,o*n*r-s*t,0,o*t*r-s*n,o*n*r+s*t,o*r*r+i,0,0,0,0,1)}else this.rotateZ(e)},invApply:function(){Qe===wr&&(Qe=new en);var e=arguments;return Qe.set(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),!!Qe.invert()&&(this.preApply(Qe),!0)},rotateX:function(e){var t=$.cos(e),n=$.sin(e);this.apply([1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1])},rotateY:function(e){var t=$.cos(e),n=$.sin(e);this.apply([t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1])},rotateZ:function(e){var t=xr.cos(e),n=xr.sin(e);this.apply([t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1])},scale:function(e,t,n){!e||t||n?e&&t&&!n&&(n=1):t=n=e,e&&t&&n&&(this.elements[0]*=e,this.elements[1]*=t,this.elements[2]*=n,this.elements[4]*=e,this.elements[5]*=t,this.elements[6]*=n,this.elements[8]*=e,this.elements[9]*=t,this.elements[10]*=n,this.elements[12]*=e,this.elements[13]*=t,this.elements[14]*=n)},skewX:function(e){var t=xr.tan(e);this.apply(1,t,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},skewY:function(e){var t=xr.tan(e);this.apply(1,0,0,0,t,1,0,0,0,0,1,0,0,0,0,1)},multX:function(e,t,n,r){return n?r?this.elements[0]*e+this.elements[1]*t+this.elements[2]*n+this.elements[3]*r:this.elements[0]*e+this.elements[1]*t+this.elements[2]*n+this.elements[3]:this.elements[0]*e+this.elements[1]*t+this.elements[3]},multY:function(e,t,n,r){return n?r?this.elements[4]*e+this.elements[5]*t+this.elements[6]*n+this.elements[7]*r:this.elements[4]*e+this.elements[5]*t+this.elements[6]*n+this.elements[7]:this.elements[4]*e+this.elements[5]*t+this.elements[7]},multZ:function(e,t,n,r){return r?this.elements[8]*e+this.elements[9]*t+this.elements[10]*n+this.elements[11]*r:this.elements[8]*e+this.elements[9]*t+this.elements[10]*n+this.elements[11]},multW:function(e,t,n,r){return r?this.elements[12]*e+this.elements[13]*t+this.elements[14]*n+this.elements[15]*r:this.elements[12]*e+this.elements[13]*t+this.elements[14]*n+this.elements[15]},invert:function(){var e=this.elements[0]*this.elements[5]-this.elements[1]*this.elements[4],t=this.elements[0]*this.elements[6]-this.elements[2]*this.elements[4],n=this.elements[0]*this.elements[7]-this.elements[3]*this.elements[4],r=this.elements[1]*this.elements[6]-this.elements[2]*this.elements[5],i=this.elements[1]*this.elements[7]-this.elements[3]*this.elements[5],s=this.elements[2]*this.elements[7]-this.elements[3]*this.elements[6],o=this.elements[8]*this.elements[13]-this.elements[9]*this.elements[12],a=this.elements[8]*this.elements[14]-this.elements[10]*this.elements[12],l=this.elements[8]*this.elements[15]-this.elements[11]*this.elements[12],h=this.elements[9]*this.elements[14]-this.elements[10]*this.elements[13],u=this.elements[9]*this.elements[15]-this.elements[11]*this.elements[13],f=this.elements[10]*this.elements[15]-this.elements[11]*this.elements[14],c=e*f-t*u+n*h+r*l-i*a+s*o;if(xr.abs(c)<=1e-9)return!1;var p=[];p[0]=+this.elements[5]*f-this.elements[6]*u+this.elements[7]*h,p[4]=-this.elements[4]*f+this.elements[6]*l-this.elements[7]*a,p[8]=+this.elements[4]*u-this.elements[5]*l+this.elements[7]*o,p[12]=-this.elements[4]*h+this.elements[5]*a-this.elements[6]*o,p[1]=-this.elements[1]*f+this.elements[2]*u-this.elements[3]*h,p[5]=+this.elements[0]*f-this.elements[2]*l+this.elements[3]*a,p[9]=-this.elements[0]*u+this.elements[1]*l-this.elements[3]*o,p[13]=+this.elements[0]*h-this.elements[1]*a+this.elements[2]*o,p[2]=+this.elements[13]*s-this.elements[14]*i+this.elements[15]*r,p[6]=-this.elements[12]*s+this.elements[14]*n-this.elements[15]*t,p[10]=+this.elements[12]*i-this.elements[13]*n+this.elements[15]*e,p[14]=-this.elements[12]*r+this.elements[13]*t-this.elements[14]*e,p[3]=-this.elements[9]*s+this.elements[10]*i-this.elements[11]*r,p[7]=+this.elements[8]*s-this.elements[10]*n+this.elements[11]*t,p[11]=-this.elements[8]*i+this.elements[9]*n-this.elements[11]*e,p[15]=+this.elements[8]*r-this.elements[9]*t+this.elements[10]*e;var g=1/c;return p[0]*=g,p[1]*=g,p[2]*=g,p[3]*=g,p[4]*=g,p[5]*=g,p[6]*=g,p[7]*=g,p[8]*=g,p[9]*=g,p[10]*=g,p[11]*=g,p[12]*=g,p[13]*=g,p[14]*=g,p[15]*=g,this.elements=p.slice(),!0},toString:function(){for(var e="",t=0;t<15;t++)e+=this.elements[t]+", ";return e+=this.elements[15]},print:function(){var e=Jt(this.elements),t=$.nfs(this.elements[0],e,4)+" "+$.nfs(this.elements[1],e,4)+" "+$.nfs(this.elements[2],e,4)+" "+$.nfs(this.elements[3],e,4)+"\n"+$.nfs(this.elements[4],e,4)+" "+$.nfs(this.elements[5],e,4)+" "+$.nfs(this.elements[6],e,4)+" "+$.nfs(this.elements[7],e,4)+"\n"+$.nfs(this.elements[8],e,4)+" "+$.nfs(this.elements[9],e,4)+" "+$.nfs(this.elements[10],e,4)+" "+$.nfs(this.elements[11],e,4)+"\n"+$.nfs(this.elements[12],e,4)+" "+$.nfs(this.elements[13],e,4)+" "+$.nfs(this.elements[14],e,4)+" "+$.nfs(this.elements[15],e,4)+"\n\n";$.println(t)},invTranslate:function(e,t,n){this.preApply(1,0,0,-e,0,1,0,-t,0,0,1,-n,0,0,0,1)},invRotateX:function(e){var t=xr.cos(-e),n=xr.sin(-e);this.preApply([1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1])},invRotateY:function(e){var t=xr.cos(-e),n=xr.sin(-e);this.preApply([t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1])},invRotateZ:function(e){var t=xr.cos(-e),n=xr.sin(-e);this.preApply([t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1])},invScale:function(e,t,n){this.preApply([1/e,0,0,0,0,1/t,0,0,0,0,1/n,0,0,0,0,1])}};var tn,nn,rn,sn,on,an,ln=$.PMatrixStack=function(){this.matrixStack=[]};function hn(e,t,n,r,i,s,o,a,l,h,u){var f=n+((l-n)*t>>8),c=r+((h-r)*t>>8),p=i+((u-i)*t>>8);return on(((4278190080&e)>>>24)+t,255)<<24|(f=(f<0?0:255<f?255:f)<<16)|(c=(c<0?0:255<c?255:c)<<8)|(p=p<0?0:255<p?255:p)}function un(e,t,n,r){var i,s,o,a;if(3===we){var l=$.color.toRGB(e,t,n);i=l[0],s=l[1],o=l[2]}else i=xr.round(e/de*255),s=xr.round(t/ve*255),o=xr.round(n/ye*255);return(a=255<(a=(a=xr.round(r/me*255))<0?0:a)?255:a)<<24&4278190080|(i=255<(i=i<0?0:i)?255:i)<<16&16711680|(s=255<(s=s<0?0:s)?255:s)<<8&65280|255&(o=255<(o=o<0?0:o)?255:o)}function fn(e){var t,n,r;t=(e>>16&255)/255,n=(e>>8&255)/255,r=(255&e)/255;var i,s=$.max($.max(t,n),r),o=$.min($.min(t,n),r);return o===s?[0,0,s*ye]:(i=t===s?(n-r)/(s-o):n===s?2+(r-t)/(s-o):4+(t-n)/(s-o),(i/=6)<0?i+=1:1<i&&(i-=1),[i*de,(s-o)/s*ve,s*ye])}function cn(){m.save()}function pn(){m.restore(),Y=j=!0}function gn(){var e=(Date.now()-Se)/1e3,t=++Pe/e;.5<e&&(Se=Date.now(),Pe=0,$.__frameRate=t),$.frameCount++}ln.prototype.load=function(){var e=A.$newPMatrix();1===arguments.length?e.set(arguments[0]):e.set(arguments),this.matrixStack.push(e)},Ut.prototype.$newPMatrix=function(){return new Qt},Gt.prototype.$newPMatrix=function(){return new en},ln.prototype.push=function(){this.matrixStack.push(this.peek())},ln.prototype.pop=function(){return this.matrixStack.pop()},ln.prototype.peek=function(){var e=A.$newPMatrix();return e.set(this.matrixStack[this.matrixStack.length-1]),e},ln.prototype.mult=function(e){this.matrixStack[this.matrixStack.length-1].apply(e)},$.split=function(e,t){return e.split(t)},$.splitTokens=function(e,t){1===arguments.length&&(t="\n\t\r\f "),t="["+t+"]";for(var n=[],r=0,i=e.search(t);0<=i;)i=(e=0===i?e.substring(1):(n[r]=e.substring(0,i),r++,e.substring(i))).search(t);return 0<e.length&&(n[r]=e),0===n.length&&(n=wr),n},$.append=function(e,t){return e[e.length]=t,e},$.concat=function(e,t){return e.concat(t)},$.sort=function(e,t){var n=[];if(0<e.length){for(var r=0<t?t:e.length,i=0;i<r;i++)n.push(e[i]);if("string"==typeof e[0]?n.sort():n.sort(function(e,t){return e-t}),0<t)for(var s=n.length;s<e.length;s++)n.push(e[s])}return n},$.splice=function(e,t,n){if(0===t.length)return e;if(t instanceof Array)for(var r=0,i=n;r<t.length;i++,r++)e.splice(i,0,t[r]);else e.splice(n,0,t);return e},$.subset=function(e,t,n){var r=n!==wr?t+n:e.length;return e.slice(t,r)},$.join=function(e,t){return e.join(t)},$.shorten=function(e){for(var t=[],n=e.length,r=0;r<n;r++)t[r]=e[r];return t.pop(),t},$.expand=function(e,t){var n=e.slice(0),r=t||2*e.length;return n.length=r,n},$.arrayCopy=function(){var e,t,n,r=0,i=0;2===arguments.length?(t=arguments[1],n=(e=arguments[0]).length):3===arguments.length?(e=arguments[0],t=arguments[1],n=arguments[2]):5===arguments.length&&(e=arguments[0],r=arguments[1],t=arguments[2],i=arguments[3],n=arguments[4]);for(var s=r,o=i;s<n+r;s++,o++){if(t[o]===wr)throw"array index out of bounds exception";t[o]=e[s]}},$.reverse=function(e){return e.reverse()},$.mix=function(e,t,n){return e+((t-e)*n>>8)},$.peg=function(e){return e<0?0:255<e?255:e},$.modes=(tn=4278190080,nn=16711680,rn=65280,sn=255,on=xr.min,an=xr.max,{replace:function(e,t){return t},blend:function(e,t){var n=(t&tn)>>>24,r=e&nn,i=e&rn,s=e&sn,o=t&nn,a=t&rn,l=t&sn;return on(((e&tn)>>>24)+n,255)<<24|r+((o-r)*n>>8)&nn|i+((a-i)*n>>8)&rn|s+((l-s)*n>>8)&sn},add:function(e,t){var n=(t&tn)>>>24;return on(((e&tn)>>>24)+n,255)<<24|on((e&nn)+((t&nn)>>8)*n,nn)&nn|on((e&rn)+((t&rn)>>8)*n,rn)&rn|on((e&sn)+((t&sn)*n>>8),sn)},subtract:function(e,t){var n=(t&tn)>>>24;return on(((e&tn)>>>24)+n,255)<<24|an((e&nn)-((t&nn)>>8)*n,rn)&nn|an((e&rn)-((t&rn)>>8)*n,sn)&rn|an((e&sn)-((t&sn)*n>>8),0)},lightest:function(e,t){var n=(t&tn)>>>24;return on(((e&tn)>>>24)+n,255)<<24|an(e&nn,((t&nn)>>8)*n)&nn|an(e&rn,((t&rn)>>8)*n)&rn|an(e&sn,(t&sn)*n>>8)},darkest:function(e,t){var n=(t&tn)>>>24,r=e&nn,i=e&rn,s=e&sn,o=on(e&nn,((t&nn)>>8)*n),a=on(e&rn,((t&rn)>>8)*n),l=on(e&sn,(t&sn)*n>>8);return on(((e&tn)>>>24)+n,255)<<24|r+((o-r)*n>>8)&nn|i+((a-i)*n>>8)&rn|s+((l-s)*n>>8)&sn},difference:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,s<n?n-s:s-n,o<r?r-o:o-r,a<i?i-a:a-i)},exclusion:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,n+s-(n*s>>7),r+o-(r*o>>7),i+a-(i*a>>7))},multiply:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,n*((t&nn)>>16)>>8,r*((t&rn)>>8)>>8,i*(t&sn)>>8)},screen:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,255-((255-n)*(255-((t&nn)>>16))>>8),255-((255-r)*(255-((t&rn)>>8))>>8),255-((255-i)*(255-(t&sn))>>8))},hard_light:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,s<128?n*s>>7:255-((255-n)*(255-s)>>7),o<128?r*o>>7:255-((255-r)*(255-o)>>7),a<128?i*a>>7:255-((255-i)*(255-a)>>7))},soft_light:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,(n*s>>7)+(n*n>>8)-(n*n*s>>15),(r*o>>7)+(r*r>>8)-(r*r*o>>15),(i*a>>7)+(i*i>>8)-(i*i*a>>15))},overlay:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn;return hn(e,(t&tn)>>>24,n,r,i,0,0,0,n<128?n*s>>7:255-((255-n)*(255-s)>>7),r<128?r*o>>7:255-((255-r)*(255-o)>>7),i<128?i*a>>7:255-((255-i)*(255-a)>>7))},dodge:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn,l=255;255!=s&&(l=(l=(n<<8)/(255-s))<0?0:255<l?255:l);var h=255;255!=o&&(h=(h=(r<<8)/(255-o))<0?0:255<h?255:h);var u=255;return 255!=a&&(u=(u=(i<<8)/(255-a))<0?0:255<u?255:u),hn(e,(t&tn)>>>24,n,r,i,0,0,0,l,h,u)},burn:function(e,t){var n=(e&nn)>>16,r=(e&rn)>>8,i=e&sn,s=(t&nn)>>16,o=(t&rn)>>8,a=t&sn,l=0;0!=s&&(l=255-((l=(255-n<<8)/s)<0?0:255<l?255:l));var h=0;0!=o&&(h=255-((h=(255-r<<8)/o)<0?0:255<h?255:h));var u=0;return 0!=a&&(u=255-((u=(255-i<<8)/a)<0?0:255<u?255:u)),hn(e,(t&tn)>>>24,n,r,i,0,0,0,l,h,u)}}),$.color=function(e,t,n,r){return e!==wr&&t!==wr&&n!==wr&&r!==wr?un(e,t,n,r):e!==wr&&t!==wr&&n!==wr?un(e,t,n,me):e!==wr&&t!==wr?function(e,t){var n;return 4278190080&e?e-(4278190080&e)+((n=(n=255<(n=xr.round(t/me*255))?255:n)<0?0:n)<<24&4278190080):1===we?un(e,e,e,t):3===we?un(0,0,e/de*ye,t):void 0}(e,t):"number"==typeof e?function(e){if(e<=de&&0<=e){if(1===we)return un(e,e,e,me);if(3===we)return un(0,0,e/de*ye,me)}if(e)return 2147483647<e&&(e-=4294967296),e}(e):un(de,ve,ye,me)},$.color.toString=function(e){return"rgba("+(e>>16&255)+","+(e>>8&255)+","+(255&e)+","+(e>>24&255)/255+")"},$.color.toInt=function(e,t,n,r){return r<<24&4278190080|e<<16&16711680|t<<8&65280|255&n},$.color.toArray=function(e){return[e>>16&255,e>>8&255,255&e,e>>24&255]},$.color.toGLArray=function(e){return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255,((4278190080&e)>>>24)/255]},$.color.toRGB=function(e,t,n){e=(e=de<e?de:e)/de*360,t=(t=ve<t?ve:t)/ve*100,n=(n=ye<n?ye:n)/ye*100;var r=xr.round(n/100*255);if(0===t)return[r,r,r];var i=e%360,s=i%60,o=xr.round(n*(100-t)/1e4*255),a=xr.round(n*(6e3-t*s)/6e5*255),l=xr.round(n*(6e3-t*(60-s))/6e5*255);switch(xr.floor(i/60)){case 0:return[r,l,o];case 1:return[a,r,o];case 2:return[o,r,l];case 3:return[o,a,r];case 4:return[l,o,r];case 5:return[r,o,a]}},$.brightness=function(e){return fn(e)[2]},$.saturation=function(e){return fn(e)[1]},$.hue=function(e){return fn(e)[0]},$.red=function(e){return(e>>16&255)/255*de},$.green=function(e){return(e>>8&255)/255*ve},$.blue=function(e){return(255&e)/255*ye},$.alpha=function(e){return(e>>24&255)/255*me},$.lerpColor=function(e,t,n){var r,i,s,o,a,l,h,u,f,c,p,g,m,d,v,y,b=$.color(e),x=$.color(t);return 3===we?(g=fn(b),h=(b>>24&255)/me,m=fn(x),p=(x>>24&255)/me,v=$.lerp(g[0],m[0],n),y=$.lerp(g[1],m[1],n),s=$.lerp(g[2],m[2],n),d=$.color.toRGB(v,y,s),$.lerp(h,p,n)*me<<24&4278190080|(255&d[0])<<16|(255&d[1])<<8|255&d[2]):(o=b>>16&255,a=b>>8&255,l=255&b,h=(b>>24&255)/me,u=x>>16&255,f=x>>8&255,c=255&x,p=((4278190080&x)>>>24)/me,r=0|$.lerp(o,u,n),i=0|$.lerp(a,f,n),s=0|$.lerp(l,c,n),$.lerp(h,p,n)*me<<24&4278190080|r<<16&16711680|i<<8&65280|255&s)},$.colorMode=function(){we=arguments[0],1<arguments.length&&(de=arguments[1],ve=arguments[2]||arguments[1],ye=arguments[3]||arguments[1],me=arguments[4]||arguments[1])},$.blendColor=function(e,t,n){return 0===n?$.modes.replace(e,t):1===n?$.modes.blend(e,t):2===n?$.modes.add(e,t):4===n?$.modes.subtract(e,t):8===n?$.modes.lightest(e,t):16===n?$.modes.darkest(e,t):32===n?$.modes.difference(e,t):64===n?$.modes.exclusion(e,t):128===n?$.modes.multiply(e,t):256===n?$.modes.screen(e,t):1024===n?$.modes.hard_light(e,t):2048===n?$.modes.soft_light(e,t):512===n?$.modes.overlay(e,t):4096===n?$.modes.dodge(e,t):8192===n?$.modes.burn(e,t):void 0},$.printMatrix=function(){je.print()},Ut.prototype.translate=function(e,t){je.translate(e,t),qe.invTranslate(e,t),m.translate(e,t)},Gt.prototype.translate=function(e,t,n){je.translate(e,t,n),qe.invTranslate(e,t,n)},Ut.prototype.scale=function(e,t){je.scale(e,t),qe.invScale(e,t),m.scale(e,t||e)},Gt.prototype.scale=function(e,t,n){je.scale(e,t,n),qe.invScale(e,t,n)},Ut.prototype.pushMatrix=function(){Ke.load(je),Je.load(qe),cn()},Gt.prototype.pushMatrix=function(){Ke.load(je),Je.load(qe)},Ut.prototype.popMatrix=function(){je.set(Ke.pop()),qe.set(Je.pop()),pn()},Gt.prototype.popMatrix=function(){je.set(Ke.pop()),qe.set(Je.pop())},Ut.prototype.resetMatrix=function(){je.reset(),qe.reset(),m.setTransform(1,0,0,1,0,0)},Gt.prototype.resetMatrix=function(){je.reset(),qe.reset()},Bt.prototype.applyMatrix=function(){var e=arguments;je.apply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),qe.invApply(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Ut.prototype.applyMatrix=function(){for(var e=arguments,t=e.length;t<16;t++)e[t]=0;e[10]=e[15]=1,Bt.prototype.applyMatrix.apply(this,e)},$.rotateX=function(e){je.rotateX(e),qe.invRotateX(e)},Ut.prototype.rotateZ=function(){throw"rotateZ() is not supported in 2D mode. Use rotate(float) instead."},Gt.prototype.rotateZ=function(e){je.rotateZ(e),qe.invRotateZ(e)},$.rotateY=function(e){je.rotateY(e),qe.invRotateY(e)},Ut.prototype.rotate=function(e){je.rotateZ(e),qe.invRotateZ(e),m.rotate(e)},Gt.prototype.rotate=function(e){$.rotateZ(e)},$.pushStyle=function(){cn(),$.pushMatrix();var e={doFill:U,currentFillColor:X,doStroke:H,currentStrokeColor:W,curTint:Ae,curRectMode:ee,curColorMode:we,colorModeX:de,colorModeZ:ye,colorModeY:ve,colorModeA:me,curTextFont:ze,horizontalTextAlignment:Le,verticalTextAlignment:De,textMode:Ie,curFontName:Oe,curTextSize:Ne,curTextAscent:Fe,curTextDescent:Me,curTextLeading:$e};Tt.push(e)},$.popStyle=function(){var e=Tt.pop();if(!e)throw"Too many popStyle() without enough pushStyle()";pn(),$.popMatrix(),U=e.doFill,X=e.currentFillColor,H=e.doStroke,W=e.currentStrokeColor,Ae=e.curTint,ee=e.curRectmode,we=e.curColorMode,de=e.colorModeX,ye=e.colorModeZ,ve=e.colorModeY,me=e.colorModeA,ze=e.curTextFont,Oe=e.curFontName,Ne=e.curTextSize,Le=e.horizontalTextAlignment,De=e.verticalTextAlignment,Ie=e.textMode,Fe=e.curTextAscent,Me=e.curTextDescent,$e=e.curTextLeading},$.year=function(){return(new Date).getFullYear()},$.month=function(){return(new Date).getMonth()+1},$.day=function(){return(new Date).getDate()},$.hour=function(){return(new Date).getHours()},$.minute=function(){return(new Date).getMinutes()},$.second=function(){return(new Date).getSeconds()},$.millis=function(){return Date.now()-Te},Ut.prototype.redraw=function(){gn(),m.lineWidth=q;var e=$.pmouseX,t=$.pmouseY;$.pmouseX=be,$.pmouseY=xe,cn(),$.draw(),pn(),be=$.mouseX,xe=$.mouseY,$.pmouseX=e,$.pmouseY=t},Gt.prototype.redraw=function(){gn();var e=$.pmouseX,t=$.pmouseY;$.pmouseX=be,$.pmouseY=xe,m.clear(m.DEPTH_BUFFER_BIT),Ee={attributes:{},locations:{}},$.noLights(),$.lightFalloff(1,0,0),$.shininess(1),$.ambient(255,255,255),$.specular(0,0,0),$.emissive(0,0,0),$.camera(),$.draw(),be=$.mouseX,xe=$.mouseY,$.pmouseX=e,$.pmouseY=t},$.noLoop=function(){K=J=!1,clearInterval(Q),h.onPause()},$.loop=function(){K||(Se=Date.now(),Pe=0,Q=yr.setInterval(function(){try{h.onFrameStart(),$.redraw(),h.onFrameEnd()}catch(e){throw yr.clearInterval(Q),e}},ae),K=J=!0,h.onLoop())},$.frameRate=function(e){ae=1e3/(oe=e),J&&($.noLoop(),$.loop())};var mn=[];function dn(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n),mn.push({elem:e,type:t,fn:n})}function vn(e){var t=e.elem,n=e.type,r=e.fn;t.removeEventListener?t.removeEventListener(n,r,!1):t.detachEvent&&t.detachEvent("on"+n,r)}function yn(e,t,n,r,i,s){var o=e<0?n:t,a=0===i,l=i===wr||i<0?0:i,h=xr.abs(e);if(a)for(l=1,h*=10;1e-6<xr.abs(xr.round(h)-h)&&l<7;)++l,h*=10;else 0!==l&&(h*=xr.pow(10,l));var u,f=2*h;if(xr.floor(h)===h)u=h;else if(xr.floor(f)===f){var c=xr.floor(h);u=c+c%2}else u=xr.round(h);for(var p="",g=r+l;0<g||0<u;)g--,p=""+u%10+p,u=xr.floor(u/10);if(s!==wr)for(var m=p.length-3-l;0<m;)p=p.substring(0,m)+s+p.substring(m),m-=3;return 0<l?o+p.substring(0,p.length-l)+"."+p.substring(p.length-l,p.length):o+p}function bn(e,t,n,r,i,s){if(e instanceof Array){for(var o=[],a=0,l=e.length;a<l;a++)o.push(yn(e[a],t,n,r,i,s));return o}return yn(e,t,n,r,i,s)}$.exit=function(){for(var e in yr.clearInterval(Q),function(e){Ir.splice(Or[e],1),delete Or[e]}($.externals.canvas.id),Fr.lib)Fr.lib.hasOwnProperty(e)&&Fr.lib[e].hasOwnProperty("detach")&&Fr.lib[e].detach($);for(var t=mn.length;t--;)vn(mn[t]);h.onExit()},$.cursor=function(){if(1<arguments.length||1===arguments.length&&arguments[0]instanceof $.PImage){var e,t,n=arguments[0];if(3<=arguments.length){if(t=arguments[2],(e=arguments[1])<0||t<0||t>=n.height||e>=n.width)throw"x and y must be non-negative and less than the dimensions of the image"}else e=n.width>>>1,t=n.height>>>1;var r='url("'+n.toDataURL()+'") '+e+" "+t+", default";l.style.cursor=r}else if(1===arguments.length){var i=arguments[0];l.style.cursor=i}else l.style.cursor=le},$.noCursor=function(){l.style.cursor=_r.NOCURSOR},$.link=function(e,t){t!==wr?yr.open(e,t):yr.location=e},$.beginDraw=Cr,$.endDraw=Cr,Ut.prototype.toImageData=function(e,t,n,r){return e=e!==wr?e:0,t=t!==wr?t:0,n=n!==wr?n:$.width,r=r!==wr?r:$.height,m.getImageData(e,t,n,r)},Gt.prototype.toImageData=function(e,t,n,r){e=e!==wr?e:0,t=t!==wr?t:0,n=n!==wr?n:$.width,r=r!==wr?r:$.height;var i=br.createElement("canvas").getContext("2d").createImageData(n,r),s=new Er(n*r*4);m.readPixels(e,t,n,r,m.RGBA,m.UNSIGNED_BYTE,s);for(var o=0,a=s.length,l=i.data;o<a;o++)l[o]=s[(r-1-xr.floor(o/4/n))*n*4+o%(4*n)];return i},$.status=function(e){yr.status=e},$.binary=function(e,t){var n;if(0<t)n=t;else if(e instanceof Ht)n=16,e|=0;else for(n=32;1<n&&!(e>>>n-1&1);)n--;for(var r="";0<n;)r+=e>>>--n&1?"1":"0";return r},$.unbinary=function(e){for(var t=e.length-1,n=1,r=0;0<=t;){var i=e[t--];if("0"!==i&&"1"!==i)throw"the value passed into unbinary was not an 8 bit binary number";"1"===i&&(r+=n),n<<=1}return r},$.nf=function(e,t,n){return bn(e,"","-",t,n)},$.nfs=function(e,t,n){return bn(e," ","-",t,n)},$.nfp=function(e,t,n){return bn(e,"+","-",t,n)},$.nfc=function(e,t,n){return bn(e,"","-",t,n,",")};function xn(e){var t=parseInt("0x"+e,16);return 2147483647<t&&(t-=4294967296),t}function wn(e){return Array.prototype.slice.call(e,1)}$.hex=function(e,t){return 1===arguments.length&&(t=e instanceof Ht?4:8),function(e,t){t=t===wr||null===t?t=8:t,e<0&&(e=4294967295+e+1);for(var n=Number(e).toString(16).toUpperCase();n.length<t;)n="0"+n;return n.length>=t&&(n=n.substring(n.length-t,n.length)),n}(e,t)},$.unhex=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(xn(e[n]));return t}return xn(e)},$.loadStrings=function(e){if(localStorage[e])return localStorage[e].split("\n");var t=Ar(e);return"string"!=typeof t||""===t?[]:(t=t.replace(/(\r\n?)/g,"\n").replace(/\n$/,"")).split("\n")},$.saveStrings=function(e,t){localStorage[e]=t.join("\n")},$.loadBytes=function(e){for(var t=Ar(e),n=[],r=0;r<t.length;r++)n.push(t.charCodeAt(r));return n},$.matchAll=function(e,t){for(var n,r=[],i=new RegExp(t,"g");null!==(n=i.exec(e));)r.push(n),0===n[0].length&&++i.lastIndex;return 0<r.length?r:null},$.__contains=function(e,t){return"string"!=typeof e?e.contains.apply(e,wn(arguments)):null!==e&&null!==t&&"string"==typeof t&&-1<e.indexOf(t)},$.__replaceAll=function(e,t,n){return"string"!=typeof e?e.replaceAll.apply(e,wn(arguments)):e.replace(new RegExp(t,"g"),n)},$.__replaceFirst=function(e,t,n){return"string"!=typeof e?e.replaceFirst.apply(e,wn(arguments)):e.replace(new RegExp(t,""),n)},$.__replace=function(e,t,n){if("string"!=typeof e)return e.replace.apply(e,wn(arguments));if(t instanceof RegExp)return e.replace(t,n);if("string"!=typeof t&&(t=t.toString()),""===t)return e;var r=e.indexOf(t);if(r<0)return e;for(var i=0,s="";s+=e.substring(i,r)+n,i=r+t.length,0<=(r=e.indexOf(t,i)););return s+e.substring(i)},$.__equals=function(e,t){return e.equals instanceof Function?e.equals.apply(e,wn(arguments)):e.valueOf()===t.valueOf()},$.__equalsIgnoreCase=function(e,t){return"string"!=typeof e?e.equalsIgnoreCase.apply(e,wn(arguments)):e.toLowerCase()===t.toLowerCase()},$.__toCharArray=function(e){if("string"!=typeof e)return e.toCharArray.apply(e,wn(arguments));for(var t=[],n=0,r=e.length;n<r;++n)t[n]=new Ht(e.charAt(n));return t},$.__split=function(e,t,n){if("string"!=typeof e)return e.split.apply(e,wn(arguments));var r=new RegExp(t);if(n===wr||n<1)return e.split(r);for(var i,s=[],o=e;-1!==(i=o.search(r))&&s.length<n-1;){var a=r.exec(o).toString();s.push(o.substring(0,i)),o=o.substring(i+a.length)}return-1===i&&""===o||s.push(o),s},$.__codePointAt=function(e,t){var n=e.charCodeAt(t);return 55296<=n&&n<=56319?1024*(n-55296)+(e.charCodeAt(t+1)-56320)+65536:n},$.match=function(e,t){return e.match(t)},$.__startsWith=function(e,t,n){return"string"!=typeof e?e.startsWith.apply(e,wn(arguments)):!((n=n||0)<0||n>e.length)&&(""===t||t===e||e.indexOf(t)===n)},$.__endsWith=function(e,t){if("string"!=typeof e)return e.endsWith.apply(e,wn(arguments));var n=t?t.length:0;return""===t||t===e||e.indexOf(t)===e.length-n},$.__hashCode=function(e){return e.hashCode instanceof Function?e.hashCode.apply(e,wn(arguments)):Rr(e)},$.__printStackTrace=function(e){$.println("Exception: "+e.toString())};var An=[];function Cn(e){return"number"==typeof e?0!==e:"boolean"==typeof e?e:"string"==typeof e?"true"===e.toLowerCase():e instanceof Ht?49===e.code||84===e.code||116===e.code:void 0}function Tn(e){return"number"==typeof e?e:"boolean"==typeof e?e?1:0:"string"==typeof e?parseFloat(e):e instanceof Ht?e.code:void 0}function Sn(e,t){return"number"==typeof e?4294967295&e:"boolean"==typeof e?e?1:0:"string"!=typeof e?e instanceof Ht?e.code:void 0:4294967295&parseInt(e,t||10)}$.println=function(e){var t=An.length;t&&(Fr.logger.log(An.join("")),An.length=0),0===arguments.length&&0===t?Fr.logger.log(""):0!==arguments.length&&Fr.logger.log(e)},$.print=function(e){An.push(e)},$.str=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString()+"");return t}return e.toString()+""},$.trim=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(e[n].replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,""));return t}return e.replace(/^\s*/,"").replace(/\s*$/,"").replace(/\r*$/,"")},$.parseBoolean=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(Cn(e[n]));return t}return Cn(e)},$.parseByte=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(0-(128&e[n])|127&e[n]);return t}return 0-(128&e)|127&e},$.parseChar=function(e){if("number"==typeof e)return new Ht(String.fromCharCode(65535&e));if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(new Ht(String.fromCharCode(65535&e[n])));return t}throw"char() may receive only one argument of type int, byte, int[], or byte[]."},$.parseFloat=function(e){if(e instanceof Array){for(var t=[],n=0;n<e.length;n++)t.push(Tn(e[n]));return t}return Tn(e)},$.parseInt=function(e,t){if(e instanceof Array){for(var n=[],r=0;r<e.length;r++)"string"!=typeof e[r]||/^\s*[+\-]?\d+\s*$/.test(e[r])?n.push(Sn(e[r],t)):n.push(0);return n}return Sn(e,t)},$.__int_cast=function(e){return 0|e},$.__instanceof=function(e,t){if("function"!=typeof t)throw"Function is expected as type argument for instanceof operator";if("string"==typeof e)return t===Object||t===String;if(e instanceof t)return!0;if("object"!=typeof e||null===e)return!1;var n=e.constructor;if(t.$isInterface){for(var r=[];n;)n.$interfaces&&(r=r.concat(n.$interfaces)),n=n.$base;for(;0<r.length;){var i=r.shift();if(i===t)return!0;i.$interfaces&&(r=r.concat(i.$interfaces))}return!1}for(;n.hasOwnProperty("$base");)if((n=n.$base)===t)return!0;return!1},$.abs=xr.abs,$.ceil=xr.ceil,$.constrain=function(e,t,n){return n<e?n:e<t?t:e},$.dist=function(){var e,t,n;return 4===arguments.length?(e=arguments[0]-arguments[2],t=arguments[1]-arguments[3],xr.sqrt(e*e+t*t)):6===arguments.length?(e=arguments[0]-arguments[3],t=arguments[1]-arguments[4],n=arguments[2]-arguments[5],xr.sqrt(e*e+t*t+n*n)):void 0},$.exp=xr.exp,$.floor=xr.floor,$.lerp=function(e,t,n){return(t-e)*n+e},$.log=xr.log,$.mag=function(e,t,n){return n?xr.sqrt(e*e+t*t+n*n):xr.sqrt(e*e+t*t)},$.map=function(e,t,n,r,i){return r+(e-t)/(n-t)*(i-r)},$.max=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[1]:arguments[0];var e=1===arguments.length?arguments[0]:arguments;if(!("length"in e&&0<e.length))throw"Non-empty array is expected";for(var t=e[0],n=e.length,r=1;r<n;++r)t<e[r]&&(t=e[r]);return t},$.min=function(){if(2===arguments.length)return arguments[0]<arguments[1]?arguments[0]:arguments[1];var e=1===arguments.length?arguments[0]:arguments;if(!("length"in e&&0<e.length))throw"Non-empty array is expected";for(var t=e[0],n=e.length,r=1;r<n;++r)t>e[r]&&(t=e[r]);return t},$.norm=function(e,t,n){return(e-t)/(n-t)},$.pow=xr.pow,$.round=xr.round,$.sq=function(e){return e*e},$.sqrt=xr.sqrt,$.acos=xr.acos,$.asin=xr.asin,$.atan=xr.atan,$.atan2=xr.atan2,$.cos=xr.cos,$.degrees=function(e){return 180*e/xr.PI},$.radians=function(e){return e/180*xr.PI},$.sin=xr.sin,$.tan=xr.tan;var Pn=xr.random;function En(e,t){function n(){return 4294967295&((65535&(r=36969*(65535&r)+(r>>>16)&4294967295))<<16|65535&(i=18e3*(65535&i)+(i>>>16)&4294967295))}var r=e||362436069,i=t||521288629;this.nextDouble=function(){var e=n()/4294967296;return e<0?1+e:e},this.nextInt=n}function _n(e){var t,n,r=e!==wr?new En(e):En.createRandomized(),m=new Er(512);for(t=0;t<256;++t)m[t]=t;for(t=0;t<256;++t){var i=m[n=255&r.nextInt()];m[n]=m[t],m[t]=i}for(t=0;t<256;++t)m[t+256]=m[t];function d(e,t,n,r){var i=15&e,s=i<8?t:n,o=i<4?n:12==i||14==i?t:r;return(0==(1&i)?s:-s)+(0==(2&i)?o:-o)}function l(e,t,n){var r=0==(1&e)?t:n;return 0==(2&e)?-r:r}function s(e,t){return 0==(1&e)?-t:t}function v(e,t,n){return t+e*(n-t)}this.noise3d=function(e,t,n){var r=255&xr.floor(e),i=255&xr.floor(t),s=255&xr.floor(n),o=(3-2*(e-=xr.floor(e)))*e*e,a=(3-2*(t-=xr.floor(t)))*t*t,l=(3-2*(n-=xr.floor(n)))*n*n,h=m[r]+i,u=m[h]+s,f=m[h+1]+s,c=m[1+r]+i,p=m[c]+s,g=m[c+1]+s;return v(l,v(a,v(o,d(m[u],e,t,n),d(m[p],e-1,t,n)),v(o,d(m[f],e,t-1,n),d(m[g],e-1,t-1,n))),v(a,v(o,d(m[u+1],e,t,n-1),d(m[p+1],e-1,t,n-1)),v(o,d(m[f+1],e,t-1,n-1),d(m[g+1],e-1,t-1,n-1))))},this.noise2d=function(e,t){var n=255&xr.floor(e),r=255&xr.floor(t),i=(3-2*(e-=xr.floor(e)))*e*e,s=(3-2*(t-=xr.floor(t)))*t*t,o=m[n]+r,a=m[1+n]+r;return v(s,v(i,l(m[o],e,t),l(m[a],e-1,t)),v(i,l(m[o+1],e,t-1),l(m[a+1],e-1,t-1)))},this.noise1d=function(e){var t=255&xr.floor(e);return v((3-2*(e-=xr.floor(e)))*e*e,s(m[t],e),s(m[1+t],e-1))}}$.random=function(){if(0===arguments.length)return Pn();if(1===arguments.length)return Pn()*arguments[0];var e=arguments[0],t=arguments[1];return Pn()*(t-e)+e},En.createRandomized=function(){var e=new Date;return new En(e/6e4&4294967295,4294967295&e)},$.randomSeed=function(e){Pn=new En(e).nextDouble},$.Random=function(e){var i,s,o=!1;this.nextGaussian=function(){if(o)return o=!1,i;for(var e,t,n;1<=(n=(e=2*s()-1)*e+(t=2*s()-1)*t)||0===n;);var r=xr.sqrt(-2*xr.log(n)/n);return i=t*r,o=!0,e*r},s=e===wr?xr.random:new En(e).nextDouble};var Rn,kn={generator:wr,octaves:4,fallout:.5,seed:wr};$.noise=function(e,t,n){kn.generator===wr&&(kn.generator=new _n(kn.seed));for(var r=kn.generator,i=1,s=1,o=0,a=0;a<kn.octaves;++a){switch(i*=kn.fallout,arguments.length){case 1:o+=i*(1+r.noise1d(s*e))/2;break;case 2:o+=i*(1+r.noise2d(s*e,s*t))/2;break;case 3:o+=i*(1+r.noise3d(s*e,s*t,s*n))/2}s*=2}return o},$.noiseDetail=function(e,t){kn.octaves=e,t!==wr&&(kn.fallout=t)},$.noiseSeed=function(e){kn.seed=e,kn.generator=wr},Bt.prototype.size=function(e,t,n){H&&$.stroke(0),U&&$.fill(255);var r={fillStyle:m.fillStyle,strokeStyle:m.strokeStyle,lineCap:m.lineCap,lineJoin:m.lineJoin};for(var i in 0<l.style.length&&(l.style.removeProperty("width"),l.style.removeProperty("height")),l.width=$.width=e||100,l.height=$.height=t||100,r)r.hasOwnProperty(i)&&(m[i]=r[i]);$.textFont(ze),$.background(),Ue=xr.max(1e3,e*t*.05),$.externals.context=m;for(var s=0;s<720;s++)at[s]=$.sin(s*(xr.PI/180)*.5),lt[s]=$.cos(s*(xr.PI/180)*.5)},Ut.prototype.size=function(e,t,n){m===wr&&(m=l.getContext("2d"),Ke=new ln,Je=new ln,je=new Qt,qe=new Qt),Bt.prototype.size.apply(this,arguments)},Gt.prototype.size=(Rn=!1,function(e,t,n){if(Rn)throw"Multiple calls to size() for 3D renders are not allowed.";Rn=!0;try{l.width=$.width=e||100,l.height=$.height=t||100,m=function(e){for(var t,n=["experimental-webgl","webgl","webkit-3d"],r=0,i=n.length;r<i&&!(t=e.getContext(n[r],{antialias:!1}));r++);return t}(l),k=m.createTexture(),L=m.createTexture()}catch(e){Fr.debug(e)}if(!m)throw"WebGL context is not supported on this browser.";m.viewport(0,0,l.width,l.height),m.enable(m.DEPTH_TEST),m.enable(m.BLEND),m.blendFunc(m.SRC_ALPHA,m.ONE_MINUS_SRC_ALPHA),p=Ft(m,"varying vec4 frontColor;attribute vec3 Vertex;attribute vec2 aTextureCoord;uniform vec4 color;uniform mat4 model;uniform mat4 view;uniform mat4 projection;uniform float pointSize;varying vec2 vTextureCoord;void main(void) {  gl_PointSize = pointSize;  frontColor = color;  gl_Position = projection * view * model * vec4(Vertex, 1.0);  vTextureCoord = aTextureCoord;}","#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 frontColor;varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform int picktype;void main(void){  if(picktype == 0){    gl_FragColor = frontColor;  }  else if(picktype == 1){    float alpha = texture2D(uSampler, vTextureCoord).a;    gl_FragColor = vec4(frontColor.rgb*alpha, alpha);\n  }}"),g=Ft(m,"varying vec4 frontColor;attribute vec3 aVertex;attribute vec4 aColor;uniform mat4 uView;uniform mat4 uProjection;uniform float pointSize;void main(void) {  frontColor = aColor;  gl_PointSize = pointSize;  gl_Position = uProjection * uView * vec4(aVertex, 1.0);}","#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 frontColor;void main(void){  gl_FragColor = frontColor;}"),$.strokeWeight(1),y=Ft(m,kt,"#ifdef GL_ES\nprecision highp float;\n#endif\nvarying vec4 frontColor;uniform sampler2D sampler;uniform bool usingTexture;varying vec2 vTexture;void main(void){  if(usingTexture){    gl_FragColor = vec4(texture2D(sampler, vTexture.xy)) * frontColor;  }  else{    gl_FragColor = frontColor;  }}"),m.useProgram(y),Dt("usingTexture3d",y,"usingTexture",ke),$.lightFalloff(1,0,0),$.shininess(1),$.ambient(255,255,255),$.specular(0,0,0),$.emissive(0,0,0),u=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,u),m.bufferData(m.ARRAY_BUFFER,St,m.STATIC_DRAW),f=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,f),m.bufferData(m.ARRAY_BUFFER,Et,m.STATIC_DRAW),b=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,b),m.bufferData(m.ARRAY_BUFFER,Pt,m.STATIC_DRAW),x=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,x),m.bufferData(m.ARRAY_BUFFER,_t,m.STATIC_DRAW),w=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,w),m.bufferData(m.ARRAY_BUFFER,Rt,m.STATIC_DRAW),C=m.createBuffer(),T=m.createBuffer(),a=m.createBuffer(),S=m.createBuffer(),E=m.createBuffer(),R=m.createBuffer(),_=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,_),m.bufferData(m.ARRAY_BUFFER,new Tr([0,0,0]),m.STATIC_DRAW),D=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,D),m.bufferData(m.ARRAY_BUFFER,new Tr([1,1,0,-1,1,0,-1,-1,0,1,-1,0]),m.STATIC_DRAW),I=m.createBuffer(),m.bindBuffer(m.ARRAY_BUFFER,I),m.bufferData(m.ARRAY_BUFFER,new Tr([0,0,1,0,1,1,0,1]),m.STATIC_DRAW),O=m.createBuffer(),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,O),m.bufferData(m.ELEMENT_ARRAY_BUFFER,new Pr([0,1,2,2,3,0]),m.STATIC_DRAW),Ze=new en,We=new en,je=new en,qe=new en,et=new en,$.camera(),$.perspective(),Ke=new ln,Je=new ln,i=new en,s=new en,P=new en,d=new en,o=new en,(v=new en).set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0),Bt.prototype.size.apply(this,arguments)}),Ut.prototype.ambientLight=Bt.prototype.a3DOnlyFunction,Gt.prototype.ambientLight=function(e,t,n,r,i,s){if(8===tt)throw"can only create 8 lights";var o=new kr(r,i,s),a=new en;a.scale(1,-1,1),a.apply(je.array()),a.mult(o,o);var l=un(e,t,n,0),h=[(l>>16&255)/255,((65280&l)>>>8)/255,(255&l)/255];m.useProgram(y),Lt("lights.color.3d."+tt,y,"lights"+tt+".color",h),Lt("lights.position.3d."+tt,y,"lights"+tt+".position",o.array()),Dt("lights.type.3d."+tt,y,"lights"+tt+".type",0),Dt("lightCount3d",y,"lightCount",++tt)},Ut.prototype.directionalLight=Bt.prototype.a3DOnlyFunction,Gt.prototype.directionalLight=function(e,t,n,r,i,s){if(8===tt)throw"can only create 8 lights";m.useProgram(y);var o=new en;o.scale(1,-1,1),o.apply(je.array());var a=[(o=o.array())[0]*r+o[4]*i+o[8]*s,o[1]*r+o[5]*i+o[9]*s,o[2]*r+o[6]*i+o[10]*s],l=un(e,t,n,0);Lt("lights.color.3d."+tt,y,"lights"+tt+".color",[(l>>16&255)/255,(l>>8&255)/255,(255&l)/255]),Lt("lights.position.3d."+tt,y,"lights"+tt+".position",a),Dt("lights.type.3d."+tt,y,"lights"+tt+".type",1),Dt("lightCount3d",y,"lightCount",++tt)},Ut.prototype.lightFalloff=Bt.prototype.a3DOnlyFunction,Gt.prototype.lightFalloff=function(e,t,n){m.useProgram(y),Lt("falloff3d",y,"falloff",[e,t,n])},Ut.prototype.lightSpecular=Bt.prototype.a3DOnlyFunction,Gt.prototype.lightSpecular=function(e,t,n){var r=un(e,t,n,0),i=[(r>>16&255)/255,(r>>8&255)/255,(255&r)/255];m.useProgram(y),Lt("specular3d",y,"specular",i)},$.lights=function(){$.ambientLight(128,128,128),$.directionalLight(128,128,128,0,0,-1),$.lightFalloff(1,0,0),$.lightSpecular(0,0,0)},Ut.prototype.pointLight=Bt.prototype.a3DOnlyFunction,Gt.prototype.pointLight=function(e,t,n,r,i,s){if(8===tt)throw"can only create 8 lights";var o=new kr(r,i,s),a=new en;a.scale(1,-1,1),a.apply(je.array()),a.mult(o,o);var l=un(e,t,n,0),h=[(l>>16&255)/255,(l>>8&255)/255,(255&l)/255];m.useProgram(y),Lt("lights.color.3d."+tt,y,"lights"+tt+".color",h),Lt("lights.position.3d."+tt,y,"lights"+tt+".position",o.array()),Dt("lights.type.3d."+tt,y,"lights"+tt+".type",2),Dt("lightCount3d",y,"lightCount",++tt)},Ut.prototype.noLights=Bt.prototype.a3DOnlyFunction,Gt.prototype.noLights=function(){tt=0,m.useProgram(y),Dt("lightCount3d",y,"lightCount",tt)},Ut.prototype.spotLight=Bt.prototype.a3DOnlyFunction,Gt.prototype.spotLight=function(e,t,n,r,i,s,o,a,l,h,u){if(8===tt)throw"can only create 8 lights";m.useProgram(y);var f=new kr(r,i,s),c=new en;c.scale(1,-1,1),c.apply(je.array()),c.mult(f,f);var p=[(c=c.array())[0]*o+c[4]*a+c[8]*l,c[1]*o+c[5]*a+c[9]*l,c[2]*o+c[6]*a+c[10]*l],g=un(e,t,n,0);Lt("lights.color.3d."+tt,y,"lights"+tt+".color",[(g>>16&255)/255,(g>>8&255)/255,(255&g)/255]),Lt("lights.position.3d."+tt,y,"lights"+tt+".position",f.array()),Lt("lights.direction.3d."+tt,y,"lights"+tt+".direction",p),Lt("lights.concentration.3d."+tt,y,"lights"+tt+".concentration",u),Lt("lights.angle.3d."+tt,y,"lights"+tt+".angle",h),Dt("lights.type.3d."+tt,y,"lights"+tt+".type",3),Dt("lightCount3d",y,"lightCount",++tt)},Ut.prototype.beginCamera=function(){throw"beginCamera() is not available in 2D mode"},Gt.prototype.beginCamera=function(){if(ht)throw"You cannot call beginCamera() again before calling endCamera()";ht=!0,je=We,qe=Ze},Ut.prototype.endCamera=function(){throw"endCamera() is not available in 2D mode"},Gt.prototype.endCamera=function(){if(!ht)throw"You cannot call endCamera() before calling beginCamera()";je.set(Ze),qe.set(We),ht=!1},$.camera=function(e,t,n,r,i,s,o,a,l){e===wr&&(ft=$.width/2,ct=$.height/2,n=pt=ct/xr.tan(ut/2),r=e=ft,i=t=ct,a=1,l=o=s=0);var h=new kr(e-r,t-i,n-s),u=new kr(o,a,l);h.normalize();var f=kr.cross(u,h);u=kr.cross(h,f),f.normalize(),u.normalize();var c=f.x,p=f.y,g=f.z,m=u.x,d=u.y,v=u.z,y=h.x,b=h.y,x=h.z;Ze.set(c,p,g,0,m,d,v,0,y,b,x,0,0,0,0,1),Ze.translate(-e,-t,-n),We.reset(),We.invApply(c,p,g,0,m,d,v,0,y,b,x,0,0,0,0,1),We.translate(e,t,n),je.set(Ze),qe.set(We)},$.perspective=function(e,t,n,r){var i,s,o,a;0===arguments.length&&(ct=l.height/2,pt=ct/xr.tan(ut/2),gt=pt/10,mt=10*pt,dt=$.width/$.height,e=ut,t=dt,n=gt,r=mt),o=(i=n*xr.tan(e/2))*t,a=(s=-i)*t,$.frustum(a,o,s,i,n,r)},Ut.prototype.frustum=function(){throw"Processing.js: frustum() is not supported in 2D mode"},Gt.prototype.frustum=function(e,t,n,r,i,s){!0,(et=new en).set(2*i/(t-e),0,(t+e)/(t-e),0,0,2*i/(r-n),(r+n)/(r-n),0,0,0,-(s+i)/(s-i),-2*s*i/(s-i),0,0,-1,0);var o=new en;o.set(et),o.transpose(),m.useProgram(p),It("projection2d",p,"projection",!1,o.array()),m.useProgram(y),It("projection3d",y,"projection",!1,o.array()),m.useProgram(g),It("uProjectionUS",g,"uProjection",!1,o.array())},$.ortho=function(e,t,n,r,i,s){0===arguments.length&&(e=0,t=$.width,n=0,r=$.height,i=-10,s=10);var o=2/(t-e),a=2/(r-n),l=-2/(s-i),h=-(t+e)/(t-e),u=-(r+n)/(r-n),f=-(s+i)/(s-i);(et=new en).set(o,0,0,h,0,a,0,u,0,0,l,f,0,0,0,1);var c=new en;c.set(et),c.transpose(),m.useProgram(p),It("projection2d",p,"projection",!1,c.array()),m.useProgram(y),It("projection3d",y,"projection",!1,c.array()),m.useProgram(g),It("uProjectionUS",g,"uProjection",!1,c.array()),!1},$.printProjection=function(){et.print()},$.printCamera=function(){Ze.print()},Ut.prototype.box=Bt.prototype.a3DOnlyFunction,Gt.prototype.box=function(e,t,n){t&&n||(t=n=e);var r=new en;r.scale(e,t,n);var i=new en;if(i.scale(1,-1,1),i.apply(je.array()),i.transpose(),U){if(m.useProgram(y),It("model3d",y,"model",!1,r.array()),It("view3d",y,"view",!1,i.array()),m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(1,1),Lt("color3d",y,"color",G),0<tt){var s=new en;s.set(i);var o=new en;o.set(r),s.mult(o);var a=new en;a.set(s),a.invert(),a.transpose(),It("normalTransform3d",y,"normalTransform",!1,a.array()),Ot("normal3d",y,"Normal",3,f)}else Nt("normal3d",y,"Normal");Ot("vertex3d",y,"Vertex",3,u),Nt("aColor3d",y,"aColor"),Nt("aTexture3d",y,"aTexture"),m.drawArrays(m.TRIANGLES,0,St.length/3),m.disable(m.POLYGON_OFFSET_FILL)}0<q&&H&&(m.useProgram(p),It("model2d",p,"model",!1,r.array()),It("view2d",p,"view",!1,i.array()),Lt("color2d",p,"color",Z),Dt("picktype2d",p,"picktype",0),Ot("vertex2d",p,"Vertex",3,b),Nt("aTextureCoord2d",p,"aTextureCoord"),m.drawArrays(m.LINES,0,Pt.length/3))};function Ln(){U&&(Y&&(m.fillStyle=$.color.toString(X),Y=!1),m.fill())}function Dn(){H&&(j&&(m.strokeStyle=$.color.toString(W),j=!1),m.stroke())}$.sphereDetail=function(e,t){var n;if(1===arguments.length&&(e=t=e),e<3&&(e=3),t<2&&(t=2),e!==rt||t!==nt){var r=720/e,i=new Tr(e),s=new Tr(e);for(n=0;n<e;n++)i[n]=lt[n*r%720|0],s[n]=at[n*r%720|0];var o=e*(t-1)+2,a=0;it=new Tr(o),st=new Tr(o),ot=new Tr(o);var l=360/t,h=l;for(n=1;n<t;n++){for(var u=at[h%720|0],f=-lt[h%720|0],c=0;c<e;c++)it[a]=i[c]*u,st[a]=f,ot[a++]=s[c]*u;h+=l}rt=e,nt=t,function(){var e,t,n,r;for(He=[],e=0;e<rt;e++)He.push(0),He.push(-1),He.push(0),He.push(it[e]),He.push(st[e]),He.push(ot[e]);He.push(0),He.push(-1),He.push(0),He.push(it[0]),He.push(st[0]),He.push(ot[0]);var i=0;for(e=2;e<nt;e++){t=n=i,r=i+=rt;for(var s=0;s<rt;s++)He.push(it[t]),He.push(st[t]),He.push(ot[t++]),He.push(it[r]),He.push(st[r]),He.push(ot[r++]);t=n,r=i,He.push(it[t]),He.push(st[t]),He.push(ot[t]),He.push(it[r]),He.push(st[r]),He.push(ot[r])}for(e=0;e<rt;e++)r=i+e,He.push(it[r]),He.push(st[r]),He.push(ot[r]),He.push(0),He.push(1),He.push(0);He.push(it[i]),He.push(st[i]),He.push(ot[i]),He.push(0),He.push(1),He.push(0),m.bindBuffer(m.ARRAY_BUFFER,C),m.bufferData(m.ARRAY_BUFFER,new Tr(He),m.STATIC_DRAW)}()}},Ut.prototype.sphere=Bt.prototype.a3DOnlyFunction,Gt.prototype.sphere=function(){var e=arguments[0];(rt<3||nt<2)&&$.sphereDetail(30);var t=new en;t.scale(e,e,e);var n=new en;if(n.scale(1,-1,1),n.apply(je.array()),n.transpose(),U){if(0<tt){var r=new en;r.set(n);var i=new en;i.set(t),r.mult(i);var s=new en;s.set(r),s.invert(),s.transpose(),It("normalTransform3d",y,"normalTransform",!1,s.array()),Ot("normal3d",y,"Normal",3,C)}else Nt("normal3d",y,"Normal");m.useProgram(y),Nt("aTexture3d",y,"aTexture"),It("model3d",y,"model",!1,t.array()),It("view3d",y,"view",!1,n.array()),Ot("vertex3d",y,"Vertex",3,C),Nt("aColor3d",y,"aColor"),m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(1,1),Lt("color3d",y,"color",G),m.drawArrays(m.TRIANGLE_STRIP,0,He.length/3),m.disable(m.POLYGON_OFFSET_FILL)}0<q&&H&&(m.useProgram(p),It("model2d",p,"model",!1,t.array()),It("view2d",p,"view",!1,n.array()),Ot("vertex2d",p,"Vertex",3,C),Nt("aTextureCoord2d",p,"aTextureCoord"),Lt("color2d",p,"color",Z),Dt("picktype2d",p,"picktype",0),m.drawArrays(m.LINE_STRIP,0,He.length/3))},$.modelX=function(e,t,n){var r=je.array(),i=We.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],a=r[8]*e+r[9]*t+r[10]*n+r[11],l=r[12]*e+r[13]*t+r[14]*n+r[15],h=i[0]*s+i[1]*o+i[2]*a+i[3]*l,u=i[12]*s+i[13]*o+i[14]*a+i[15]*l;return 0!=u?h/u:h},$.modelY=function(e,t,n){var r=je.array(),i=We.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],a=r[8]*e+r[9]*t+r[10]*n+r[11],l=r[12]*e+r[13]*t+r[14]*n+r[15],h=i[4]*s+i[5]*o+i[6]*a+i[7]*l,u=i[12]*s+i[13]*o+i[14]*a+i[15]*l;return 0!=u?h/u:h},$.modelZ=function(e,t,n){var r=je.array(),i=We.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],a=r[8]*e+r[9]*t+r[10]*n+r[11],l=r[12]*e+r[13]*t+r[14]*n+r[15],h=i[8]*s+i[9]*o+i[10]*a+i[11]*l,u=i[12]*s+i[13]*o+i[14]*a+i[15]*l;return 0!=u?h/u:h},Ut.prototype.ambient=Bt.prototype.a3DOnlyFunction,Gt.prototype.ambient=function(e,t,n){m.useProgram(y),Dt("usingMat3d",y,"usingMat",!0);var r=$.color(e,t,n);Lt("mat_ambient3d",y,"mat_ambient",$.color.toGLArray(r).slice(0,3))},Ut.prototype.emissive=Bt.prototype.a3DOnlyFunction,Gt.prototype.emissive=function(e,t,n){m.useProgram(y),Dt("usingMat3d",y,"usingMat",!0);var r=$.color(e,t,n);Lt("mat_emissive3d",y,"mat_emissive",$.color.toGLArray(r).slice(0,3))},Ut.prototype.shininess=Bt.prototype.a3DOnlyFunction,Gt.prototype.shininess=function(e){m.useProgram(y),Dt("usingMat3d",y,"usingMat",!0),Lt("shininess3d",y,"shininess",e)},Ut.prototype.specular=Bt.prototype.a3DOnlyFunction,Gt.prototype.specular=function(e,t,n){m.useProgram(y),Dt("usingMat3d",y,"usingMat",!0);var r=$.color(e,t,n);Lt("mat_specular3d",y,"mat_specular",$.color.toGLArray(r).slice(0,3))},$.screenX=function(e,t,n){var r=je.array();if(16!==r.length)return je.multX(e,t);var i=r[0]*e+r[1]*t+r[2]*n+r[3],s=r[4]*e+r[5]*t+r[6]*n+r[7],o=r[8]*e+r[9]*t+r[10]*n+r[11],a=r[12]*e+r[13]*t+r[14]*n+r[15],l=et.array(),h=l[0]*i+l[1]*s+l[2]*o+l[3]*a,u=l[12]*i+l[13]*s+l[14]*o+l[15]*a;return 0!=u&&(h/=u),$.width*(1+h)/2},$.screenY=function(e,t,n){var r=je.array();if(16!==r.length)return je.multY(e,t);var i=r[0]*e+r[1]*t+r[2]*n+r[3],s=r[4]*e+r[5]*t+r[6]*n+r[7],o=r[8]*e+r[9]*t+r[10]*n+r[11],a=r[12]*e+r[13]*t+r[14]*n+r[15],l=et.array(),h=l[4]*i+l[5]*s+l[6]*o+l[7]*a,u=l[12]*i+l[13]*s+l[14]*o+l[15]*a;return 0!=u&&(h/=u),$.height*(1+h)/2},$.screenZ=function(e,t,n){var r=je.array();if(16!==r.length)return 0;var i=et.array(),s=r[0]*e+r[1]*t+r[2]*n+r[3],o=r[4]*e+r[5]*t+r[6]*n+r[7],a=r[8]*e+r[9]*t+r[10]*n+r[11],l=r[12]*e+r[13]*t+r[14]*n+r[15],h=i[8]*s+i[9]*o+i[10]*a+i[11]*l,u=i[12]*s+i[13]*o+i[14]*a+i[15]*l;return 0!=u&&(h/=u),(h+1)/2},Bt.prototype.fill=function(){var e=$.color(arguments[0],arguments[1],arguments[2],arguments[3]);e===X&&U||(U=!0,X=e)},Ut.prototype.fill=function(){Bt.prototype.fill.apply(this,arguments),Y=!0},Gt.prototype.fill=function(){Bt.prototype.fill.apply(this,arguments),G=$.color.toGLArray(X)},$.noFill=function(){U=!1},Bt.prototype.stroke=function(){var e=$.color(arguments[0],arguments[1],arguments[2],arguments[3]);e===W&&H||(H=!0,W=e)},Ut.prototype.stroke=function(){Bt.prototype.stroke.apply(this,arguments),j=!0},Gt.prototype.stroke=function(){Bt.prototype.stroke.apply(this,arguments),Z=$.color.toGLArray(W)},$.noStroke=function(){H=!1},Bt.prototype.strokeWeight=function(e){q=e},Ut.prototype.strokeWeight=function(e){Bt.prototype.strokeWeight.apply(this,arguments),m.lineWidth=e},Gt.prototype.strokeWeight=function(e){Bt.prototype.strokeWeight.apply(this,arguments),m.useProgram(p),Lt("pointSize2d",p,"pointSize",e),m.useProgram(g),Lt("pointSizeUnlitShape",g,"pointSize",e),m.lineWidth(e)},$.strokeCap=function(e){A.$ensureContext().lineCap=e},$.strokeJoin=function(e){A.$ensureContext().lineJoin=e},Ut.prototype.smooth=function(){!0;var e=l.style;e.setProperty("image-rendering","optimizeQuality","important"),e.setProperty("-ms-interpolation-mode","bicubic","important"),m.hasOwnProperty("mozImageSmoothingEnabled")&&(m.mozImageSmoothingEnabled=!0)},Gt.prototype.smooth=Cr,Ut.prototype.noSmooth=function(){!1;var e=l.style;e.setProperty("image-rendering","optimizeSpeed","important"),e.setProperty("image-rendering","-moz-crisp-edges","important"),e.setProperty("image-rendering","-webkit-optimize-contrast","important"),e.setProperty("image-rendering","optimize-contrast","important"),e.setProperty("-ms-interpolation-mode","nearest-neighbor","important"),m.hasOwnProperty("mozImageSmoothingEnabled")&&(m.mozImageSmoothingEnabled=!1)},Gt.prototype.noSmooth=Cr,Ut.prototype.point=function(e,t){H&&(e=xr.round(e),t=xr.round(t),m.fillStyle=$.color.toString(W),Y=!0,1<q?(m.beginPath(),m.arc(e,t,q/2,0,6.283185307179586,!1),m.fill()):m.fillRect(e,t,1,1))},Gt.prototype.point=function(e,t,n){var r=new en;r.translate(e,t,n||0),r.transpose();var i=new en;i.scale(1,-1,1),i.apply(je.array()),i.transpose(),m.useProgram(p),It("model2d",p,"model",!1,r.array()),It("view2d",p,"view",!1,i.array()),0<q&&H&&(Lt("color2d",p,"color",Z),Dt("picktype2d",p,"picktype",0),Ot("vertex2d",p,"Vertex",3,_),Nt("aTextureCoord2d",p,"aTextureCoord"),m.drawArrays(m.POINTS,0,1))},$.beginShape=function(e){he=e,[],vt=[]},Ut.prototype.vertex=function(e,t,n,r){var i=[];At=At&&!1,i.isVert=!0,i[0]=e,i[1]=t,i[2]=0,i[3]=n,i[4]=r,i[5]=X,i[6]=W,vt.push(i)},Gt.prototype.vertex=function(e,t,n,r,i){var s=[];At=At&&!1,s.isVert=!0,i===wr&&ke&&(i=r,r=n,n=0),r!==wr&&i!==wr&&(2===Re&&(r/=_e.width,i/=_e.height),r=(r=1<r?1:r)<0?0:r,i=(i=1<i?1:i)<0?0:i),s[0]=e,s[1]=t,s[2]=n||0,s[3]=r||0,s[4]=i||0,s[5]=G[0],s[6]=G[1],s[7]=G[2],s[8]=G[3],s[9]=Z[0],s[10]=Z[1],s[11]=Z[2],s[12]=Z[3],s[13]=ne,s[14]=re,s[15]=ie,vt.push(s)};function In(e,t){var n=new en;n.scale(1,-1,1),n.apply(je.array()),n.transpose(),m.useProgram(g),It("uViewUS",g,"uView",!1,n.array()),Ot("aVertexUS",g,"aVertex",3,_),m.bufferData(m.ARRAY_BUFFER,new Tr(e),m.STREAM_DRAW),Ot("aColorUS",g,"aColor",4,S),m.bufferData(m.ARRAY_BUFFER,new Tr(t),m.STREAM_DRAW),m.drawArrays(m.POINTS,0,e.length/3)}function On(e,t,n){var r;r="LINES"===t?m.LINES:"LINE_LOOP"===t?m.LINE_LOOP:m.LINE_STRIP;var i=new en;i.scale(1,-1,1),i.apply(je.array()),i.transpose(),m.useProgram(g),It("uViewUS",g,"uView",!1,i.array()),Ot("aVertexUS",g,"aVertex",3,T),m.bufferData(m.ARRAY_BUFFER,new Tr(e),m.STREAM_DRAW),Ot("aColorUS",g,"aColor",4,E),m.bufferData(m.ARRAY_BUFFER,new Tr(n),m.STREAM_DRAW),m.drawArrays(r,0,e.length/3)}function Nn(e,t,n,r){var i;i="TRIANGLES"===t?m.TRIANGLES:"TRIANGLE_FAN"===t?m.TRIANGLE_FAN:m.TRIANGLE_STRIP;var s=new en;s.scale(1,-1,1),s.apply(je.array()),s.transpose(),m.useProgram(y),It("model3d",y,"model",!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),It("view3d",y,"view",!1,s.array()),m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(1,1),Lt("color3d",y,"color",[-1,0,0,0]),Ot("vertex3d",y,"Vertex",3,a),m.bufferData(m.ARRAY_BUFFER,new Tr(e),m.STREAM_DRAW),ke&&null!==Ae&&Ce(n),Ot("aColor3d",y,"aColor",4,S),m.bufferData(m.ARRAY_BUFFER,new Tr(n),m.STREAM_DRAW),Nt("normal3d",y,"Normal"),ke&&(Dt("usingTexture3d",y,"usingTexture",ke),Ot("aTexture3d",y,"aTexture",2,R),m.bufferData(m.ARRAY_BUFFER,new Tr(r),m.STREAM_DRAW)),m.drawArrays(i,0,e.length/3),m.disable(m.POLYGON_OFFSET_FILL)}function Fn(){Ln(),Dn(),m.closePath()}Ut.prototype.endShape=function(e){if(0!==vt.length){var t=2===e;t&&vt.push(vt[0]);var n,r,i,s=[],o=[],a=[],l=[];At=!0;var h=vt.length;for(r=0;r<h;r++)for(n=vt[r],i=0;i<3;i++)s.push(n[i]);for(r=0;r<h;r++)for(n=vt[r],i=5;i<9;i++)o.push(n[i]);for(r=0;r<h;r++)for(n=vt[r],i=9;i<13;i++)a.push(n[i]);for(r=0;r<h;r++)n=vt[r],l.push(n[3]),l.push(n[4]);if(!xt||20!==he&&he!==wr)if(!wt||20!==he&&he!==wr)if(2===he)for(r=0;r<h;r++)n=vt[r],H&&$.stroke(n[6]),$.point(n[0],n[1]);else if(4===he)for(r=0;r+1<h;r+=2)n=vt[r],H&&$.stroke(vt[r+1][6]),$.line(n[0],n[1],vt[r+1][0],vt[r+1][1]);else if(9===he)for(r=0;r+2<h;r+=3)n=vt[r],m.beginPath(),m.moveTo(n[0],n[1]),m.lineTo(vt[r+1][0],vt[r+1][1]),m.lineTo(vt[r+2][0],vt[r+2][1]),m.lineTo(n[0],n[1]),U&&($.fill(vt[r+2][5]),Ln()),H&&($.stroke(vt[r+2][6]),Dn()),m.closePath();else if(10===he)for(r=0;r+1<h;r++)n=vt[r],m.beginPath(),m.moveTo(vt[r+1][0],vt[r+1][1]),m.lineTo(n[0],n[1]),H&&$.stroke(vt[r+1][6]),U&&$.fill(vt[r+1][5]),r+2<h&&(m.lineTo(vt[r+2][0],vt[r+2][1]),H&&$.stroke(vt[r+2][6]),U&&$.fill(vt[r+2][5])),Fn();else if(11===he){if(2<h)for(m.beginPath(),m.moveTo(vt[0][0],vt[0][1]),m.lineTo(vt[1][0],vt[1][1]),m.lineTo(vt[2][0],vt[2][1]),U&&($.fill(vt[2][5]),Ln()),H&&($.stroke(vt[2][6]),Dn()),m.closePath(),r=3;r<h;r++)n=vt[r],m.beginPath(),m.moveTo(vt[0][0],vt[0][1]),m.lineTo(vt[r-1][0],vt[r-1][1]),m.lineTo(n[0],n[1]),U&&($.fill(n[5]),Ln()),H&&($.stroke(n[6]),Dn()),m.closePath()}else if(16===he)for(r=0;r+3<h;r+=4){for(n=vt[r],m.beginPath(),m.moveTo(n[0],n[1]),i=1;i<4;i++)m.lineTo(vt[r+i][0],vt[r+i][1]);m.lineTo(n[0],n[1]),U&&($.fill(vt[r+3][5]),Ln()),H&&($.stroke(vt[r+3][6]),Dn()),m.closePath()}else if(17===he){if(3<h)for(r=0;r+1<h;r+=2)n=vt[r],m.beginPath(),r+3<h?(m.moveTo(vt[r+2][0],vt[r+2][1]),m.lineTo(n[0],n[1]),m.lineTo(vt[r+1][0],vt[r+1][1]),m.lineTo(vt[r+3][0],vt[r+3][1]),U&&$.fill(vt[r+3][5]),H&&$.stroke(vt[r+3][6])):(m.moveTo(n[0],n[1]),m.lineTo(vt[r+1][0],vt[r+1][1])),Fn()}else{for(m.beginPath(),m.moveTo(vt[0][0],vt[0][1]),r=1;r<h;r++)(n=vt[r]).isVert&&(n.moveTo?m.moveTo(n[0],n[1]):m.lineTo(n[0],n[1]));Fn()}else{for(m.beginPath(),r=0;r<h;r++)n=vt[r],vt[r].isVert?vt[r].moveTo?m.moveTo(n[0],n[1]):m.lineTo(n[0],n[1]):m.bezierCurveTo(vt[r][0],vt[r][1],vt[r][2],vt[r][3],vt[r][4],vt[r][5]);Fn()}else if(3<h){var u=[],f=1-ue;for(m.beginPath(),m.moveTo(vt[1][0],vt[1][1]),r=1;r+2<h;r++)n=vt[r],u[0]=[n[0],n[1]],u[1]=[n[0]+(f*vt[r+1][0]-f*vt[r-1][0])/6,n[1]+(f*vt[r+1][1]-f*vt[r-1][1])/6],u[2]=[vt[r+1][0]+(f*vt[r][0]-f*vt[r+2][0])/6,vt[r+1][1]+(f*vt[r][1]-f*vt[r+2][1])/6],u[3]=[vt[r+1][0],vt[r+1][1]],m.bezierCurveTo(u[1][0],u[1][1],u[2][0],u[2][1],u[3][0],u[3][1]);Fn()}wt=xt=!1,yt=[],bt=0,t&&vt.pop()}},Gt.prototype.endShape=function(e){if(0!==vt.length){var t,n,r,i,s=2===e,o=[],a=[],l=[],h=[],u=[];At=!0;var f=vt.length;for(n=0;n<f;n++)for(t=vt[n],r=0;r<3;r++)a.push(t[r]);for(n=0;n<f;n++)for(t=vt[n],r=5;r<9;r++)l.push(t[r]);for(n=0;n<f;n++)for(t=vt[n],r=9;r<13;r++)h.push(t[r]);for(n=0;n<f;n++)t=vt[n],u.push(t[3]),u.push(t[4]);if(s){for(a.push(vt[0][0]),a.push(vt[0][1]),a.push(vt[0][2]),n=5;n<9;n++)l.push(vt[0][n]);for(n=9;n<13;n++)h.push(vt[0][n]);u.push(vt[0][3]),u.push(vt[0][4])}if(!xt||20!==he&&he!==wr)if(!wt||20!==he&&he!==wr){if(2===he){for(n=0;n<f;n++)for(t=vt[n],r=0;r<3;r++)o.push(t[r]);In(o,h)}else if(4===he){for(n=0;n<f;n++)for(t=vt[n],r=0;r<3;r++)o.push(t[r]);for(n=0;n<f;n++)for(t=vt[n],r=5;r<9;r++)l.push(t[r]);On(o,"LINES",h)}else if(9===he){if(2<f)for(n=0;n+2<f;n+=3){for(a=[],u=[],o=[],l=[],h=[],r=0;r<3;r++)for(i=0;i<3;i++)o.push(vt[n+r][i]),a.push(vt[n+r][i]);for(r=0;r<3;r++)for(i=3;i<5;i++)u.push(vt[n+r][i]);for(r=0;r<3;r++)for(i=5;i<9;i++)l.push(vt[n+r][i]),h.push(vt[n+r][i+4]);H&&On(o,"LINE_LOOP",h),(U||ke)&&Nn(a,"TRIANGLES",l,u)}}else if(10===he){if(2<f)for(n=0;n+2<f;n++){for(o=[],a=[],h=[],l=[],u=[],r=0;r<3;r++)for(i=0;i<3;i++)o.push(vt[n+r][i]),a.push(vt[n+r][i]);for(r=0;r<3;r++)for(i=3;i<5;i++)u.push(vt[n+r][i]);for(r=0;r<3;r++)for(i=5;i<9;i++)h.push(vt[n+r][i+4]),l.push(vt[n+r][i]);(U||ke)&&Nn(a,"TRIANGLE_STRIP",l,u),H&&On(o,"LINE_LOOP",h)}}else if(11===he){if(2<f){for(n=0;n<3;n++)for(t=vt[n],r=0;r<3;r++)o.push(t[r]);for(n=0;n<3;n++)for(t=vt[n],r=9;r<13;r++)h.push(t[r]);for(H&&On(o,"LINE_LOOP",h),n=2;n+1<f;n++){for(h=[],(o=[]).push(vt[0][0]),o.push(vt[0][1]),o.push(vt[0][2]),h.push(vt[0][9]),h.push(vt[0][10]),h.push(vt[0][11]),h.push(vt[0][12]),r=0;r<2;r++)for(i=0;i<3;i++)o.push(vt[n+r][i]);for(r=0;r<2;r++)for(i=9;i<13;i++)h.push(vt[n+r][i]);H&&On(o,"LINE_STRIP",h)}(U||ke)&&Nn(a,"TRIANGLE_FAN",l,u)}}else if(16===he)for(n=0;n+3<f;n+=4){for(o=[],r=0;r<4;r++)for(t=vt[n+r],i=0;i<3;i++)o.push(t[i]);if(H&&On(o,"LINE_LOOP",h),U){for(a=[],l=[],u=[],r=0;r<3;r++)a.push(vt[n][r]);for(r=5;r<9;r++)l.push(vt[n][r]);for(r=0;r<3;r++)a.push(vt[n+1][r]);for(r=5;r<9;r++)l.push(vt[n+1][r]);for(r=0;r<3;r++)a.push(vt[n+3][r]);for(r=5;r<9;r++)l.push(vt[n+3][r]);for(r=0;r<3;r++)a.push(vt[n+2][r]);for(r=5;r<9;r++)l.push(vt[n+2][r]);ke&&(u.push(vt[n+0][3]),u.push(vt[n+0][4]),u.push(vt[n+1][3]),u.push(vt[n+1][4]),u.push(vt[n+3][3]),u.push(vt[n+3][4]),u.push(vt[n+2][3]),u.push(vt[n+2][4])),Nn(a,"TRIANGLE_STRIP",l,u)}}else if(17===he){if(3<f){for(n=0;n<2;n++)for(t=vt[n],r=0;r<3;r++)o.push(t[r]);for(n=0;n<2;n++)for(t=vt[n],r=9;r<13;r++)h.push(t[r]);for(On(o,"LINE_STRIP",h),4<f&&0<f%2&&(a.splice(a.length-3),vt.pop()),n=0;n+3<f;n+=2){for(o=[],h=[],r=0;r<3;r++)o.push(vt[n+1][r]);for(r=0;r<3;r++)o.push(vt[n+3][r]);for(r=0;r<3;r++)o.push(vt[n+2][r]);for(r=0;r<3;r++)o.push(vt[n+0][r]);for(r=9;r<13;r++)h.push(vt[n+1][r]);for(r=9;r<13;r++)h.push(vt[n+3][r]);for(r=9;r<13;r++)h.push(vt[n+2][r]);for(r=9;r<13;r++)h.push(vt[n+0][r]);H&&On(o,"LINE_STRIP",h)}(U||ke)&&Nn(a,"TRIANGLE_LIST",l,u)}}else if(1===f){for(r=0;r<3;r++)o.push(vt[0][r]);for(r=9;r<13;r++)h.push(vt[0][r]);In(o,h)}else{for(n=0;n<f;n++){for(t=vt[n],r=0;r<3;r++)o.push(t[r]);for(r=5;r<9;r++)h.push(t[r])}H&&s?On(o,"LINE_LOOP",h):H&&!s&&On(o,"LINE_STRIP",h),(U||ke)&&Nn(a,"TRIANGLE_FAN",l,u)}ke=!1,m.useProgram(y),Dt("usingTexture3d",y,"usingTexture",ke)}else(o=a).splice(o.length-3),h.splice(h.length-4),H&&On(o,null,h),U&&Nn(a,"TRIANGLES",l);else o=a,H&&On(o,null,h),U&&Nn(a,null,l);wt=xt=!1,yt=[],bt=0}};function Mn(e,t){var n=1/e,r=n*n,i=r*n;t.set(0,0,0,1,i,r,n,0,6*i,2*r,0,0,6*i,0,0,0)}function $n(){P||(i=new en,P=new en,ce=!0);var e=ue;i.set((e-1)/2,(e+3)/2,(-3-e)/2,(1-e)/2,1-e,(-5-e)/2,e+2,(e-1)/2,(e-1)/2,0,(1-e)/2,0,0,1,0,0),Mn(fe,P),o||(s=new en),s.set(i),s.preApply(o),P.apply(i)}Ut.prototype.bezierVertex=function(){wt=!0;var e=[];if(At)throw"vertex() must be used at least once before calling bezierVertex()";for(var t=0;t<arguments.length;t++)e[t]=arguments[t];vt.push(e),vt[vt.length-1].isVert=!1},Gt.prototype.bezierVertex=function(){wt=!0;if(At)throw"vertex() must be used at least once before calling bezierVertex()";if(9===arguments.length){d===wr&&(d=new en);var e=vt.length-1;Mn(ge,d),d.apply(v);for(var t=d.array(),n=vt[e][0],r=vt[e][1],i=vt[e][2],s=t[4]*n+t[5]*arguments[0]+t[6]*arguments[3]+t[7]*arguments[6],o=t[8]*n+t[9]*arguments[0]+t[10]*arguments[3]+t[11]*arguments[6],a=t[12]*n+t[13]*arguments[0]+t[14]*arguments[3]+t[15]*arguments[6],l=t[4]*r+t[5]*arguments[1]+t[6]*arguments[4]+t[7]*arguments[7],h=t[8]*r+t[9]*arguments[1]+t[10]*arguments[4]+t[11]*arguments[7],u=t[12]*r+t[13]*arguments[1]+t[14]*arguments[4]+t[15]*arguments[7],f=t[4]*i+t[5]*arguments[2]+t[6]*arguments[5]+t[7]*arguments[8],c=t[8]*i+t[9]*arguments[2]+t[10]*arguments[5]+t[11]*arguments[8],p=t[12]*i+t[13]*arguments[2]+t[14]*arguments[5]+t[15]*arguments[8],g=0;g<ge;g++)n+=s,s+=o,o+=a,r+=l,l+=h,h+=u,i+=f,f+=c,c+=p,$.vertex(n,r,i);$.vertex(arguments[6],arguments[7],arguments[8])}},$.texture=function(e){var t=A.$ensureContext();if(e.__texture)t.bindTexture(t.TEXTURE_2D,e.__texture);else if("canvas"===e.localName)t.bindTexture(t.TEXTURE_2D,k),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.generateMipmap(t.TEXTURE_2D),_e.width=e.width,_e.height=e.height;else{var n,r=t.createTexture(),i=br.createElement("canvas"),s=i.getContext("2d");if(e.width&e.width-1==0)i.width=e.width;else{for(n=1;n<e.width;)n*=2;i.width=n}if(e.height&e.height-1==0)i.height=e.height;else{for(n=1;n<e.height;)n*=2;i.height=n}s.drawImage(e.sourceImg,0,0,e.width,e.height,0,0,i.width,i.height),t.bindTexture(t.TEXTURE_2D,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),t.generateMipmap(t.TEXTURE_2D),e.__texture=r,_e.width=e.width,_e.height=e.height}ke=!0,t.useProgram(y),Dt("usingTexture3d",y,"usingTexture",ke)},$.textureMode=function(e){Re=e};Ut.prototype.curveVertex=function(e,t){xt=!0,$.vertex(e,t)},Gt.prototype.curveVertex=function(e,t,n){xt=!0,ce||$n();var r=[];r[0]=e,r[1]=t,r[2]=n,yt.push(r),3<++bt&&function(e,t,n,r,i,s,o,a,l,h,u,f){var c=r,p=i,g=s,m=P.array(),d=m[4]*e+m[5]*r+m[6]*o+m[7]*h,v=m[8]*e+m[9]*r+m[10]*o+m[11]*h,y=m[12]*e+m[13]*r+m[14]*o+m[15]*h,b=m[4]*t+m[5]*i+m[6]*a+m[7]*u,x=m[8]*t+m[9]*i+m[10]*a+m[11]*u,w=m[12]*t+m[13]*i+m[14]*a+m[15]*u,A=m[4]*n+m[5]*s+m[6]*l+m[7]*f,C=m[8]*n+m[9]*s+m[10]*l+m[11]*f,T=m[12]*n+m[13]*s+m[14]*l+m[15]*f;$.vertex(c,p,g);for(var S=0;S<fe;S++)c+=d,d+=v,v+=y,p+=b,b+=x,x+=w,g+=A,A+=C,C+=T,$.vertex(c,p,g)}(yt[bt-4][0],yt[bt-4][1],yt[bt-4][2],yt[bt-3][0],yt[bt-3][1],yt[bt-3][2],yt[bt-2][0],yt[bt-2][1],yt[bt-2][2],yt[bt-1][0],yt[bt-1][1],yt[bt-1][2])},Ut.prototype.curve=function(){8===arguments.length&&($.beginShape(),$.curveVertex(arguments[0],arguments[1]),$.curveVertex(arguments[2],arguments[3]),$.curveVertex(arguments[4],arguments[5]),$.curveVertex(arguments[6],arguments[7]),$.endShape())},Gt.prototype.curve=function(){12===arguments.length&&($.beginShape(),$.curveVertex(arguments[0],arguments[1],arguments[2]),$.curveVertex(arguments[3],arguments[4],arguments[5]),$.curveVertex(arguments[6],arguments[7],arguments[8]),$.curveVertex(arguments[9],arguments[10],arguments[11]),$.endShape())},$.curveTightness=function(e){ue=e},$.curveDetail=function(e){fe=e,$n()},$.rectMode=function(e){ee=e},$.imageMode=function(e){switch(e){case 0:Vt=Mt;break;case 1:Vt=$t;break;case 3:Vt=zt;break;default:throw"Invalid imageMode"}},$.ellipseMode=function(e){te=e},$.arc=function(e,t,n,r,i,s){if(!(n<=0||s<i)){for(1===te?(n-=e,r-=t):2===te?(e-=n,t-=r,n*=2,r*=2):3===te&&(e-=n/2,t-=r/2);i<0;)i+=6.283185307179586,s+=6.283185307179586;6.283185307179586<s-i&&(i=0,s=6.283185307179586);var o,a,l=n/2,h=r/2,u=e+l,f=t+h,c=0|i*$.RAD_TO_DEG*2-.5,p=0|.5+s*$.RAD_TO_DEG*2;if(U){var g=H;for(H=!1,$.beginShape(),$.vertex(u,f),o=c;o<=p;o++)a=o%720,$.vertex(u+lt[a]*l,f+at[a]*h);$.endShape(2),H=g}if(H){var m=U;for(U=!1,$.beginShape(),o=c;o<=p;o++)a=o%720,$.vertex(u+lt[a]*l,f+at[a]*h);$.endShape(),U=m}}},Ut.prototype.line=function(e,t,n,r){if(H)if(e=xr.round(e),n=xr.round(n),t=xr.round(t),r=xr.round(r),e!==n||t!==r){for(var i=wr,s=wr,o=!0,a=je.array(),l=[1,0,0,0,1,0],h=0;h<6&&o;h++)o=a[h]===l[h];o&&(e===n?(r<t&&(i=t,t=r,r=i),r++,q%2==1&&m.translate(.5,0)):t===r&&(n<e&&(i=e,e=n,n=i),n++,q%2==1&&m.translate(0,.5)),1===q&&(s=m.lineCap,m.lineCap="butt")),m.beginPath(),m.moveTo(e||0,t||0),m.lineTo(n||0,r||0),Dn(),o&&(e===n&&q%2==1?m.translate(-.5,0):t===r&&q%2==1&&m.translate(0,-.5),1===q&&(m.lineCap=s))}else $.point(e,t)},Gt.prototype.line=function(e,t,n,r,i,s){if(i!==wr&&s!==wr||(i=r,r=n,n=s=0),e!==r||t!==i||n!==s){var o=[e,t,n,r,i,s],a=new en;a.scale(1,-1,1),a.apply(je.array()),a.transpose(),0<q&&H&&(m.useProgram(p),It("model2d",p,"model",!1,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),It("view2d",p,"view",!1,a.array()),Lt("color2d",p,"color",Z),Dt("picktype2d",p,"picktype",0),Ot("vertex2d",p,"Vertex",3,T),Nt("aTextureCoord2d",p,"aTextureCoord"),m.bufferData(m.ARRAY_BUFFER,new Tr(o),m.STREAM_DRAW),m.drawArrays(m.LINES,0,2))}else $.point(e,t,n)},Ut.prototype.bezier=function(){if(8!==arguments.length)throw"You must use 8 parameters for bezier() in 2D mode";$.beginShape(),$.vertex(arguments[0],arguments[1]),$.bezierVertex(arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7]),$.endShape()},Gt.prototype.bezier=function(){if(12!==arguments.length)throw"You must use 12 parameters for bezier() in 3D mode";$.beginShape(),$.vertex(arguments[0],arguments[1],arguments[2]),$.bezierVertex(arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10],arguments[11]),$.endShape()},$.bezierDetail=function(e){ge=e},$.bezierPoint=function(e,t,n,r,i){return(1-i)*(1-i)*(1-i)*e+3*(1-i)*(1-i)*i*t+3*(1-i)*i*i*n+i*i*i*r},$.bezierTangent=function(e,t,n,r,i){return 3*i*i*(3*t-e-3*n+r)+6*i*(e-2*t+n)+3*(-e+t)},$.curvePoint=function(e,t,n,r,i){return.5*(2*t+(-e+n)*i+(2*e-5*t+4*n-r)*i*i+(3*t-e-3*n+r)*i*i*i)},$.curveTangent=function(e,t,n,r,i){return.5*(-e+n+2*(2*e-5*t+4*n-r)*i+3*(3*t-e-3*n+r)*i*i)},$.triangle=function(e,t,n,r,i,s){$.beginShape(9),$.vertex(e,t,0),$.vertex(n,r,0),$.vertex(i,s,0),$.endShape()},$.quad=function(e,t,n,r,i,s,o,a){$.beginShape(16),$.vertex(e,t,0),$.vertex(n,r,0),$.vertex(i,s,0),$.vertex(o,a,0),$.endShape()};Ut.prototype.rect=function(e,t,n,r,i,s,o,a){(n||r)&&(1===ee?(n-=e,r-=t):2===ee?(e-=(n*=2)/2,t-=(r*=2)/2):3===ee&&(e-=n/2,t-=r/2),e=xr.round(e),t=xr.round(t),n=xr.round(n),r=xr.round(r),i===wr?(H&&q%2==1&&m.translate(.5,.5),m.beginPath(),m.rect(e,t,n,r),Ln(),Dn(),H&&q%2==1&&m.translate(-.5,-.5)):function(e,t,n,r,i,s,o,a){a===wr&&(a=o=s=i);var l=n/2,h=r/2;(l<i||h<i)&&(i=xr.min(l,h)),(l<s||h<s)&&(s=xr.min(l,h)),(l<o||h<o)&&(o=xr.min(l,h)),(l<a||h<a)&&(a=xr.min(l,h)),U&&!H||m.translate(.5,.5),m.beginPath(),m.moveTo(e+i,t),m.lineTo(e+n-s,t),m.quadraticCurveTo(e+n,t,e+n,t+s),m.lineTo(e+n,t+r-o),m.quadraticCurveTo(e+n,t+r,e+n-o,t+r),m.lineTo(e+a,t+r),m.quadraticCurveTo(e,t+r,e,t+r-a),m.lineTo(e,t+i),m.quadraticCurveTo(e,t,e+i,t),U&&!H||m.translate(-.5,-.5),Ln(),Dn()}(e,t,n,r,i,s,o,a))},Gt.prototype.rect=function(e,t,n,r,i,s,o,a){if(i!==wr)throw"rect() with rounded corners is not supported in 3D mode";1===ee?(n-=e,r-=t):2===ee?(e-=(n*=2)/2,t-=(r*=2)/2):3===ee&&(e-=n/2,t-=r/2);var l=new en;l.translate(e,t,0),l.scale(n,r,1),l.transpose();var h=new en;if(h.scale(1,-1,1),h.apply(je.array()),h.transpose(),0<q&&H&&(m.useProgram(p),It("model2d",p,"model",!1,l.array()),It("view2d",p,"view",!1,h.array()),Lt("color2d",p,"color",Z),Dt("picktype2d",p,"picktype",0),Ot("vertex2d",p,"Vertex",3,x),Nt("aTextureCoord2d",p,"aTextureCoord"),m.drawArrays(m.LINE_LOOP,0,_t.length/3)),U){if(m.useProgram(y),It("model3d",y,"model",!1,l.array()),It("view3d",y,"view",!1,h.array()),m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(1,1),Lt("color3d",y,"color",G),0<tt){var u=new en;u.set(h);var f=new en;f.set(l),u.mult(f);var c=new en;c.set(u),c.invert(),c.transpose(),It("normalTransform3d",y,"normalTransform",!1,c.array()),Ot("normal3d",y,"Normal",3,w)}else Nt("normal3d",y,"Normal");Ot("vertex3d",y,"Vertex",3,x),m.drawArrays(m.TRIANGLE_FAN,0,_t.length/3),m.disable(m.POLYGON_OFFSET_FILL)}},Ut.prototype.ellipse=function(e,t,n,r){if(e=e||0,t=t||0,!(n<=0&&r<=0))if(2===te?(n*=2,r*=2):1===te?(e+=(n-=e)/2,t+=(r-=t)/2):0===te&&(e+=n/2,t+=r/2),n===r)m.beginPath(),m.arc(e,t,n/2,0,6.283185307179586,!1),Ln(),Dn();else{var i=n/2,s=r/2,o=.5522847498307933,a=o*i,l=o*s;$.beginShape(),$.vertex(e+i,t),$.bezierVertex(e+i,t-l,e+a,t-s,e,t-s),$.bezierVertex(e-a,t-s,e-i,t-l,e-i,t),$.bezierVertex(e-i,t+l,e-a,t+s,e,t+s),$.bezierVertex(e+a,t+s,e+i,t+l,e+i,t),$.endShape()}},Gt.prototype.ellipse=function(e,t,n,r){if(e=e||0,t=t||0,!(n<=0&&r<=0)){2===te?(n*=2,r*=2):1===te?(e+=(n-=e)/2,t+=(r-=t)/2):0===te&&(e+=n/2,t+=r/2);var i=n/2,s=r/2,o=.5522847498307933,a=o*i,l=o*s;if($.beginShape(),$.vertex(e+i,t),$.bezierVertex(e+i,t-l,0,e+a,t-s,0,e,t-s,0),$.bezierVertex(e-a,t-s,0,e-i,t-l,0,e-i,t,0),$.bezierVertex(e-i,t+l,0,e-a,t+s,0,e,t+s,0),$.bezierVertex(e+a,t+s,0,e+i,t+l,0,e+i,t,0),$.endShape(),U){var h,u,f=0,c=0;for(h=0;h<vt.length;h++)f+=vt[h][0],c+=vt[h][1];f/=vt.length,c/=vt.length;var p=[],g=[],m=[];for(p[0]=f,p[1]=c,p[2]=0,p[3]=0,p[4]=0,p[5]=G[0],p[6]=G[1],p[7]=G[2],p[8]=G[3],p[9]=Z[0],p[10]=Z[1],p[11]=Z[2],p[12]=Z[3],p[13]=ne,p[14]=re,p[15]=ie,vt.unshift(p),h=0;h<vt.length;h++){for(u=0;u<3;u++)g.push(vt[h][u]);for(u=5;u<9;u++)m.push(vt[h][u])}Nn(g,"TRIANGLE_FAN",m)}}},$.normal=function(e,t,n){if(3!==arguments.length||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n)throw"normal() requires three numeric arguments.";ne=e,re=t,ie=n,0!==he&&(0===se?se=1:1===se&&(se=2))},$.save=function(e,t){return t!==wr?yr.open(t.toDataURL(),"_blank"):yr.open($.externals.canvas.toDataURL(),"_blank")};var zn=0;$.saveFrame=function(e){e===wr&&(e="screen-####.png");var t=e.replace(/#+/,function(e){for(var t=""+zn++;t.length<e.length;)t="0"+t;return t});$.save(t)};var Bn=br.createElement("canvas").getContext("2d"),Vn=[wr,wr,wr];function Un(e,t,n){var r=Vn.shift();r===wr&&((r={}).canvas=br.createElement("canvas"),r.context=r.canvas.getContext("2d")),Vn.push(r);var i=r.canvas,s=r.context,o=t||e.width,a=n||e.height;return i.width=o,i.height=a,e?"data"in e?s.putImageData(e,0,0):(s.clearRect(0,0,o,a),s.drawImage(e,0,0,o,a)):s.clearRect(0,0,o,a),r}var Gn=function(e,t,n){if(this.__isDirty=!1,e instanceof HTMLImageElement)this.fromHTMLImageData(e);else if(t||n){this.width=e||1,this.height=t||1;var r=this.sourceImg=br.createElement("canvas");r.width=this.width,r.height=this.height;this.imageData=r.getContext("2d").createImageData(this.width,this.height);if(this.format=2===n||4===n?n:1,1===this.format)for(var i=3,s=this.imageData.data,o=s.length;i<o;i+=4)s[i]=255;this.__isDirty=!0,this.updatePixels()}else this.width=0,this.height=0,this.imageData=Bn.createImageData(1,1),this.format=2;this.pixels=function(e){return{getLength:(t=e,function(){if(t.isRemote)throw"Image is loaded remotely. Cannot get length.";return t.imageData.data.length?t.imageData.data.length/4:0}),getPixel:(r=e,function(e){var t=4*e,n=r.imageData.data;if(r.isRemote)throw"Image is loaded remotely. Cannot get pixels.";return(255&n[3+t])<<24|(255&n[t])<<16|(255&n[1+t])<<8|255&n[2+t]}),setPixel:(i=e,function(e,t){var n=4*e,r=i.imageData.data;if(i.isRemote)throw"Image is loaded remotely. Cannot set pixel.";r[0+n]=t>>16&255,r[1+n]=t>>8&255,r[2+n]=255&t,r[3+n]=t>>24&255,i.__isDirty=!0}),toArray:(s=e,function(){var e=[],t=s.imageData.data,n=s.width*s.height;if(s.isRemote)throw"Image is loaded remotely. Cannot get pixels.";for(var r=0,i=0;r<n;r++,i+=4)e.push((255&t[i+3])<<24|(255&t[i])<<16|(255&t[i+1])<<8|255&t[i+2]);return e}),set:(o=e,function(e){var t,n,r;if(this.isRemote)throw"Image is loaded remotely. Cannot set pixels.";n=o.imageData.data;for(var i=0,s=e.length;i<s;i++)r=e[i],n[0+(t=4*i)]=r>>16&255,n[1+t]=r>>8&255,n[2+t]=255&r,n[3+t]=r>>24&255;o.__isDirty=!0})};var o,s,i,r,t}(this)};function Xn(e,t,n,r){var i=new Gn(n,r,2);return i.fromImageData($.toImageData(e,t,n,r)),i}function Yn(e,t,n,r,i){if(i.isRemote)throw"Image is loaded remotely. Cannot get x,y,w,h.";for(var s=new Gn(n,r,2),o=s.imageData.data,a=i.width,l=i.height,h=i.imageData.data,u=xr.max(0,-t),f=xr.max(0,-e),c=xr.min(r,l-t),p=xr.min(n,a-e),g=u;g<c;++g)for(var m=4*((t+g)*a+(e+f)),d=4*(g*n+f),v=f;v<p;++v)o[d++]=h[m++],o[d++]=h[m++],o[d++]=h[m++],o[d++]=h[m++];return s.__isDirty=!0,s}function Hn(){Ve&&(m=N,Ve=!1,$.updatePixels())}function Zn(){function e(e,t){e[t]=function(){Hn(),m[t].apply(m,arguments)}}function t(e,t){$.defineProperty(e,t,{get:function(){return Hn(),m[t]},set:function(e){Hn(),m[t]=e}})}for(var n in m)"function"==typeof m[n]?e(this,n):t(this,n)}function Wn(e,t,n){e<$.width&&0<=e&&0<=t&&t<$.height&&(Ve||($.loadPixels(),null===Be&&(N=m,Be=new Zn),Ve=!0,m=Be,F=0),$.pixels.setPixel((0|e)+$.width*(0|t),n),++F>Ue&&Hn())}Gn.prototype={__isPImage:!0,updatePixels:function(){var e=this.sourceImg;e&&e instanceof HTMLCanvasElement&&this.__isDirty&&e.getContext("2d").putImageData(this.imageData,0,0),this.__isDirty=!1},fromHTMLImageData:function(t){var e=Un(t);try{var n=e.context.getImageData(0,0,t.width,t.height);this.fromImageData(n)}catch(e){t.width&&t.height&&(this.isRemote=!0,this.width=t.width,this.height=t.height)}this.sourceImg=t},get:function(e,t,n,r){return arguments.length?2===arguments.length?$.get(e,t,this):4===arguments.length?$.get(e,t,n,r,this):void 0:$.get(this)},set:function(e,t,n){$.set(e,t,n,this),this.__isDirty=!0},blend:function(e,t,n,r,i,s,o,a,l,h){9===arguments.length?$.blend(this,e,t,n,r,i,s,o,a,l,this):10===arguments.length&&$.blend(e,t,n,r,i,s,o,a,l,h,this),delete this.sourceImg},copy:function(e,t,n,r,i,s,o,a,l){8===arguments.length?$.blend(this,e,t,n,r,i,s,o,a,0,this):9===arguments.length&&$.blend(e,t,n,r,i,s,o,a,l,0,this),delete this.sourceImg},filter:function(e,t){2===arguments.length?$.filter(e,t,this):1===arguments.length&&$.filter(e,null,this),delete this.sourceImg},save:function(e){$.save(e,this)},resize:function(e,t){if(this.isRemote)throw"Image is loaded remotely. Cannot resize.";if(0!==this.width||0!==this.height){0===e&&0!==t?e=xr.floor(this.width/this.height*t):0===t&&0!==e&&(t=xr.floor(this.height/this.width*e));var n=Un(Un(this.imageData).canvas,e,t).context.getImageData(0,0,e,t);this.fromImageData(n)}},mask:function(e){var t,n,r=this.toImageData();if(e instanceof Gn||e.__isPImage){if(e.width!==this.width||e.height!==this.height)throw"mask must have the same dimensions as PImage.";for(e=e.toImageData(),t=2,n=this.width*this.height*4;t<n;t+=4)r.data[t+1]=e.data[t]}else if(e instanceof Array){if(this.width*this.height!==e.length)throw"mask array must be the same length as PImage pixels array.";for(t=0,n=e.length;t<n;++t)r.data[4*t+3]=e[t]}this.fromImageData(r)},loadPixels:Cr,toImageData:function(){return this.isRemote?this.sourceImg:this.__isDirty?Un(this.imageData).context.getImageData(0,0,this.width,this.height):this.imageData},toDataURL:function(){if(this.isRemote)throw"Image is loaded remotely. Cannot create dataURI.";return Un(this.imageData).canvas.toDataURL()},fromImageData:function(e){var t=e.width,n=e.height,r=br.createElement("canvas"),i=r.getContext("2d");this.width=r.width=t,this.height=r.height=n,i.putImageData(e,0,0),this.format=2,this.imageData=e,this.sourceImg=r}},$.PImage=Gn,$.createImage=function(e,t,n){return new Gn(e,t,n)},$.loadImage=function(e,t,n){var r;if(t&&(e=e+"."+t),h.imageCache.images[e])return(r=new Gn(h.imageCache.images[e])).loaded=!0,r;r=new Gn;var i,s,o,a=br.createElement("img");return(r.sourceImg=a).onload=(i=a,s=r,o=n,function(){s.fromHTMLImageData(i),s.loaded=!0,o&&o()}),a.src=e,r},$.requestImage=$.loadImage,$.get=function(e,t,n,r,i){return void 0!==i?Yn(e,t,n,r,i):void 0!==r?Xn(e,t,n,r):void 0!==n?function(e,t,n){if(n.isRemote)throw"Image is loaded remotely. Cannot get x,y.";var r=t*n.width*4+4*e,i=n.imageData.data;return(255&i[3+r])<<24|(255&i[r])<<16|(255&i[1+r])<<8|255&i[2+r]}(e,t,n):void 0!==t?function(e,t){var n;if(e>=$.width||e<0||t<0||t>=$.height)return 0;if(Ve){var r=4*((0|e)+$.width*(0|t));return(255&(n=$.imageData.data)[3+r])<<24|(255&n[r])<<16|(255&n[1+r])<<8|255&n[2+r]}return(255&(n=$.toImageData(0|e,0|t,1,1).data)[3])<<24|(255&n[0])<<16|(255&n[1])<<8|255&n[2]}(e,t):void 0!==e?Yn(0,0,e.width,e.height,e):Xn(0,0,$.width,$.height)},$.createGraphics=function(e,t,n){var r=new Fr;return r.size(e,t,n),r},$.set=function(e,t,n,r){3===arguments.length?"number"==typeof n?Wn(e,t,n):(n instanceof Gn||n.__isPImage)&&$.image(n,e,t):4===arguments.length&&function(e,t,n,r){if(r.isRemote)throw"Image is loaded remotely. Cannot set x,y.";var i=$.color.toArray(n),s=t*r.width*4+4*e,o=r.imageData.data;o[s]=i[0],o[1+s]=i[1],o[2+s]=i[2],o[3+s]=i[3]}(e,t,n,r)},$.imageData={},$.pixels={getLength:function(){return $.imageData.data.length?$.imageData.data.length/4:0},getPixel:function(e){var t=4*e,n=$.imageData.data;return n[3+t]<<24&4278190080|n[0+t]<<16&16711680|n[1+t]<<8&65280|255&n[2+t]},setPixel:function(e,t){var n=4*e,r=$.imageData.data;r[0+n]=(16711680&t)>>>16,r[1+n]=(65280&t)>>>8,r[2+n]=255&t,r[3+n]=(4278190080&t)>>>24},toArray:function(){for(var e=[],t=$.imageData.width*$.imageData.height,n=$.imageData.data,r=0,i=0;r<t;r++,i+=4)e.push(n[i+3]<<24&4278190080|n[i+0]<<16&16711680|n[i+1]<<8&65280|255&n[i+2]);return e},set:function(e){for(var t=0,n=e.length;t<n;t++)this.setPixel(t,e[t])}},$.loadPixels=function(){$.imageData=A.$ensureContext().getImageData(0,0,$.width,$.height)},$.updatePixels=function(){$.imageData&&A.$ensureContext().putImageData($.imageData,0,0)},$.hint=function(e){var t=A.$ensureContext();4===e?(t.disable(t.DEPTH_TEST),t.depthMask(!1),t.clear(t.DEPTH_BUFFER_BIT)):-4===e&&(t.enable(t.DEPTH_TEST),t.depthMask(!0))};function jn(e,t,n,r){var i;if(e instanceof Gn||e.__isPImage){if(!(i=e).loaded)throw"Error using image in background(): PImage not loaded.";if(i.width!==$.width||i.height!==$.height)throw"Background image must be the same dimensions as the canvas."}else i=$.color(e,t,n,r);pe=i}Ut.prototype.background=function(e,t,n,r){e!==wr&&jn(e,t,n,r),pe instanceof Gn||pe.__isPImage?(cn(),m.setTransform(1,0,0,1,0,0),$.image(pe,0,0)):(cn(),m.setTransform(1,0,0,1,0,0),$.alpha(pe)!==me&&m.clearRect(0,0,$.width,$.height),m.fillStyle=$.color.toString(pe),m.fillRect(0,0,$.width,$.height),Y=!0),pn()},Gt.prototype.background=function(e,t,n,r){0<arguments.length&&jn(e,t,n,r);var i=$.color.toGLArray(pe);m.clearColor(i[0],i[1],i[2],i[3]),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT)},Ut.prototype.image=function(e,t,n,r,i){if(t=xr.round(t),n=xr.round(n),0<e.width){r||e.width,i||e.height;var s=Vt(t||0,n||0,r||e.width,i||e.height,arguments.length<4);if(!!e.sourceImg&&null===Ae){var o=e.sourceImg;e.__isDirty&&e.updatePixels(),m.drawImage(o,0,0,o.width,o.height,s.x,s.y,s.w,s.h)}else{var a=e.toImageData();null!==Ae&&(Ae(a),e.__isDirty=!0),m.drawImage(Un(a).canvas,0,0,e.width,e.height,s.x,s.y,s.w,s.h)}}},Gt.prototype.image=function(e,t,n,r,i){0<e.width&&(t=xr.round(t),n=xr.round(n),r=r||e.width,i=i||e.height,$.beginShape($.QUADS),$.texture(e),$.vertex(t,n,0,0,0),$.vertex(t,n+i,0,0,i),$.vertex(t+r,n+i,0,r,i),$.vertex(t+r,n,0,r,0),$.endShape())},$.tint=function(e,t,n,r){var i=$.color(e,t,n,r),s=$.red(i)/de,o=$.green(i)/ve,a=$.blue(i)/ye,l=$.alpha(i)/me;Ae=function(e){for(var t=e.data,n=4*e.width*e.height,r=0;r<n;)t[r++]*=s,t[r++]*=o,t[r++]*=a,t[r++]*=l},Ce=function(e){for(var t=0;t<e.length;)e[t++]=s,e[t++]=o,e[t++]=a,e[t++]=l}},$.noTint=function(){Ce=Ae=null},$.copy=function(e,t,n,r,i,s,o,a,l){l===wr&&(l=a,a=o,o=s,s=i,i=r,r=n,n=t,t=e,e=$),$.blend(e,t,n,r,i,s,o,a,l,0)},$.blend=function(e,t,n,r,i,s,o,a,l,h,u){if(e.isRemote)throw"Image is loaded remotely. Cannot blend image.";h===wr&&(h=l,l=a,a=o,o=s,s=i,i=r,r=n,n=t,t=e,e=$);var f=t+r,c=n+i,p=s+a,g=o+l,m=u||$;u!==wr&&h!==wr||$.loadPixels(),e.loadPixels(),e===$&&$.intersect(t,n,f,c,s,o,p,g)?$.blit_resize($.get(t,n,f-t,c-n),0,0,f-t-1,c-n-1,m.imageData.data,m.width,m.height,s,o,p,g,h):$.blit_resize(e,t,n,f,c,m.imageData.data,m.width,m.height,s,o,p,g,h),u===wr&&$.updatePixels()};function qn(e,t){var n,r,i,s,o,a,l,h,u,f,c,p,g,m,d,v=t.pixels.getLength(),y=new Tr(v),b=new Tr(v),x=new Tr(v),w=new Tr(v),A=0;!function(e){var t,n=$.floor(3.5*e);if(n=n<1?1:n<248?n:248,$.shared.blurRadius!==n){$.shared.blurRadius=n,$.shared.blurKernelSize=1+($.shared.blurRadius<<1),$.shared.blurKernel=new Tr($.shared.blurKernelSize);var r=$.shared.blurKernel,i=$.shared.blurKernelSize;$.shared.blurRadius;for(t=0;t<i;t++)r[t]=0;var s=(n-1)*(n-1);for(t=1;t<n;t++)r[n+t]=r[void 0]=s;r[n]=n*n}}(e);var C=t.height,T=t.width,S=$.shared.blurKernelSize,P=$.shared.blurRadius,E=$.shared.blurKernel,_=t.imageData.data;for(g=0;g<C;g++){for(p=0;p<T;p++){if(s=i=r=o=n=0,(l=p-P)<0)c=-l,l=0;else{if(T<=l)break;c=0}for(m=c;m<S&&!(T<=l);m++)d=4*(l+A),o+=(a=E[m])*_[d+3],r+=a*_[d],i+=a*_[d+1],s+=a*_[d+2],n+=a,l++;w[h=A+p]=o/n,y[h]=r/n,b[h]=i/n,x[h]=s/n}A+=T}for(f=(u=-P)*T,g=A=0;g<C;g++){for(p=0;p<T;p++){if(s=i=r=o=n=0,u<0)c=h=-u,l=p;else{if(C<=u)break;c=0,h=u,l=p+f}for(m=c;m<S&&!(C<=h);m++)o+=(a=E[m])*w[l],r+=a*y[l],i+=a*b[l],s+=a*x[l],n+=a,h++,l+=T;_[d=4*(p+A)]=r/n,_[d+1]=i/n,_[d+2]=s/n,_[d+3]=o/n}A+=T,f+=T,u++}}function Kn(e,t){var n,r,i,s,o,a,l,h,u,f,c,p,g,m,d,v,y,b=0,x=t.pixels.getLength(),w=new Sr(x);if(e)for(;b<x;)for(r=(n=b)+t.width;b<r;)i=s=t.pixels.getPixel(b),(l=b-1)<n&&(l=b),r<=(a=b+1)&&(a=b),(h=b-t.width)<0&&(h=0),x<=(u=b+t.width)&&(u=b),p=t.pixels.getPixel(h),c=t.pixels.getPixel(l),g=t.pixels.getPixel(u),(d=77*(c>>16&255)+151*(c>>8&255)+28*(255&c))<(o=77*(i>>16&255)+151*(i>>8&255)+28*(255&i))&&(s=c,o=d),(m=77*((f=t.pixels.getPixel(a))>>16&255)+151*(f>>8&255)+28*(255&f))<o&&(s=f,o=m),(v=77*(p>>16&255)+151*(p>>8&255)+28*(255&p))<o&&(s=p,o=v),(y=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))<o&&(s=g,o=y),w[b++]=s;else for(;b<x;)for(r=(n=b)+t.width;b<r;)i=s=t.pixels.getPixel(b),(l=b-1)<n&&(l=b),r<=(a=b+1)&&(a=b),(h=b-t.width)<0&&(h=0),x<=(u=b+t.width)&&(u=b),p=t.pixels.getPixel(h),c=t.pixels.getPixel(l),g=t.pixels.getPixel(u),(o=77*(i>>16&255)+151*(i>>8&255)+28*(255&i))<(d=77*(c>>16&255)+151*(c>>8&255)+28*(255&c))&&(s=c,o=d),o<(m=77*((f=t.pixels.getPixel(a))>>16&255)+151*(f>>8&255)+28*(255&f))&&(s=f,o=m),o<(v=77*(p>>16&255)+151*(p>>8&255)+28*(255&p))&&(s=p,o=v),o<(y=77*(g>>16&255)+151*(g>>8&255)+28*(255&g))&&(s=g,o=y),w[b++]=s;t.pixels.set(w)}$.filter=function(e,t,n){var r,i,s,o;if(r=3===arguments.length?(n.loadPixels(),n):($.loadPixels(),$),t===wr&&(t=null),r.isRemote)throw"Image is loaded remotely. Cannot filter image.";var a=r.pixels.getLength();switch(e){case 11:qn(t||1,r);break;case 12:if(4===r.format){for(o=0;o<a;o++)i=255-r.pixels.getPixel(o),r.pixels.setPixel(o,4278190080|i<<16|i<<8|i);r.format=1}else for(o=0;o<a;o++)s=77*((i=r.pixels.getPixel(o))>>16&255)+151*(i>>8&255)+28*(255&i)>>8,r.pixels.setPixel(o,4278190080&i|s<<16|s<<8|s);break;case 13:for(o=0;o<a;o++)r.pixels.setPixel(o,16777215^r.pixels.getPixel(o));break;case 15:if(null===t)throw"Use filter(POSTERIZE, int levels) instead of filter(POSTERIZE)";var l=$.floor(t);if(l<2||255<l)throw"Levels must be between 2 and 255 for filter(POSTERIZE, levels)";var h=l-1;for(o=0;o<a;o++){var u=r.pixels.getPixel(o)>>16&255,f=r.pixels.getPixel(o)>>8&255,c=255&r.pixels.getPixel(o);u=255*(u*l>>8)/h,f=255*(f*l>>8)/h,c=255*(c*l>>8)/h,r.pixels.setPixel(o,4278190080&r.pixels.getPixel(o)|u<<16|f<<8|c)}break;case 14:for(o=0;o<a;o++)r.pixels.setPixel(o,4278190080|r.pixels.getPixel(o));r.format=1;break;case 16:if(null===t&&(t=.5),t<0||1<t)throw"Level must be between 0 and 1 for filter(THRESHOLD, level)";var p=$.floor(255*t);for(o=0;o<a;o++){var g=$.max((16711680&r.pixels.getPixel(o))>>16,$.max((65280&r.pixels.getPixel(o))>>8,255&r.pixels.getPixel(o)));r.pixels.setPixel(o,4278190080&r.pixels.getPixel(o)|(g<p?0:16777215))}break;case 17:Kn(!0,r);break;case 18:Kn(!1,r)}r.updatePixels()},$.shared={fracU:0,ifU:0,fracV:0,ifV:0,u1:0,u2:0,v1:0,v2:0,sX:0,sY:0,iw:0,iw1:0,ih1:0,ul:0,ll:0,ur:0,lr:0,cUL:0,cLL:0,cUR:0,cLR:0,srcXOffset:0,srcYOffset:0,r:0,g:0,b:0,a:0,srcBuffer:null,blurRadius:0,blurKernelSize:0,blurKernel:null},$.intersect=function(e,t,n,r,i,s,o,a){var l=n-e+1,h=r-t+1,u=o-i+1,f=a-s+1;if(i<e)l<(u+=i-e)&&(u=l);else{var c=l+e-i;c<u&&(u=c)}if(s<t)h<(f+=s-t)&&(f=h);else{var p=h+t-s;p<f&&(f=p)}return!(u<=0||f<=0)};var Jn,Qn={};function er(e){return e instanceof String?e:"number"==typeof e?e===(0|e)?e.toString():$.nf(e,0,3):null===e||e===wr?"":e.toString()}function tr(e,t,n,r){var i,s;s=e.indexOf("\n")<0?(i=[e],1):(i=e.split(/\r?\n/g)).length;var o=0;101===De?o=Fe+Me:3===De?o=Fe/2-(s-1)*$e/2:102===De&&(o=-(Me+(s-1)*$e));for(var a=0;a<s;++a){var l=i[a];A.text$line(l,t,n+o,r,Le),o+=$e}}function nr(e,t,n,r,i,s){if(0!==e.length&&0!==r&&0!==i&&!(i<Ne)){for(var o=-1,a=0,l=0,h=[],u=0,f=e.length;u<f;u++){var c=e[u],p=" "===c,g=ze.measureTextWidth(c);if("\n"!==c&&l+g<=r)p&&(o=u),l+=g;else{if(o+1===a){if(!(0<u))return;o=u}a="\n"===c?(h.push({text:e.substring(a,u),width:l}),u+1):(h.push({text:e.substring(a,o+1),width:l}),o+1),l=0,u=a-1}}a<f&&h.push({text:e.substring(a),width:l});var m=1,d=Fe;3===Le?m=r/2:39===Le&&(m=r);var v,y,b,x=h.length,w=xr.min(x,xr.floor(i/$e));for(101===De?d=Fe+Me:3===De?d=i/2-$e*(w/2-1):102===De&&(d=Me+$e),v=0;v<x&&!(i-Me<d+(b=v*$e));v++)y=h[v],A.text$line(y.text,t+m,n+d+b,s,Le)}}function rr(e){for(var t in A="3D"===e?new Gt:"2D"===e?new Ut:new Xt,Xt.prototype)Xt.prototype.hasOwnProperty(t)&&t.indexOf("$")<0&&($[t]=A[t]);A.$init()}function ir(e){return function(){return rr("2D"),A[e].apply(this,arguments)}}function sr(e){var t=e,n=0,r=0;if($.pmouseX=$.mouseX,$.pmouseY=$.mouseY,t.offsetParent)for(;n+=t.offsetLeft,r+=t.offsetTop,t=t.offsetParent;);for(t=e;n-=t.scrollLeft||0,r-=t.scrollTop||0,t=t.parentNode;);return n+=M,r+=z,n+=B,r+=V,{X:n+=yr.pageXOffset,Y:r+=yr.pageYOffset}}function or(e,t){var n=sr(e);$.mouseX=t.pageX-n.X,$.mouseY=t.pageY-n.Y}function ar(e){var t,n=sr(e.changedTouches[0].target,e.changedTouches[0]);for(t=0;t<e.touches.length;t++){var r=e.touches[t];r.offsetX=r.pageX-n.X,r.offsetY=r.pageY-n.Y}for(t=0;t<e.targetTouches.length;t++){var i=e.targetTouches[t];i.offsetX=i.pageX-n.X,i.offsetY=i.pageY-n.Y}for(t=0;t<e.changedTouches.length;t++){var s=e.changedTouches[t];s.offsetX=s.pageX-n.X,s.offsetY=s.pageY-n.Y}return e}function lr(e){e.preventDefault(),e.stopPropagation()}Qn[1]=$.modes.blend,Qn[2]=$.modes.add,Qn[4]=$.modes.subtract,Qn[8]=$.modes.lightest,Qn[16]=$.modes.darkest,Qn[0]=$.modes.replace,Qn[32]=$.modes.difference,Qn[64]=$.modes.exclusion,Qn[128]=$.modes.multiply,Qn[256]=$.modes.screen,Qn[512]=$.modes.overlay,Qn[1024]=$.modes.hard_light,Qn[2048]=$.modes.soft_light,Qn[4096]=$.modes.dodge,Qn[8192]=$.modes.burn,$.blit_resize=function(e,t,n,r,i,s,o,a,l,h,u,f,c){var p,g;t<0&&(t=0),n<0&&(n=0),r>=e.width&&(r=e.width-1),i>=e.height&&(i=e.height-1);var m=r-t,d=i-n,v=u-l,y=f-h;if(!(v<=0||y<=0||m<=0||d<=0||o<=l||a<=h||t>=e.width||n>=e.height)){var b=xr.floor(m/v*32768),x=xr.floor(d/y*32768),w=$.shared;w.srcXOffset=xr.floor(l<0?-l*b:32768*t),w.srcYOffset=xr.floor(h<0?-h*x:32768*n),l<0&&(v+=l,l=0),h<0&&(y+=h,h=0),v=xr.min(v,o-l),y=xr.min(y,a-h);var A,C=h*o+l;w.srcBuffer=e.imageData.data,w.iw=e.width,w.iw1=e.width-1,w.ih1=e.height-1;$.filter_bilinear,$.filter_new_scanline;var T,S,P,E,_,R,k=Qn[c],L=4278190080,D=16711680,I=65280,O=255,N=32767,F=w.srcBuffer,M=xr.min;for(g=0;g<y;g++){for(w.sX=w.srcXOffset,w.fracV=w.srcYOffset&N,w.ifV=N-w.fracV,w.v1=(w.srcYOffset>>15)*w.iw,w.v2=M(1+(w.srcYOffset>>15),w.ih1)*w.iw,p=0;p<v;p++)A=s[3+(S=4*(C+p))]<<24&L|s[S]<<16&D|s[1+S]<<8&I|s[2+S]&O,w.fracU=w.sX&N,w.ifU=N-w.fracU,w.ul=w.ifU*w.ifV>>15,w.ll=w.ifU*w.fracV>>15,w.ur=w.fracU*w.ifV>>15,w.lr=w.fracU*w.fracV>>15,w.u1=w.sX>>15,w.u2=M(w.u1+1,w.iw1),P=4*(w.v1+w.u1),E=4*(w.v1+w.u2),_=4*(w.v2+w.u1),R=4*(w.v2+w.u2),w.cUL=F[3+P]<<24&L|F[P]<<16&D|F[1+P]<<8&I|F[2+P]&O,w.cUR=F[3+E]<<24&L|F[E]<<16&D|F[1+E]<<8&I|F[2+E]&O,w.cLL=F[3+_]<<24&L|F[_]<<16&D|F[1+_]<<8&I|F[2+_]&O,w.cLR=F[3+R]<<24&L|F[R]<<16&D|F[1+R]<<8&I|F[2+R]&O,w.r=w.ul*((w.cUL&D)>>16)+w.ll*((w.cLL&D)>>16)+w.ur*((w.cUR&D)>>16)+w.lr*((w.cLR&D)>>16)<<1&D,w.g=w.ul*(w.cUL&I)+w.ll*(w.cLL&I)+w.ur*(w.cUR&I)+w.lr*(w.cLR&I)>>>15&I,w.b=w.ul*(w.cUL&O)+w.ll*(w.cLL&O)+w.ur*(w.cUR&O)+w.lr*(w.cLR&O)>>>15,w.a=w.ul*((w.cUL&L)>>>24)+w.ll*((w.cLL&L)>>>24)+w.ur*((w.cUR&L)>>>24)+w.lr*((w.cLR&L)>>>24)<<9&L,T=k(A,w.a|w.r|w.g|w.b),s[S]=(T&D)>>>16,s[1+S]=(T&I)>>>8,s[2+S]=T&O,s[3+S]=(T&L)>>>24,w.sX+=b;C+=o,w.srcYOffset+=x}}},$.loadFont=function(i,e){if(i===wr)throw"font name required in loadFont.";if(-1===i.indexOf(".svg"))return e===wr&&(e=ze.size),Nr.get(i,e);var t=$.loadGlyphs(i);return{name:i,css:"12px sans-serif",glyph:!0,units_per_em:t.units_per_em,horiz_adv_x:1/t.units_per_em*t.horiz_adv_x,ascent:t.ascent,descent:t.descent,width:function(e){for(var t=0,n=e.length,r=0;r<n;r++)try{t+=parseFloat($.glyphLook($.glyphTable[i],e[r]).horiz_adv_x)}catch(e){Fr.debug(e)}return t/$.glyphTable[i].units_per_em}}},$.createFont=function(e,t){return $.loadFont(e,t)},$.textFont=function(e,t){t!==wr&&(e.glyph||(e=Nr.get(e.name,t)),Ne=t),Oe=(ze=e).name,Fe=ze.ascent,Me=ze.descent,$e=ze.leading,A.$ensureContext().font=ze.css},$.textSize=function(e){e!==Ne&&(ze=Nr.get(Oe,e),Ne=e,Fe=ze.ascent,Me=ze.descent,$e=ze.leading,A.$ensureContext().font=ze.css)},$.textAscent=function(){return Fe},$.textDescent=function(){return Me},$.textLeading=function(e){$e=e},$.textAlign=function(e,t){Le=e,De=t||0},Ut.prototype.textWidth=function(e){var t,n=er(e).split(/\r?\n/g),r=0,i=n.length;for(m.font=ze.css,t=0;t<i;++t)r=xr.max(r,ze.measureTextWidth(n[t]));return 0|r},Gt.prototype.textWidth=function(e){var t,n=er(e).split(/\r?\n/g),r=0,i=n.length;c===wr&&(c=br.createElement("canvas"));var s=c.getContext("2d");for(s.font=ze.css,t=0;t<i;++t)r=xr.max(r,s.measureText(n[t]).width);return 0|r},$.glyphLook=function(e,t){try{switch(t){case"1":return e.one;case"2":return e.two;case"3":return e.three;case"4":return e.four;case"5":return e.five;case"6":return e.six;case"7":return e.seven;case"8":return e.eight;case"9":return e.nine;case"0":return e.zero;case" ":return e.space;case"$":return e.dollar;case"!":return e.exclam;case'"':return e.quotedbl;case"#":return e.numbersign;case"%":return e.percent;case"&":return e.ampersand;case"'":return e.quotesingle;case"(":return e.parenleft;case")":return e.parenright;case"*":return e.asterisk;case"+":return e.plus;case",":return e.comma;case"-":return e.hyphen;case".":return e.period;case"/":return e.slash;case"_":return e.underscore;case":":return e.colon;case";":return e.semicolon;case"<":return e.less;case"=":return e.equal;case">":return e.greater;case"?":return e.question;case"@":return e.at;case"[":return e.bracketleft;case"\\":return e.backslash;case"]":return e.bracketright;case"^":return e.asciicircum;case"`":return e.grave;case"{":return e.braceleft;case"|":return e.bar;case"}":return e.braceright;case"~":return e.asciitilde;default:return e[t]}}catch(e){Fr.debug(e)}},Ut.prototype.text$line=function(e,t,n,r,i){var s=0,o=0;if(ze.glyph){var a=$.glyphTable[Oe];cn(),m.translate(t,n+Ne),39!==i&&3!==i||(s=a.width(e),o=39===i?-s:-s/2);var l=1/a.units_per_em*Ne;m.scale(l,l);for(var h=0,u=e.length;h<u;h++)try{$.glyphLook(a,e[h]).draw()}catch(e){Fr.debug(e)}pn()}else e&&"fillText"in m&&(Y&&(m.fillStyle=$.color.toString(X),Y=!1),39!==i&&3!==i||(s=ze.measureTextWidth(e),o=39===i?-s:-s/2),m.fillText(e,t+o,n))},Gt.prototype.text$line=function(e,t,n,r,i){c===wr&&(c=br.createElement("canvas"));var s=m;(m=c.getContext("2d")).font=ze.css;var o=ze.measureTextWidth(e);c.width=o,c.height=Ne,(m=c.getContext("2d")).font=ze.css,m.textBaseline="top",Ut.prototype.text$line(e,0,0,0,37);var a=c.width/c.height;(m=s).bindTexture(m.TEXTURE_2D,L),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,c),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE);var l=0;39===i?l=-o:3===i&&(l=-o/2);var h=new en,u=.5*Ne;h.translate(t+l-u/2,n-u,r),h.scale(-a*u,-u,u),h.translate(-1,-1,-1),h.transpose();var f=new en;f.scale(1,-1,1),f.apply(je.array()),f.transpose(),m.useProgram(p),Ot("vertex2d",p,"Vertex",3,D),Ot("aTextureCoord2d",p,"aTextureCoord",2,I),Dt("uSampler2d",p,"uSampler",[0]),Dt("picktype2d",p,"picktype",1),It("model2d",p,"model",!1,h.array()),It("view2d",p,"view",!1,f.array()),Lt("color2d",p,"color",G),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,O),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0)},$.text=function(){5!==Ie&&(3===arguments.length?tr(er(arguments[0]),arguments[1],arguments[2],0):4===arguments.length?tr(er(arguments[0]),arguments[1],arguments[2],arguments[3]):5===arguments.length?nr(er(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],0):6===arguments.length&&nr(er(arguments[0]),arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]))},$.textMode=function(e){Ie=e},$.loadGlyphs=function(l){function s(e,t){var n,r=0,i=[],s=new RegExp(e,"g");for(n=i[r]=s.exec(t);n;)n=i[++r]=s.exec(t);return i}function h(e){var t=s("[A-Za-z][0-9\\- ]+|Z",e);b="return {draw:function(){var curContext=beforePathDraw();curContext.beginPath();",m=e=p=c=f=u=a=o=0,d="",v=t.length-1;for(var n=0;n<v;n++){var r=t[n][0],i=s("[0-9\\-]+",r);switch(r[0]){case"M":o=parseFloat(i[0][0]),a=parseFloat(i[1][0]),b+="curContext.moveTo("+o+","+-a+");";break;case"L":o=parseFloat(i[0][0]),a=parseFloat(i[1][0]),b+="curContext.lineTo("+o+","+-a+");";break;case"H":o=parseFloat(i[0][0]),b+="curContext.lineTo("+o+","+-a+");";break;case"V":a=parseFloat(i[0][0]),b+="curContext.lineTo("+o+","+-a+");";break;case"T":c=parseFloat(i[0][0]),p=parseFloat(i[1][0]),f="Q"===d||"T"===d?(e=xr.sqrt(xr.pow(o-u,2)+xr.pow(f-a,2)),m=xr.PI+xr.atan2(u-o,f-a),u=o+xr.sin(m)*e,a+xr.cos(m)*e):(u=o,a),b+="curContext.quadraticCurveTo("+u+","+-f+","+c+","+-p+");",o=c,a=p;break;case"Q":u=parseFloat(i[0][0]),f=parseFloat(i[1][0]),c=parseFloat(i[2][0]),p=parseFloat(i[3][0]),b+="curContext.quadraticCurveTo("+u+","+-f+","+c+","+-p+");",o=c,a=p;break;case"Z":b+="curContext.closePath();"}d=r[0]}return b+="afterPathDraw();",b+="curContext.translate("+y+",0);",b+="}}",new Function("beforePathDraw","afterPathDraw",b)(function(){return cn(),A.$ensureContext()},function(){Ln(),Dn(),pn()})}function r(e){var t=e.getElementsByTagName("font");$.glyphTable[l].horiz_adv_x=t[0].getAttribute("horiz-adv-x");var n=e.getElementsByTagName("font-face")[0];$.glyphTable[l].units_per_em=parseFloat(n.getAttribute("units-per-em")),$.glyphTable[l].ascent=parseFloat(n.getAttribute("ascent")),$.glyphTable[l].descent=parseFloat(n.getAttribute("descent"));for(var r=e.getElementsByTagName("glyph"),i=r.length,s=0;s<i;s++){var o=r[s].getAttribute("unicode"),a=r[s].getAttribute("glyph-name");null===(y=r[s].getAttribute("horiz-adv-x"))&&(y=$.glyphTable[l].horiz_adv_x),(g=r[s].getAttribute("d"))!==wr&&(b=h(g),$.glyphTable[l][a]={name:a,unicode:o,horiz_adv_x:y,draw:b.draw})}}var o,a,u,f,c,p,g,m,d,v,y,b;return $.glyphTable[l]={},function(){var e;try{e=br.implementation.createDocument("","",null)}catch(e){return Fr.debug(e.message)}try{e.async=!1,e.load(l),r(e.getElementsByTagName("svg")[0])}catch(t){Fr.debug(t);try{var n=new yr.XMLHttpRequest;n.open("GET",l,!1),n.send(null),r(n.responseXML.documentElement)}catch(e){Fr.debug(t)}}}(),$.glyphTable[l]},$.param=function(e){var t="data-processing-"+e;if(l.hasAttribute(t))return l.getAttribute(t);for(var n=0,r=l.childNodes.length;n<r;++n){var i=l.childNodes.item(n);if(1===i.nodeType&&"param"===i.tagName.toLowerCase()&&i.getAttribute("name")===e)return i.getAttribute("value")}return h.params.hasOwnProperty(e)?h.params[e]:null},Xt.prototype.translate=ir("translate"),Xt.prototype.scale=ir("scale"),Xt.prototype.pushMatrix=ir("pushMatrix"),Xt.prototype.popMatrix=ir("popMatrix"),Xt.prototype.resetMatrix=ir("resetMatrix"),Xt.prototype.applyMatrix=ir("applyMatrix"),Xt.prototype.rotate=ir("rotate"),Xt.prototype.rotateZ=ir("rotateZ"),Xt.prototype.redraw=ir("redraw"),Xt.prototype.toImageData=ir("toImageData"),Xt.prototype.ambientLight=ir("ambientLight"),Xt.prototype.directionalLight=ir("directionalLight"),Xt.prototype.lightFalloff=ir("lightFalloff"),Xt.prototype.lightSpecular=ir("lightSpecular"),Xt.prototype.pointLight=ir("pointLight"),Xt.prototype.noLights=ir("noLights"),Xt.prototype.spotLight=ir("spotLight"),Xt.prototype.beginCamera=ir("beginCamera"),Xt.prototype.endCamera=ir("endCamera"),Xt.prototype.frustum=ir("frustum"),Xt.prototype.box=ir("box"),Xt.prototype.sphere=ir("sphere"),Xt.prototype.ambient=ir("ambient"),Xt.prototype.emissive=ir("emissive"),Xt.prototype.shininess=ir("shininess"),Xt.prototype.specular=ir("specular"),Xt.prototype.fill=ir("fill"),Xt.prototype.stroke=ir("stroke"),Xt.prototype.strokeWeight=ir("strokeWeight"),Xt.prototype.smooth=ir("smooth"),Xt.prototype.noSmooth=ir("noSmooth"),Xt.prototype.point=ir("point"),Xt.prototype.vertex=ir("vertex"),Xt.prototype.endShape=ir("endShape"),Xt.prototype.bezierVertex=ir("bezierVertex"),Xt.prototype.curveVertex=ir("curveVertex"),Xt.prototype.curve=ir("curve"),Xt.prototype.line=ir("line"),Xt.prototype.bezier=ir("bezier"),Xt.prototype.rect=ir("rect"),Xt.prototype.ellipse=ir("ellipse"),Xt.prototype.background=ir("background"),Xt.prototype.image=ir("image"),Xt.prototype.textWidth=ir("textWidth"),Xt.prototype.text$line=ir("text$line"),Xt.prototype.$ensureContext=ir("$ensureContext"),Xt.prototype.$newPMatrix=ir("$newPMatrix"),Xt.prototype.size=function(e,t,n){rr(2===n?"3D":"2D"),$.size(e,t,n)},Xt.prototype.$init=Cr,Ut.prototype.$init=function(){$.size($.width,$.height),m.lineCap="round",$.noSmooth(),$.disableContextMenu()},Gt.prototype.$init=function(){$.use3DContext=!0},Bt.prototype.$ensureContext=function(){return m},dn(l,"touchstart",function(e){l.setAttribute("style","-webkit-user-select: none"),l.setAttribute("onclick","void(0)"),l.setAttribute("style","-webkit-tap-highlight-color:rgba(0,0,0,0)");for(var t=0,n=mn.length;t<n;t++){var r=mn[t].type;"mouseout"!==r&&"mousemove"!==r&&"mousedown"!==r&&"mouseup"!==r&&"DOMMouseScroll"!==r&&"mousewheel"!==r&&"touchstart"!==r||vn(mn[t])}$.touchStart!==wr||$.touchMove!==wr||$.touchEnd!==wr||$.touchCancel!==wr?(dn(l,"touchstart",function(e){$.touchStart!==wr&&(e=ar(e),$.touchStart(e))}),dn(l,"touchmove",function(e){$.touchMove!==wr&&(e.preventDefault(),e=ar(e),$.touchMove(e))}),dn(l,"touchend",function(e){$.touchEnd!==wr&&(e=ar(e),$.touchEnd(e))}),dn(l,"touchcancel",function(e){$.touchCancel!==wr&&(e=ar(e),$.touchCancel(e))})):(dn(l,"touchstart",function(e){or(l,e.touches[0]),$.__mousePressed=!0,$.mouseDragging=!1,$.mouseButton=37,"function"==typeof $.mousePressed&&$.mousePressed()}),dn(l,"touchmove",function(e){e.preventDefault(),or(l,e.touches[0]),"function"!=typeof $.mouseMoved||$.__mousePressed||$.mouseMoved(),"function"==typeof $.mouseDragged&&$.__mousePressed&&($.mouseDragged(),$.mouseDragging=!0)}),dn(l,"touchend",function(e){$.__mousePressed=!1,"function"!=typeof $.mouseClicked||$.mouseDragging||$.mouseClicked(),"function"==typeof $.mouseReleased&&$.mouseReleased()})),l.dispatchEvent(e)}),Jn=!0,$.disableContextMenu=function(){Jn&&(dn(l,"contextmenu",lr),Jn=!1)},$.enableContextMenu=function(){Jn||(vn({elem:l,type:"contextmenu",fn:lr}),Jn=!0)},dn(l,"mousemove",function(e){or(l,e),"function"!=typeof $.mouseMoved||$.__mousePressed||$.mouseMoved(),"function"==typeof $.mouseDragged&&$.__mousePressed&&($.mouseDragged(),$.mouseDragging=!0)}),dn(l,"mouseout",function(e){"function"==typeof $.mouseOut&&$.mouseOut()}),dn(l,"mouseover",function(e){or(l,e),"function"==typeof $.mouseOver&&$.mouseOver()}),dn(l,"mousedown",function(e){switch($.__mousePressed=!0,$.mouseDragging=!1,e.which){case 1:$.mouseButton=37;break;case 2:$.mouseButton=3;break;case 3:$.mouseButton=39}"function"==typeof $.mousePressed&&$.mousePressed()}),dn(l,"mouseup",function(e){$.__mousePressed=!1,"function"!=typeof $.mouseClicked||$.mouseDragging||$.mouseClicked(),"function"==typeof $.mouseReleased&&$.mouseReleased()});function hr(e){var t=0;e.wheelDelta?(t=e.wheelDelta/120,yr.opera&&(t=-t)):e.detail&&(t=-e.detail/3),($.mouseScroll=t)&&"function"==typeof $.mouseScrolled&&$.mouseScrolled()}function ur(e){var t=e.which||e.keyCode;switch(t){case 13:return 10;case 91:case 93:case 224:return 157;case 57392:return 17;case 46:return 127;case 45:return 155}return t}function fr(e){return"function"==typeof e.preventDefault?e.preventDefault():"function"==typeof e.stopPropagation&&e.stopPropagation(),!1}function cr(){var e;for(e in Ge)if(Ge.hasOwnProperty(e))return void($.__keyPressed=!0);$.__keyPressed=!1}function pr(){$.__keyPressed=!1,Ge=[],Xe=null}function gr(e,t){Ge[e]=t,Xe=null,$.key=t,$.keyCode=e,$.keyPressed(),$.keyCode=0,$.keyTyped(),cr()}if(dn(br,"DOMMouseScroll",hr),dn(br,"mousewheel",hr),"string"==typeof l&&(l=br.getElementById(l)),l.getAttribute("tabindex")||l.setAttribute("tabindex",0),n)h=new Fr.Sketch,rr(),$.size=function(e,t,n){rr(n&&2===n?"3D":"2D"),$.size(e,t,n)};else{h=t instanceof Fr.Sketch?t:"function"==typeof t?new Fr.Sketch(t):t?Fr.compile(t):new Fr.Sketch(function(){}),$.externals.sketch=h,rr(),l.onfocus=function(){$.focused=!0},l.onblur=function(){$.focused=!1,h.options.globalKeyEvents||pr()},h.options.pauseOnBlur&&(dn(yr,"focus",function(){J&&$.loop()}),dn(yr,"blur",function(){J&&K&&($.noLoop(),J=!0),pr()}));var mr=h.options.globalKeyEvents?yr:l;for(var dr in dn(mr,"keydown",function(e){var t=ur(e);if(127!==t){if(!(Ye.indexOf(t)<0)){var n=new Ht(65535);return $.key=n,$.keyCode=t,Ge[t]=n,$.keyPressed(),Xe=null,cr(),fr(e)}Xe=t}else gr(t,new Ht(127))}),dn(mr,"keypress",function(e){if(null!==Xe)return gr(Xe,function(e){var t=e.which||e.keyCode,n=e.shiftKey||e.ctrlKey||e.altKey||e.metaKey;switch(t){case 13:t=n?13:10;break;case 8:t=n?127:8}return new Ht(t)}(e)),fr(e)}),dn(mr,"keyup",function(e){var t=ur(e),n=Ge[t];n!==wr&&($.key=n,$.keyCode=t,$.keyReleased(),delete Ge[t],cr())}),Fr.lib)Fr.lib.hasOwnProperty(dr)&&(Fr.lib[dr].hasOwnProperty("attach")?Fr.lib[dr].attach($):Fr.lib[dr]instanceof Function&&Fr.lib[dr].call(this));var vr=function(e){if(h.imageCache.pending||Nr.preloading.pending(100))yr.setTimeout(function(){vr(e)},100);else{if(yr.opera){var t,n,r=h.imageCache.operaCache;for(t in r)r.hasOwnProperty(t)&&(null!==(n=r[t])&&br.body.removeChild(n),delete r[t])}h.attach(e,Lr),h.onLoad(e),e.setup&&(e.setup(),e.resetMatrix(),h.onSetup()),Hn(),e.draw&&(J?e.loop():e.redraw())}};!function(e){e.externals.canvas.id!==wr&&e.externals.canvas.id.length||(e.externals.canvas.id="__processing"+Ir.length),Or[e.externals.canvas.id]=Ir.length,Ir.push(e)}(this),vr($)}};function l(e){var a=function(){var e,t,n=["abs","acos","alpha","ambient","ambientLight","append","applyMatrix","arc","arrayCopy","asin","atan","atan2","background","beginCamera","beginDraw","beginShape","bezier","bezierDetail","bezierPoint","bezierTangent","bezierVertex","binary","blend","blendColor","blit_resize","blue","box","breakShape","brightness","camera","ceil","Character","color","colorMode","concat","constrain","copy","cos","createFont","createGraphics","createImage","cursor","curve","curveDetail","curvePoint","curveTangent","curveTightness","curveVertex","day","degrees","directionalLight","disableContextMenu","dist","draw","ellipse","ellipseMode","emissive","enableContextMenu","endCamera","endDraw","endShape","exit","exp","expand","externals","fill","filter","floor","focused","frameCount","frameRate","frustum","get","glyphLook","glyphTable","green","height","hex","hint","hour","hue","image","imageMode","intersect","join","key","keyCode","keyPressed","keyReleased","keyTyped","lerp","lerpColor","lightFalloff","lights","lightSpecular","line","link","loadBytes","loadFont","loadGlyphs","loadImage","loadPixels","loadShape","loadStrings","log","loop","mag","map","match","matchAll","max","millis","min","minute","mix","modelX","modelY","modelZ","modes","month","mouseButton","mouseClicked","mouseDragged","mouseMoved","mouseOut","mouseOver","mousePressed","mouseReleased","mouseScroll","mouseScrolled","mouseX","mouseY","name","nf","nfc","nfp","nfs","noCursor","noFill","noise","noiseDetail","noiseSeed","noLights","noLoop","norm","normal","noSmooth","noStroke","noTint","ortho","param","parseBoolean","parseByte","parseChar","parseFloat","parseInt","peg","perspective","PImage","pixels","PMatrix2D","PMatrix3D","PMatrixStack","pmouseX","pmouseY","point","pointLight","popMatrix","popStyle","pow","print","printCamera","println","printMatrix","printProjection","PShape","PShapeSVG","pushMatrix","pushStyle","quad","radians","random","Random","randomSeed","rect","rectMode","red","redraw","requestImage","resetMatrix","reverse","rotate","rotateX","rotateY","rotateZ","round","saturation","save","saveFrame","saveStrings","scale","screenX","screenY","screenZ","second","set","setup","shape","shapeMode","shared","shininess","shorten","sin","size","smooth","sort","specular","sphere","sphereDetail","splice","split","splitTokens","spotLight","sq","sqrt","status","str","stroke","strokeCap","strokeJoin","strokeWeight","subset","tan","text","textAlign","textAscent","textDescent","textFont","textLeading","textMode","textSize","texture","textureMode","textWidth","tint","toImageData","touchCancel","touchEnd","touchMove","touchStart","translate","triangle","trim","unbinary","unhex","updatePixels","use3DContext","vertex","width","XMLElement","year","__contains","__equals","__equalsIgnoreCase","__frameRate","__hashCode","__int_cast","__instanceof","__keyPressed","__mousePressed","__printStackTrace","__replace","__replaceAll","__replaceFirst","__toCharArray","__split","__codePointAt","__startsWith","__endsWith"],r={};for(e=0,t=n.length;e<t;++e)r[n[e]]=null;for(var i in Fr.lib)if(Fr.lib.hasOwnProperty(i)&&Fr.lib[i].exports){var s=Fr.lib[i].exports;for(e=0,t=s.length;e<t;++e)r[s[e]]=null}return r}();function v(e){var t,n=/^\s*/.exec(e);if(n[0].length===e.length)t={left:n[0],middle:"",right:""};else{var r=/\s*$/.exec(e);t={left:n[0],middle:e.substring(n[0].length,r.index),right:r[0]}}return t.untrim=function(e){return this.left+e+this.right},t}function P(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function s(e,t){for(var n=0,r=t.length;n<r;++n)e[t[n]]=null;return e}function l(e){return e.substring(2,e.length-1)}function t(e,t,n,r){return t||r?e:(i=!0,"")}for(var i,n=e.replace(/\r\n?|\n\r/g,"\n"),h=[],r=n.replace(/("(?:[^"\\\n]|\\.)*")|('(?:[^'\\\n]|\\.)*')|(([\[\(=|&!\^:?]\s*)(\/(?![*\/])(?:[^\/\\\n]|\\.)*\/[gim]*)\b)|(\/\/[^\n]*\n)|(\/\*(?:(?!\*\/)(?:.|\n))*\*\/)/g,function(e,t,n,r,i,s,o,a){var l;return t||n?(l=h.length,h.push(e),"'"+l+"'"):r?(l=h.length,h.push(s),i+"'"+l+"'"):""!==a?" ":"\n"});i=!1,r=r.replace(/([<]?)<\s*((?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?(?:\s*,\s*(?:\?|[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s+(?:extends|super)\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)?)*)\s*>([=]?)/g,t),i;);var E,u,f,c,y,o,d,b=function(e){for(var t=[],n=e.split(/([\{\[\(\)\]\}])/),r=n[0],i=[],s=1;s<n.length;s+=2){var o=n[s];if("["===o||"{"===o||"("===o)i.push(r),r=o;else if("]"===o||"}"===o||")"===o){var a="}"===o?"A":")"===o?"B":"C",l=t.length;t.push(r+o),r=i.pop()+'"'+a+(l+1)+'"'}r+=n[s+1]}return t.unshift(r),t}(r),g={},p=0;function m(e,t){var n=b.length;return b.push(e),'"'+t+n+'"'}function x(){return"class"+ ++p}function w(e,t,n){e.classId=t,e.scopeId=n,g[t]=e}var A=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)(class|interface)\s+([A-Za-z_$][\w$]*\b)(\s+extends\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?(\s+implements\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\b)*)?\s*("A\d+")/g,C=/\b((?:(?:public|private|final|protected|static|abstract|synchronized)\s+)*)((?!(?:else|new|return|throw|function|public|private|protected)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+"|;)/g,T=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:else|new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*([A-Za-z_$][\w$]*\b)\s*(?:"C\d+"\s*)*([=,]|$)/,S=/\b((?:(?:public|private|final|protected|static|abstract)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b)\s*("B\d+")(\s*throws\s+[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*,\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)*)?\s*("A\d+")/g,_=/^((?:(?:public|private|final|protected|static)\s+)*)((?!(?:new|return|throw)\b)[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*(?:\s*"C\d+")*)\s*/,R=/\bfunction(?:\s+([A-Za-z_$][\w$]*))?\s*("B\d+")\s*("A\d+")/g;function k(e){var t=e;return t=(t=(t=t.replace(A,function(e){return m(e,"E")})).replace(C,function(e){return m(e,"D")})).replace(R,function(e){return m(e,"H")})}function L(e,o){return e.replace(S,function(e,t,n,r,i,s){return n!==o?e:m(e,"G")})}function D(e){this.name=e}function I(e){this.params=e}function O(e){var t=P(e.substring(1,e.length-1)),n=[];if(""!==t)for(var r=t.split(","),i=0;i<r.length;++i){var s=/\b([A-Za-z_$][\w$]*\b)(\s*"[ABC][\d]*")*\s*$/.exec(r[i]);n.push(new D(s[1]))}return new I(n)}function N(e,t){this.baseInterfaceName=e,(this.body=t).owner=this}function F(e,t,n){this.name=e,this.params=t,this.body=n}function M(e){var t=new RegExp(/\b([A-Za-z_$][\w$]*)\s*"B(\d+)"\s*"A(\d+)"/).exec(e);return new F("function"!==t[1]?t[1]:null,O(b[t[2]]),y(b[t[3]]))}function $(e){this.members=e}function z(e){if("("===e.charAt(0)||"["===e.charAt(0))return e.charAt(0)+z(e.substring(1,e.length-1))+e.charAt(e.length-1);if("{"===e.charAt(0))return/^\{\s*(?:[A-Za-z_$][\w$]*|'\d+')\s*:/.test(e)?"{"+m(e.substring(1,e.length-1),"I")+"}":"["+z(e.substring(1,e.length-1))+"]";var t=v(e),n=function(e){var o,t=e;function n(e,t,n,r){var i=b[r];o=!0;var s=v(i.substring(1,i.length-1));return"__"+n+(""===s.middle?m("("+t.replace(/\.\s*$/,"")+")","B"):m("("+t.replace(/\.\s*$/,"")+","+s.middle+")","B"))}for(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"C\d+")+\s*("A\d+")/g,function(e,t,n){return n})).replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)(?:\s*"B\d+")\s*("A\d+")/g,function(e,t,n){return m(e,"F")})).replace(R,function(e){return m(e,"H")})).replace(/\bnew\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*("C\d+"(?:\s*"C\d+")*)/g,function(e,t,n){var r=n.replace(/"C(\d+)"/g,function(e,t){return b[t]}).replace(/\[\s*\]/g,"[null]").replace(/\s*\]\s*\[\s*/g,", ");return"$p.createJavaArray"+m("('"+t+"', "+m("{"+r.substring(1,r.length-1)+"}","A")+")","B")})).replace(/(\.\s*length)\s*"B\d+"/g,"$1")).replace(/#([0-9A-Fa-f]{6})\b/g,function(e,t){return"0xFF"+t})).replace(/"B(\d+)"(\s*(?:[\w$']|"B))/g,function(e,t,n){var r=b[t];if(!/^\(\s*[A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*\s*(?:"C\d+"\s*)*\)$/.test(r))return e;if(/^\(\s*int\s*\)$/.test(r))return"(int)"+n;var i=r.split(/"C(\d+)"/g);return 1<i.length&&!/^\[\s*\]$/.test(b[i[1]])?e:""+n})).replace(/\(int\)([^,\]\)\}\?\:\*\+\-\/\^\|\%\&\~<\>\=]+)/g,function(e,t){var n=v(t);return n.untrim("__int_cast("+n.middle+")")})).replace(/\bsuper(\s*"B\d+")/g,"$$superCstr$1").replace(/\bsuper(\s*\.)/g,"$$super$1")).replace(/\b0+((\d*)(?:\.[\d*])?(?:[eE][\-\+]?\d+)?[fF]?)\b/,function(e,t,n){return t===n?e:""===n?"0"+t:t})).replace(/\b(\.?\d+\.?)[fF]\b/g,"$1")).replace(/([^\s])%([^=\s])/g,"$1 % $2")).replace(/\b(frameRate|keyPressed|mousePressed)\b(?!\s*"B)/g,"__$1")).replace(/\b(boolean|byte|char|float|int)\s*"B/g,function(e,t){return"parse"+t.substring(0,1).toUpperCase()+t.substring(1)+'"B'})).replace(/\bpixels\b\s*(("C(\d+)")|\.length)?(\s*=(?!=)([^,\]\)\}]+))?/g,function(e,t,n,r,i,s){if(n){var o=b[r];return i?"pixels.setPixel"+m("("+o.substring(1,o.length-1)+","+s+")","B"):"pixels.getPixel"+m("("+o.substring(1,o.length-1)+")","B")}return t?"pixels.getLength"+m("()","B"):i?"pixels.set"+m("("+s+")","B"):"pixels.toArray"+m("()","B")});o=!1,t=t.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*\.\s*(?:[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*\.\s*)*)(replace|replaceAll|replaceFirst|contains|equals|equalsIgnoreCase|hashCode|toCharArray|printStackTrace|split|startsWith|endsWith|codePointAt)\s*"B(\d+)"/g,n),o;);function r(e,t,n){return o=!0,"__instanceof"+m("("+t+", "+n+")","B")}for(;o=!1,t=t.replace(/((?:'\d+'|\b[A-Za-z_$][\w$]*\s*(?:"[BC]\d+")*)\s*(?:\.\s*[A-Za-z_$][\w$]*\s*(?:"[BC]\d+"\s*)*)*)instanceof\s+([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)/g,r),o;);return t=t.replace(/\bthis(\s*"B\d+")/g,"$$constr$1")}(t.middle);return n=n.replace(/"[ABC](\d+)"/g,function(e,t){return z(b[t])}),t.untrim(n)}function B(e,t){this.expr=e,this.transforms=t}function V(e,t,n){this.name=e,this.value=t,this.isDefault=n}function U(e,t){var n,r,i,s=e.indexOf("=");return i=s<0?(n=e,r=t,!0):(n=e.substring(0,s),r=d(e.substring(s+1)),!1),new V(P(n.replace(/(\s*"C\d+")+/g,"")),r,i)}function G(e){return"int"===e||"float"===e?"0":"boolean"===e?"false":"color"===e?"0x00000000":"null"}function X(e,t){this.definitions=e,this.varType=t}function Y(e){this.expression=e}function H(e){if(T.test(e)){for(var t=_.exec(e),n=e.substring(t[0].length).split(","),r=G(t[2]),i=0;i<n.length;++i)n[i]=U(n[i],r);return new X(n,t[2])}return new Y(d(e))}function Z(e,t,n){this.initStatement=e,this.condition=t,this.step=n}function W(e,t){this.initStatement=e,this.container=t}function j(e,t){this.initStatement=e,this.container=t}function q(e){e.sort(function(e,t){return t.weight-e.weight})}function K(e,t,n){this.name=e,this.body=t,this.isStatic=n,t.owner=this}function J(e,t,n){this.name=e,this.body=t,this.isStatic=n,t.owner=this}function Q(e){var t,n=A.exec(e),r=(A.lastIndex=0)<=n[1].indexOf("static"),i=b[l(n[6])],s=u,o=x();return u=o,w(t="interface"===n[2]?new K(n[3],c(i,n[3],n[4]),r):new J(n[3],f(i,n[3],n[4],n[5]),r),o,s),u=s,t}function ee(e,t,n,r){this.name=e,this.params=t,this.body=n,this.isStatic=r}function te(e){var t=C.exec(e),n=(C.lastIndex=0)<=t[1].indexOf("static"),r=";"!==t[6]?b[l(t[6])]:"{}";return new ee(t[3],O(b[l(t[4])]),y(r),n)}function ne(e,t,n){this.definitions=e,this.fieldType=t,this.isStatic=n}function re(e){for(var t=_.exec(e),n=0<=t[1].indexOf("static"),r=e.substring(t[0].length).split(/,\s*/g),i=G(t[2]),s=0;s<r.length;++s)r[s]=U(r[s],i);return new ne(r,t[2],n)}function ie(e,t){this.params=e,this.body=t}function se(e,t,n,r,i,s){var o,a;for(this.name=e,this.interfacesNames=t,this.methodsNames=n,this.fields=r,this.innerClasses=i,this.misc=s,o=0,a=r.length;o<a;++o)r[o].owner=this}function oe(e,t,n,r,i,s,o,a,l){var h,u;for(this.name=e,this.baseClassName=t,this.interfacesNames=n,this.functions=r,this.methods=i,this.fields=s,this.cstrs=o,this.innerClasses=a,this.misc=l,h=0,u=s.length;h<u;++h)s[h].owner=this}function ae(e,t){this.name=e,(this.body=t).owner=this}function le(e,t){this.name=e,(this.body=t).owner=this}function he(e){var t=A.exec(e);A.lastIndex=0;var n,r=b[l(t[6])],i=u,s=x();return u=s,w(n="interface"===t[2]?new ae(t[3],c(r,t[3],t[4])):new le(t[3],f(r,t[3],t[4],t[5])),s,i),u=i,n}function ue(e,t,n){this.name=e,this.params=t,this.body=n}function fe(e){var t=C.exec(e);C.lastIndex=0;return new ue(t[3],O(b[l(t[4])]),y(b[l(t[6])]))}function ce(e,t){this.argument=e,this.misc=t}function pe(e,t){this.argument=e,this.misc=t}function ge(e,t,n){this.name=e,this.argument=t,this.misc=n}function me(e){this.expr=e}function de(e){this.label=e}function ve(e){for(var t=[],n=0,r=e.length;n<r;++n){var i=e[n];i instanceof X?t=t.concat(i.getNames()):i instanceof ce&&i.argument.initStatement instanceof X?t=t.concat(i.argument.initStatement.getNames()):(i instanceof K||i instanceof J||i instanceof ae||i instanceof le||i instanceof ue||i instanceof F)&&t.push(i.name)}return s({},t)}function ye(e){this.statements=e}function be(e){this.statements=e}D.prototype.toString=function(){return this.name},I.prototype.getNames=function(){for(var e=[],t=0,n=this.params.length;t<n;++t)e.push(this.params[t].name);return e},I.prototype.toString=function(){if(0===this.params.length)return"()";for(var e="(",t=0,n=this.params.length;t<n;++t)e+=this.params[t]+", ";return e.substring(0,e.length-2)+")"},N.prototype.toString=function(){return"new ("+this.body+")"},F.prototype.toString=function(){var t=E,n=s({this:null},this.params.getNames());E=function(e){return n.hasOwnProperty(e.name)?e.name:t(e)};var e="function";return this.name&&(e+=" "+this.name),e+=this.params+" "+this.body,E=t,e},$.prototype.toString=function(){var t=E;E=function(e){return"this"===e.name?"this":t(e)};for(var e="",n=0,r=this.members.length;n<r;++n)this.members[n].label&&(e+=this.members[n].label+": "),e+=this.members[n].value.toString()+", ";return E=t,e.substring(0,e.length-2)},B.prototype.toString=function(){var n=this.transforms;return function(e){return e.replace(/(\.\s*)?((?:\b[A-Za-z_]|\$)[\w$]*)(\s*\.\s*([A-Za-z_$][\w$]*)(\s*\()?)?/g,function(e,t,n,r,i,s){return t?e:E({name:n,member:i,callSign:!!s})+(r===wr?"":r)})}(this.expr).replace(/"!(\d+)"/g,function(e,t){return n[t].toString()})},d=function(e){var n=[],t=z(e);return new B(t=(t=(t=t.replace(/"H(\d+)"/g,function(e,t){return n.push(M(b[t])),'"!'+(n.length-1)+'"'})).replace(/"F(\d+)"/g,function(e,t){return n.push(function(e){var t=new RegExp(/\bnew\s*([A-Za-z_$][\w$]*\s*(?:\.\s*[A-Za-z_$][\w$]*)*)\s*"B\d+"\s*"A(\d+)"/).exec(e),n=u,r=x();u=r;var i=t[1]+"$"+r,s=new N(i,f(b[t[2]],i,"","implements "+t[1]));return w(s,r,n),u=n,s}(b[t])),'"!'+(n.length-1)+'"'})).replace(/"I(\d+)"/g,function(e,t){return n.push(function(e){for(var t=e.split(","),n=0;n<t.length;++n){var r=t[n].indexOf(":");t[n]=r<0?{value:d(t[n])}:{label:P(t[n].substring(0,r)),value:d(P(t[n].substring(r+1)))}}return new $(t)}(b[t])),'"!'+(n.length-1)+'"'}),n)},V.prototype.toString=function(){return this.name+" = "+this.value},X.prototype.getNames=function(){for(var e=[],t=0,n=this.definitions.length;t<n;++t)e.push(this.definitions[t].name);return e},X.prototype.toString=function(){return"var "+this.definitions.join(",")},Y.prototype.toString=function(){return this.expression.toString()},Z.prototype.toString=function(){return"("+this.initStatement+"; "+this.condition+"; "+this.step+")"},W.prototype.toString=function(){var e=this.initStatement.toString();return 0<=e.indexOf("=")&&(e=e.substring(0,e.indexOf("="))),"("+e+" in "+this.container+")"},j.iteratorId=0,j.prototype.toString=function(){var e=this.initStatement.toString(),t="$it"+j.iteratorId++,n=e.replace(/^\s*var\s*/,"").split("=")[0];return"("+("var "+t+" = new $p.ObjectIterator("+this.container+"), "+n+" = void(0)")+"; "+(t+".hasNext() && (("+n+" = "+t+".next()) || true)")+";)"},K.prototype.toString=function(){return""+this.body},J.prototype.toString=function(){return""+this.body},ee.prototype.toString=function(){var t=s({},this.params.getNames()),n=E;E=function(e){return t.hasOwnProperty(e.name)?e.name:n(e)};var e="function "+this.methodId+this.params+" "+this.body+"\n";return E=n,e},ne.prototype.getNames=function(){for(var e=[],t=0,n=this.definitions.length;t<n;++t)e.push(this.definitions[t].name);return e},ne.prototype.toString=function(){var e=E({name:"[this]"});if(this.isStatic){for(var t=this.owner.name,n=[],r=0,i=this.definitions.length;r<i;++r){var s=this.definitions[r],o=s.name,a=t+"."+o,l="if("+a+" === void(0)) {\n "+a+" = "+s.value+"; }\n$p.defineProperty("+e+", '"+o+"', { get: function(){return "+a+";}, set: function(val){"+a+" = val;} });\n";n.push(l)}return n.join("")}return e+"."+this.definitions.join("; "+e+".")},ie.prototype.toString=function(){var t=s({},this.params.getNames()),n=E;E=function(e){return t.hasOwnProperty(e.name)?e.name:n(e)};var e="function $constr_"+this.params.params.length+this.params.toString(),r=this.body.toString();return/\$(superCstr|constr)\b/.test(r)||(r="{\n$superCstr();\n"+r.substring(1)),E=n,e+r+"\n"},se.prototype.getMembers=function(e,t,n){var r,i,s,o;for(this.owner.base&&this.owner.base.body.getMembers(e,t,n),r=0,s=this.fields.length;r<s;++r){var a=this.fields[r].getNames();for(i=0,o=a.length;i<o;++i)e[a[i]]=this.fields[r]}for(r=0,s=this.methodsNames.length;r<s;++r){t[this.methodsNames[r]]=!0}for(r=0,s=this.innerClasses.length;r<s;++r){var l=this.innerClasses[r];n[l.name]=l}},se.prototype.toString=function(){!function(e){for(var t=0;e;)++t,e=e.scope}(this.owner);var e,t,n=this.name,r="",i="";if(this.getMembers({},{},{}),this.owner.interfaces){var s,o=[];for(e=0,t=this.interfacesNames.length;e<t;++e)this.owner.interfaces[e]&&(s=E({name:this.interfacesNames[e]}),o.push(s),r+="$p.extendInterfaceMembers("+n+", "+s+");\n");i+=n+".$interfaces = ["+o.join(", ")+"];\n"}for(i+=n+".$isInterface = true;\n",i+=n+".$methods = ['"+this.methodsNames.join("', '")+"'];\n",q(this.innerClasses),e=0,t=this.innerClasses.length;e<t;++e){var a=this.innerClasses[e];a.isStatic&&(r+=n+"."+a.name+" = "+a+";\n")}for(e=0,t=this.fields.length;e<t;++e){var l=this.fields[e];l.isStatic&&(r+=n+"."+l.definitions.join(";\n"+n+".")+";\n")}return"(function() {\nfunction "+n+"() { throw 'Unable to create the interface'; }\n"+r+i+"return "+n+";\n})()"},c=function(e,t,n){var r=e.substring(1,e.length-1);r=L(r=k(r),t);var i,s,o,a=[],l=[],h=(r=r.replace(/"([DE])(\d+)"/g,function(e,t,n){return"D"===t?a.push(n):"E"===t&&l.push(n),""})).split(/;(?:\s*;)*/g);for(n!==wr&&(i=n.replace(/^\s*extends\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g)),s=0,o=a.length;s<o;++s){var u=te(b[a[s]]);a[s]=u.name}for(s=0,o=h.length-1;s<o;++s){var f=v(h[s]);h[s]=re(f.middle)}var c=h.pop();for(s=0,o=l.length;s<o;++s)l[s]=Q(b[l[s]]);return new se(t,i,a,h,l,{tail:c})},oe.prototype.getMembers=function(e,t,n){var r,i,s,o;for(this.owner.base&&this.owner.base.body.getMembers(e,t,n),r=0,s=this.fields.length;r<s;++r){var a=this.fields[r].getNames();for(i=0,o=a.length;i<o;++i)e[a[i]]=this.fields[r]}for(r=0,s=this.methods.length;r<s;++r){var l=this.methods[r];t[l.name]=l}for(r=0,s=this.innerClasses.length;r<s;++r){var h=this.innerClasses[r];n[h.name]=h}},oe.prototype.toString=function(){var n="$this_"+function(e){for(var t=0;e;)++t,e=e.scope;return t}(this.owner),r=this.name,e="var "+n+" = this;\n",t="",i="",s={},o={},a={};this.getMembers(s,o,a);var l,h,u,f,c,p=E;if(E=function(e){var t=e.name;return"this"===t?e.callSign||!e.member?n+".$self":n:s.hasOwnProperty(t)?s[t].isStatic?r+"."+t:n+"."+t:a.hasOwnProperty(t)?n+"."+t:o.hasOwnProperty(t)?o[t].isStatic?r+"."+t:n+".$self."+t:p(e)},this.baseClassName?(l=p({name:this.baseClassName}),e+="var $super = { $upcast: "+n+" };\n",e+="function $superCstr(){"+l+".apply($super,arguments);if(!('$self' in $super)) $p.extendClassChain($super)}\n",i+=r+".$base = "+l+";\n"):e+="function $superCstr(){$p.extendClassChain("+n+")}\n",this.owner.base&&(t+="$p.extendStaticMembers("+r+", "+l+");\n"),this.owner.interfaces){var g,m=[];for(h=0,u=this.interfacesNames.length;h<u;++h)this.owner.interfaces[h]&&(g=p({name:this.interfacesNames[h]}),m.push(g),t+="$p.extendInterfaceMembers("+r+", "+g+");\n");i+=r+".$interfaces = ["+m.join(", ")+"];\n"}for(0<this.functions.length&&(e+=this.functions.join("\n")+"\n"),q(this.innerClasses),h=0,u=this.innerClasses.length;h<u;++h){var d=this.innerClasses[h];d.isStatic?(t+=r+"."+d.name+" = "+d+";\n",e+=n+"."+d.name+" = "+r+"."+d.name+";\n"):e+=n+"."+d.name+" = "+d+";\n"}for(h=0,u=this.fields.length;h<u;++h){var v=this.fields[h];if(v.isStatic)for(t+=r+"."+v.definitions.join(";\n"+r+".")+";\n",f=0,c=v.definitions.length;f<c;++f){var y=v.definitions[f].name,b=r+"."+y;e+="$p.defineProperty("+n+", '"+y+"', {get: function(){return "+b+"}, set: function(val){"+b+" = val}});\n"}else e+=n+"."+v.definitions.join(";\n"+n+".")+";\n"}var x={};for(h=0,u=this.methods.length;h<u;++h){var w=this.methods[h],A=x[w.name],C=w.name+"$"+w.params.params.length;A?C+="_"+ ++A:A=1,w.methodId=C,x[w.name]=A,w.isStatic?(t+=w,t+="$p.addMethod("+r+", '"+w.name+"', "+C+");\n"):e+=w,e+="$p.addMethod("+n+", '"+w.name+"', "+C+");\n"}e+=P(this.misc.tail),0<this.cstrs.length&&(e+=this.cstrs.join("\n")+"\n"),e+="function $constr() {\n";var T=[];for(h=0,u=this.cstrs.length;h<u;++h){var S=this.cstrs[h].params.params.length;T.push("if(arguments.length === "+S+") { $constr_"+S+".apply("+n+", arguments); }")}return 0<T.length&&(e+=T.join(" else ")+" else "),e+="$superCstr();\n}\n",E=p,"(function() {\nfunction "+r+"() {\n"+(e+="$constr.apply(null, arguments);\n")+"}\n"+t+i+"return "+r+";\n})()"},f=function(e,t,n,r){var i=e.substring(1,e.length-1);i=L(i=k(i),t);var s,o,a,l=[],h=[],u=[],f=[],c=(i=i.replace(/"([DEGH])(\d+)"/g,function(e,t,n){return"D"===t?l.push(n):"E"===t?h.push(n):"H"===t?f.push(n):u.push(n),""})).replace(/^(?:\s*;)+/,"").split(/;(?:\s*;)*/g);for(n!==wr&&(s=n.replace(/^\s*extends\s+([A-Za-z_$][\w$]*\b(?:\s*\.\s*[A-Za-z_$][\w$]*\b)*)\s*$/g,"$1")),r!==wr&&(o=r.replace(/^\s*implements\s+(.+?)\s*$/g,"$1").split(/\s*,\s*/g)),a=0;a<f.length;++a)f[a]=M(b[f[a]]);for(a=0;a<l.length;++a)l[a]=te(b[l[a]]);for(a=0;a<c.length-1;++a){var p=v(c[a]);c[a]=re(p.middle)}var g,m,d=c.pop();for(a=0;a<u.length;++a)u[a]=(g=b[u[a]],void 0,m=new RegExp(/"B(\d+)"\s*"A(\d+)"/).exec(g),new ie(O(b[m[1]]),y(b[m[2]])));for(a=0;a<h.length;++a)h[a]=Q(b[h[a]]);return new oe(t,s,o,f,l,c,u,h,{tail:d})},ae.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n$p."+this.name+" = "+this.name+";\n"},le.prototype.toString=function(){return"var "+this.name+" = "+this.body+";\n$p."+this.name+" = "+this.name+";\n"},ue.prototype.toString=function(){var t=s({},this.params.getNames()),n=E;E=function(e){return t.hasOwnProperty(e.name)?e.name:n(e)};var e="function "+this.name+this.params+" "+this.body+"\n$p."+this.name+" = "+this.name+";";return E=n,e},ce.prototype.toString=function(){return this.misc.prefix+this.argument.toString()},pe.prototype.toString=function(){return this.misc.prefix+this.argument.toString()},ge.prototype.toString=function(){var e=this.misc.prefix;return this.argument!==wr&&(e+=this.argument.toString()),e},me.prototype.toString=function(){return"case "+this.expr+":"},de.prototype.toString=function(){return this.label},o=function(e,t,n){var r=new RegExp(/\b(catch|for|if|switch|while|with)\s*"B(\d+)"|\b(do|else|finally|return|throw|try|break|continue)\b|("[ADEH](\d+)")|\b(case)\s+([^:]+):|\b([A-Za-z_$][\w$]*\s*:)|(;)/g),i=[];e=function(e){var t=e;return t=t.replace(/\b(catch\s*"B\d+"\s*"A\d+")(\s*catch\s*"B\d+"\s*"A\d+")+/g,"$1")}(e);for(var s,o,a,l,h=0;null!==(s=r.exec(e));){if(s[1]!==wr){var u=e.lastIndexOf('"B',r.lastIndex),f=e.substring(h,u);"for"===s[1]?i.push(new ce((a=b[s[2]],l=void 0,/\bin\b/.test(a)?new W(H(P((l=a.substring(1,a.length-1).split(/\bin\b/g))[0])),d(l[1])):0<=a.indexOf(":")&&a.indexOf(";")<0?new j(H(P((l=a.substring(1,a.length-1).split(":"))[0])),d(l[1])):new Z(H(P((l=a.substring(1,a.length-1).split(";"))[0])),d(l[1]),d(l[2]))),{prefix:f})):"catch"===s[1]?i.push(new pe(O(b[s[2]]),{prefix:f})):i.push(new ge(s[1],d(b[s[2]]),{prefix:f}))}else if(s[3]!==wr)i.push(new ge(s[3],wr,{prefix:e.substring(h,r.lastIndex)}));else if(s[4]!==wr){if(0!==P(o=e.substring(h,r.lastIndex-s[4].length)).length)continue;i.push(o);var c=s[4].charAt(1),p=s[5];"D"===c?i.push(t(b[p])):"E"===c?i.push(n(b[p])):"H"===c?i.push(M(b[p])):i.push(y(b[p]))}else if(s[6]!==wr)i.push(new me(d(P(s[7]))));else if(s[8]!==wr){if(0!==P(o=e.substring(h,r.lastIndex-s[8].length)).length)continue;i.push(new de(e.substring(h,r.lastIndex)))}else{var g=v(e.substring(h,r.lastIndex-1));i.push(g.left),i.push(H(g.middle)),i.push(g.right+";")}h=r.lastIndex}var m=v(e.substring(h));return i.push(m.left),""!==m.middle&&(i.push(H(m.middle)),i.push(";"+m.right)),i},ye.prototype.toString=function(){var t=ve(this.statements),n=E;!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(t)&&(E=function(e){return t.hasOwnProperty(e.name)?e.name:n(e)});var e="{\n"+this.statements.join("")+"\n}";return E=n,e},y=function(e){var t=v(e.substring(1,e.length-1));return new ye(o(t.middle))},be.prototype.toString=function(){for(var e,t=[],n=[],r=0,i=this.statements.length;r<i;++r)(e=this.statements[r])instanceof le||e instanceof ae?t.push(e):n.push(e);q(t);var s=ve(this.statements);E=function(e){var t=e.name;return s.hasOwnProperty(t)?t:a.hasOwnProperty(t)||_r.hasOwnProperty(t)||Lr.hasOwnProperty(t)?"$p."+t:t};var o="// this code was autogenerated from PJS\n(function($p) {\n"+t.join("")+"\n"+n.join("")+"\n})";return E=null,o};var xe=function(){var e=k(b[0]);return e=e.replace(/\bimport\s+[^;]+;/g,""),new be(o(e,fe,he))}();!function(){var e,t,a={};for(e in g)if(g.hasOwnProperty(e)){var n=(t=g[e]).scopeId,r=t.name;if(n){var i=g[n];(t.scope=i).inScope===wr&&(i.inScope={}),i.inScope[r]=t}else a[r]=t}function s(e,t){for(var n,r=t.split("."),i=e.scope;i;){if(i.hasOwnProperty(r[0])){n=i[r[0]];break}i=i.scope}n===wr&&(n=a[r[0]]);for(var s=1,o=r.length;s<o&&n;++s)n=n.inScope[r[s]];return n}for(e in g)if(g.hasOwnProperty(e)){var o=(t=g[e]).body.baseClassName;if(o){var l=s(t,o);l&&((t.base=l).derived||(l.derived=[]),l.derived.push(t))}var h,u,f=t.body.interfacesNames,c=[];if(f&&0<f.length){for(h=0,u=f.length;h<u;++h){var p=s(t,f[h]);c.push(p),p&&(p.derived||(p.derived=[]),p.derived.push(t))}0<c.length&&(t.interfaces=c)}}}(),function(){var e,t,n,r=[],i={};for(e in g)if(g.hasOwnProperty(e))if((n=g[e]).inScope||n.derived){var s=[];if(n.inScope)for(t in n.inScope)n.inScope.hasOwnProperty(t)&&s.push(n.inScope[t]);n.derived&&(s=s.concat(n.derived)),i[e]=s}else r.push(e),n.weight=0;function o(e,t){var n=i[e];if(!n)return!1;var r=n.indexOf(t);return!(r<0)&&(n.splice(r,1),!(0<n.length)&&(delete i[e],!0))}for(;0<r.length;){var a,l;if(e=r.shift(),(n=g[e]).scopeId&&o(n.scopeId,n)&&(r.push(n.scopeId),g[n.scopeId].weight=n.weight+1),n.base&&o(n.base.classId,n)&&(r.push(n.base.classId),n.base.weight=n.weight+1),n.interfaces)for(a=0,l=n.interfaces.length;a<l;++a)n.interfaces[a]&&o(n.interfaces[a].classId,n)&&(r.push(n.interfaces[a].classId),n.interfaces[a].weight=n.weight+1)}}();var we,Ae=xe.toString();return Ae=Ae.replace(/\s*\n(?:[\t ]*\n)+/g,"\n\n"),we=h,Ae.replace(/'(\d+)'/g,function(e,t){var n=we[t];return"/"===n.charAt(0)?n:/^'((?:[^'\\\n])|(?:\\.[0-9A-Fa-f]*))'$/.test(n)?"(new $p.Character("+n+"))":n})}Fr.debug=e,Fr.prototype=Lr,Fr.compile=function(e){var t=new Fr.Sketch,n=l(function(e,t){var n=new RegExp(/\/\*\s*@pjs\s+((?:[^\*]|\*+[^\*\/])*)\*\//g).exec(e);if(n&&2===n.length){function r(e){return e.replace(/^\s*["']?/,"").replace(/["']?\s*$/,"")}for(var i=[],s=n.splice(1,2)[0].replace(/\{([\s\S]*?)\}/g,function(e,t){return i.push(t),"{"+(i.length-1)+"}"}).replace("\n","").replace("\r","").split(";"),o=0,a=s.length;o<a;o++){var l=s[o].split("=");if(l&&2===l.length){var h=r(l[0]),u=r(l[1]),f=[];if("preload"===h)for(var c=0,p=(f=u.split(",")).length;c<p;c++){var g=r(f[c]);t.imageCache.add(g)}else if("font"===h)for(var m=0,d=(f=u.split(",")).length;m<d;m++){var v=r(f[m]),y=/^\{(\d*?)\}$/.exec(v);Nr.preloading.add(y?JSON.parse("{"+i[y[1]]+"}"):v)}else"pauseOnBlur"===h?t.options.pauseOnBlur="true"===u:"globalKeyEvents"===h?t.options.globalKeyEvents="true"===u:"param-"===h.substring(0,6)?t.params[h.substring(6)]=u:t.options[h]=u}}}return e}(e,t));return t.sourceCode=n,t};var m,d,v,y,b,x,w,A,C,T,S,P,E,_,R,h,u,p=(R={},h="undefined",u="function",typeof tinylog!=h&&typeof tinylog.log==u?R.log=tinylog.log:typeof br==h||br.fake?typeof print==u&&(R.log=print):(d="div",v="style",y="title",b={zIndex:1e4,position:"fixed",bottom:"0px",width:"100%",height:"15%",fontFamily:"sans-serif",color:"#ccc",backgroundColor:"black"},x={position:"relative",fontFamily:"monospace",overflow:"auto",height:"100%",paddingTop:"5px"},w={height:"5px",marginTop:"-5px",cursor:"n-resize",backgroundColor:"darkgrey"},A={position:"absolute",top:"5px",right:"20px",color:"#111",MozBorderRadius:"4px",webkitBorderRadius:"4px",borderRadius:"4px",cursor:"pointer",fontWeight:"normal",textAlign:"center",padding:"3px 5px",backgroundColor:"#333",fontSize:"12px"},C={minHeight:"16px"},T={fontSize:"12px",margin:"0 8px 0 8px",maxWidth:"100%",whiteSpace:"pre-wrap",overflow:"auto"},S=(m=br).defaultView,P=m.documentElement,E=P[v],_=R.log=function(e){function r(){E.paddingBottom=s.clientHeight+"px"}function t(e){var t=S.innerHeight,n=a.clientHeight;e<0?e=0:t<e+n&&(e=t-n),o.height=e/t*100+"%",r()}var n,i=E.paddingBottom,s=N(d),o=s[v],a=O(s,N(d)),l=O(s,N(d)),h=O(s,N(d)),u=!1,f=!1,c=!1,p=0,g=[L(m,"mousemove",function(e){u&&(t(S.innerHeight-e.clientY),l.scrollTop=c)}),L(m,"mouseup",function(){u=u&&(c=!1)}),L(a,"dblclick",function(e){e.preventDefault(),f?(t(f),f=!1):(f=s.clientHeight,o.height="0px")}),L(a,"mousedown",function(e){e.preventDefault(),u=!0,c=l.scrollTop}),L(a,"contextmenu",function(){u=!1}),L(h,"click",function(){n()})];n=function(){for(var e=g.length;e--;)D.apply(R,g[e]);P.removeChild(s),E.paddingBottom=i,I(l),I(s),R.log=_},k(s,b,l,x,a,w,h,A),h[y]="Close Log",O(h,F("â")),a[y]="Double-click to toggle log minimization",P.insertBefore(s,P.firstChild),R.log=function(e){512===p?l.removeChild(l.firstChild):p++;var t=O(l,N(d)),n=O(t,N(d));t[y]=(new Date).toLocaleTimeString(),k(t,C,n,T),O(n,F(e)),l.scrollTop=l.scrollHeight},R.log(e),r()}),R);function k(){for(var e,t,n,r=arguments.length;r--;)for(n in t=arguments[r--],e=arguments[r][v],t)t.hasOwnProperty(n)&&(e[n]=t[n])}function L(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n),[e,t,n]}function D(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function I(e){for(var t=e.childNodes,n=t.length;n--;)e.removeChild(t.item(0))}function O(e,t){return e.appendChild(t)}function N(e){return m.createElement(e)}function F(e){return m.createTextNode(e)}Fr.logger=p,Fr.version="1.3.6",Fr.lib={},Fr.registerLibrary=function(e,t){(Fr.lib[e]=t).hasOwnProperty("init")&&t.init(Lr)},Fr.instances=Ir,Fr.getInstanceById=function(e){return Ir[Or[e]]},Fr.Sketch=function(e){this.attachFunction=e,this.options={pauseOnBlur:!1,globalKeyEvents:!1},this.onLoad=Cr,this.onSetup=Cr,this.onPause=Cr,this.onLoop=Cr,this.onFrameStart=Cr,this.onFrameEnd=Cr,this.onExit=Cr,this.params={},this.imageCache={pending:0,images:{},operaCache:{},add:function(e,t){var n;if(!this.images[e]&&(i||(this.images[e]=null),t||((t=new Image).onload=(n=this,function(){n.pending--}),this.pending++,t.src=e),this.images[e]=t,yr.opera)){var r=br.createElement("div");r.appendChild(t),r.style.position="absolute",r.style.opacity=0,r.style.width="1px",r.style.height="1px",this.operaCache[e]||(br.body.appendChild(r),this.operaCache[e]=r)}}},this.sourceCode=void 0,this.attach=function(e){if("function"==typeof this.attachFunction)this.attachFunction(e);else{if(!this.sourceCode)throw"Unable to attach sketch to the processing instance";var t=new Function("return ("+this.sourceCode+");")();t(e),this.attachFunction=t}},this.toString=function(){var e,t="((function(Sketch) {\n";for(e in t+="var sketch = new Sketch(\n"+this.sourceCode+");\n",this.options)if(this.options.hasOwnProperty(e)){var n=this.options[e];t+="sketch.options."+e+" = "+("string"==typeof n?'"'+n+'"':""+n)+";\n"}for(e in this.imageCache)this.options.hasOwnProperty(e)&&(t+='sketch.imageCache.add("'+e+'");\n');return t+="return sketch;\n})(Processing.Sketch))"}};function g(i,e){var s=[],o=[],a=e.length,l=0;function t(n,r){function e(e,t){if(s[n]=e,++l,t&&o.push(r+" ==> "+t),l===a){if(0!==o.length)throw"Processing.js: Unable to load pjs sketch files: "+o.join("\n");try{return new Fr(i,s.join("\n"))}catch(e){throw"Processing.js: Unable to execute pjs sketch: "+e}}}if("#"!==r.charAt(0))!function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){var e;4===n.readyState&&(200!==n.status&&0!==n.status?e="Invalid XHR status "+n.status:""===n.responseText&&(e="withCredentials"in new XMLHttpRequest&&!1===(new XMLHttpRequest).withCredentials&&"file:"===yr.location.protocol?"XMLHttpRequest failure, possibly due to a same-origin policy violation. You can try loading this page in another browser, or load it from http://localhost using a local webserver. See the Processing.js README for a more detailed explanation of this problem and solutions.":"File is empty."),t(n.responseText,e))},n.open("GET",e,!0),n.overrideMimeType&&n.overrideMimeType("application/json"),n.setRequestHeader("If-Modified-Since","Fri, 01 Jan 1960 00:00:00 GMT"),n.send(null)}(r,e);else{var t=br.getElementById(r.substring(1));t?e(t.text||t.textContent):e("","Unable to load pjs sketch: element with id '"+r.substring(1)+"' was not found")}}for(var n=0;n<a;++n)t(n,e[n])}var M=function(){br.removeEventListener("DOMContentLoaded",M,!1);for(var e,t=br.getElementsByTagName("canvas"),n=0,r=t.length;n<r;n++){var i=t[n].getAttribute("data-processing-sources");if(null===i&&null===(i=t[n].getAttribute("data-src"))&&(i=t[n].getAttribute("datasrc")),i){e=i.split(" ");for(var s=0;s<e.length;)e[s]?s++:e.splice(s,1);g(t[n],e)}}var o,a,l=br.getElementsByTagName("script");for(o=0;o<l.length;o++){var h=l[o];if(h.getAttribute){var u=h.getAttribute("type");if(u&&("text/processing"===u.toLowerCase()||"application/processing"===u.toLowerCase())){var f=h.getAttribute("data-processing-target");if(t=wr,f)t=br.getElementById(f);else{for(var c=h.nextSibling;c&&1!==c.nodeType;)c=c.nextSibling;"canvas"===c.nodeName.toLowerCase()&&(t=c)}if(t){if(h.getAttribute("src")){e=h.getAttribute("src").split(/\s+/),g(t,e);continue}a=h.textContent||h.text,new Fr(t,a)}}}}};Fr.loadSketchFromSources=g,Fr.disableInit=function(){i&&br.removeEventListener("DOMContentLoaded",M,!1)},i?(yr.Processing=Fr,br.addEventListener("DOMContentLoaded",M,!1)):this.Processing=Fr}(window,window.document,Math);
IG$.v$olapChartView.prototype.drawProtovisChart=function(t,e){var n,r,a,i=this,o=i.sheetoption?i.sheetoption.model.chart_option:null,l=e._tabledata,s=e.colfix,d=e.rowfix,c=0<l.length?l[0].length:0,u=[],p=i.cop.relationgroups;i.drawmode="protovis",i.mresult=e,i.rct=t,o.settings=o.settings||{};var h,v=$(i.container),f=IG$.j$ext._w(v),g=IG$.j$ext._h(v);switch(t){case"boxplot":var m=[],x=[],b=[],y=0;for(n=s;n<c;n++){for(r=0;r<d;r++)B=0==r?l[r][n].text:B+IG$._separator+l[r][n].text;x.push(B),b.push({id:B,median:0,uq:0,lq:0,max:0,min:0})}for(n=s;n<c;n++){kt=[];var w,_=Number(l[d][n].code),k=_,I=parseInt(.8*(l.length-d)),G=parseInt(.2*(l.length-d)),F=parseInt(.5*(l.length-d));for(r=d;r<l.length;r++)w=Number(l[r][n].code),_=Math.min(_,w),k=Math.max(k,w),w,kt.push(w);kt=kt.sort(function(t,e){return t-e}),b[n-s].min=_,b[n-s].max=k,b[n-s].median=kt[F],b[n-s].lq=kt[G],b[n-s].uq=kt[I],y=Math.max(y,k)}var M=f,S=g;i.vismargin={top:0,bottom:20,right:20,left:40},f-=i.vismargin.left+i.vismargin.right,g-=i.vismargin.top+i.vismargin.bottom;var N=pv.Scale.ordinal(b,function(t){return t.id}).splitBanded(0,f,.6);U=pv.Scale.linear(0,y).range(0,g),P=N.range().band/2,i.vis=(new pv.Panel).canvas(i.container).width(f).height(g).top(i.vismargin.top).bottom(i.vismargin.bottom).left(i.vismargin.left).right(i.vismargin.right),i.vis.add(pv.Rule).data(U.ticks()).bottom(U).strokeStyle(function(t){return 0==t||1==t?"#000":"#ccc"}).anchor("left").add(pv.Label).text(U.tickFormat);var D=i.vis.add(pv.Panel).data(b).left(function(t){return N(t.id)}).width(2*P);D.anchor("bottom").add(pv.Label).textBaseline("top").text(function(t){return t.id}),D.add(pv.Rule).left(P).bottom(function(t){return U(t.min)}).height(function(t){return U(t.max)-U(t.min)}),D.add(pv.Rule).data(function(t){return[t.min,t.max]}).bottom(U).left(P/2).width(P),D.add(pv.Bar).bottom(function(t){return U(t.lq)}).height(function(t){return U(t.uq)-U(t.lq)}).fillStyle(function(t){return t.median>.5*(t.uq-t.lq)+t.lq?"#aec7e8":"#ffbb78"}).strokeStyle("black").lineWidth(1).antialias(!1),D.add(pv.Rule).bottom(function(t){return U(t.median)}),i.vis.render();break;case"performancemap":m=[],x=["Name"];var B,C,L=30,A=100;for(n=s;n<c;n++){for(r=0;r<d;r++)B=0==r?l[r][n].text:B+IG$._separator+l[r][n].text;C=IG$.measureText(12,B),L=Math.max(C.width+10,L),x.push(B)}for(n=d;n<l.length;n++){for(kt=[],r=0;r<s;r++)B=0==r?l[n][r].text:B+IG$._separator+l[n][r].text;for(C=IG$.measureText(12,B),A=Math.max(C.width,A),kt.push(B),r=s;r<c;r++)kt.push(Number(l[n][r].code)||0);m.push(kt)}m=m.map(function(t){return pv.dict(x,function(){return t[this.index]})}),x.shift();N=pv.dict(x,function(e){return pv.mean(m,function(t){return t[e]})});var P=pv.dict(x,function(e){return pv.deviation(m,function(t){return t[e]})}),E=pv.dict(x,function(t){return pv.Scale.linear().domain(-3*P[t]+N[t],3*P[t]+N[t]).range("white","steelblue")});i.vismargin={top:L,left:A,width:24*x.length,height:13*m.length};var T=$(i.container),q=Math.max(i.vismargin.width+i.vismargin.left,f),R=Math.max(i.vismargin.top+i.vismargin.height,g);T.css({overflow:"scroll"}),i.vis=(new pv.Panel).canvas(i.container).width(i.vismargin.width).height(i.vismargin.height).top(L).left(A),i.vis.add(pv.Panel).data(x).left(function(){return 24*this.index}).width(24).add(pv.Panel).data(m).top(function(){return 13*this.index}).height(13).fillStyle(function(t,e){return E[e](t[e])}).strokeStyle("white").lineWidth(1).antialias(!1).title(function(t,e){return t.Name+"'s "+e+": "+t[e]}),i.vis.add(pv.Label).data(x).top(3).left(function(){return 24*this.index+12}).textAngle(-Math.PI/2).textBaseline("middle"),i.vis.add(pv.Label).data(m).top(function(){return 13*this.index+6.5}).left(3).textAlign("right").textBaseline("middle").text(function(t){return t.Name}),i.vis.render();break;case"parallel":for(n=s;n<l[0].length;n++){for(a="",r=0;r<d;r++)a=0==r?l[n][r].text:a+IG$._separator+l[n][r].text;u.push(a)}var j=[],V=(x=[],{});for(n=s;n<l[0].length;n++){for(a="",r=0;r<d;r++)a=0==r?l[r][n].text:a+IG$._separator+l[r][n].text;V[a]={name:a,unit:""},x.push(a)}var z=pv.keys(V);for(n=d;n<l.length;n++){for(a="",r=0;r<s;r++)a=0==r?l[n][r].text:a+IG$._separator+l[n][r].text;var O={};for(O.name=a,r=s;r<l[n].length;r++)O[x[r-s]]=Number(l[n][r].code);j.push(O)}i.vismargin={left:30,right:30,top:30,bottom:40},f-=i.vismargin.left+i.vismargin.right,g-=i.vismargin.top+i.vismargin.bottom;N=pv.Scale.ordinal(z).splitFlush(0,f);var U=pv.dict(z,function(e){return pv.Scale.linear(j.filter(function(t){return!isNaN(t[e])}),function(t){return Math.floor(t[e])-.5},function(t){return Math.ceil(t[e])+.5}).range(0,g)}),W=pv.dict(z,function(e){return pv.Scale.linear(j.filter(function(t){return!isNaN(t[e])}),function(t){return Math.floor(t[e])-.5},function(t){return Math.ceil(t[e])+.5}).range("steelblue","brown")}),H=pv.dict(z,function(t){return{min:U[t].domain()[0],max:U[t].domain()[1]}}),J=z[0];i.vis=(new pv.Panel).canvas(i.container).width(f).height(g).left(i.vismargin.left).right(i.vismargin.right).top(i.vismargin.top).bottom(i.vismargin.bottom),i.vis.add(pv.Panel).data(j).visible(function(e){return z.every(function(t){return e[t]>=H[t].min&&e[t]<=H[t].max})}).add(pv.Line).data(z).left(function(t,e){return N(t)}).bottom(function(t,e){return U[t](e[t])}).strokeStyle("#ddd").lineWidth(1).antialias(!1),i.vis.add(pv.Rule).data(z).left(N).anchor("top").add(pv.Label).top(-12).font("bold 10px sans-serif").text(function(t){return V[t].name});var K=i.vis.add(pv.Panel);K.add(pv.Panel).data(j).visible(function(e){return z.every(function(t){return e[t]>=H[t].min&&e[t]<=H[t].max})}).add(pv.Line).data(z).left(function(t,e){return N(t)}).bottom(function(t,e){return U[t](e[t])}).strokeStyle(function(t,e){return W[J](e[J])}).lineWidth(1);function Q(t){var e=t.dim;return H[e].min=Math.max(U[e].domain()[0],U[e].invert(g-t.y-t.dy)),H[e].max=Math.min(U[e].domain()[1],U[e].invert(g-t.y)),J=e,i.updateSel.call(i,H,x),K.render(),!1}var X=K.add(pv.Panel).data(z.map(function(t){return{y:0,dy:g,dim:t}})).left(function(t){return N(t.dim)-30}).width(60).fillStyle("rgba(0,0,0,.001)").cursor("crosshair").event("mousedown",pv.Behavior.select()).event("select",Q).event("selectend",function(t){if(t.dy<3){var e=t.dim;H[e].min=Math.max(U[e].domain()[0],U[e].invert(0)),H[e].max=Math.min(U[e].domain()[1],U[e].invert(g)),t.y=0,t.dy=g,J=e,i.updateSel.call(i,null),K.render()}return!1}).add(pv.Bar).left(25).top(function(t){return t.y}).width(10).height(function(t){return t.dy}).fillStyle(function(t){return t.dim==J?W[t.dim]((H[t.dim].max+H[t.dim].min)/2):"hsla(0,0,50%,.5)"}).strokeStyle("white").cursor("move").event("mousedown",pv.Behavior.drag()).event("dragstart",Q).event("drag",Q);X.anchor("bottom").add(pv.Label).textBaseline("top").text(function(t){return H[t.dim].min.toFixed(0)+V[t.dim].unit}),X.anchor("top").add(pv.Label).textBaseline("bottom").text(function(t){return H[t.dim].max.toFixed(0)+V[t.dim].unit}),i.vis.render(),i._selBtn||(i._selBtn=$("<div class='m-vis-selbutton'>Selected</div>").appendTo(i.maincontainer),i._selBtn.bind("click",function(){i.showHideSel.call(i,null)}));break;case"networkdiagram_pos":case"networkdiagram_neg":var Y=i.cop.rel_range1==IG$.UNDEFINED||null==i.cop.rel_range1?-1:i.cop.rel_range1,Z=i.cop.rel_range2==IG$.UNDEFINED||null==i.cop.rel_range2?1:i.cop.rel_range2;i.vismargin={left:0,right:0,top:0,bottom:90},f-=i.vismargin.left+i.vismargin.right,g-=i.vismargin.top+i.vismargin.bottom;var tt=i.getRelData(e,"networkdiagram_pos"==t?1:0,!1,p,{s:Y,t:Z});i.vis=(new pv.Panel).canvas(i.container).width(f).height(g).bottom(90),(Vt=i.vis.add(pv.Layout.Arc).nodes(tt.nodes).links(tt.links).sort(function(t,e){return t.group==e.group?e.linkDegree-t.linkDegree:e.group-t.group})).link.add(pv.Line),Vt.node.add(pv.Dot).size(function(t){return t.linkDegree+4}).fillStyle(pv.Colors.category19().by(function(t){return t.group})).strokeStyle(function(){return this.fillStyle().darker()}),Vt.label.add(pv.Label),i.vis.render();break;case"matrixdiagram":var et=pv.Colors.category19().by(function(t){return t.group});Y=i.cop.rel_range1==IG$.UNDEFINED||null==i.cop.rel_range1?-1:i.cop.rel_range1,Z=i.cop.rel_range2==IG$.UNDEFINED||null==i.cop.rel_range2?1:i.cop.rel_range2;i.vismargin={left:90,right:0,top:90,bottom:0},f-=i.vismargin.left+i.vismargin.right,g-=i.vismargin.top+i.vismargin.bottom;tt=i.getRelData(e,2,!1,p,{s:Y,t:Z});i.vis=(new pv.Panel).canvas(i.container).width(f).height(g).top(i.vismargin.top).left(i.vismargin.left);var nt=i.vis.add(pv.Layout.Matrix).nodes(tt.nodes).links(tt.links).sort(function(t,e){return e.group-t.group});nt.link.add(pv.Bar).fillStyle(function(t){return t.linkValue?t.targetNode.group==t.sourceNode.group?et(t.sourceNode):"#555":"#eee"}).antialias(!1).lineWidth(1),nt.label.add(pv.Label).textStyle(et),i.vis.render();break;case"anderson":var rt,at,it,ot=150,lt=[],st={},dt=[],ct=[],ut=0;c=l[0].length;for(n=s;n<l[0].length;n++){for(a="",r=0;r<d;r++)a=0==r?l[r][n].text:a+"_"+l[r][n].text;dt.push(a)}for(n=0;n<i.sheetoption.model.rows.length;n++)if(i.sheetoption.model.rows[n].name==i.cop.andersonspecies){ut=n;break}for(n=d;n<l.length;n++){for(st[rt=l[n][ut].text]||(st[rt]=rt),at={species:rt},r=s;r<c;r++)at[dt[r-s]]=l[n][r].code;ct.push(at)}for(it in st)lt.push(it);T=$(i.container),q=Math.max(170*dt.length,f),R=Math.max(170*dt.length,g)+20;T.css({overflow:"scroll"});var pt=pv.rgb(144,144,144,.2),ht=(et=pv.colors("rgba(30, 108, 11, 1)","rgba(0, 72, 140, 1)","rgba(51, 38, 9, 1)","rgba(216, 64, 0, 1)","rgba(67, 76, 67, 1)","rgba(179, 0, 35, 1)","rgba(248, 215, 83, 1)","rgba(92, 151, 70, 1)","rgba(62, 117, 167, 1)","rgba(122, 101, 62, 1)","rgba(225, 102, 42, 1)","rgba(116, 121, 111, 1)","rgba(196, 56, 79, 1)","rgba(255, 248, 163, 1)","rgba(196, 204, 143, 1)","rgba(178, 200, 217, 1)","rgba(190, 163, 122, 1)","rgba(243, 170, 121, 1)","rgba(181, 181, 169, 1)","rgba(230, 165, 164, 1)"),pv.dict(dt,function(e){return pv.Scale.linear(ct,function(t){return t[e]}).range(0,ot)}));i.vismargin={left:10,right:0,top:5,bottom:0},f-=i.vismargin.left+i.vismargin.right,g-=i.vismargin.top+i.vismargin.bottom,i.vismargin.width=q,i.vismargin.height=R,i.vis=(new pv.Panel).canvas(i.container).width(170*dt.length).height(170*dt.length+20).left(i.vismargin.left).top(i.vismargin.top);var vt=i.vis.add(pv.Panel).data(dt).top(function(){return 170*this.index+10}).height(ot).add(pv.Panel).data(function(e){return dt.map(function(t){return{px:t,py:e}})}).left(function(){return 170*this.index+10}).width(ot),ft=vt.add(pv.Panel).visible(function(t){return t.px!=t.py}).strokeStyle("#aaa"),gt=ft.add(pv.Rule).data(function(t){return ht[t.px].ticks(5)}).left(function(t,e){return ht[e.px](t)}).strokeStyle("#eee");gt.anchor("bottom").add(pv.Label).visible(function(){return vt.parent.index==dt.length-1&&!(1&vt.index)}).text(function(t,e){return ht[e.px].tickFormat(t)}),gt.anchor("top").add(pv.Label).visible(function(){return 0==vt.parent.index&&1&vt.index}).text(function(t,e){return ht[e.px].tickFormat(t)});var mt=ft.add(pv.Rule).data(function(t){return ht[t.py].ticks(5)}).bottom(function(t,e){return ht[e.py](t)}).strokeStyle("#eee");mt.anchor("left").add(pv.Label).visible(function(){return 0==vt.index&&1&vt.parent.index}).text(function(t,e){return ht[e.py].tickFormat(t)}),mt.anchor("right").add(pv.Label).visible(function(){return vt.index==dt.length-1&&!(1&vt.parent.index)}).text(function(t,e){return ht[e.py].tickFormat(t)});function xt(t,e){(P=t).px=e.px,P.py=e.py,P.x1=ht[e.px].invert(t.x),P.x2=ht[e.px].invert(t.x+t.dx),P.y1=ht[e.py].invert(ot-t.y-t.dy),P.y2=ht[e.py].invert(ot-t.y),bt.context(null,0,function(){yt.render()}),i.updateSel.call(i,null,dt,P)}var bt=ft.add(pv.Dot).data(ct).left(function(t,e){return ht[e.px](t[e.px])}).bottom(function(t,e){return ht[e.py](t[e.py])}).size(10).strokeStyle(null).fillStyle(function(t){return P&&(t[P.px]<P.x1||t[P.px]>P.x2||t[P.py]<P.y1||t[P.py]>P.y2)?pt:et(t.species)}),yt=i.vis;ft.add(pv.Panel).data([{x:20,y:20,dx:100,dy:100}]).cursor("crosshair").events("all").event("mousedown",pv.Behavior.select()).event("selectstart",function(){return P=null,yt}).event("select",xt).add(pv.Bar).visible(function(t,e,n){return P&&P.px==n.px&&P.py==n.py}).left(function(t){return t.x}).top(function(t){return t.y}).width(function(t){return t.dx}).height(function(t){return t.dy}).fillStyle("rgba(0,0,0,.15)").strokeStyle("white").cursor("move").event("mousedown",pv.Behavior.drag()).event("drag",xt),vt.anchor("center").add(pv.Label).visible(function(t){return t.px==t.py}).font("bold 14px sans-serif").text(function(t){return t.px.replace(/([WL])/," $1").toLowerCase()}),i.vis.add(pv.Dot).data(lt).bottom(10).left(function(){return 15+65*this.index}).size(8).strokeStyle(null).fillStyle(et).anchor("right").add(pv.Label),i.vis.render(),i._selBtn||(i._selBtn=$("<div class='m-vis-selbutton'></div>").appendTo(i.maincontainer),i._selBtn.bind("click",function(){i.showHideSel.call(i,null)}));break;case"forcelayout":i.vismargin={left:0,right:0,top:0,bottom:0},f-=i.vismargin.left+i.vismargin.right,g-=i.vismargin.top+i.vismargin.bottom;var wt=pv.Colors.category19();Y=i.cop.rel_range1==IG$.UNDEFINED||null==i.cop.rel_range1?-1:i.cop.rel_range1,Z=i.cop.rel_range2==IG$.UNDEFINED||null==i.cop.rel_range2?1:i.cop.rel_range2,tt=i.getRelData(e,2,!0,p,{s:Y,t:Z});i.vis=(new pv.Panel).canvas(i.container).width(f).height(g).fillStyle("white").event("mousedown",pv.Behavior.pan()).event("mousewheel",pv.Behavior.zoom());var _t=i.vis.add(pv.Layout.Force).nodes(tt.nodes).links(tt.links).chargeConstant(-9e3);_t.link.add(pv.Line),_t.node.add(pv.Dot).size(function(t){return(t.linkDegree+4)*Math.pow(this.scale,-1.5)}).fillStyle(function(t){return t.fix?"brown":wt(t.group)}).strokeStyle(function(){return this.fillStyle().darker()}).lineWidth(1).title(function(t){return t.nodeName}).event("mousedown",pv.Behavior.drag()).event("drag",_t),i.vis.render();break;case"chord":var kt,$t,It=[],Gt=[],Ft=(c=l[0].length,o&&o.settings.chd_method||"relations"),Mt=[],St=0;et=d3.scale.category20c(),Y=i.cop.rel_range1==IG$.UNDEFINED||null==i.cop.rel_range1?-1:i.cop.rel_range1,Z=i.cop.rel_range2==IG$.UNDEFINED||null==i.cop.rel_range2?1:i.cop.rel_range2;if("tablematrix"==Ft){var Nt,Dt,Bt,Ct,Lt={},At=[];P=0;if(0<s){for(n=d;n<l.length;n++)Lt[Pt=l[n][0].code]||(Nt={name:Pt,seq:P,r:n,c:-1},At.push(Nt),P++,Lt[Pt]=Nt,Mt.push({title:Pt,code:Pt}));for(n=s;n<c;n++)Lt[Pt=l[0][n].code]&&(Lt[Pt].c=n);for(n=0;n<At.length;n++){for(kt=[],Ct=At[n].r,r=0;r<At.length;r++)Dt=0,-1<(Bt=At[r].c)&&(Dt=Number(l[Ct][Bt].code)||0),0<Dt&&(St=1),kt.push(Dt);It.push(kt)}}}else{var Pt,Et=i.getRelData(e,2,!1,p,{s:Y,t:Z});Et.nodes.length;for(n=0;n<Et.nodes.length;n++){for(kt=[],Pt=Et.nodes[n].nodeName,Gt.push({name:Pt}),r=0;r<Et.nodes.length;r++)kt.push(0);Mt.push({title:Pt,code:Pt}),It.push(kt)}for(n=0;n<Et.links.length;n++)$t=Et.links[n],It[$t.source][$t.target]=$t.value+1,$t.source!=$t.target&&(It[$t.target][$t.source]=$t.value+1,St=1)}if(0==St)return;M=f,S=g;var Tt=(o?o.colorset:"")||e.c_cset,qt=d3.layout.chord().sortSubgroups(d3.descending).matrix(It),Rt=.41*Math.min(f,g),jt=1.1*Rt;wt=["#009CFF","#FBE105","#72C936","#C42AD8","#2164E9","#FF9600","#F02F1B"];IG$.__chartoption&&IG$.__chartoption.chartcolors&&IG$.__chartoption.chartcolors[Tt]&&(wt=IG$.__chartoption.chartcolors[Tt]);E=d3.scale.ordinal().domain(d3.range(wt.length)).range(wt);var Vt=d3.svg.arc().innerRadius(Rt).outerRadius(jt),zt=d3.svg.chord().radius(Rt);function Ot(t,e){t.transition().duration(3e3).style("stroke",function(t){return E(e.index)}).attr("stroke-dashoffset","1000").attr("animation","dash 5s linear forwards")}function Ut(n){return function(t,e){e=d3.interpolate(n.groups()[e],t);return function(t){return Vt(e(t))}}};function Wt(t){var e=(t.endAngle-t.startAngle)/t.value;return[{angle:t.value*e/2+t.startAngle,label:Mt[t.index].title}]};i.vis=qt;var Ht,Jt=d3.select(i.container).append("svg").attr("width",M).attr("height",S).append("g").attr("id","circle").attr("transform","translate("+M/2+","+S/2+")"),Kt=Jt.append("defs"),Qt=[];for(n=0;n<wt.length;n++)(Ht=Kt.append("linearGradient").attr("id","color"+n)).append("stop").attr("offset","0%").attr("stop-color",wt[n]),Ht.append("stop").attr("offset","100%").attr("stop-color",wt[n]),Qt.push(Ht);Jt.append("g").selectAll("path").data(qt.groups).enter().append("path").attr("class","arc").style("fill",function(t){return E(t.index)}).style("stroke","#FFFFFF").style("stroke-width","3.5px").attr("d",Vt).on("mouseover",function(t){d3.select(this).transition().duration(100).style("stroke","gold").style("stroke-width","2.5px").style("cursor","pointer")}).on("mouseout",function(t){d3.select(this).transition().duration(100).style("stroke","#FFFFFF").style("stroke-width","2.5px")}).on("click",function(a,t){a.index,Jt.selectAll(".chord path").transition().ease("linear-in").style("opacity",function(t,e){return a.index!=t.source.index&&a.index!=t.target.index?.1:1}).style("stroke",function(t,e){return a.index!=t.source.index&&(a.index,t.target.index),"#FFF"}).style("stroke-width",function(t,e){return a.index!=t.source.index&&a.index!=t.target.index?"0px":"1px"}).call(Ot,a),Jt.select(".chord").selectAll("path").style("fill",function(t,e){var n,r;return t.source.index!=a.index&&t.source.subindex!=a.index||(r=a.index%Qt.length,Qt[r]&&(n="url(#color"+r+")")),n})});var Xt=d3.tip().attr("class","d3-tip").offset([0,0]).html(function(t){return function(t,e,n){var r="",a="",i="";return"S"==t&&(r=Mt[e].title,a=Mt[n].title,i="<span style='color:#C0FF00'>"+It[e][n]+" </span>"),r+" "+a+"<br><br>"+i}("S",t.source.index,t.source.subindex)});Jt.call(Xt);var Yt=Jt.append("g").attr("class","ticks").selectAll("g").data(qt.groups).enter().append("g").attr("class","group").selectAll("g").data(Wt).enter().append("g").attr("class","neighs").attr("transform",function(t){return"rotate("+(180*t.angle/Math.PI-90)+")translate("+jt+",0)"});Yt.append("line").attr("x1",1).attr("y1",0).attr("x2",5).attr("y2",0).style("stroke","#ffffff"),Yt.append("text").attr("x",8).attr("dy",".35em").attr("transform",function(t){return t.angle>Math.PI?"rotate(180)translate(-16)":null}).style("text-anchor",function(t){return t.angle>Math.PI?"end":null}).style("text-weight","bold").style("text-size","13px").text(function(t){return t.label});Jt.append("g").attr("class","chord").selectAll("path").data(qt.chords).enter().append("path").style("opacity",0).attr("d",zt).on("mouseover",Xt.show).on("mouseout",Xt.hide);Jt.selectAll(".ticks").selectAll(".group").data(qt.groups).selectAll(".neighs").data(Wt).transition().duration(1500).attr("transform",function(t){return"rotate("+(180*t.angle/Math.PI-90)+")translate("+jt+",0)"}),Jt.selectAll(".arc").data(qt.groups).transition().duration(1500).select("title").text(function(t,e){return neighs[e].name+": "+formatPercent(t.value)+" of origins"}),Jt.select(".chord").selectAll("path").data(qt.chords).style("fill",function(t,e){var n,r=t.target.index%Qt.length;return Qt[r]&&(n="url(#color"+r+")"),n}).transition().duration(1500).style("opacity",1).attrTween("d",(h=qt,function(t,e){return e=d3.interpolate(h.chords()[e],t),function(t){return zt(e(t))}}));break;case"sunburst":if(!window.d3)return;M=f,S=g;var Zt,te=Math.min(M,S)/2,ee=s;for(et=d3.scale.category20c(),sundata={name:"root",children:[]},c=l[0].length,pva=[],n=0;n<s;n++)pva.push({name:null,child:sundata});for(n=d;n<l.length;n++)for(r=0;r<s;r++)B=l[n][r].text||l[n][r].code,pva[r].name!=B&&(0==r?(Zt={name:B},sundata.children.push(Zt)):(Zt={name:B},pva[r-1].child.children.push(Zt)),pva[r].child=Zt,pva[r].name=Zt.name,r==s-1?Zt.size=Number(l[n][ee].code||0):Zt.children=[]);function Ut(n){var r=d3.interpolate({x:n.x0,dx:n.dx0},n);return function(t){var e=r(t);return n.x0=e.x,n.dx0=e.dx,Vt(e)}}i.vis=d3.select(i.container).append("svg:svg").attr("width",M).attr("height",S).append("svg:g").attr("transform","translate("+f/2+","+g/2+")");var ne=d3.layout.partition().sort(null).size([2*Math.PI,te*te]).value(function(t){return t.size}),re=(Vt=d3.svg.arc().startAngle(function(t){return t.x}).endAngle(function(t){return t.x+t.dx}).innerRadius(function(t){return Math.sqrt(t.y)}).outerRadius(function(t){return Math.sqrt(t.y+t.dy)}),i.vis.data([sundata]).selectAll("g").data(ne.nodes).enter().append("svg:g").attr("display",function(t){return t.depth?null:"none"}));re.append("svg:path").attr("d",Vt).attr("fill-rule","evenodd").style("stroke","#fff").style("fill",function(t){return et((t.children?t:t.parent).name)}).each(function(t){t.x0=t.x,t.dx0=t.dx}),re.append("svg:text").attr("transform",function(t){return"rotate("+(t.x+t.dx/2-Math.PI/2)/Math.PI*180+")"}).attr("x",function(t){return Math.sqrt(t.y)}).attr("dx","6").attr("dy",".35em").text(function(t){return t.name}),d3.select("#size").on("click",function(){re.data(ne.value(function(t){return t.size})).transition().duration(1500).attrTween("d",Ut),d3.select("#size").classed("active",!0),d3.select("#count").classed("active",!1)}),d3.select("#count").on("click",function(){re.data(ne.value(function(t){return 1})).transition().duration(1500).attrTween("d",Ut),d3.select("#size").classed("active",!1),d3.select("#count").classed("active",!0)})}},IG$.v$olapChartView.prototype.drD3Cust=function(t,e){var n,r=this;r.drawmode="dcust",r.mresult=e,r.rct=t;var a=$(r.container);IG$.j$ext._w(a),IG$.j$ext._h(a);switch(t){case"bullet":(n=new IG$.c$BulChart($(r.container))).loadData.call(n,r.mresult),r.dcust=n;break;case"nation":(n=new IG$.c$NatChart($(r.container),r.sheetoption,r.cop)).loadData.call(n,r.mresult),r.dcust=n}},IG$.v$olapChartView.prototype.getRelData=function(t,e,n,r,a){var i,o,l,s,d,c,u,p,h,v,f=t._tabledata,g=t.colfix,m=t.rowfix,x=[],b={nodes:[],links:[]};for(i=g;i<f[0].length;i++){for(l="",o=0;o<m;o++)l=0==o?f[o][i].text:l+IG$._separator+f[o][i].text;b.nodes.push({nodeName:l,group:r&&r.length>i-g&&""!=r[i-g]?parseInt(r[i-g]):i})}for(p=b.nodes.length,i=m;i<f.length;i++){for(s=[],o=g;o<f[i].length;o++)d=Number(f[i][o].code)||0,s.push(d);x.push(s)}for(c=0;c<p;c++)for(u=0;u<c+1;u++)c!=u&&(h={source:c,target:u},v=this.corRelCoefficient.call(this,x,c,u),a.s<=v&&v<=a.t&&(h.value=v,h.value=1==n?10*(v+1):10*v,1==e?0<v&&b.links.push(h):0==e?v<0&&b.links.push(h):b.links.push(h)));return b},IG$.v$olapChartView.prototype.corRelCoefficient=function(t,e,n){var r,a,i=t.length,o=0,l=0,s=0,d=0,c=0;for(a=0;a<t.length;a++){var u=(r=t[a])[e],p=r[n];o+=u,l+=p,s+=Math.pow(u,2),d+=Math.pow(p,2),c+=u*p}return(i*c-o*l)/(Math.sqrt(i*s-Math.pow(o,2))*Math.sqrt(i*d-Math.pow(l,2)))},IG$.v$olapChartView.prototype.drMatrixChart=function(t){var e,n,r,a,i,o=t._tabledata,l=t.colfix,s=t.rowfix,d=[],c=[],u=this;for(u.drawmode="qavis",e=l;e<o[0].length;e++){for(r="",n=0;n<s;n++)r=0==n?o[n][e].text:r+IG$._separator+o[n][e].text;d.push(r)}for(e=s;e<o.length;e++){for(a=[],n=l;n<o[e].length;n++)i=Number(o[e][n].code),a.push(i);c.push(a)}u.qavis=new IG$.ComparisonMatrix(u.container,{cr1:u.cop.comp_range0,cr2:u.cop.comp_range1}),u.qavis.dataSet=c,u.qavis.fields=d,u.qavis.commitProp()},IG$.v$olapChartView.prototype.centroid=function(t){for(var e,n,r,a=t.length,i=0,o=0,l=a-1,s=0;s<a;l=s++)n=t[s],r=t[l],e=n.lng*r.lat-r.lng*n.lat,i+=(n.lng+r.lng)*e,o+=(n.lat+r.lat)*e;return{lng:i/(e=6*this.area(t)),lat:o/e}},IG$.v$olapChartView.prototype.drMapChart=function(t){var e=this;e.drD3ExtMap(t)},IG$.v$olapChartView.prototype.drProtovisMapChart=function(t){function r(t){return t<17?"#008038":t<20?"#A3D396":t<23?"#FDD2AA":t<26?"#F7976B":t<29?"#F26123":t<32?"#E12816":"#B7161E"}var e=this;us_lowres.forEach(function(t){t.code=t.code.toUpperCase(),t.centLatLon=e.centroid(t.borders[0])});var a=[];for(i=t.rowfix;i<t._tabledata.length;i++){var n,o=t._tabledata[i][0].text,l=0;for(j=t.colfix;j<t.colcnt;j++)n=t._tabledata[i][j].code,l+=Number(n);a[o]=l}var s=$(e.container),d=IG$.j$ext._w(s),c=IG$.j$ext._h(s),u=pv.Geo.scale().domain({lng:-128,lat:24},{lng:-64,lat:50}).range({x:0,y:0},{x:d,y:c});e.vismargin={top:30,bottom:20},e.vis=(new pv.Panel).canvas(e.container).width(d).height(c-e.vismargin.top-e.vismargin.bottom).top(30).bottom(20),e.vis.add(pv.Panel).data(us_lowres).add(pv.Panel).data(function(t){return t.borders}).add(pv.Line).data(function(t){return t}).left(u.x).top(u.y).fillStyle(function(t,e,n){return r(a[n.code])}).lineWidth(1).strokeStyle("white").antialias(!1),e.vis.add(pv.Label).data(us_lowres).left(function(t){return u(t.centLatLon).x}).top(function(t){return u(t.centLatLon).y}).text(function(t){return t.code}).textAlign("center").textBaseline("middle"),e.vis.add(pv.Bar).data(pv.range(14,32.1,3)).bottom(function(t){return 12*this.index}).height(10).width(10).left(5).fillStyle(function(t){return r(14+3*this.index)}).lineWidth(null).anchor("right").add(pv.Label).textAlign("left").text(function(t){return t+" - "+(t+3)+"%"}),e.vis.render()},IG$.v$olapChartView.prototype.drD3Map=function(t){var e=d3.geo.path(),n=d3.select(this.container).append("svg"),r=n.append("g").attr("id","counties").attr("class","Blues"),a=n.append("g").attr("id","states");d3.json("./data/us-counties.json",function(t){r.selectAll("path").data(t.features).enter().append("path").attr("class",data?c:null).attr("d",e)}),d3.json("./data/us-states.json",function(t){a.selectAll("path").data(t.features).enter().append("path").attr("d",e)});var o=[];for(i=t.rowfix;i<t._tabledata.length;i++){var l,s=t._tabledata[i][0].text,d=0;for(j=t.colfix;j<t.colcnt;j++)l=t._tabledata[i][j].code,d+=Number(l);o[s]=d}function c(t){return"q"+Math.min(8,~~(9*o[t.id]/12))+"-9"}r.selectAll("path").attr("class",c)},IG$.v$olapChartView.prototype.drD3ExtMap=function(){function n(t){return t<17?"#008038":t<20?"#A3D396":t<23?"#FDD2AA":t<26?"#F7976B":t<29?"#F26123":t<32?"#E12816":"#B7161E"}var t,e,r,a,i,o,l,s,d,c=this,u=c.mresult,p=u.colfix,h=u.rowfix,v=u._tabledata,f=0<v.length?v[0].length:0,g=c.container,m=c.cop,x=c.sheetoption?c.sheetoption.model:null,b=m.mapcategory,y=-1,w=IG$.mLU?IG$.mLU.maptype:null,_=null,k={},I=[];if(w)for(e=0;e<w.length;e++)if(w[e].subtype==m.maptype){_=w[e];break}if(x){for(e=0;e<x.rows.length;e++)if(x.rows[e].uid==b){y=e;break}y<0&&0<x.rows.length&&(y=0)}if(null!=_){for(e=p;e<f;e++){for(d="",r=0;r<h;r++)d+=((a=v[r][e]).text||a.code)+IG$._separator;I.push({cindex:e,c:e-p,name:d,maxvalue:null,minvalue:null,sumvalue:0})}for(e=h;e<v.length;e++){if(i=(i=-1<y?v[e][y].code:"NO_REGION")?i.toLowerCase():"",k[i])s=k[i];else for(k[i]=s=[],r=0;r<I.length;r++)s.push(0);for(r=p;r<f;r++)l=r-p,o=(a=v[e][r]).code&&""!=a.code?parseFloat(a.code):0,s[l]+=o,I[l].maxvalue=null==I[l].maxvalue?s[l]:Math.max(I[l].maxvalue,s[l]),I[l].minvalue=null==I[l].minvalue?s[l]:Math.min(I[l].minvalue,s[l]),I[l].sumvalue+=o}t="./data/"+_.filename;$.getJSON(t,function(t){var e=$(g),r=new gJ(e);r.color=n,r.clickHandler={o:c,f:function(t){var e={name:r.mapseries[r.legidx||0].name},n={point:{category:t.value}};" "==e.name.charAt(e.name.length-1)&&(e.name=e.name.substring(0,e.name.length-1)),c.procClickEvent.call(c,e,n)}},r.drawMap.call(r,t,{scale:_.scale,maptype:_.subtype,mapseries:I,mapdp:k})})}},IG$.v$olapChartView.prototype.drGSAPIMap=function(){var t=this.container,e=new google.visualization.GeoChart(t),n=new google.visualization.DataTable;n.addColumn("string","State"),n.addColumn("number","Data"),e.draw(n,{region:"840"})},IG$.v$olapChartView.prototype.drTreeMap=function(t){var e,n,r,a,i,o,l,s,d=this,c=t._tabledata,u=t.colfix,p=t.rowfix,h=d.sheetoption.model.chart_option,v=h.tm_l_cl,f=0<t._tabledata.length?t._tabledata[0].length:0,g=[],m=[],x=[],b=$(d.container),y={ty:0},w=0;for(b.empty(),s=IG$.__chartoption&&IG$.__chartoption.chartcolors&&IG$.__chartoption.chartcolors[h.colorset]?IG$.__chartoption.chartcolors[h.colorset]:Highcharts.getOptions().colors,e=0;e<u;e++)m.push({value:null,seq:0,point:null});for(e=u;e<f;e++){for(I="",n=0;n<p;n++)I=0==n?c[n][e].text:I+IG$._separator+c[n][e].text;x.push({name:I,selected:e-u==d.ti})}for(x&&1<x.length&&(o=$("<div class='mtreemap-caption'></div>"),b.append(o),$.each(x,function(e,t){$("<input type='radio' name='category' value='"+e+"'>"+t.name+"&nbsp;&nbsp;&nbsp;&nbsp;</input>").prop("checked",t.selected).appendTo(o).bind("change",function(t){d.ti=e,d.drTreeMap.call(d,d.mresult)})}),y.ty=o.height()),e=p;e<c.length;e++){for(r=c[e],n=0;n<u;n++)val=r[n].text,m[n].value!=val&&(0==n?(a={id:"id_"+m[n].seq,name:val,value:0},v?a.colorValue=0:a.color=s[w%s.length],m[n].seq++,m[n].point=a,g.push(a),w++):(a={id:(i=m[n-1].point).id+"_"+m[n].seq,name:val,parent:i.id,value:0},v&&(a.colorValue=0),m[n].seq++,m[n].point=a,g.push(a))),m[n].value=val,v&&(m[n].colorValue=val);if(r.length>d.ti+u)for(l=r[d.ti+u],a={id:(i=m[u-1].point).id+"_"+(d.ti+u),name:x[d.ti].name,parent:i.id,value:Number(l.code)},v&&(a.colorValue=Number(l.code)),g.push(a),k=0;k<m.length;k++)val=Number(l.code),val&&(m[k].point.value+=val,v&&(m[k].point.colorValue=m[k].point.value))}var _=IG$.j$ext._w(b),I=IG$.j$ext._h(b),G=new Object;if(d.drawmode="treemap",y.box=$("<div></div>").appendTo(b),y.box.css({position:"absolute",width:_,height:I-y.ty,top:y.ty,left:0}),G.chart={animation:!1,renderTo:y.box[0],reflow:!1,alignTicks:!0,borderWidth:0},G.colors=s,1==h.showtitle){var F=h.title||"";switch(G.title={text:F},h.titleposition){case"BOTTOM_LEFT":G.title.align="left",G.title.floating=!0,G.chart.marginBottom=50,G.title.y=I-20;break;case"BOTTOM_CENTER":G.title.align="center",G.title.floating=!0,G.chart.marginBottom=50,G.title.y=I-20;break;case"BOTTOM_RIGHT":G.title.align="right",G.title.floating=!0,G.chart.marginBottom=50,G.title.y=I-20;break;case"TOP_LEFT":G.title.align="left",G.title.verticalAlign="top";break;case"TOP_CENTER":break;case"TOP_RIGHT":G.title.align="right",G.title.verticalAlign="top"}}else G.title={text:""};v&&(G.colorAxis={minColor:"#FFFFFF",maxColor:Highcharts.getOptions().colors[0]}),G.series=[{type:"treemap",layoutAlgorithm:h.tm_l_alg||"squarified",allowDrillToNode:!0,dataLabels:{enabled:!1},levelIsConstant:!1,levels:[{level:1,colorByPoint:!1,dataLabels:{enabled:!0},borderWidth:2}],drillUpButton:{text:"< "+IRm$.r1("B_BACK"),relativeTo:"plotBox",position:{y:0,x:0}},data:g}],y.map=new Highcharts.Chart(G),d.treemap=y};