IG$.showLoginProc=function(){var e=$("#loginWindow");$("#userid");e.hide()},IG$.open_url=function(e){if(e.objid||e.uid){var i=IG$.mainPanel,n=new IG$._rpc$;n.init(this,{ack:"helpcontent",payload:{uid:e.objid||e.uid},mbody:{option:"translate"}},this,(function(e){var n=e&&e.length?e[0]:null;n&&i.navigateApp.call(i,n.uid,n.type.toLowerCase(),n.name,n.nodepath,!0,n.writable)})),n.send()}},IG$.$loadApp=function(e){if(ig$.theme_id)switch(ig$.theme_id.toLowerCase()){case"desertlight":ig$.echarts_theme="dark"}ig$._load_obj&&ig$._load_obj.objid&&IG$.open_url({objid:ig$._load_obj.objid})},IG$._load_viewer_cnt=function(e){var i=!1;if(e&&e.uuid){if(i=!0,IG$.dlgLogin.callback=new IG$.callBackObj(this,IG$.showLoginProc),IG$.dlgLogin.uuid=e.uuid,IG$.dlgLogin.mts={sid:e.mts,name:e.mts_name},IG$._g$a=IG$.dlgLogin.mts.sid,window.m$mts&&IG$.dlgLogin.mts.name!=window.m$mts&&IG$.dlgLogin.mts.sid!=window.m$mts)return void IG$.showLogout(new IG$.callBackObj(this,IG$.showLoginProc));if(IG$.dlgLogin.lastLogin={lastaccesstime:e.lastaccesstime,lastaccesshost:e.lastaccesshost,lastaccessaddr:e.lastaccessaddr,accesshost:e.accesshost,accessaddr:e.accessaddr,accesstime:e.accesstime},IG$.mainPanel&&IG$.mainPanel.updateLoginInfo.call(IG$.mainPanel),IG$.dlgLogin.getUserDetail.call(IG$.dlgLogin,!1),!ig$._load_obj)if(ig$.viewer_menu)$.ajax({type:"GET",url:ig$.viewer_menu+"?_d="+IG$.getUniqueKey(),dataType:"json",timeout:1e4,success:function(e){if(e.menus){var i=$("#d_nav");$("#content").mouseover((function(){$("#slide_menu").slideUp(400),$("#nav > ul > li > ul").fadeOut(300)})),$.each(e.menus,(function(e,n){var t=$("<li></li>").appendTo(i),o=$("<a>"+n.name+"</a>").appendTo(t);if(o.mouseover((function(){if(n.menus&&n.menus.length){var e=$(this).parent("li").children("ul").children("li").size()-1,i=0==e?75:20*e+78;$("#slide_menu").css("height",i+"px"),$("#nav > ul > li > ul").hide(),$("#slide_menu").slideDown(300),$(this).parent("li").children("ul").fadeIn(300).siblings().children("ul").fadeOut(200)}else $("#slide_menu").slideUp(400),$("#nav > ul > li > ul").fadeOut(300)})),o.click((function(e){e.preventDefault(),e.stopPropagation(),$("#title_area > h1").text($(this).text()),IG$.open_url(n)})),n.menus&&n.menus.length){var a=$("<ul></ul>").appendTo(t);$.each(n.menus,(function(e,i){$("<li><a>"+i.name+"</a></li>").appendTo(a).click((function(e){e.preventDefault(),e.stopPropagation(),$("#title_area > h1").text(n.name+" > "+i.name),$("#slide_menu").slideUp(400),$("#nav > ul > li > ul").fadeOut(300),IG$.open_url(i)}))}))}}))}},error:function(e,i,n){}});else{var n=new IG$._rpc$;n.showerror=!1,n.init(this,{ack:"content",payload:{uid:"/SYS_Config/dashboardmenu"},mbody:{}},this,(function(e){if(e.menustructure){var i=$("#d_nav");$("#content").mouseover((function(){$("#slide_menu").slideUp(400),$("#nav > ul > li > ul").fadeOut(300)})),$.each(e.menustructure,(function(e,n){var t=$("<li></li>").appendTo(i),o=$("<a>"+n.name+"</a>").appendTo(t);if(o.mouseover((function(){if(n.items&&n.items.length){var e=$(this).parent("li").children("ul").children("li").size()-1,i=0==e?75:20*e+78;$("#slide_menu").css("height",i+"px"),$("#nav > ul > li > ul").hide(),$("#slide_menu").slideDown(300),$(this).parent("li").children("ul").fadeIn(300).siblings().children("ul").fadeOut(200)}else $("#slide_menu").slideUp(400),$("#nav > ul > li > ul").fadeOut(300)})),o.click((function(e){e.preventDefault(),e.stopPropagation(),n.options&&"report"==n.options.ltype&&n.options.rptl_uid&&($("#title_area > h1").text(n.options.rptl||$(this).text()),IG$.open_url({uid:n.options.rptl_uid}))})),n.items&&n.items.length){var a=$("<ul></ul>").appendTo(t);$.each(n.items,(function(e,i){$("<li><a>"+i.name+"</a></li>").appendTo(a).click((function(e){e.preventDefault(),e.stopPropagation(),$("#title_area > h1").text(n.name+" > "+i.name),$("#slide_menu").slideUp(400),$("#nav > ul > li > ul").fadeOut(300),IG$.open_url(i)}))}))}}));var n=e.menustructure[0];n&&n.options&&"report"==n.options.ltype&&n.options.rptl_uid&&($("#title_area > h1").text(n.options.rptl),IG$.open_url({uid:n.options.rptl_uid}))}})),n.send()}}0==i&&IG$.showLogin(new IG$.callBackObj(this,IG$.showLoginProc),0)},$s.ready((function(){$("#lpt","#loading").css("width","80%"),!webix.env.touch&&webix.ui.scrollSize&&webix.CustomScroll.init(),IRm$.r2({func:function(){$("#lpt","#loading").css("width","100%"),setTimeout((function(){var e;IG$.loadExtend.rcsloaded=!0,e={closeText:IRm$.r1("L_C_CLOSE"),prevText:IRm$.r1("L_C_PREV"),nextText:IRm$.r1("L_C_NEXT"),currentText:IRm$.r1("L_C_CUR"),monthNames:IRm$.r1("L_C_M_NAMES").split("#"),monthNamesShort:IRm$.r1("L_C_M_NAMES_S").split("#"),dayNames:IRm$.r1("L_C_D_NAMES").split("#"),dayNamesShort:IRm$.r1("L_C_D_NAMES_S").split("#"),dayNamesMin:IRm$.r1("L_C_D_NAMES_M").split("#"),weekHeader:IRm$.r1("L_C_W_H"),firstDay:0,isRTL:!1,showMonthAfterYear:!0,yearSuffix:IRm$.r1("L_C_YR_SFX"),c1disp:"yyyy-mm-dd",c1format:"yy-mm-dd",c2disp:"yyyy-mm",c2format:"yy-mm"};var i,n,t,o,a,l=window.location.search,s={};if(l&&l.length&&(i=l.split("&")).length>0)for(n=0;n<i.length;n++)(a=i[n]).indexOf("=")>0&&(t=a.substring(0,a.indexOf("=")),o=a.substring(a.indexOf("=")+1),"?"==t.charAt(0)&&(t=t.substring(1)),s[t]=o);$.datepicker.setDefaults(e),IG$.calendar_locale=e,IG$.mainPanel=new IG$.MainPanel({}),$.each(IG$.loadExtend.items,(function(e,i){IG$.extend(i.name,i.base,i.option)})),$.each(IG$.filteropcodes,(function(e,i){var n=i.lcode;i.locale=IRm$.r1(n)}));var d=new $s.viewport({layout:"fit",id:ig$.mainview||"mainview"}),u={w:$("#mainview").width(),h:$("#mainview").height()};setInterval((function(){var e={w:$("#mainview").width(),h:$("#mainview").height()};e.w&&e.h&&(e.w!=u.w||e.h!=u.h)&&(d.setSize(e.w,e.h),u=e)}),100),d.doLayout(),IG$.viewport=d,mainview=new $s.panel({layout:{type:"vbox",align:"stretch"},items:[{xtype:"container",name:"maintab",border:1,flex:1,layout:"fit",items:[IG$.mainPanel]}]}),d.add(mainview),mainview.doLayout(),IG$.viewport=d,setTimeout((function(){$("#loading").fadeOut({remove:!0}),$("#loading-mask").fadeOut({remove:!0})}),150);var r=$.cookie("lui")||"";IG$.createLoginPanel(r,"",!0),IG$.loadMapData(),ig$._load_obj=s;var c=new IG$._rpc$;s.obj_key?(c.init(null,{ack:"apphelp",payload:{},mbody:{option:"get_share_key",obj_key:s.obj_key,mts:window.m$mts||"",lang:window.useLocale||""}},null,(function(e){s.obj_info=e,"T"==e.public?((c=new IG$._rpc$).init(null,{ack:"apphelp",payload:{},mbody:{option:"get_share_sec",obj_key:s.obj_key,mts:window.m$mts||"",lang:window.useLocale||""}},null,(function(e){IG$._g$a=e._mts_,IG$._share_uid_=e.token,IG$.open_url({objid:s.obj_info.uid})}),(function(){return IG$.showLogin(new IG$.callBackObj(this,IG$.showLoginProc),0),!0})),c.send()):((c=new IG$._rpc$).init(null,{ack:"helpcontent",payload:{},mbody:{option:"ls",mts:window.m$mts||"",lang:window.useLocale||""}},null,IG$._load_viewer_cnt,(function(){return IG$.showLogin(new IG$.callBackObj(this,IG$.showLoginProc),0),!0})),c.send())}),(function(){return IG$.showLogin(new IG$.callBackObj(this,IG$.showLoginProc),0),!0})),c.send()):(c.init(null,{ack:"helpcontent",payload:{},mbody:{option:"ls",mts:window.m$mts||"",lang:window.useLocale||""}},null,IG$._load_viewer_cnt,(function(){return IG$.showLogin(new IG$.callBackObj(this,IG$.showLoginProc),0),!0})),c.send())}),300)}})}));
IG$.changeApp=function(){},IG$.MainPanel=$s.extend($s.panel,{layout:"card",customAddTab:function(t,e){var n=this.getComponent(t);n?(IG$.changeApp(2),this.setActiveTab(n)):(IG$.changeApp(2),e.id=t,n=this.add(e),this.setActiveTab(n))},navigateApp:function(t,e,n,i,a,o,l,s){var d,c,p=this.getComponent(e+"_"+t);if(p)IG$.changeApp(2),this.setActiveTab(p),s&&p.applyOption&&p.applyOption.call(p,s),"dashboard"==e&&this.getComponent("dashboardedit_"+t)&&p.uid&&p.uid.length>0&&p.procRunDashboard.call(p);else if((s=s||{}).header=!1,s._viewmode="dashboard",c=IG$.createAppPanel(t,e,n,i,o,s)){if(c.address=i,c.title=n,l)for(d in l)c[d]=l[d];if(1==c.isWindow)IG$.ps[c.address]||(IG$.ps[c.address]=c,c.on("close",(function(){delete IG$.ps[c.address]})),c.show());else{IG$.changeApp(2),c.id=e+"_"+t;var r=this.add(c);this.setActiveTab(r)}}else a=!1;1==a&&(lastHist="lang="+useLocale+"&p1="+e+"&p2="+t,window.hist&&hist.addHistory(lastHist))},initRecentVisit:function(){},updateLoginInfo:function(){var t,e,n=IG$.viewport,i=$("#igc_login_user");IG$.dlgLogin&&IG$.dlgLogin.logininfo&&(t=(e=IG$.dlgLogin.logininfo).username,i.html(t),n._1||(n._1=!0,this.L1(n)),IG$.$loadApp(e.tmpl),IG$.dlgLogin.logininfo.__bdmenu||(IG$.dlgLogin.logininfo.__bdmenu=1,i.bind("click",(function(){}))))},L1:function(t){IG$.dlgLogin.jS2},L2:function(t,e){},L3:function(t,e,n,i){var a=this;$.each([e.children,e.items],(function(e,o){o&&$.each(o,(function(e,o){var l,s,d=$("<li><div class='indicator'></div></li>").appendTo(t),c=$("<div class='igc-nav-item'>"+o.name+"</div>").appendTo(d);if(c.hover((function(){$(".indicator",d).addClass("igc-hover")}),(function(){$(".indicator",d).removeClass("igc-hover")})),!!(!i&&o.children&&o.children.length>0||"Folder"==o.type||o.items&&o.items.length>0)){s=$("<div class='igc-submenu-expand'>&gt;</div>").appendTo(d),(l=$("<ul class='submenu'></ul>").appendTo(d)).hide();var p=function(t){if(t.stopPropagation(),o.loaded||"Folder"!=o.type)l.toggle();else{var e=new IG$._rpc$;e.init(a,{ack:"content",payload:{uid:o.uid},mbody:{}},a,(function(t){var e,i,s=t?t.children:null;if(o.items=[],o.loaded=!0,s){for(e=0;e<s.length;e++)i=s[e],/Report|Folder|Dashboard/.test(i.type)&&o.items.push(i);IG$.sortMeta(o.items),a.L3.call(a,l,o,n+1),l.show()}})),e.send()}};s.bind("click",p),c.bind("click",p),a.L3.call(a,l,o,n+1)}else i?c.bind("click",(function(t){o.handler&&o.handler.call(this,o)})):o.uid&&c.bind("click",(function(t){a.navigateApp.call(a,o.uid,o.type.toLowerCase(),o.name,o.nodepath,!1,!1)}))}))}))},setActiveTab:function(t){this.setActiveItem(t)},_1:function(){var t=new IG$._rpc$;t.init(this,{ack:"helpcontent",payload:{},mbody:{option:"favorites"}},this,this.rs__1,null,null),t.send()},rs__1:function(t){var e,n,i=IG$.viewport.down("[name=sidebar_m1]"),a=IG$.XGetNode(t,"/smsg"),o=a?IG$.XGetChildNodes(a):null,l=[];if(this.floaded=!0,o){for(n=$("#sidebar_fav",i.el.dom),(n=$(".navbar-top-menu",n)).empty(),e=0;e<o.length;e++)l.push(IG$.XGetAttrProp(o[e]));this.L3(n,{children:null,items:l},0)}},_2:function(t){var e,n,i,a=this,o=t.options,l=o?o.ltype:null;if(l)switch(l){case"html":(e=o.html)&&a._3(t,o,e);break;case"report":o.rptl_uid&&(o.rptl_item?(i=o.rptl_item,a.navigateApp.call(a,i.uid,i.type.toLowerCase(),i.name,i.nodepath,!1,!1)):((n=new IG$._rpc$).init(a,{ack:"helpcontent",payload:{uid:o.rptl_uid},mbody:{option:"translate"}},a,(function(t){var e=t&&t.length?t[0]:null;e&&(o.rptl_item=e,this.navigateApp.call(this,e.uid,e.type.toLowerCase(),e.name,e.nodepath,!1,!1))}),!1),n.send()))}},_3:function(t,e,n){var i=this,a="tpage_"+t.sid,o=this.getComponent(a);IG$.changeApp(2),o||(o=$s.panel({layout:"fit",name:a,id:a,autoScroll:!0,autoLoad:{url:n,callback:function(){if(e.scrp&&window[e.scrp]){var n=this.down("[name="+a+"]");window[e.scrp].call(i,t,n)}},scope:this}}),this.add(o)),this.setActiveTab(o)},initComponent:function(){IG$.MainPanel.superclass.initComponent.call(this)},listeners:{beforeadd:function(t,e,n,i){e.closable=!1,e.setTitle(null)}}}),IG$.navigateMenuByUID=function(t,e,n,i){var a=new IG$._rpc$;a.init(null,{ack:"helpcontent",payload:{uid:t},mbody:{option:"translate"}},null,(function(t){var a=IG$.XGetNode(t,"/smsg/item"),o=IG$.XGetAttr(a,"uid"),l=IG$.XGetAttr(a,"type").toLowerCase(),s=IG$.XGetAttr(a,"name"),d=IG$.XGetAttr(a,"nodepath"),c="T"==IG$.XGetAttr(a,"manage")||"T"==IG$.XGetAttr(a,"writable");"dashboard"==l&&"dashboardedit"==e?l=e:"export"==l&&(!0,l="report"),IG$.mainPanel.navigateApp.call(IG$.mainPanel,o,l,s,d,void 0===i||i,c,null,n)}),null),a.send()};