function m$B2(t,a){var l=this;l.ind=t,l.rowdata=a,l.ellipses=[],l.label=$("<div class='bblabel'></div>"),l.html=$("<div class='bbbox'></div>"),l.ind.container.append(l.html),l.paper=new Raphael(l.html[0]),l.html.append(l.label),l.invalidate=-1,l.validateData.call(l)}function m$Bl(t){this.parent=t,this.mv=null,this.colorset=[.23,.4,.3],this.initVariables()}m$B2.prototype={validateData:function(){var t,a,l=this,e=l.ellipses,i=l.ind.colorset,n=l.rowdata;for(t=0;t<e.length;t++)e[t].html.remove();for(e=[],l.label.text(n.name),t=0;t<n.value.length;t++)(a={}).color=i[t%i.length],e.push(a);l.ellipses=e,l.validateDisplay()},validateDisplay:function(){var t=this;t.invalidate>-1&&clearTimeout(t.invalidate),setTimeout((function(){t.updateDisplay.call(t)}),100)},updateDisplay:function(){var t,a,l,e,i,n,h,o,s,r,m,c,p=this,u=p.ind,v=p.html,b=IG$.j$ext._w(v),d=IG$.j$ext._h(v),f=p.rowdata,x=p.ellipses,$=u.mcalc.max,g=null==u.mv?u.mcalc.min:u.mv>u.mcalc.min?u.mv:u.mcalc.min,y=p.label;if(b>0&&d>0){if((s=p.paper).clear(),s.setSize(b,d),x&&x.length>0){for(e=Math.min(b,d),a=$==g?$:$-g,o=0;o<x.length;o++)h=0==o?f.value[o]:h+f.value[o];for(n=(h-g)/a*(.8*e)+.1*e,o=0;o<x.length;o++)i=0==o?f.value[o]:i+f.value[o],l=Math.sqrt(n*n*i/h),(t=x[o]).x=b/2,t.y=d/2,t.radius=l/2;for(o=x.length-1;o>=0;o--)r=(t=x[o]).x,m=t.y,c=t.radius,hue=t.color,t.circle=s.set(s.ellipse(r,m+c-c/5,0,0).attr({fill:"rhsb("+hue+", 1, .25)-hsb("+hue+", 1, .25)",stroke:"none",opacity:0}).animate({rx:c,ry:c/2},400,"<"),s.ellipse(r,m,0,0).attr({fill:"r(.5,.9)hsb("+hue+", 1, .75)-hsb("+hue+", .5, .25)",stroke:"none"}).animate({rx:c,ry:c},400,"<"),s.ellipse(r,m,0,0).attr({stroke:"none",fill:"r(.5,.1)#ccc-#ccc",opacity:0}).animate({rx:c-c/5,ry:c-c/20},400,"<"))}p.label.css({top:d-y.height()-4,left:(b-IG$.j$ext._w(p.label))/2})}}},m$Bl.prototype={initVariables:function(){var t=this;t.ex=[],t.mx=[],t.bubbles=[],t.mcalc={},t.container=$("<div class='bbmain'></div>").appendTo(t.parent)},initControl:function(){var t,a=this.bubbles;for(t=0;t<a.length;t++)a[t].html.remove();a=[]},loadData:function(t){var a,l,e,i,n,h,o,s,r=this,m=r.ea,c=r.ma,p=r.mcalc;if(t&&t.length>0&&m&&m.length>0&&c&&c.length>0){for(a=0;a<c.length;a++)c[a].max=0,c[a].min=0;for(a=0;a<t.length;a++){for("col_"&a,i="",h=[],l=0;l<m.length;l++)e=m[l].i,i=0==l?t[a][e]:i+" "+t[a][e];for(l=0;l<c.length;l++)e=c[l].i,n=Number(t[a][e]),0==a?(c[l].min=n,c[l].max=n):(c[l].min=Math.min(c[l].min,n),c[l].max=Math.max(c[l].max,n)),o=0==l?n:o+n,h.push(n);0==a?(p.min=o,p.max=o):(p.min=Math.min(p.min,o),p.max=Math.max(p.max,o)),s=new m$B2(r,{name:i,value:h}),r.bubbles.push(s)}r.validateControl()}},validateControl:function(){var t,a,l,e,i,n=$(this.parent),h=IG$.j$ext._w(n),o=IG$.j$ext._h(n),s=this.bubbles;if(h>0&&o>0&&s&&s.length>0)for(i=0,l=h/s.length,e=o,a=0;a<s.length;a++)(t=s[a]).html.css({left:i,top:0,position:"absolute"}),IG$.j$ext._w(t.html,l),IG$.j$ext._h(t.html,e),t.validateDisplay.call(t),i+=l}};
IG$.m$CompMatrix=function(){var t=this;t.xField=null,t.xFieldName=null,t.yField=null,t.yFieldName=null,t.compVal,t.dataSet=null,t.toString=function(){return t.xFieldName+", "+t.yFieldName+" : "+t.compVal}},IG$.compMatrixPlotCell=function(){var t,e,a=this,i=window.bowser,l=window&&window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");a.hasCanvas=!l&&!i.msie,a.compItem,a.xMin,a.xMax,a.yMin,a.yMax,a.xRange,a.yRange,a.cr1=0,a.cr2=0,a.selected,a.width,a.height,a.html=$('<div class="matrixchart"></div>'),1==a.hasCanvas&&(a.canvas=$("<canvas></canvas>"),a.canvas.appendTo(a.html)),a.updateExtremes=function(){if(a.compItem&&a.compItem.dataSet){for(a.xMin=Number.MAX_VALUE,a.yMin=Number.MAX_VALUE,a.xMax=Number.MIN_VALUE,a.yMax=Number.MIN_VALUE,t=0;t<a.compItem.dataSet.length;t++)e=a.compItem.dataSet[t],a.xMin=Math.min(a.xMin,e[a.compItem.xField]),a.yMin=Math.min(a.yMin,e[a.compItem.yField]),a.xMax=Math.max(a.xMax,e[a.compItem.xField]),a.yMax=Math.max(a.yMax,e[a.compItem.yField]);a.xRange=a.xMax-a.xMin,a.yRange=a.yMax-a.yMin}},a.computeX=function(t){var e=t[a.compItem.xField];return 1-(a.xMax-e)/a.xRange},a.computeY=function(t){var e=t[a.compItem.yField];return 1-(a.yMax-e)/a.yRange},a.updatePlot=function(){var t,e,i,l;for(a.plotData=[],t=0;t<a.compItem.dataSet.length;t++)e=a.compItem.dataSet[t],i=a.computeX(e),l=a.computeY(e),a.plotData.push([i,l]);a.drawPlot()},a.drawPlot=function(){var e=this;e.width=e.html.innerWidth(),e.height=e.html.innerHeight();var a,i={};for(a=e.compItem.compVal>e.cr2?"rgba(0,0,255,":e.compItem.compVal>e.cr1?"rgba(150,150,150,":"rgba(255,0,0,",1==e.hasCanvas?(e.canvas.width=e.width,e.canvas.height=e.height,e.ctx=e.canvas[0].getContext("2d"),e.ctx.scale(1,1),e.ctx.fillStyle="rgb(255,255,255)",e.ctx.fillRect(0,0,e.width,e.height),e.ctx.strokeStyle="#5F5F5F",e.ctx.lineWidth=1,e.ctx.fillStyle=a+".5)"):e.paper?e.paper.clear():e.paper=Raphael(e.html[0],0,0,e.width,e.height),t=0;t<e.plotData.length;t++){var l,o=e.plotData[t],n=0==isNaN(o[0])?o[0]*e.width:0,r=0==isNaN(o[1])?(1-o[1])*e.height:e.height,c=Math.floor(n),s=Math.floor(r);i[l=(c-=c%5)+","+(s-=s%5)]||(1==e.hasCanvas?(e.ctx.beginPath(),e.ctx.arc(n,r,1,0,2*Math.PI,!0),e.ctx.closePath(),e.ctx.fill(),i[l]={obj:!0,mbody:0}):(i[l]={obj:e.paper.circle(n,r,2),mbody:0},i[l].obj.attr("fill",a+"0.5)")))}i=null},a.updateDispList=function(t,e){a.drawPlot()},a.commitProps=function(){a.updateExtremes(),a.updatePlot()}},IG$.ComparisonMatrix=function(t,e){var a,i,l=this;l.compItems=null,l.cells=[],l.parent=t,l.config=e,l.textFields=[],l.showLabels=e.showLabels||!0,l.cr1=null==e.cr1||void 0===e.cr1?0:e.cr1,l.cr2=null==e.cr2||void 0===e.cr2?0:e.cr2,l.container=$('<div class="matrixcontainer"></div>'),l.container.appendTo(l.parent),(i=l.labelhtml=$('<div class="matrixlabel"></div>')).css({position:"absolute",top:"0px",left:"0px",width:"0px",height:"0px"}),i.appendTo(l.parent),l.isDirty=!1,(a=l.detailviewer=$('<div class="detailviewer"></div>')).css({position:"absolute",top:10,left:10,width:100,height:100,margin:0,padding:0,backgroundColor:"#ececec",borderColor:"#222222",display:"none"}),a.appendTo(l.parent),a.bind("click",(function(){$(this).fadeOut()})),l.detailcontainer=$('<div class="detailmatrixplot"></div>'),l.detailcontainer.css({position:"absolute",margin:"20 0 0 0",padding:0,top:0,left:0,right:0,bottom:0}),l.uid=0,l.detailcontainer.appendTo(a);var o=$('<div class="detailmatrixclosebtn"></div>');o.css({position:"absolute",top:2,width:16,height:16,right:2}),a.append(o),o.bind({click:function(){a.fadeOut()}}),l.correlationCoefficient=function(t,e,a){var i,l,o=t.length,n=0,r=0,c=0,s=0,d=0;for(l=0;l<t.length;l++){var m=(i=t[l])[e],p=i[a];n+=m,r+=p,c+=Math.pow(m,2),s+=Math.pow(p,2),d+=m*p}return(o*d-n*r)/(Math.sqrt(o*c-Math.pow(n,2))*Math.sqrt(o*s-Math.pow(r,2)))},l.comparisonFunction=l.correlationCoefficient,l.generateComparisonStatistics=function(){if(l.compItems=[],0!=l.fields.length&&null!=l.dataSet&&0!=l.dataSet.length)for(var t=l.fields.length,e=0;e<t;e++)for(var a=0;a<e+1;a++)if(e!=a){var i=new IG$.m$CompMatrix;i.xFieldName=l.fields[e],i.xField=e,i.yFieldName=l.fields[a],i.yField=a,i.compVal=l.comparisonFunction.call(l,l.dataSet,i.xField,i.yField),l.compItems.push(i)}},l.createOrRemoveCells=function(){var t,e=this,a=e.compItems.length,i=[];for(e.matrixitems={};e.cells.length<a;){var l=new IG$.compMatrixPlotCell;l.html.css({border:"1px solid #a5a5a5",width:200,height:200,position:"absolute",padding:0}),l.html.appendTo(e.container),t="matrixplot"+e.uid,l.html[0].id=t,l.id=t,e.uid++,i.push(l),e.cells.push(l),e.matrixitems[t]=l}for($.each(i,(function(t,a){a.html.bind({click:function(){e.drawDetailPlot.call(e,a)}})}));a<e.cells.length;){e.cells.pop().remove()}},l.updateTextFields=function(){var t,e,a=this,i=a.fields.length;for(t=0;t<i;t++)a.textFields.length<t+1&&((e=$('<div class="matrixtextfield"></div>')).css({fontSize:"0.8em",padding:"0 0 0 3",margin:0,position:"absolute",width:130}),a.textFields.push(e),e.appendTo(a.labelhtml)),a.textFields[t][0].innerText=a.fields[t];for(;i<a.textFields.length;){textFields.pop();a.textFieldToRemove.remove()}},l.layoutTextFields=function(){var t,e,a,i,l,o=this,n=o.textFields.length;if(n>0)for(t=o.textFields[0].height(),e=0;e<n;e++)a=o.textFields[e],i=e*o.actualCellSize+1,l=0==e?0:(e-1)*o.actualCellSize+t,a.css({left:i,top:l})},l.layoutCells=function(){var t=this,e=0;if(t.showLabels&&t.textFields.length>0){var a=t.textFields[0];e=a.position().top+a.height()}for(var i=t.fields.length,l=0,o=0;o<i;o++)for(var n=0;n<o+1;n++)if(o!=n){var r=t.compItems[l],c=t.cells[l];r.dataSet=t.dataSet,c.compItem=r,c.selected=r==t.selectedItem;var s;s=r.xField+"\n"+r.yField+"\n"+r.compVal,c.toolTip=s;var d=n*t.actualCellSize,m=(o-1)*t.actualCellSize+e;c.html.css({left:d,top:m,width:t.actualCellSize,height:t.actualCellSize}),c.cr1=t.cr1,c.cr2=t.cr2,1==t.isDirty?c.commitProps.call(c):c.updateDispList.call(c),l++}},l.computeCellSize=function(t,e){var a=this,i=t,l=e;return 1==a.showLabels&&a.textFields.length>0?(i=t-a.textFields[a.textFields.length-1].width(),l=e-a.textFields[0].height()):(i=t,l=e),Math.min(i,l)/(a.fields.length-1)},l.updateDispList=function(){var t=this,e=$(t.parent),a=e.innerWidth(),i=e.innerHeight();t.container.css({width:a,height:i}),t.actualCellSize=t.computeCellSize(a,i),t.showLabels&&t.textFields.length>0&&t.layoutTextFields(),t.layoutCells()},l.commitProp=function(){var t=this;t.isDirty=!0,t.generateComparisonStatistics(),t.createOrRemoveCells(),t.updateTextFields(),t.updateDispList(),t.isDirty=!1}},IG$.ComparisonMatrix.prototype.drawDetailPlot=function(t){var e,a=this,i=a.matrixitems[t.id],l=i.compItem.compVal>a.cr2?"rgba(0,0,255,.5)":i.compItem.compVal>a.cr1?"rgba(150,150,150,.5)":"rgba(255,0,0,0.5)";if(i){e=window.Highcharts?{chart:{renderTo:a.detailcontainer[0],defaultSeriesType:"scatter",zoomType:"xy"},title:{text:i.compItem.xFieldName+" vs. "+i.compItem.yFieldName},xAxis:{title:{enabled:!0,text:i.compItem.xFieldName},startOnTick:!0,endOnTick:!0,showLastLabel:!0,min:0,max:1},yAxis:{title:{text:i.compItem.yFieldName},min:0,max:1},tooltip:{formatter:function(){return a.x+", "+a.y}},legend:{enabled:!1,layout:"vertical",align:"left",verticalAlign:"top",floating:!0,backgroundColor:"#FFFFFF",borderWidth:1},plotOptions:{scatter:{marker:{radius:5,states:{hover:{enabled:!0,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:!1}}}}},series:[{name:"comparison",color:l,data:i.plotData}]}:{chart:{renderTo:a.detailcontainer[0],defaultSeriesType:"scatter",zoomType:"xy",echart_theme:a.config.echart_theme},title:{text:i.compItem.xFieldName+" vs. "+i.compItem.yFieldName},xAxis:{title:{enabled:!0,text:i.compItem.xFieldName},startOnTick:!0,endOnTick:!0,showLastLabel:!0,min:0,max:1},yAxis:{title:{text:i.compItem.yFieldName},min:0,max:1},tooltip:{formatter:function(){return a.x+", "+a.y}},legend:{enabled:!1,layout:"vertical",align:"left",verticalAlign:"top",floating:!0,backgroundColor:"#FFFFFF",borderWidth:1},plotOptions:{scatter:{marker:{radius:5,states:{hover:{enabled:!0,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:!1}}}}},series:[{type:"scatter",symbolSize:5,name:"comparison",color:l,data:i.plotData}]};var o=$(a.parent),n=o.width(),r=o.height(),c=.85*Math.min(r,n);a.detailviewer.css({left:n-c-10,top:5,width:c,height:c}),a.detailviewer.show(),window.Highcharts?a.plotdetail=new Highcharts.Chart(e):(a.plotdetail=echarts.init(e.chart.renderTo,e.chart.echart_theme||ig$.echarts_theme||"amplix",{renderer:"canvas"}),a.plotdetail.setOption(e))}};
function randomize(t){return t.randomizer||(t.randomizer=randomizer(t)),t.ranges=t.ranges.map(t.randomizer),t.markers=t.markers.map(t.randomizer),t.measures=t.measures.map(t.randomizer),t}function randomizer(t){var r=.2*d3.max(t.ranges);return function(t){return Math.max(0,t+r*(Math.random()-.5))}}function bulletRanges(t){return t.ranges}function bulletMarkers(t){return t.markers}function bulletMeasures(t){return t.measures}function bulletTranslate(t){return function(r){return"translate("+t(r)+",0)"}}function bulletWidth(t){var r=t(0);return function(a){return Math.abs(t(a)-r)}}IG$.c$BulChart=function(t){this.owner=t,this.bb=null,this.initialize()},IG$.c$BulChart.prototype={initialize:function(){var t,r=this,a=r.owner,e=$("<div></div>").appendTo(a);r.width=IG$.j$ext._w(a),r.height=IG$.j$ext._h(a),r.margin={top:5,right:40,bottom:20,left:120},r.bb||(r.bb=IG$.c$BullChartV(),IG$.j$ext._w(r.bb,r.width-r.margin.right-r.margin.left),IG$.j$ext._h(r.bb,r.height-r.margin.top-r.margin.bottom)),t=$("<ul></ul>").appendTo(e),r.gtp=t,t=$("<li></li>").appendTo(r.gtp),$("<div>Ranges</div>").appendTo(t),r.ranges=$("<combobox></combobox>").appendTo(t),t=$("<li></li>").appendTo(r.gtp),$("<div>Measures</div>").appendTo(t),r.measures=$("<combobox></combobox>").appendTo(t),t=$("<li></li>").appendTo(r.gtp),$("<div>Markers</div>").appendTo(t),r.markers=$("<combobox></combobox>").appendTo(t)},loadData:function(t){var r,a=this,e=(a.owner,a.width),n=a.height,i=a.margin,l=$("<div><div>").appendTo(a.owner),o=d3.select(l[0]).selectAll("svg"),s=a.bb;r=a.getData(),o.data(r).enter().append("svg").attr("class","bullet").attr("width",e).attr("height",n).append("g").attr("transform","translate("+i.left+","+i.top+")").call(s);var u=o.append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(n-i.top-i.bottom)/2+")");u.append("text").attr("class","title").text((function(t){return t.title})),u.append("text").attr("class","subtitle").attr("dy","1em").text((function(t){return t.subtitle})),a.vis=o,a.title=u,s.duration(1e3)},drawChart:function(){var t=this.bb;vis.datum(randomize).call(t)},getData:function(){var t,r,a,e,n,i,l,o,s=[],u=mresult._tabledata,d=mresult.colfix,c=mresult.rowfix,h=u.length>0?u[0].length:0,m={},g={};for(t=d;t<h;t++);for(t=c;t<u.length;t++){for(a={title:null,ranges:[],measures:[],markers:[]},l=null,o=null,r=0;r<h;r++)r<d?(e=u[t][r].text||u[t][r].code,a.title=0==t?e:a.title+" "+e):(e=Number(u[t][r].code),n=r==d?e:Math.max(n,e),i=r==d?e:Math.min(i,e),1==m[r]&&(null==l?(l=e,o=e):(l=Math.min(l,e),o=Math.max(o,e))),1==g[r]&&a.markers.push(e));a.ranges=[i,void 0,n],a.measures=[l,o],s.push(a)}return s}},IG$.c$BullChartV=function(){var t="left",r=!1,a=0,e=bulletRanges,n=bulletMarkers,i=bulletMeasures,l=380,o=30,s=null;function u(t){t.each((function(t,u){var d=e.call(this,t,u).slice().sort(d3.descending),c=n.call(this,t,u).slice().sort(d3.descending),h=i.call(this,t,u).slice().sort(d3.descending),m=d3.select(this),g=d3.scale.linear().domain([0,Math.max(d[0],c[0],h[0])]).range(r?[l,0]:[0,l]),p=this.__chart__||d3.scale.linear().domain([0,1/0]).range(g.range());this.__chart__=g;var b=bulletWidth(p),f=bulletWidth(g),x=m.selectAll("rect.range").data(d);x.enter().append("svg:rect").attr("class",(function(t,r){return"range s"+r})).attr("width",b).attr("height",o).attr("x",r?p:0).transition().duration(a).attr("width",f).attr("x",r?g:0),x.transition().duration(a).attr("x",r?g:0).attr("width",f).attr("height",o);var v=m.selectAll("rect.measure").data(h);v.enter().append("svg:rect").attr("class",(function(t,r){return"measure s"+r})).attr("width",b).attr("height",o/3).attr("x",r?p:0).attr("y",o/3).transition().duration(a).attr("width",f).attr("x",r?g:0),v.transition().duration(a).attr("width",f).attr("height",o/3).attr("x",r?g:0).attr("y",o/3);var $=m.selectAll("line.marker").data(c);$.enter().append("svg:line").attr("class","marker").attr("x1",p).attr("x2",p).attr("y1",o/6).attr("y2",5*o/6).transition().duration(a).attr("x1",g).attr("x2",g),$.transition().duration(a).attr("x1",g).attr("x2",g).attr("y1",o/6).attr("y2",5*o/6);var y=s||g.tickFormat(8),w=m.selectAll("g.tick").data(g.ticks(8),(function(t){return this.textContent||y(t)})),k=w.enter().append("svg:g").attr("class","tick").attr("transform",bulletTranslate(p)).style("opacity",1e-6);k.append("svg:line").attr("y1",o).attr("y2",7*o/6),k.append("svg:text").attr("text-anchor","middle").attr("dy","1em").attr("y",7*o/6).text(y),k.transition().duration(a).attr("transform",bulletTranslate(g)).style("opacity",1);var T=w.transition().duration(a).attr("transform",bulletTranslate(g)).style("opacity",1);T.select("line").attr("y1",o).attr("y2",7*o/6),T.select("text").attr("y",7*o/6),w.exit().transition().duration(a).attr("transform",bulletTranslate(g)).style("opacity",1e-6).remove()})),d3.timer.flush()}return u.orient=function(a){return arguments.length?(r="right"==(t=a)||"bottom"==t,u):t},u.ranges=function(t){return arguments.length?(e=t,u):e},u.markers=function(t){return arguments.length?(n=t,u):n},u.measures=function(t){return arguments.length?(i=t,u):i},u.width=function(t){return arguments.length?(l=t,u):l},u.height=function(t){return arguments.length?(o=t,u):o},u.tickFormat=function(t){return arguments.length?(s=t,u):s},u.duration=function(t){return arguments.length?(a=t,u):a},u};