function m$B2(t,a){var l=this;l.ind=t,l.rowdata=a,l.ellipses=[],l.label=$("<div class='bblabel'></div>"),l.html=$("<div class='bbbox'></div>"),l.ind.container.append(l.html),l.paper=new Raphael(l.html[0]),l.html.append(l.label),l.invalidate=-1,l.validateData.call(l)}function m$Bl(t){this.parent=t,this.mv=null,this.colorset=[.23,.4,.3],this.initVariables()}m$B2.prototype={validateData:function(){var t,a,l=this,e=l.ellipses,i=l.ind.colorset,n=l.rowdata;for(t=0;t<e.length;t++)e[t].html.remove();for(e=[],l.label.text(n.name),t=0;t<n.value.length;t++)(a={}).color=i[t%i.length],e.push(a);l.ellipses=e,l.validateDisplay()},validateDisplay:function(){var t=this;t.invalidate>-1&&clearTimeout(t.invalidate),setTimeout((function(){t.updateDisplay.call(t)}),100)},updateDisplay:function(){var t,a,l,e,i,n,h,o,s,r,m,c,p=this,u=p.ind,v=p.html,b=IG$.j$ext._w(v),d=IG$.j$ext._h(v),f=p.rowdata,x=p.ellipses,$=u.mcalc.max,g=null==u.mv?u.mcalc.min:u.mv>u.mcalc.min?u.mv:u.mcalc.min,y=p.label;if(b>0&&d>0){if((s=p.paper).clear(),s.setSize(b,d),x&&x.length>0){for(e=Math.min(b,d),a=$==g?$:$-g,o=0;o<x.length;o++)h=0==o?f.value[o]:h+f.value[o];for(n=(h-g)/a*(.8*e)+.1*e,o=0;o<x.length;o++)i=0==o?f.value[o]:i+f.value[o],l=Math.sqrt(n*n*i/h),(t=x[o]).x=b/2,t.y=d/2,t.radius=l/2;for(o=x.length-1;o>=0;o--)r=(t=x[o]).x,m=t.y,c=t.radius,hue=t.color,t.circle=s.set(s.ellipse(r,m+c-c/5,0,0).attr({fill:"rhsb("+hue+", 1, .25)-hsb("+hue+", 1, .25)",stroke:"none",opacity:0}).animate({rx:c,ry:c/2},400,"<"),s.ellipse(r,m,0,0).attr({fill:"r(.5,.9)hsb("+hue+", 1, .75)-hsb("+hue+", .5, .25)",stroke:"none"}).animate({rx:c,ry:c},400,"<"),s.ellipse(r,m,0,0).attr({stroke:"none",fill:"r(.5,.1)#ccc-#ccc",opacity:0}).animate({rx:c-c/5,ry:c-c/20},400,"<"))}p.label.css({top:d-y.height()-4,left:(b-IG$.j$ext._w(p.label))/2})}}},m$Bl.prototype={initVariables:function(){var t=this;t.ex=[],t.mx=[],t.bubbles=[],t.mcalc={},t.container=$("<div class='bbmain'></div>").appendTo(t.parent)},initControl:function(){var t,a=this.bubbles;for(t=0;t<a.length;t++)a[t].html.remove();a=[]},loadData:function(t){var a,l,e,i,n,h,o,s,r=this,m=r.ea,c=r.ma,p=r.mcalc;if(t&&t.length>0&&m&&m.length>0&&c&&c.length>0){for(a=0;a<c.length;a++)c[a].max=0,c[a].min=0;for(a=0;a<t.length;a++){for("col_"&a,i="",h=[],l=0;l<m.length;l++)e=m[l].i,i=0==l?t[a][e]:i+" "+t[a][e];for(l=0;l<c.length;l++)e=c[l].i,n=Number(t[a][e]),0==a?(c[l].min=n,c[l].max=n):(c[l].min=Math.min(c[l].min,n),c[l].max=Math.max(c[l].max,n)),o=0==l?n:o+n,h.push(n);0==a?(p.min=o,p.max=o):(p.min=Math.min(p.min,o),p.max=Math.max(p.max,o)),s=new m$B2(r,{name:i,value:h}),r.bubbles.push(s)}r.validateControl()}},validateControl:function(){var t,a,l,e,i,n=$(this.parent),h=IG$.j$ext._w(n),o=IG$.j$ext._h(n),s=this.bubbles;if(h>0&&o>0&&s&&s.length>0)for(i=0,l=h/s.length,e=o,a=0;a<s.length;a++)(t=s[a]).html.css({left:i,top:0,position:"absolute"}),IG$.j$ext._w(t.html,l),IG$.j$ext._h(t.html,e),t.validateDisplay.call(t),i+=l}};
IG$.m$CompMatrix=function(){this.xField=null,this.xFieldName=null,this.yField=null,this.yFieldName=null,this.compVal,this.dataSet=null,this.toString=function(){return this.xFieldName+", "+this.yFieldName+" : "+this.compVal}},IG$.compMatrixPlotCell=function(){var t,i,e=window.bowser,s=window&&window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1");this.hasCanvas=!s&&!e.msie,this.compItem,this.xMin,this.xMax,this.yMin,this.yMax,this.xRange,this.yRange,this.cr1=0,this.cr2=0,this.selected,this.width,this.height,this.html=$('<div class="matrixchart"></div>'),1==this.hasCanvas&&(this.canvas=$("<canvas></canvas>"),this.canvas.appendTo(this.html)),this.updateExtremes=function(){if(this.compItem&&this.compItem.dataSet){for(this.xMin=Number.MAX_VALUE,this.yMin=Number.MAX_VALUE,this.xMax=Number.MIN_VALUE,this.yMax=Number.MIN_VALUE,t=0;t<this.compItem.dataSet.length;t++)i=this.compItem.dataSet[t],this.xMin=Math.min(this.xMin,i[this.compItem.xField]),this.yMin=Math.min(this.yMin,i[this.compItem.yField]),this.xMax=Math.max(this.xMax,i[this.compItem.xField]),this.yMax=Math.max(this.yMax,i[this.compItem.yField]);this.xRange=this.xMax-this.xMin,this.yRange=this.yMax-this.yMin}},this.computeX=function(t){var i=t[this.compItem.xField];return 1-(this.xMax-i)/this.xRange},this.computeY=function(t){var i=t[this.compItem.yField];return 1-(this.yMax-i)/this.yRange},this.updatePlot=function(){var t,i,e,s;for(this.plotData=[],t=0;t<this.compItem.dataSet.length;t++)i=this.compItem.dataSet[t],e=this.computeX(i),s=this.computeY(i),this.plotData.push([e,s]);this.drawPlot()},this.drawPlot=function(){this.width=this.html.innerWidth(),this.height=this.html.innerHeight();var i,e={};for(i=this.compItem.compVal>this.cr2?"rgba(0,0,255,":this.compItem.compVal>this.cr1?"rgba(150,150,150,":"rgba(255,0,0,",1==this.hasCanvas?(this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas[0].getContext("2d"),this.ctx.scale(1,1),this.ctx.fillStyle="rgb(255,255,255)",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.strokeStyle="#5F5F5F",this.ctx.lineWidth=1,this.ctx.fillStyle=i+".5)"):this.paper?this.paper.clear():this.paper=Raphael(this.html[0],0,0,this.width,this.height),t=0;t<this.plotData.length;t++){var s,h=this.plotData[t],a=0==isNaN(h[0])?h[0]*this.width:0,l=0==isNaN(h[1])?(1-h[1])*this.height:this.height,o=Math.floor(a),n=Math.floor(l);e[s=(o-=o%5)+","+(n-=n%5)]||(1==this.hasCanvas?(this.ctx.beginPath(),this.ctx.arc(a,l,1,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill(),e[s]={obj:!0,mbody:0}):(e[s]={obj:this.paper.circle(a,l,2),mbody:0},e[s].obj.attr("fill",i+"0.5)")))}e=null},this.updateDispList=function(t,i){this.drawPlot()},this.commitProps=function(){this.updateExtremes(),this.updatePlot()}},IG$.ComparisonMatrix=function(t,i){this.compItems=null,this.cells=[],this.parent=t,this.config=i,this.textFields=[],this.showLabels=i.showLabels||!0,this.cr1=null==i.cr1||void 0===i.cr1?0:i.cr1,this.cr2=null==i.cr2||void 0===i.cr2?0:i.cr2,this.container=$('<div class="matrixcontainer"></div>'),this.container.appendTo(this.parent),this.labelhtml=$('<div class="matrixlabel"></div>'),this.labelhtml.css({position:"absolute",top:"0px",left:"0px",width:"0px",height:"0px"}),this.labelhtml.appendTo(this.parent),this.isDirty=!1,this.detailviewer=$('<div class="detailviewer"></div>'),this.detailviewer.css({position:"absolute",top:10,left:10,width:100,height:100,margin:0,padding:0,backgroundColor:"#ececec",borderColor:"#222222",display:"none"}),this.detailviewer.appendTo(this.parent),this.detailviewer.bind("click",(function(){$(this).fadeOut()})),this.detailcontainer=$('<div class="detailmatrixplot"></div>'),this.detailcontainer.css({position:"absolute",margin:"20 0 0 0",padding:0,top:0,left:0,right:0,bottom:0}),this.uid=0,this.detailcontainer.appendTo(this.detailviewer);var e=$('<div class="detailmatrixclosebtn"></div>'),s=this.detailviewer;e.css({position:"absolute",top:2,width:16,height:16,right:2}),this.detailviewer.append(e),e.bind({click:function(){s.fadeOut()}}),this.correlationCoefficient=function(t,i,e){var s,h,a=t.length,l=0,o=0,n=0,r=0,c=0;for(h=0;h<t.length;h++){var d=(s=t[h])[i],m=s[e];l+=d,o+=m,n+=Math.pow(d,2),r+=Math.pow(m,2),c+=d*m}return(a*c-l*o)/(Math.sqrt(a*n-Math.pow(l,2))*Math.sqrt(a*r-Math.pow(o,2)))},this.comparisonFunction=this.correlationCoefficient,this.generateComparisonStatistics=function(){if(this.compItems=[],0!=this.fields.length&&null!=this.dataSet&&0!=this.dataSet.length)for(var t=this.fields.length,i=0;i<t;i++)for(var e=0;e<i+1;e++)if(i!=e){var s=new IG$.m$CompMatrix;s.xFieldName=this.fields[i],s.xField=i,s.yFieldName=this.fields[e],s.yField=e,s.compVal=this.comparisonFunction.call(this,this.dataSet,s.xField,s.yField),this.compItems.push(s)}},this.createOrRemoveCells=function(){var t,i=this,e=this.compItems.length;for(this.matrixitems={};this.cells.length<e;){var s=new IG$.compMatrixPlotCell;s.html.css({border:"1px solid #a5a5a5",width:200,height:200,position:"absolute",padding:0}),s.html.appendTo(this.container),t="matrixplot"+this.uid,s.html[0].id=t,this.uid++,s.html.bind({click:function(){i.drawDetailPlot.call(i,this)}}),this.cells.push(s),this.matrixitems[t]=s}for(;e<this.cells.length;){this.cells.pop().remove()}},this.updateTextFields=function(){var t,i,e=this.fields.length;for(t=0;t<e;t++)this.textFields.length<t+1&&((i=$('<div class="matrixtextfield"></div>')).css({fontSize:"0.8em",padding:"0 0 0 3",margin:0,position:"absolute",width:130}),this.textFields.push(i),i.appendTo(this.labelhtml)),this.textFields[t][0].innerText=this.fields[t];for(;e<this.textFields.length;){textFields.pop();this.textFieldToRemove.remove()}},this.layoutTextFields=function(){var t,i,e,s,h,a=this.textFields.length;if(a>0)for(t=this.textFields[0].height(),i=0;i<a;i++)e=this.textFields[i],s=i*this.actualCellSize+1,h=0==i?0:(i-1)*this.actualCellSize+t,e.css({left:s,top:h})},this.layoutCells=function(){var t=0;if(this.showLabels&&this.textFields.length>0){var i=this.textFields[0];t=i.position().top+i.height()}for(var e=this.fields.length,s=0,h=0;h<e;h++)for(var a=0;a<h+1;a++)if(h!=a){var l=this.compItems[s],o=this.cells[s];l.dataSet=this.dataSet,o.compItem=l,o.selected=l==this.selectedItem;var n;n=l.xField+"\n"+l.yField+"\n"+l.compVal,o.toolTip=n;var r=a*this.actualCellSize,c=(h-1)*this.actualCellSize+t;o.html.css({left:r,top:c,width:this.actualCellSize,height:this.actualCellSize}),o.cr1=this.cr1,o.cr2=this.cr2,1==this.isDirty?o.commitProps.call(o):o.updateDispList.call(o),s++}},this.computeCellSize=function(t,i){var e=t,s=i;return 1==this.showLabels&&this.textFields.length>0?(e=t-this.textFields[this.textFields.length-1].width(),s=i-this.textFields[0].height()):(e=t,s=i),Math.min(e,s)/(this.fields.length-1)},this.updateDispList=function(){var t=$(this.parent),i=t.innerWidth(),e=t.innerHeight();this.container.css({width:i,height:e}),this.actualCellSize=this.computeCellSize(i,e),this.showLabels&&this.textFields.length>0&&this.layoutTextFields(),this.layoutCells()},this.commitProp=function(){this.isDirty=!0,this.generateComparisonStatistics(),this.createOrRemoveCells(),this.updateTextFields(),this.updateDispList(),this.isDirty=!1}},IG$.ComparisonMatrix.prototype.drawDetailPlot=function(t){var i=this.matrixitems[t.id],e=i.compItem.compVal>this.cr2?"rgba(0,0,255,.5)":i.compItem.compVal>this.cr1?"rgba(150,150,150,.5)":"rgba(255,0,0,0.5)";if(i){var s={chart:{renderTo:this.detailcontainer[0],defaultSeriesType:"scatter",zoomType:"xy"},title:{text:i.compItem.xFieldName+" vs. "+i.compItem.yFieldName},xAxis:{title:{enabled:!0,text:i.compItem.xFieldName},startOnTick:!0,endOnTick:!0,showLastLabel:!0,min:0,max:1},yAxis:{title:{text:i.compItem.yFieldName},min:0,max:1},tooltip:{formatter:function(){return this.x+", "+this.y}},legend:{enabled:!1,layout:"vertical",align:"left",verticalAlign:"top",floating:!0,backgroundColor:"#FFFFFF",borderWidth:1},plotOptions:{scatter:{marker:{radius:5,states:{hover:{enabled:!0,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:!1}}}}},series:[{name:"comparison",color:e,data:i.plotData}]},h=$(this.parent),a=h.width(),l=h.height(),o=.85*Math.min(l,a);this.detailviewer.css({left:a-o-10,top:5,width:o,height:o}),this.detailviewer.show(),this.plotdetail=new Highcharts.Chart(s)}};
function randomize(t){return t.randomizer||(t.randomizer=randomizer(t)),t.ranges=t.ranges.map(t.randomizer),t.markers=t.markers.map(t.randomizer),t.measures=t.measures.map(t.randomizer),t}function randomizer(t){var r=.2*d3.max(t.ranges);return function(t){return Math.max(0,t+r*(Math.random()-.5))}}function bulletRanges(t){return t.ranges}function bulletMarkers(t){return t.markers}function bulletMeasures(t){return t.measures}function bulletTranslate(t){return function(r){return"translate("+t(r)+",0)"}}function bulletWidth(t){var r=t(0);return function(a){return Math.abs(t(a)-r)}}IG$.c$BulChart=function(t){this.owner=t,this.bb=null,this.initialize()},IG$.c$BulChart.prototype={initialize:function(){var t,r=this,a=r.owner,e=$("<div></div>").appendTo(a);r.width=IG$.j$ext._w(a),r.height=IG$.j$ext._h(a),r.margin={top:5,right:40,bottom:20,left:120},r.bb||(r.bb=IG$.c$BullChartV(),IG$.j$ext._w(r.bb,r.width-r.margin.right-r.margin.left),IG$.j$ext._h(r.bb,r.height-r.margin.top-r.margin.bottom)),t=$("<ul></ul>").appendTo(e),r.gtp=t,t=$("<li></li>").appendTo(r.gtp),$("<div>Ranges</div>").appendTo(t),r.ranges=$("<combobox></combobox>").appendTo(t),t=$("<li></li>").appendTo(r.gtp),$("<div>Measures</div>").appendTo(t),r.measures=$("<combobox></combobox>").appendTo(t),t=$("<li></li>").appendTo(r.gtp),$("<div>Markers</div>").appendTo(t),r.markers=$("<combobox></combobox>").appendTo(t)},loadData:function(t){var r,a=this,e=(a.owner,a.width),n=a.height,i=a.margin,l=$("<div><div>").appendTo(a.owner),o=d3.select(l[0]).selectAll("svg"),s=a.bb;r=a.getData(),o.data(r).enter().append("svg").attr("class","bullet").attr("width",e).attr("height",n).append("g").attr("transform","translate("+i.left+","+i.top+")").call(s);var u=o.append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(n-i.top-i.bottom)/2+")");u.append("text").attr("class","title").text((function(t){return t.title})),u.append("text").attr("class","subtitle").attr("dy","1em").text((function(t){return t.subtitle})),a.vis=o,a.title=u,s.duration(1e3)},drawChart:function(){var t=this.bb;vis.datum(randomize).call(t)},getData:function(){var t,r,a,e,n,i,l,o,s=[],u=mresult._tabledata,d=mresult.colfix,c=mresult.rowfix,h=u.length>0?u[0].length:0,m={},g={};for(t=d;t<h;t++);for(t=c;t<u.length;t++){for(a={title:null,ranges:[],measures:[],markers:[]},l=null,o=null,r=0;r<h;r++)r<d?(e=u[t][r].text||u[t][r].code,a.title=0==t?e:a.title+" "+e):(e=Number(u[t][r].code),n=r==d?e:Math.max(n,e),i=r==d?e:Math.min(i,e),1==m[r]&&(null==l?(l=e,o=e):(l=Math.min(l,e),o=Math.max(o,e))),1==g[r]&&a.markers.push(e));a.ranges=[i,void 0,n],a.measures=[l,o],s.push(a)}return s}},IG$.c$BullChartV=function(){var t="left",r=!1,a=0,e=bulletRanges,n=bulletMarkers,i=bulletMeasures,l=380,o=30,s=null;function u(t){t.each((function(t,u){var d=e.call(this,t,u).slice().sort(d3.descending),c=n.call(this,t,u).slice().sort(d3.descending),h=i.call(this,t,u).slice().sort(d3.descending),m=d3.select(this),g=d3.scale.linear().domain([0,Math.max(d[0],c[0],h[0])]).range(r?[l,0]:[0,l]),p=this.__chart__||d3.scale.linear().domain([0,1/0]).range(g.range());this.__chart__=g;var b=bulletWidth(p),f=bulletWidth(g),x=m.selectAll("rect.range").data(d);x.enter().append("svg:rect").attr("class",(function(t,r){return"range s"+r})).attr("width",b).attr("height",o).attr("x",r?p:0).transition().duration(a).attr("width",f).attr("x",r?g:0),x.transition().duration(a).attr("x",r?g:0).attr("width",f).attr("height",o);var v=m.selectAll("rect.measure").data(h);v.enter().append("svg:rect").attr("class",(function(t,r){return"measure s"+r})).attr("width",b).attr("height",o/3).attr("x",r?p:0).attr("y",o/3).transition().duration(a).attr("width",f).attr("x",r?g:0),v.transition().duration(a).attr("width",f).attr("height",o/3).attr("x",r?g:0).attr("y",o/3);var $=m.selectAll("line.marker").data(c);$.enter().append("svg:line").attr("class","marker").attr("x1",p).attr("x2",p).attr("y1",o/6).attr("y2",5*o/6).transition().duration(a).attr("x1",g).attr("x2",g),$.transition().duration(a).attr("x1",g).attr("x2",g).attr("y1",o/6).attr("y2",5*o/6);var y=s||g.tickFormat(8),w=m.selectAll("g.tick").data(g.ticks(8),(function(t){return this.textContent||y(t)})),k=w.enter().append("svg:g").attr("class","tick").attr("transform",bulletTranslate(p)).style("opacity",1e-6);k.append("svg:line").attr("y1",o).attr("y2",7*o/6),k.append("svg:text").attr("text-anchor","middle").attr("dy","1em").attr("y",7*o/6).text(y),k.transition().duration(a).attr("transform",bulletTranslate(g)).style("opacity",1);var T=w.transition().duration(a).attr("transform",bulletTranslate(g)).style("opacity",1);T.select("line").attr("y1",o).attr("y2",7*o/6),T.select("text").attr("y",7*o/6),w.exit().transition().duration(a).attr("transform",bulletTranslate(g)).style("opacity",1e-6).remove()})),d3.timer.flush()}return u.orient=function(a){return arguments.length?(r="right"==(t=a)||"bottom"==t,u):t},u.ranges=function(t){return arguments.length?(e=t,u):e},u.markers=function(t){return arguments.length?(n=t,u):n},u.measures=function(t){return arguments.length?(i=t,u):i},u.width=function(t){return arguments.length?(l=t,u):l},u.height=function(t){return arguments.length?(o=t,u):o},u.tickFormat=function(t){return arguments.length?(s=t,u):s},u.duration=function(t){return arguments.length?(a=t,u):a},u};